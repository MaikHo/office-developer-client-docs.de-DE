---
title: Benachrichtigung bei unterstützenden
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a1e3e49c-8d1d-4f7e-ba5a-be441f0f10ae
description: 'Letzte �nderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 45bfe9f9314a154bd5f096ac20f76f6bf4f259c3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19795643"
---
# <a name="supporting-event-notification"></a><span data-ttu-id="6b56b-103">Benachrichtigung bei unterstützenden</span><span class="sxs-lookup"><span data-stu-id="6b56b-103">Supporting Event Notification</span></span>

  
  
<span data-ttu-id="6b56b-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="6b56b-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="6b56b-105">Da Unterstützung ereignisbenachrichtigung kompliziert sein kann, bietet MAPI drei Support-Objekt-Methoden, mit die die schwierigsten Teile des Prozesses implementiert.</span><span class="sxs-lookup"><span data-stu-id="6b56b-105">Because supporting event notification can be complicated, MAPI supplies three support object methods that implement the most difficult parts of the process.</span></span> <span data-ttu-id="6b56b-106">Diese Methoden funktionieren als Einheit und ein Anbieter muss alle drei oder keines der Projekte verwenden.</span><span class="sxs-lookup"><span data-stu-id="6b56b-106">These methods work as a unit, and a provider must use all three or none of them.</span></span>
  
<span data-ttu-id="6b56b-107">Die MAPI-Support-Methoden verwenden Benachrichtigung Schlüssel zum Verwalten der Verbindungen zwischen der Advise-senken und die Objekte, die die Benachrichtigungen generieren.</span><span class="sxs-lookup"><span data-stu-id="6b56b-107">The MAPI support methods use notification keys to manage the connections between the advise sinks and the objects that generate the notifications.</span></span> <span data-ttu-id="6b56b-108">Ein Benachrichtigung Schlüssel ist eine [NOTIFKEY](notifkey.md) -Struktur, die binäre Daten enthält, die ein Objekt über Prozesse identifiziert.</span><span class="sxs-lookup"><span data-stu-id="6b56b-108">A notification key is a [NOTIFKEY](notifkey.md) structure that contains binary data that identifies an object across processes.</span></span> <span data-ttu-id="6b56b-109">Ein Benachrichtigung Schlüssel wird in der Regel aus der langfristige Eintrags-ID des Quellobjekts Advise kopiert.</span><span class="sxs-lookup"><span data-stu-id="6b56b-109">A notification key is typically copied from the long-term entry identifier of the advise source object.</span></span> <span data-ttu-id="6b56b-110">Wenn der Client einen Eintrag Bezeichner im Aufruf **Advise**bereitgestellt hat, können Sie es für die Benachrichtigung-Taste.</span><span class="sxs-lookup"><span data-stu-id="6b56b-110">If the client has supplied an entry identifier in the call to **Advise**, you can use it for the notification key.</span></span> <span data-ttu-id="6b56b-111">Wenn der Parameter _LpEntryID_ **Advise** NULL ist, verwenden Sie die Eintrags-ID des äußersten möglichen Container-Objekts, wie die Nachrichtenspeicher.</span><span class="sxs-lookup"><span data-stu-id="6b56b-111">If the  _lpEntryID_ parameter to **Advise** is NULL, use the entry identifier of the outermost possible container object, such as the message store.</span></span> 
  
<span data-ttu-id="6b56b-112">Um die von Unterstützungsmethoden verwenden, rufen Sie [IMAPISupport::Subscribe](imapisupport-subscribe.md) , wenn ein Client für eine Benachrichtigung registrieren Ihrer **Advise** -Methode aufruft.</span><span class="sxs-lookup"><span data-stu-id="6b56b-112">To use the support methods, call [IMAPISupport::Subscribe](imapisupport-subscribe.md) whenever a client calls your **Advise** method to register for a notification.</span></span> <span data-ttu-id="6b56b-113">Ordnen Sie eine Struktur [NOTIFKEY zu](notifkey.md) , und erstellen Sie einen eindeutigen Benachrichtigung Product Key für Ihre Advise-Source-Objekt.</span><span class="sxs-lookup"><span data-stu-id="6b56b-113">Allocate a [NOTIFKEY](notifkey.md) structure and create a unique notification key for your advise source object.</span></span> <span data-ttu-id="6b56b-114">Eine Nachricht Speicheranbieter, die aufgefordert wird, einen Client benachrichtigen, wenn eine Nachricht empfangen wird in einen bestimmten Ordner erstellt beispielsweise einen Benachrichtigung Schlüssel für diesen Ordner.</span><span class="sxs-lookup"><span data-stu-id="6b56b-114">For example, a message store provider that is prompted to notify a client when a message is received into a particular folder creates a notification key for that folder.</span></span> <span data-ttu-id="6b56b-115">Übergeben Sie einen Zeiger auf die Struktur **NOTIFKEY** im Aufruf **Subscribe** sowie einen Zeiger auf des Clients advise-Empfänger.</span><span class="sxs-lookup"><span data-stu-id="6b56b-115">Pass a pointer to the **NOTIFKEY** structure in the call to **Subscribe** along with a pointer to the client's advise sink.</span></span> <span data-ttu-id="6b56b-116">**Subscribe** ruft Advise-Empfänger [IUnknown:: AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) -Methode, um die Anzahl der Verweise zu erhöhen und MAPI behält den Zeiger, bis die Registrierung abgebrochen wird.</span><span class="sxs-lookup"><span data-stu-id="6b56b-116">**Subscribe** calls the advise sink's [IUnknown::AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) method to increment its reference count and MAPI retains the pointer until the registration is canceled.</span></span> 
  
<span data-ttu-id="6b56b-117">Können Sie die Kennzeichen NOTIFY_SYNC an übergeben **Subscribe** anfordern, dass **Benachrichtigen** Verhalten synchron und nicht zurückgegeben, bis sie alle Aufrufe der Methoden [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) vorgenommen hat registriert advise-Empfänger.</span><span class="sxs-lookup"><span data-stu-id="6b56b-117">You can pass the NOTIFY_SYNC flag to **Subscribe** to request that **Notify** behave synchronously and not return until it has made all calls to the [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) methods of registered advise sinks.</span></span> <span data-ttu-id="6b56b-118">Legen Sie dieses Flag nur für die interne Verwendung.</span><span class="sxs-lookup"><span data-stu-id="6b56b-118">Set this flag only for your own internal use.</span></span> <span data-ttu-id="6b56b-119">Legen Sie sie nicht, wenn Sie einen Client **Advise** -Anruf beantworten.</span><span class="sxs-lookup"><span data-stu-id="6b56b-119">Do not set it when you respond to a client **Advise** call.</span></span> <span data-ttu-id="6b56b-120">Benachrichtigung bei zwischen Clients und Anbieter ist immer asynchron.</span><span class="sxs-lookup"><span data-stu-id="6b56b-120">Event notification between clients and providers is always asynchronous.</span></span> <span data-ttu-id="6b56b-121">MAPI garantiert, dass das heißt, den Anruf, in dem ein Ereignis eintritt an den Client zurückgegeben werden, bevor einer der Aufrufe **OnNotify** vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="6b56b-121">That is, MAPI guarantees that the call during which an event happens will return to the client before any of the **OnNotify** calls are made.</span></span> 
  
<span data-ttu-id="6b56b-122">Wenn Sie das NOTIFY_SYNC-Flag festlegen, nehmen Sie keine Änderungen nicht auf eines der Empfängerobjekten anweisen, und übergeben Sie einen Wrapper Advise-Empfänger erstelltes [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) **Abonnieren**nicht.</span><span class="sxs-lookup"><span data-stu-id="6b56b-122">If you set the NOTIFY_SYNC flag, do not make any changes to any of the advise sink objects, and do not pass a wrapper advise sink created by [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) to **Subscribe**.</span></span> <span data-ttu-id="6b56b-123">**HrThisThreadAdviseSink** erstellt eine threadsicheren Version einer Advise-Empfänger mit asynchrone Benachrichtigung nur verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="6b56b-123">**HrThisThreadAdviseSink** creates a thread-safe version of an advise sink to be used with asynchronous notification only.</span></span> 
  
<span data-ttu-id="6b56b-124">Wenn ein Advise-Empfänger, die für die synchrone Benachrichtigung registriert **OnNotify** mit CALLBACK_DISCONTINUE Flag zurückgibt, [IMAPISupport::Notify](imapisupport-notify.md) legt das Flag NOTIFY_CANCELED und ohne Aufrufe von **OnNotify**zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6b56b-124">If an advise sink registered for synchronous notification returns from **OnNotify** with the CALLBACK_DISCONTINUE flag set, [IMAPISupport::Notify](imapisupport-notify.md) sets the NOTIFY_CANCELED flag and returns without making any calls to **OnNotify**.</span></span> 
  
<span data-ttu-id="6b56b-125">Nachdem **Subscribe** zurückgegeben wurde, wird nicht mehr muss alle Ihre Kopie des Clients advise-Empfänger.</span><span class="sxs-lookup"><span data-stu-id="6b56b-125">Once **Subscribe** has returned, you will no longer have any need to hold onto your copy of the client's advise sink.</span></span> <span data-ttu-id="6b56b-126">Rufen Sie dessen [IUnknown](http://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) -Methode, um es zu lösen.</span><span class="sxs-lookup"><span data-stu-id="6b56b-126">Call its [IUnknown::Release](http://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) method to release it.</span></span> <span data-ttu-id="6b56b-127">**Subscribe** gibt eine Verbindung ungleich NULL zurück, die an den Client zurückgegeben werden soll.</span><span class="sxs-lookup"><span data-stu-id="6b56b-127">**Subscribe** returns a nonzero connection number that you should return to the client.</span></span> <span data-ttu-id="6b56b-128">Die Nummer stellt die Verknüpfung zwischen der Advise-Quelle und der Advise-Empfänger.</span><span class="sxs-lookup"><span data-stu-id="6b56b-128">The connection number represents the link between the advise source and the advise sink.</span></span> <span data-ttu-id="6b56b-129">Es bleibt gültig, bis der Client erfolgreich **Unadvise**aufruft.</span><span class="sxs-lookup"><span data-stu-id="6b56b-129">It remains valid until the client makes a successful call to **Unadvise**.</span></span> 
  
<span data-ttu-id="6b56b-130">Wenn der Client eine Registrierung Abbrechen bereit ist, ruft es Ihre **Unadvise** -Methode.</span><span class="sxs-lookup"><span data-stu-id="6b56b-130">When the client is ready to cancel a registration, it calls your **Unadvise** method.</span></span> <span data-ttu-id="6b56b-131">Übergeben Sie die Nummer aus dem Aufruf **Unadvise** [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md).</span><span class="sxs-lookup"><span data-stu-id="6b56b-131">Pass the connection number from the **Unadvise** call to [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md).</span></span> <span data-ttu-id="6b56b-132">Der Advise-Empfänger **IUnknown** -Methode aufgerufen, **zum Abmelden** .</span><span class="sxs-lookup"><span data-stu-id="6b56b-132">**Unsubscribe** calls the advise sink's **IUnknown::Release** method.</span></span> <span data-ttu-id="6b56b-133">Wie bei **Advise** und **Unadvise**müssen Aufrufe von **Abonnieren** und **kündigen** kombiniert werden.</span><span class="sxs-lookup"><span data-stu-id="6b56b-133">As with **Advise** and **Unadvise**, calls to **Subscribe** and **Unsubscribe** must be paired.</span></span> <span data-ttu-id="6b56b-134">Sie müssen durch Aufrufen von **zum Abmelden** für jeden Aufruf vornehmen, die mit **Subscribe**hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="6b56b-134">You must make one call to **Unsubscribe** for every call that is made to **Subscribe**.</span></span> <span data-ttu-id="6b56b-135">Sie müssen jedoch keinen **Subscribe** rufen Sie jedes Mal, wenn die **Advise** -Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="6b56b-135">However, you do not have to call **Subscribe** every time your **Advise** method is called.</span></span> <span data-ttu-id="6b56b-136">Im Gegensatz dazu können Sie es für das Einrichten von internen Benachrichtigungen aufrufen.</span><span class="sxs-lookup"><span data-stu-id="6b56b-136">Conversely, you can call it for setting up internal notifications.</span></span> 
  
<span data-ttu-id="6b56b-137">Wenn ein Ereignis eintritt, reservieren Sie eine oder mehrere [Benachrichtigung](notification.md) Strukturen vom Typ für das Ereignis, und rufen Sie [IMAPISupport::Notify](imapisupport-notify.md).</span><span class="sxs-lookup"><span data-stu-id="6b56b-137">When an event occurs, allocate one or more [NOTIFICATION](notification.md) structures of the type appropriate for the event and call [IMAPISupport::Notify](imapisupport-notify.md).</span></span> <span data-ttu-id="6b56b-138">**Benachrichtigen** generiert eine Benachrichtigung für jeden registrierten Advise-Empfänger.</span><span class="sxs-lookup"><span data-stu-id="6b56b-138">**Notify** generates a notification for each registered advise sink.</span></span> <span data-ttu-id="6b56b-139">Sie sollten alle nicht verwendeten Mitglieder der [Benachrichtigung](notification.md) Struktur auf NULL festgelegt.</span><span class="sxs-lookup"><span data-stu-id="6b56b-139">You should set all the unused members of the [NOTIFICATION](notification.md) structure to zero.</span></span> <span data-ttu-id="6b56b-140">Dieses Verfahren für die Initialisierung der **Benachrichtigung** Struktur hilft Clients kleiner, schneller und weniger fehleranfällig **OnNotify** Implementierungen zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="6b56b-140">This technique for initializing the **NOTIFICATION** structure can help clients create smaller, faster, and less error-prone **OnNotify** implementations.</span></span> 
  
<span data-ttu-id="6b56b-141">Beachten Sie, dass eine separate **Benachrichtigung** Struktur für jedes Ereignis, auch für mehrere Ereignisse des gleichen Typs erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="6b56b-141">Note that a separate **NOTIFICATION** structure is necessary for each event, even for multiple events of the same type.</span></span> <span data-ttu-id="6b56b-142">Beispielsweise müssen drei Clients für die Tabelle Benachrichtigung für eine bestimmte Tabelle registriert sind, und fünf Zeilen der Tabelle hinzugefügt werden, Sie fünf **OBJECT_NOTIFICATION** Strukturen für Ihren Anruf **Benachrichtigen** erstellen.</span><span class="sxs-lookup"><span data-stu-id="6b56b-142">For example, if three clients are registered for table notification on a particular table and five rows are added to the table, you must create five **OBJECT_NOTIFICATION** structures for your **Notify** call.</span></span> <span data-ttu-id="6b56b-143">Eine Benachrichtigung Batch wie dies führt eine bessere Leistung als **Benachrichtigen** fünfmaliges aufrufen.</span><span class="sxs-lookup"><span data-stu-id="6b56b-143">A batch notification such as this results in better performance than calling **Notify** five times.</span></span> <span data-ttu-id="6b56b-144">Für jeden Anruf **Benachrichtigen** ruft MAPI die [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) -Methode des alle registrierten Advise-Empfänger.</span><span class="sxs-lookup"><span data-stu-id="6b56b-144">For each **Notify** call, MAPI calls the [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) method of every registered advise sink.</span></span> <span data-ttu-id="6b56b-145">Wenn vorhanden sind keine registrierten advise-Empfänger, MAPI ignoriert den Anruf.</span><span class="sxs-lookup"><span data-stu-id="6b56b-145">If there are no registered advise sinks, MAPI ignores the call.</span></span> 
  
<span data-ttu-id="6b56b-146">Dienstanbieter, die im Batchmodus Benachrichtigungen senden müssen sie bestellen, damit sie auf die letzte aus der ersten Benachrichtigung interpretiert werden können.</span><span class="sxs-lookup"><span data-stu-id="6b56b-146">Service providers that send batched notifications must order them so that they can be interpreted from the first notification to the last.</span></span> <span data-ttu-id="6b56b-147">Diese Reihenfolge ist insbesondere dann erforderlich, wenn ein Batches für die Benachrichtigung über eine Reihe von Ereignissen, wie etwa TABLE_ROW_ADDED mit einem Ereignis enthält, das auf eine vorherige Zeile verweist, die in einem anderen Ereignis in einem Batch hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="6b56b-147">This ordering is especially necessary when a notification batch contains a series of events, such as TABLE_ROW_ADDED with one event that refers to a prior row that was added in another event in the same batch.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="6b56b-148">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="6b56b-148">See also</span></span>



[<span data-ttu-id="6b56b-149">MAPI-Dienstanbieter</span><span class="sxs-lookup"><span data-stu-id="6b56b-149">MAPI Service Providers</span></span>](mapi-service-providers.md)

