---
title: Cache für Spitznamen
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 2813c102-6778-4443-ab4b-b573f3568705
description: 'Zuletzt geändert: 30 Januar 2013'
ms.openlocfilehash: 841b01ae8dfcf841b0a1d64113ce7258c4c61583
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/04/2018
ms.locfileid: "25389260"
---
# <a name="nickname-cache"></a><span data-ttu-id="07c9f-103">Cache für Spitznamen</span><span class="sxs-lookup"><span data-stu-id="07c9f-103">Nickname cache</span></span>

 
  
<span data-ttu-id="07c9f-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="07c9f-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="07c9f-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010 und Microsoft Outlook 2013 interagieren mit der Nickname-Cache, auch bekannt als "AutoVervollständigen Datenstroms."</span><span class="sxs-lookup"><span data-stu-id="07c9f-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010, and Microsoft Outlook 2013 interact with the nickname cache, also known as the "autocomplete stream."</span></span> <span data-ttu-id="07c9f-106">Der AutoVervollständigen-Stream ist, in denen Outlook weiterhin auftritt, der AutoVervollständigen-Liste wird die Liste der Namen, die in der **an**, **Cc**, anzeigt und **Bcc** Bearbeitungsfelder während ein Benutzer eine e-Mail-Nachricht erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="07c9f-106">The autocomplete stream is where Outlook persists the autocomplete list, which is the list of names that displays in the **To**, **Cc**, and **Bcc** edit boxes while a user is composing an email.</span></span> <span data-ttu-id="07c9f-107">In diesem Thema wird beschrieben, wie Outlook 2007, Outlook 2010 und Outlook 2013 mit dem AutoVervollständigen-Stream interagieren und erörtert das binäre Format der Datei und die empfohlenen Maßnahmen für die Interaktion mit dem AutoVervollständigen-Stream.</span><span class="sxs-lookup"><span data-stu-id="07c9f-107">This topic describes how Outlook 2007, Outlook 2010, and Outlook 2013 interact with the autocomplete stream and also discusses the binary format of the file and the recommended ways for interacting with the autocomplete stream.</span></span> 
  
<span data-ttu-id="07c9f-108">Für Anwendungen, die Interaktion mit Outlook 2010 oder Outlook 2013, AutoVervollständigen-Datenstroms wird als MAPI-Eigenschaft gespeichert und kann mithilfe der MAPI oder das **PropertyAccessor** -Objekt der Nachricht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="07c9f-108">For applications that interact with Outlook 2010 or Outlook 2013, the autocomplete stream is stored as a MAPI property and can be modified using the MAPI or the **PropertyAccessor** object of the message.</span></span> <span data-ttu-id="07c9f-109">Das **PropertyAccessor** -Objekt wird in der Outlook 2010 oder Outlook 2013-Objektmodell verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="07c9f-109">The **PropertyAccessor** object is exposed in the Outlook 2010 or Outlook 2013 object models.</span></span> 
  
<span data-ttu-id="07c9f-110">Es gibt keine Abhängigkeiten auf dem Outlook 2007-Objektmodell oder die MAPI-APIs.</span><span class="sxs-lookup"><span data-stu-id="07c9f-110">There are no dependencies on the Outlook 2007 object model or MAPI APIs.</span></span> <span data-ttu-id="07c9f-111">Anwendungen, die die AutoVervollständigen-Datenstroms in Outlook 2007 ändern können daher mithilfe einer beliebigen Programmiersprache geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="07c9f-111">Therefore, applications that make changes to the autocomplete stream within Outlook 2007 can be written using any programming language.</span></span>
  
## <a name="interacting-with-the-autocomplete-stream"></a><span data-ttu-id="07c9f-112">Interaktion mit dem AutoVervollständigen-Stream</span><span class="sxs-lookup"><span data-stu-id="07c9f-112">Interacting with the Autocomplete Stream</span></span>

<span data-ttu-id="07c9f-113">Wenn die Bearbeitungsfelder **an**, **Cc**oder **Bcc** für eine Nachricht zugegriffen werden, der AutoVervollständigen-Stream wird geladen, und die Liste der Benutzernamen wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="07c9f-113">When the **To**, **Cc**, or **Bcc** edit boxes are accessed on a message, the autocomplete stream is loaded and the list of user names is displayed.</span></span> <span data-ttu-id="07c9f-114">Outlook interagiert mit dem AutoVervollständigen-Stream auf zwei Arten:</span><span class="sxs-lookup"><span data-stu-id="07c9f-114">Outlook interacts with the autocomplete stream in two ways:</span></span> 
  
1. <span data-ttu-id="07c9f-115">Laden den AutoVervollständigen-stream</span><span class="sxs-lookup"><span data-stu-id="07c9f-115">Loading the autocomplete stream</span></span> 
    
2. <span data-ttu-id="07c9f-116">Speichern von Änderungen an den Daten im Datenstrom AutoVervollständigen</span><span class="sxs-lookup"><span data-stu-id="07c9f-116">Saving changes to the data in the autocomplete stream</span></span>
    
<span data-ttu-id="07c9f-117">Die Mittel zur Speicherung der Daten AutoVervollständigen unterscheidet zwischen Outlook 2007 und Outlook 2010 oder Outlook 2013 wie folgt:</span><span class="sxs-lookup"><span data-stu-id="07c9f-117">The means of storing the autocomplete data differs between Outlook 2007 and Outlook 2010 or Outlook 2013 as follows:</span></span> 
  
 <span data-ttu-id="07c9f-118">**Outlook 2007**</span><span class="sxs-lookup"><span data-stu-id="07c9f-118">**Outlook 2007**</span></span>
  
<span data-ttu-id="07c9f-119">Für Outlook 2007 wird der Stream AutoVervollständigen in einer Datei mit dem gleichen Namen wie das Profil und der Erweiterung nk2 gespeichert.</span><span class="sxs-lookup"><span data-stu-id="07c9f-119">For Outlook 2007, the autocomplete stream is stored in a file with the same name as the profile and an extension of .nk2.</span></span> <span data-ttu-id="07c9f-120">Angenommen, wenn das Standardprofil für "Outlook" verwendet wird, wird die Datei "outlook.nk2" aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="07c9f-120">For example, if the default profile of "outlook" is used, the file will be called "outlook.nk2".</span></span> <span data-ttu-id="07c9f-121">Die NK2-Datei wird in % APPDATA%\Microsoft\Outlook gespeichert.</span><span class="sxs-lookup"><span data-stu-id="07c9f-121">The .nk2 file is stored in %APPDATA%\Microsoft\Outlook.</span></span> <span data-ttu-id="07c9f-122">Weitere Informationen zu der Nickname-Cache-Binärdateiformat finden Sie unter [Outlook 2003/2007 NK2-Dateiformat und Richtlinien für Entwickler](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span><span class="sxs-lookup"><span data-stu-id="07c9f-122">For more information about the nickname cache binary file format, see [Outlook 2003/2007 NK2 File Format and Developer Guidelines](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span></span>
  
 <span data-ttu-id="07c9f-123">**Outlook 2010 und Outlook 2013**</span><span class="sxs-lookup"><span data-stu-id="07c9f-123">**Outlook 2010 and Outlook 2013**</span></span>
  
<span data-ttu-id="07c9f-124">Outlook 2010 oder Outlook 2013 liest den AutoVervollständigen-Stream aus einer Nachricht in der Tabelle verknüpfte Inhalt des Posteingangs von übermittlungsspeicher der e-Mail-Konto.</span><span class="sxs-lookup"><span data-stu-id="07c9f-124">Outlook 2010 or Outlook 2013 reads the autocomplete stream from a message in the Associated Contents table of the Inbox of the mail account's delivery store.</span></span> <span data-ttu-id="07c9f-125">Diese ausgeblendete Nachricht hat eine Nachrichtenklasse und den Betreff der IPM. Configuration.Autocomplete.</span><span class="sxs-lookup"><span data-stu-id="07c9f-125">This hidden message has a message class and subject of IPM.Configuration.Autocomplete.</span></span> <span data-ttu-id="07c9f-126">Der AutoVervollständigen-Stream wird dieser Nachricht in der PR_ROAMING_BINARYSTREAM-Eigenschaft ([PidTagRoamingBinary kanonische-Eigenschaft](pidtagroamingbinary-canonical-property.md)) gespeichert.</span><span class="sxs-lookup"><span data-stu-id="07c9f-126">The autocomplete stream is stored on this message in the PR_ROAMING_BINARYSTREAM property ([PidTagRoamingBinary Canonical Property](pidtagroamingbinary-canonical-property.md)).</span></span> <span data-ttu-id="07c9f-127">Die AutoVervollständigen-Daten können in einer AutoVervollständigen .dat-Datei befindet sich im % USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache vorübergehend zwischengespeichert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="07c9f-127">The autocomplete data may be temporarily cached in an autocomplete .dat file located in %USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span></span> <span data-ttu-id="07c9f-128">Allerdings werden die .dat-Datei ist nur ein Cache und wird nicht verwendet, um die übermittlungsspeicher Zurückschreiben, wenn der Benutzer Outlook 2010 oder Outlook 2013 beendet.</span><span class="sxs-lookup"><span data-stu-id="07c9f-128">However, the .dat file is only a cache and is not used to write back to the delivery store when the user exits Outlook 2010 or Outlook 2013.</span></span>
  
## <a name="loading-the-autocomplete-stream"></a><span data-ttu-id="07c9f-129">Laden den AutoVervollständigen-Stream</span><span class="sxs-lookup"><span data-stu-id="07c9f-129">Loading the Autocomplete Stream</span></span>

<span data-ttu-id="07c9f-130">Outlook lädt den AutoVervollständigen-Datenstrom aus, wenn ein Element mit Adressierung Funktionalität initialisiert wird.</span><span class="sxs-lookup"><span data-stu-id="07c9f-130">Outlook loads the autocomplete stream whenever an item with addressing functionality is initialized.</span></span> <span data-ttu-id="07c9f-131">Beispielsweise werden e-Mail-Adressen in einer neuen e-Mail-Nachrichten, eine e-Mail-Antwort, ein Kontaktelement, einer Besprechungsanfrage usw. verwendet.</span><span class="sxs-lookup"><span data-stu-id="07c9f-131">For example, email addresses are used in a new mail, a mail reply, a contact item, a meeting request, and so on.</span></span> <span data-ttu-id="07c9f-132">Um die Daten zu laden, liest Outlook den Inhalt des Datenstroms in den Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="07c9f-132">To load the data, Outlook reads all of the contents of the stream into memory.</span></span>
  
<span data-ttu-id="07c9f-133">Für AutoVervollständigen-Operationen interagiert Outlook ausschließlich diese Struktur im Speicher für die Dauer der Lebensdauer Prozess outlook.exe.</span><span class="sxs-lookup"><span data-stu-id="07c9f-133">For autocomplete operations, Outlook interacts exclusively with this in-memory structure for the duration of the outlook.exe process lifetime.</span></span> <span data-ttu-id="07c9f-134">Outlook speichert nur die Struktur auf Herunterfahren.</span><span class="sxs-lookup"><span data-stu-id="07c9f-134">Outlook only saves the structure on shutdown.</span></span> <span data-ttu-id="07c9f-135">Finden Sie im folgenden Abschnitt "AutoVervollständigen-Stream speichern" Weitere Informationen zu diesem Vorgang.</span><span class="sxs-lookup"><span data-stu-id="07c9f-135">See the following section "Saving the Autocomplete Stream" for more information on this process.</span></span>
  
## <a name="saving-the-autocomplete-stream"></a><span data-ttu-id="07c9f-136">Speichern den AutoVervollständigen-Stream</span><span class="sxs-lookup"><span data-stu-id="07c9f-136">Saving the Autocomplete Stream</span></span>

<span data-ttu-id="07c9f-137">Outlook gespeichert AutoVervollständigen-Datenstrom beim Herunterfahren, wenn die AutoVervollständigen-Liste in einem der folgenden Methoden geändert wurde:</span><span class="sxs-lookup"><span data-stu-id="07c9f-137">Outlook saves the autocomplete stream on shutdown if the autocomplete list has changed in any of the following ways:</span></span>
  
- <span data-ttu-id="07c9f-138">Ein neuen Eintrag Spitzname wird über das Auflösen von Namen, einen Empfänger aus dem Adressbuch im Dialogfeld Adresse auswählen oder Senden von Nachrichten an einen Empfänger, der nicht bereits in der Liste wurde hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="07c9f-138">A new nickname entry is added through resolving a name, picking a recipient from the address book dialog, or sending mail to a recipient that was not already in the list.</span></span>
    
- <span data-ttu-id="07c9f-139">Ein Eintrag wird durch Senden von Nachrichten an einen vorhandenen Empfänger in der Liste geändert.</span><span class="sxs-lookup"><span data-stu-id="07c9f-139">An entry is modified by sending mail to an existing recipient in the list.</span></span>
    
- <span data-ttu-id="07c9f-140">Ein Eintrag wird vom Benutzer über die Benutzeroberfläche entfernt.</span><span class="sxs-lookup"><span data-stu-id="07c9f-140">An entry is removed by the user through the UI.</span></span>
    
- <span data-ttu-id="07c9f-141">Andere kleineren Szenarien in diesem Thema nicht relevant.</span><span class="sxs-lookup"><span data-stu-id="07c9f-141">Other minor scenarios not relevant to this topic.</span></span>
    
<span data-ttu-id="07c9f-142">Speichern von Änderungen an den AutoVervollständigen-Daten umfasst das Zurückschreiben in-Memory-Struktur in einer [AutoVervollständigen-Stream](autocomplete-stream.md).</span><span class="sxs-lookup"><span data-stu-id="07c9f-142">Saving changes to the autocomplete data involves writing the in-memory structure back to an [Autocomplete Stream](autocomplete-stream.md).</span></span> <span data-ttu-id="07c9f-143">Bei der Interaktion mit Outlook 2007, wird der Stream-Objekt in einer lokalen NK2-Datei gespeichert.</span><span class="sxs-lookup"><span data-stu-id="07c9f-143">When interacting with Outlook 2007, the stream is saved to a local .nk2 file.</span></span> <span data-ttu-id="07c9f-144">Für Outlook 2010 oder Outlook 2013 schreibt der AutoVervollständigen-Stream zurück zur Inhalt verknüpften Tabelle mit den Posteingang des übermittlungsspeicher der e-Mail-Konto.</span><span class="sxs-lookup"><span data-stu-id="07c9f-144">For Outlook 2010 or Outlook 2013, the autocomplete stream writes back to the Associated Contents table of the Inbox of the mail account's delivery store.</span></span>
  
## <a name="recommendations"></a><span data-ttu-id="07c9f-145">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="07c9f-145">Recommendations</span></span>

- <span data-ttu-id="07c9f-146">Nie teilweise Ändern des AutoVervollständigen-Streams.</span><span class="sxs-lookup"><span data-stu-id="07c9f-146">Never partially modify the autocomplete stream.</span></span> <span data-ttu-id="07c9f-147">Die unterstützte Interaktion wird (1) lesen Sie den gesamten AutoVervollständigen-Stream in den Arbeitsspeicher, (2) ändern die Struktur Arbeitsspeicher und 3) zurückschreiben dem gesamten Datenstrom entweder der verknüpften Inhaltstabelle im Posteingang des übermittlungsspeicher der e-Mail-Konto (für Outlook 2010 oder Outlook 2013) oder der lokalen NK2-Datei (Outlook 2007).</span><span class="sxs-lookup"><span data-stu-id="07c9f-147">The supported interaction is to 1) read the entire autocomplete stream into memory, 2) modify the memory structure, and 3) write the entire stream back to either the Associated Contents table of the Inbox of the mail account's delivery store (for Outlook 2010 or Outlook 2013) or to the local .nk2 file (Outlook 2007).</span></span>
    
- <span data-ttu-id="07c9f-148">Interagieren Sie sich nicht mit dem AutoVervollständigen-Stream, während Outlook ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="07c9f-148">Do not interact with the autocomplete stream while Outlook is running.</span></span> <span data-ttu-id="07c9f-149">Falls Outlook ausgeführt wird, während Sie den Stream ändern, wird wahrscheinlich die Änderungen überschrieben, wenn er heruntergefahren.</span><span class="sxs-lookup"><span data-stu-id="07c9f-149">If Outlook is running while you modify the stream, it will likely overwrite your changes when it shuts down.</span></span>
    
- <span data-ttu-id="07c9f-150">Nicht Schreibeigenschaften von führen Sie PT_MV_UNICODE und PR_MV_STRING8 in ein AutoVervollständigen-Stream, der von Microsoft Outlook 2003 genutzt werden eingeben.</span><span class="sxs-lookup"><span data-stu-id="07c9f-150">Do not write properties of type PT_MV_UNICODE and PR_MV_STRING8 into an autocomplete stream to be consumed by Microsoft Outlook 2003.</span></span> <span data-ttu-id="07c9f-151">Diese Eigenschaften sind nur von Outlook 2007, Outlook 2010 und Outlook 2013 verstanden.</span><span class="sxs-lookup"><span data-stu-id="07c9f-151">These properties are only understood by Outlook 2007, Outlook 2010, and Outlook 2013.</span></span>
    
- <span data-ttu-id="07c9f-152">Beim Entwickeln von Code, der mit Outlook 2007 interagiert, wird empfohlen, dass Sie die NK2-Datei vor Änderung durch andere Prozesse sperren, beim Lesen und Schreiben sperren APIs (beispielsweise **Sperrdatei** in C/C++- und **-Standarddatei FileStream.Lock** in c#).</span><span class="sxs-lookup"><span data-stu-id="07c9f-152">When developing code that interacts with Outlook 2007, we recommend that you lock the .nk2 file from modification by other processes while you are reading and writing it using standard file locking APIs (for example, **LockFile** in C/C++ and **FileStream.Lock** in C#).</span></span> 
    
- <span data-ttu-id="07c9f-153">Ändern Sie nur die Eigenschaften des Typen, die sich aus der Zeile-Gruppe des Datenstroms AutoVervollständigen.</span><span class="sxs-lookup"><span data-stu-id="07c9f-153">Only modify the properties of types that are from the row-set of the autocomplete stream.</span></span> <span data-ttu-id="07c9f-154">Weitere Informationen über die AutoVervollständigen Stream Eigenschaften und Eigenschaftentypen finden Sie unter [AutoVervollständigen-Stream](autocomplete-stream.md).</span><span class="sxs-lookup"><span data-stu-id="07c9f-154">For more information about the autocomplete stream properties and property types, see [Autocomplete Stream](autocomplete-stream.md).</span></span>
    
## <a name="see-also"></a><span data-ttu-id="07c9f-155">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="07c9f-155">See also</span></span>



[<span data-ttu-id="07c9f-156">Stream für automatisches Vervollständigen</span><span class="sxs-lookup"><span data-stu-id="07c9f-156">Autocomplete Stream</span></span>](autocomplete-stream.md)
  
[<span data-ttu-id="07c9f-157">MAPI-Profile</span><span class="sxs-lookup"><span data-stu-id="07c9f-157">MAPI Profiles</span></span>](mapi-profiles.md)


[<span data-ttu-id="07c9f-158">Outlook 2003/2007 NK2 Dateiformat und Richtlinien für Entwickler</span><span class="sxs-lookup"><span data-stu-id="07c9f-158">Outlook 2003/2007 NK2 File Format and Developer Guidelines</span></span>](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)

