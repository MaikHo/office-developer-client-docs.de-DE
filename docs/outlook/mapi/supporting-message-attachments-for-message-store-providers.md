---
title: Unterstützen von Nachrichtenanlagen für Nachrichtenspeicheranbieter
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: 'Letzte �nderung: Montag, 7. Dezember 2015'
ms.openlocfilehash: a94d1230f4f26d080976fd15768bdfeb6ea04748
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/23/2018
ms.locfileid: "22576099"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="dc34b-103">Unterstützen von Nachrichtenanlagen für Nachrichtenspeicheranbieter</span><span class="sxs-lookup"><span data-stu-id="dc34b-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="dc34b-104">**Betrifft**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="dc34b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="dc34b-105">Ihre Nachricht Speicheranbieter muss nicht zur Unterstützung von e-Mail-Anlagen.</span><span class="sxs-lookup"><span data-stu-id="dc34b-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="dc34b-106">Erwarten jedoch viele Clientanwendungen Anlagen zu Nachrichten hinzufügen können.</span><span class="sxs-lookup"><span data-stu-id="dc34b-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="dc34b-107">Wenn Ihre Nachrichtenspeicher zum Erstellen oder IPM Speichern verwendet wird. Beachten Sie Nachrichten, und klicken Sie dann Sie e-Mail-Anlagen unterstützen soll.</span><span class="sxs-lookup"><span data-stu-id="dc34b-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="dc34b-108">Standard-Nachricht Anbieter sollten auch e-Mail-Anlagen unterstützen.</span><span class="sxs-lookup"><span data-stu-id="dc34b-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="dc34b-109">Weitere Informationen finden Sie unter [MAPI Message Classes](mapi-message-classes.md)und [Nachrichtenspeicher Standard](default-message-stores.md).</span><span class="sxs-lookup"><span data-stu-id="dc34b-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="dc34b-110">Es gibt fünf Typen von Anlagen, die MAPI unterstützt: file, Anlagen, Daten Anlagen, e-Mail-Anlagen, OLE-Objekt-Anlagen und Links.</span><span class="sxs-lookup"><span data-stu-id="dc34b-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="dc34b-111">Die Anforderungen für die Unterstützung von jedem Typ unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="dc34b-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="dc34b-112">Clients unterscheiden zwischen den beiden Typen von Anlagen mit der **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md))-Eigenschaft auf Attachment-Objekte.</span><span class="sxs-lookup"><span data-stu-id="dc34b-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="dc34b-113">Unterstützung von Anlagen bedeutet die Implementierung der [IAttach: IMAPIProp](iattachimapiprop.md) Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="dc34b-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="dc34b-114">Die Schnittstelle **IAttach** verfügt über keine Methoden eigenen; Es hat nur Methoden, die von der Schnittstelle [IMAPIProp](imapipropiunknown.md) vererbt werden.</span><span class="sxs-lookup"><span data-stu-id="dc34b-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="dc34b-115">Da Ihre Nachricht Speicheranbieter Eigenschaften für Nachrichtenobjekte bereits implementiert werden muss, vereinfacht dies das erheblich Unterstützung für Anlagen.</span><span class="sxs-lookup"><span data-stu-id="dc34b-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="dc34b-116">Implementieren **IAttach** im Wesentlichen bedeutet das Bereitstellen der Möglichkeit für Clients Zugriff auf eine Tabelle von Eigenschaften für die Anlagen auf Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="dc34b-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="dc34b-117">Daten Anlagen sind einfach Anlagen, die den Inhalt der Anlage direkt in eine Anlage **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md))-Eigenschaft gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="dc34b-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="dc34b-118">Daten Anlagen vorhanden und kann in erster Linie damit Clients So fügen Sie Dateien auf eine Nachricht an, wenn der Absender und Empfänger der Nachricht nicht über Zugriff auf einen gemeinsamen Dateiserver verfügen.</span><span class="sxs-lookup"><span data-stu-id="dc34b-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="dc34b-119">Weitere Informationen finden Sie unter der **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md))-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="dc34b-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="dc34b-120">E-Mail-Anlagen sind für die das-Unterobjekt Anlage eine andere ist Anlagen [IMessage: ' mapiProp '](imessageimapiprop.md) Objekt.</span><span class="sxs-lookup"><span data-stu-id="dc34b-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="dc34b-121">Da Nachricht Anbieter bereits die **IMessage** -Schnittstelle unterstützt, ist die Unterstützung von e-Mail-Anlagen nicht schwierig.</span><span class="sxs-lookup"><span data-stu-id="dc34b-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="dc34b-122">OLE-Objekt Anlagen unterstützen bedeutet, dass die OLE- **IStorage** **IStream**und **IStreamDocfile** Schnittstellen implementieren.</span><span class="sxs-lookup"><span data-stu-id="dc34b-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="dc34b-123">Ihre Nachricht Speicheranbieter muss möglicherweise konvertieren OLE-Objektdaten in der Nachricht in einer aktiven OLE-Objekt gespeichert wird, wenn ein Client das Objekt geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="dc34b-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="dc34b-124">Links gibt zwei Arten: Links zu Dateien und Links zu anderen Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="dc34b-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="dc34b-125">Links zu Dateien mithilfe den ATTACH_BY_REF_ONLY-Wert für die **PR_ATTACH_METHOD** -Eigenschaft zusammen mit **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) oder **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) an die Position einer Datei.</span><span class="sxs-lookup"><span data-stu-id="dc34b-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="dc34b-126">Eine Implementierung von Links zu Nachrichten möglicherweise hängen Aspekte des lokalen Messagingsystem bereit und, daher kann nicht vollständig dokumentiert werden hier.</span><span class="sxs-lookup"><span data-stu-id="dc34b-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="dc34b-127">Senden eine Verknüpfung mit einer Meldung, die auf einem Server-basierten Nachrichtenspeicher gespeichert ist ist beispielsweise in der Regel nur darum, die Eintrags-ID der verknüpften Nachricht, vorausgesetzt, dass Absender und Empfänger Zugriff auf diesem Server haben zu senden.</span><span class="sxs-lookup"><span data-stu-id="dc34b-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="dc34b-128">Andere messaging Systemkonfigurationen-Präsentation vor anderen Anforderungen und Herausforderungen für die Implementierung von Links zu Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="dc34b-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="dc34b-129">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="dc34b-129">See also</span></span>



[<span data-ttu-id="dc34b-130">Nachrichtenspeicher-Features</span><span class="sxs-lookup"><span data-stu-id="dc34b-130">Message Store Features</span></span>](message-store-features.md)

