---
title: Interaktion mit dem MAPI-Spooler
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5cc1d0a8-ad23-4173-b220-b7c0169073fa
description: 'Letzte �nderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: faf3d48b63d1858a2b91f66c83d9ce08e9daa02b
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19792692"
---
# <a name="interacting-with-the-mapi-spooler"></a><span data-ttu-id="3ef04-103">Interaktion mit dem MAPI-Spooler</span><span class="sxs-lookup"><span data-stu-id="3ef04-103">Interacting with the MAPI Spooler</span></span>

  
  
<span data-ttu-id="3ef04-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="3ef04-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="3ef04-105">Die Methoden in der [IXPLogon: IUnknown](ixplogoniunknown.md) Schnittstelle werden beim Aufrufen der Adressbuchhierarchie durch die MAPI-Warteschlange verwendet.</span><span class="sxs-lookup"><span data-stu-id="3ef04-105">The methods in the [IXPLogon : IUnknown](ixplogoniunknown.md) interface are used by the MAPI spooler when calling the transport provider.</span></span> <span data-ttu-id="3ef04-106">Es sollte für die meisten Arten von Transportanbieter für die meisten dieser Methoden implementieren, sodass diese schnell zurückgeben möglich sein.</span><span class="sxs-lookup"><span data-stu-id="3ef04-106">It should be possible for most types of transport providers to implement most of these methods so that they return quickly.</span></span> <span data-ttu-id="3ef04-107">Dies ist wünschenswert, da, wenn eine Methode zum Zurückgeben lange dauert dann es mit Aufrufen an die Warteschlange MAPI-Version die CPU für andere Aufgaben aufgeteilt werden sollte.</span><span class="sxs-lookup"><span data-stu-id="3ef04-107">This is desirable because if a method takes a long time to return then it should be broken up with calls back to the MAPI spooler to release the CPU for other tasks.</span></span> 
  
<span data-ttu-id="3ef04-108">Die MAPI-Warteschlange führt diese Aufgaben und seine Aufrufe der Anbieter Transport, wenn Vordergrund Applikationen im Leerlauf befinden.</span><span class="sxs-lookup"><span data-stu-id="3ef04-108">The MAPI spooler does its work and makes its calls to transport providers when foreground applications are idle.</span></span> <span data-ttu-id="3ef04-109">Nach dem Anzeigen von Dialogfeldern optional, wenn der Adressbuchhierarchie zuerst angemeldet ist (unterliegt von MAPI an der Adressbuchhierarchie übergebene Kennzeichen), Betrieb Transportanbieter im Hintergrund, wenn vom Client zum leeren senden und Empfangen von Warteschlangen aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="3ef04-109">After optionally displaying dialog boxes when the transport provider is first logged on (governed by flags passed from MAPI to the transport provider), transport providers operate in the background unless called by the client to flush send and receive queues.</span></span> <span data-ttu-id="3ef04-110">Das leeren Warteschlangen ist nur dann, dass ein Transportdienstes nicht die CPU freigeben muss und dann nur, wenn der Benutzer informiert wird, dass eine möglicherweise länger Aktion ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="3ef04-110">Flushing queues is the only time that a transport provider need not release the CPU, and then only if the user is informed that a potentially long action is in progress.</span></span> <span data-ttu-id="3ef04-111">Die MAPI-Warteschlange fordert, dass ein Transportdienstes leeren Warteschlangen als Antwort auf eine Benutzeraktion aus, damit der Adressbuchhierarchie in der Regel keine muss nichts, um sicherzustellen, dass der Benutzer informiert wird in der Regel an.</span><span class="sxs-lookup"><span data-stu-id="3ef04-111">The MAPI spooler typically requests that a transport provider flush its queues in response to a user action, so the transport provider typically does not need to do anything to ensure that the user is informed.</span></span>
  
<span data-ttu-id="3ef04-112">Ein Transportdienstes kann unabhängig voneinander leeren eine Warteschlange und die Bits STATUS_INBOUND_FLUSH und STATUS_OUTBOUND_FLUSH in der Statuszeile der **PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))-Eigenschaft verwenden, um die MAPI-Warteschlange zu informieren, die dass die diesmal festlegen Aufmerksamkeit, damit das alles erledigt abrufen kann.</span><span class="sxs-lookup"><span data-stu-id="3ef04-112">A transport provider can independently decide to flush a queue and use the STATUS_INBOUND_FLUSH and STATUS_OUTBOUND_FLUSH bits in the **PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md)) property of its status row to inform the MAPI spooler that it wants attention so that it can get the job done.</span></span> <span data-ttu-id="3ef04-113">Die Statuszeile wird mit der [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) -Methode aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="3ef04-113">The status row is updated using the [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) method.</span></span> <span data-ttu-id="3ef04-114">In diesem Fall sollte der Adressbuchhierarchie wahrscheinlich angezeigt werden, eine Statusanzeige oder andere-Schnittstelle für den Benutzer zu informieren, dass eine lange Aktion durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="3ef04-114">In this case the transport provider should probably display a progress indicator or other interface to inform the user that a long action is occuring.</span></span> 
  
<span data-ttu-id="3ef04-115">Da Netzwerkaktivität oft mehr als 0,2 Sekunden dauert, sollten, Transportanbieter nach Möglichkeit asynchrones Netzwerkanfragen verwenden.</span><span class="sxs-lookup"><span data-stu-id="3ef04-115">Since network activity often takes more than 0.2 seconds, transport providers should, whenever possible, use asynchronous network requests.</span></span> <span data-ttu-id="3ef04-116">So können sie eine Anforderung initiieren, Version CPU erneut, indem die MAPI-Warteschlange und wenn die MAPI-Warteschlange erneut sie bietet Kontrolle, überprüfen, um festzustellen, ob ihre Netzwerk-Anforderung abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="3ef04-116">This enables them to initiate a request, release the CPU by calling back to the MAPI spooler, and when the MAPI spooler again gives them control, to check to see if their network request has completed.</span></span> <span data-ttu-id="3ef04-117">Wenn sie noch nicht abgeschlossen wurde, Version sie erneut die CPU Rückrufen an die MAPI-Warteschlange mit der [IMAPISupport::SpoolerYield](imapisupport-spooleryield.md) -Methode.</span><span class="sxs-lookup"><span data-stu-id="3ef04-117">If it has not yet completed, they again release the CPU by calling back to the MAPI spooler with the [IMAPISupport::SpoolerYield](imapisupport-spooleryield.md) method.</span></span> 
  
<span data-ttu-id="3ef04-118">Während der Verarbeitung, zwischen [IXPLogon::SubmitMessage](ixplogon-submitmessage.md) und [IXPLogon::EndMessage](ixplogon-endmessage.md) und während der [IXPLogon::StartMessage](ixplogon-startmessage.md)sendet der Adressbuchhierarchie viele Aufrufe in der Regel auf Objekte, die die MAPI-Warteschlange ausgesetzt.</span><span class="sxs-lookup"><span data-stu-id="3ef04-118">During message processing, between [IXPLogon::SubmitMessage](ixplogon-submitmessage.md) and [IXPLogon::EndMessage](ixplogon-endmessage.md) and during [IXPLogon::StartMessage](ixplogon-startmessage.md), the transport provider typically makes many calls on objects exposed to it by the MAPI spooler.</span></span> <span data-ttu-id="3ef04-119">Im Rahmen der Behandlung von dieser Objekte kann die MAPI-Warteschlange der Adressbuchhierarchie entsprechend als Hintergrundprozess steuern, indem Sie auf einem eigenen bei Bedarf zurückhalten.</span><span class="sxs-lookup"><span data-stu-id="3ef04-119">As part of its handling of these objects, the MAPI spooler helps the transport provider behave appropriately as a background process by yielding on its own when appropriate.</span></span> <span data-ttu-id="3ef04-120">Ein Transportdienstes zeitlich bedingte verarbeitenden kann einen wichtigen Abschnitt aus, um die MAPI-Warteschlange mithilfe der [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) Support-Objekt-Methode deklarieren.</span><span class="sxs-lookup"><span data-stu-id="3ef04-120">A transport provider requiring time-critical processing can declare a critical section to the MAPI spooler using the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) support object method.</span></span> <span data-ttu-id="3ef04-121">In diesem Fall wird die CPU nur auf explizite **SpoolerYield** Aufrufe von freigegeben der Adressbuchhierarchie, bis der Adressbuchhierarchie kritischen Abschnitt mit einer anderen Aufruf **SpoolerNotify**Verarbeitung beendet.</span><span class="sxs-lookup"><span data-stu-id="3ef04-121">In this case, the CPU is released only on explicit **SpoolerYield** calls by the transport provider until the transport provider ends critical section processing with another call to **SpoolerNotify**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="3ef04-122">Dies ist nicht identisch mit einem kritischen Win32-Abschnitt.</span><span class="sxs-lookup"><span data-stu-id="3ef04-122">This is not the same as a Win32 critical section.</span></span> <span data-ttu-id="3ef04-123">Dies sollte nur geschehen, wenn der Adressbuchhierarchie Real-Time Control von externen Ressourcen wie Lesen von eingehenden Daten aus einer Zeile Fax benötigt.</span><span class="sxs-lookup"><span data-stu-id="3ef04-123">This should only be done when the transport provider needs real-time control of external resources such as reading incoming data from a fax line.</span></span> <span data-ttu-id="3ef04-124">Da dies die Priorität des Prozesses MAPI-Warteschlange erhöht und kann dazu führen, dass die Arbeitsstation für die Dauer des Vorgangs nicht reagiert werden soll, ist es ratsam, benachrichtigt den Benutzer, den eine möglicherweise länger Aktion ausgeführt wird, und geben Sie nach Möglichkeit eine Statusanzeige.</span><span class="sxs-lookup"><span data-stu-id="3ef04-124">Since this raises the priority of the MAPI spooler process and can cause the workstation to be unresponsive for the duration of the operation, it is a good idea to notify the user that a potentially long action is underway and provide a progress indicator if possible.</span></span> 
  

