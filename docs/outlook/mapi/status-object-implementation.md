---
title: Implementierung von Statusobjekten
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 48fd3e28-c2d2-474d-9487-5e2f08ca7319
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: e97efb70716ffbd7fa98f980ce8520cfcb988532
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336337"
---
# <a name="status-object-implementation"></a><span data-ttu-id="a7aba-103">Implementierung von Statusobjekten</span><span class="sxs-lookup"><span data-stu-id="a7aba-103">Status object implementation</span></span>

<span data-ttu-id="a7aba-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a7aba-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a7aba-105">Alle Dienstanbieter müssen ein Status-Objekt implementieren und dessen Eigenschaften in die Tabelle Sitzungsstatus einteilen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-105">All service providers must implement a status object and furnish properties from it to the session status table.</span></span> <span data-ttu-id="a7aba-106">Sie können je nach Anzahl der Ressourcen, die Sie steuern, eine oder mehrere Zeilen in die Statustabelle aufnehmen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-106">You can include one or more rows in the status table, depending on the number of resources that you control.</span></span> <span data-ttu-id="a7aba-107">Ein Transportanbieter sollte beispielsweise für jede von ihm verwaltete Nachrichtenwarteschlange eine Zeile in der Statustabelle erstellen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-107">A transport provider, for example, should create a row in the status table for each message queue it manages.</span></span> <span data-ttu-id="a7aba-108">Wenn Änderungen auftreten, muss die entsprechende Statustabellen Zeile aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="a7aba-108">When changes occur, the appropriate status table row must be updated.</span></span> <span data-ttu-id="a7aba-109">Statusobjekte werden implementiert, um sowohl auf die in der Statustabelle enthaltenen Informationen als auch auf zusätzliche Informationen, die nicht in der Tabelle enthalten sind, zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-109">Status objects are implemented to provide access both to the information included in the status table and to additional information not included in the table.</span></span>
  
### <a name="to-implement-a-status-object"></a><span data-ttu-id="a7aba-110">So implementieren Sie ein Statusobjekt</span><span class="sxs-lookup"><span data-stu-id="a7aba-110">To implement a status object</span></span>

1. <span data-ttu-id="a7aba-111">Implementieren Sie die **OpenStatusEntry** -Methode des LOGON-Objekts.</span><span class="sxs-lookup"><span data-stu-id="a7aba-111">Implement the **OpenStatusEntry** method of your logon object.</span></span> <span data-ttu-id="a7aba-112">Wenn Clients Ihr Status-Objekt öffnen möchten, rufen Sie [IMAPISession:: OpenEntry](imapisession-openentry.md)auf.</span><span class="sxs-lookup"><span data-stu-id="a7aba-112">When clients want to open your status object, they call [IMAPISession::OpenEntry](imapisession-openentry.md).</span></span> <span data-ttu-id="a7aba-113">MAPI erfüllt die offene Anforderung durch Aufrufen der **OpenStatusEntry** -Methode Ihres Anbieters, sodass der Anbieter sein Status-Objekt öffnen und zum Client einen Zeiger auf seine **IMAPIStatus** -Implementierung zurückgeben kann.</span><span class="sxs-lookup"><span data-stu-id="a7aba-113">MAPI fulfills the open request by calling your provider's **OpenStatusEntry** method, causing your provider to open its status object and return to the client a pointer to its **IMAPIStatus** implementation.</span></span> <span data-ttu-id="a7aba-114">Führen Sie in der **OpenStatusEntry** -Implementierung die folgenden Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="a7aba-114">In your **OpenStatusEntry** implementation, complete the following steps:</span></span> 
    
   1. <span data-ttu-id="a7aba-115">Führen Sie die folgenden Aufgaben aus, wenn Ihr Logon-Objekt noch kein Status-Objekt erstellt hat:</span><span class="sxs-lookup"><span data-stu-id="a7aba-115">Perform the following tasks if your logon object has not yet created a status object:</span></span>
    
      1. <span data-ttu-id="a7aba-116">Rufen Sie die [IMAPISupport:: OpenProfileSection](imapisupport-openprofilesection.md) -Methode des Support Objekts auf, um auf den Profilbereich Ihres Anbieters zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-116">Call the support object's [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) method to access your provider's profile section.</span></span> 
          
      2. <span data-ttu-id="a7aba-117">Erstellen Sie ein neues Status-Objekt.</span><span class="sxs-lookup"><span data-stu-id="a7aba-117">Create a new status object.</span></span>
          
      3. <span data-ttu-id="a7aba-118">Speichern Sie einen Verweis auf den profile-Abschnitt im Status-Objekt Ihres Anbieters, und rufen Sie die [IUnknown:: AddRef](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) -Methode des profile-Abschnitts auf, um den Verweiszähler zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-118">Store a reference to the profile section in your provider's status object and call the profile section's [IUnknown::AddRef](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) method to increment its reference count.</span></span> 
          
      4. <span data-ttu-id="a7aba-119">Speichern Sie einen Verweis auf das Logon-Objekt im Status-Objekt Ihres Anbieters, und rufen Sie die **IUnknown:: AddRef** -Methode des LOGON-Objekts auf, um den Verweiszähler zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-119">Store a reference to the logon object in your provider's status object and call the logon object's **IUnknown::AddRef** method to increment its reference count.</span></span> 
          
      5. <span data-ttu-id="a7aba-120">Speichern Sie einen Verweis auf das Status-Objekt im Logon-Objekt Ihres Anbieters.</span><span class="sxs-lookup"><span data-stu-id="a7aba-120">Store a reference to the status object in your provider's logon object.</span></span>
    
   2. <span data-ttu-id="a7aba-121">Rufen Sie die **IUnknown:: AddRef** -Methode des Status-Objekts auf, um den Verweiszähler im Logon-Objekt zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-121">Call the status object's **IUnknown::AddRef** method to increment its reference count in the logon object.</span></span> 
    
   3. <span data-ttu-id="a7aba-122">Legen Sie die **PR_OBJECT_TYPE** ([pidtagobjecttype (](pidtagobjecttype-canonical-property.md))-Eigenschaft des Status-Objekts auf MAPI_STATUS.</span><span class="sxs-lookup"><span data-stu-id="a7aba-122">Set the status object's **PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md)) property to MAPI_STATUS.</span></span>
    
   4. <span data-ttu-id="a7aba-123">Legen Sie den _lppMAPIStatus_ -Ausgabeparameter so fest, dass er auf das Status-Objekt zeigt, und geben Sie zurück.</span><span class="sxs-lookup"><span data-stu-id="a7aba-123">Set the  _lppMAPIStatus_ output parameter to point to the status object, and return.</span></span> 
    
   5. <span data-ttu-id="a7aba-124">Überprüfen Sie den _ulFlags_ -Eingabeparameter.</span><span class="sxs-lookup"><span data-stu-id="a7aba-124">Check the  _ulFlags_ input parameter.</span></span> <span data-ttu-id="a7aba-125">Wenn es auf MAPI_MODIFY festgelegt ist und Ihr Anbieter Lese-/Schreibzugriff auf sein Status-Objekt unterstützt, geben Sie ein beschreibbares Objekt zurück.</span><span class="sxs-lookup"><span data-stu-id="a7aba-125">If it is set to MAPI_MODIFY and your provider supports read/write access to its status object, return a writeable object.</span></span> <span data-ttu-id="a7aba-126">Wenn Ihr Anbieter jedoch keinen Lese-/Schreibzugriff auf sein Status-Objekt unterstützt, schlagen Sie nicht fehl.</span><span class="sxs-lookup"><span data-stu-id="a7aba-126">However, if your provider does not support read/write access to its status object, do not fail.</span></span> <span data-ttu-id="a7aba-127">Gibt ein schreibgeschütztes Statusobjekt zurück.</span><span class="sxs-lookup"><span data-stu-id="a7aba-127">Return a status object that is read-only.</span></span> <span data-ttu-id="a7aba-128">Clients, die erwarten, dass Sie Lese-/Schreibzugriff auf Statusobjekte erhalten, sollten überprüfen, ob Lese-/Schreibzugriff erteilt wurde, bevor Sie Änderungen vornehmen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-128">Clients that expect to receive read/write status objects should verify that read/write permission has been granted before attempting to make any changes.</span></span> 
    
2. <span data-ttu-id="a7aba-129">Legen Sie alle erforderlichen Status-und Statustabellen Eigenschaften fest.</span><span class="sxs-lookup"><span data-stu-id="a7aba-129">Set all of the required status object and status table properties.</span></span> <span data-ttu-id="a7aba-130">Die Eigenschaften, die Sie in Ihre Statustabellen Zeile aufnehmen, sollten über Ihr Status-Objekt verfügbar sein, mit Ausnahme der von MAPI berechneten Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="a7aba-130">The properties that you include in your status table row should be available through your status object, except for the properties calculated by MAPI.</span></span> <span data-ttu-id="a7aba-131">Folgende Eigenschaften sind erforderlich:</span><span class="sxs-lookup"><span data-stu-id="a7aba-131">The required properties are as follows:</span></span>
    
   - <span data-ttu-id="a7aba-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="a7aba-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>
    
   - <span data-ttu-id="a7aba-133">**PR_PROVIDER_DLL_NAME** ([Pidtagproviderdllname (](pidtagproviderdllname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="a7aba-133">**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span></span>
    
   - <span data-ttu-id="a7aba-134">**PR_PROVIDER_DISPLAY** ([Pidtagproviderdisplay (](pidtagproviderdisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="a7aba-134">**PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md))</span></span>
    
   - <span data-ttu-id="a7aba-135">**PR_RESOURCE_TYPE** ([Pidtagresourcetype (](pidtagresourcetype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="a7aba-135">**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span></span>
    
   - <span data-ttu-id="a7aba-136">**PR_RESOURCE_METHODS** ([Pidtagresourcemethods (](pidtagresourcemethods-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="a7aba-136">**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span></span>
    
   - <span data-ttu-id="a7aba-137">**PR_RESOURCE_FLAGS** ([Pidtagresourceflags (](pidtagresourceflags-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="a7aba-137">**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span></span>
    
   - <span data-ttu-id="a7aba-138">**PR_STATUS_CODE** ([Pidtagstatuscode (](pidtagstatuscode-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="a7aba-138">**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span></span>
    
3. <span data-ttu-id="a7aba-139">Implementieren Sie die [IMAPIStatus: IMAPIProp](imapistatusimapiprop.md) -Methoden, die für Ihren Anbieter geeignet sind.</span><span class="sxs-lookup"><span data-stu-id="a7aba-139">Implement the [IMAPIStatus : IMAPIProp](imapistatusimapiprop.md) methods that are appropriate for your provider.</span></span> <span data-ttu-id="a7aba-140">Je nach Anbieter müssen Sie nicht alle vier Methoden in **IMAPIStatus**implementieren.</span><span class="sxs-lookup"><span data-stu-id="a7aba-140">Depending on your provider, you do not need to implement all of the four methods in **IMAPIStatus**.</span></span> <span data-ttu-id="a7aba-141">Jeder Anbieter sollte eine schreibgeschützte Version der Methoden der [IMAPIProp: IUnknown](imapipropiunknown.md) -Schnittstelle und der [IMAPIStatus:: ValidateState](imapistatus-validatestate.md) -Methode implementieren.</span><span class="sxs-lookup"><span data-stu-id="a7aba-141">Every provider should implement a read-only version of the methods of the [IMAPIProp : IUnknown](imapipropiunknown.md) interface and the [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method.</span></span> 

   <span data-ttu-id="a7aba-142">Transport Anbieter sollten auch [IMAPIStatus:: FlushQueues](imapistatus-flushqueues.md)implementieren, und alle Anbieter sollten [IMAPIStatus:: Settingsdialog](imapistatus-settingsdialog.md)unterstützen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-142">Transport providers should also implement [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md), and all providers should support [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md).</span></span> <span data-ttu-id="a7aba-143">Die Unterstützung für [IMAPIStatus:: ChangePassword](imapistatus-changepassword.md) ist jedoch optional.</span><span class="sxs-lookup"><span data-stu-id="a7aba-143">However, support for [IMAPIStatus::ChangePassword](imapistatus-changepassword.md) is optional.</span></span> <span data-ttu-id="a7aba-144">Nur Dienstanbieter, die Kennwörter erfordern und es Benutzern ermöglichen möchten, Sie programmgesteuert zu ändern, müssen diese Methode implementieren.</span><span class="sxs-lookup"><span data-stu-id="a7aba-144">Only service providers that require passwords and want to allow users to change them programmatically need to implement this method.</span></span> <span data-ttu-id="a7aba-145">Legen Sie für jede unterstützte Methode das entsprechende Bit in der **PR_RESOURCE_METHODS** -Eigenschaft fest.</span><span class="sxs-lookup"><span data-stu-id="a7aba-145">For every method that you support, set the corresponding bit in the **PR_RESOURCE_METHODS** property.</span></span> <span data-ttu-id="a7aba-146">Wenn Sie beispielsweise **ValidateState** und **Settingsdialog** unterstützen, legen Sie **PR_RESOURCE_METHODS** auf Folgendes fest:</span><span class="sxs-lookup"><span data-stu-id="a7aba-146">For example, if you support **ValidateState** and **SettingsDialog** only, set **PR_RESOURCE_METHODS** to the following:</span></span> 
    
   `STATUS_VALIDATE_STATE | STATUS_SETTINGS_DIALOG`
    
   <span data-ttu-id="a7aba-147">Clients sollten den Wert von **PR_RESOURCE_METHODS** überprüfen, bevor Sie versuchen, Ihr Status-Objekt aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-147">Clients should check the value of **PR_RESOURCE_METHODS** before attempting to call your status object.</span></span> <span data-ttu-id="a7aba-148">Behandeln Sie Aufrufe einer der nicht unterstützten Methoden, indem Sie MAPI_E_NO_SUPPORT zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="a7aba-148">Handle calls to any of your unsupported methods by returning MAPI_E_NO_SUPPORT.</span></span> 
    
4. <span data-ttu-id="a7aba-149">Rufen Sie [IMAPISupport:: ModifyStatusRow](imapisupport-modifystatusrow.md) während der Anmeldung auf, um die Zeile oder Zeilen zur Statustabelle hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="a7aba-149">Call [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) during logon to add your row or rows to the status table.</span></span> <span data-ttu-id="a7aba-150">Übergeben Sie ein Eigenschafts Wertarray, das die Spalteninformationen für die Zeile und 0 für den _ulFlags_ -Parameter enthält.</span><span class="sxs-lookup"><span data-stu-id="a7aba-150">Pass a property value array that contains the column information for the row and 0 for the  _ulFlags_ parameter.</span></span> <span data-ttu-id="a7aba-151">Wenn sich der Status Ihres Anbieters zu einem späteren Zeitpunkt in der Sitzung ändert und es erforderlich ist, die Spalteninformationen zu aktualisieren, rufen Sie **ModifyStatusRow** erneut mit dem STATUSROW_UPDATE-Flagsatz auf.</span><span class="sxs-lookup"><span data-stu-id="a7aba-151">If at some point later in the session your provider's status changes and it becomes necessary to update the column information, call **ModifyStatusRow** again with the STATUSROW_UPDATE flag set.</span></span> 
    
<span data-ttu-id="a7aba-152">Weitere Informationen zu Statusobjekten finden Sie unter [MAPI-Statusobjekte](mapi-status-objects.md).</span><span class="sxs-lookup"><span data-stu-id="a7aba-152">For more information about status objects, see [MAPI Status Objects](mapi-status-objects.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="a7aba-153">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="a7aba-153">See also</span></span>

- [<span data-ttu-id="a7aba-154">MAPI-Dienstanbieter</span><span class="sxs-lookup"><span data-stu-id="a7aba-154">MAPI Service Providers</span></span>](mapi-service-providers.md)

