---
title: IMSProviderLogon
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMSProvider.Logon
api_type:
- COM
ms.assetid: 890d9cbe-3570-4cf0-aeae-667c0e5ba181
description: 'Letzte �nderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: b89c8129f68852bdd243a7f984497ab312aa2551
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19792702"
---
# <a name="imsproviderlogon"></a><span data-ttu-id="29076-103">IMSProvider::Logon</span><span class="sxs-lookup"><span data-stu-id="29076-103">IMSProvider::Logon</span></span>

  
  
<span data-ttu-id="29076-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="29076-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="29076-105">Protokolle MAPI an eine Instanz der Anbieter eine Nachricht.</span><span class="sxs-lookup"><span data-stu-id="29076-105">Logs MAPI on to one instance of a message store provider.</span></span>
  
```cpp
HRESULT Logon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  ULONG ulFlags,
  LPCIID lpInterface,
  ULONG FAR * lpcbSpoolSecurity,
  LPBYTE FAR * lppbSpoolSecurity,
  LPMAPIERROR FAR * lppMAPIError,
  LPMSLOGON FAR * lppMSLogon,
  LPMDB FAR * lppMDB
);
```

## <a name="parameters"></a><span data-ttu-id="29076-106">Parameter</span><span class="sxs-lookup"><span data-stu-id="29076-106">Parameters</span></span>

 <span data-ttu-id="29076-107">_lpMAPISup_</span><span class="sxs-lookup"><span data-stu-id="29076-107">_lpMAPISup_</span></span>
  
> <span data-ttu-id="29076-108">[in] Ein Zeiger auf den aktuellen MAPI unterstützt Objekt für den Nachrichtenspeicher.</span><span class="sxs-lookup"><span data-stu-id="29076-108">[in] A pointer to the current MAPI support object for the message store.</span></span>
    
 <span data-ttu-id="29076-109">_ulUIParam_</span><span class="sxs-lookup"><span data-stu-id="29076-109">_ulUIParam_</span></span>
  
> <span data-ttu-id="29076-110">[in] Ein Handle für das übergeordnete Fenster des alle Dialogfelder oder Fenster zeigt diese Methode an.</span><span class="sxs-lookup"><span data-stu-id="29076-110">[in] A handle to the parent window of any dialog boxes or windows this method displays.</span></span> 
    
 <span data-ttu-id="29076-111">_lpszProfileName_</span><span class="sxs-lookup"><span data-stu-id="29076-111">_lpszProfileName_</span></span>
  
> <span data-ttu-id="29076-112">[in] Ein Zeiger auf eine Zeichenfolge mit dem Namen des Profils, das für die Anmeldung des Store verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="29076-112">[in] A pointer to a string that contains the name of the profile being used for store provider logon.</span></span> <span data-ttu-id="29076-113">Diese Zeichenfolge kann in Dialogfeldern angezeigt, in eine Protokolldatei geschrieben oder einfach ignoriert werden.</span><span class="sxs-lookup"><span data-stu-id="29076-113">This string can be displayed in dialog boxes, written out to a log file, or simply ignored.</span></span> <span data-ttu-id="29076-114">Es muss im Unicode-Format sein, wenn die Option MAPI_UNICODE im _UlFlags_ -Parameter festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="29076-114">It must be in Unicode format if the MAPI_UNICODE flag is set in the  _ulFlags_ parameter.</span></span> 
    
 <span data-ttu-id="29076-115">_cbEntryID_</span><span class="sxs-lookup"><span data-stu-id="29076-115">_cbEntryID_</span></span>
  
> <span data-ttu-id="29076-116">[in] Die Größe des Eintrags-ID, die auf das durch den Parameter _LpEntryID_ in Bytes.</span><span class="sxs-lookup"><span data-stu-id="29076-116">[in] The size, in bytes, of the entry identifier pointed to by the  _lpEntryID_ parameter.</span></span> 
    
 <span data-ttu-id="29076-117">_lpEntryID_</span><span class="sxs-lookup"><span data-stu-id="29076-117">_lpEntryID_</span></span>
  
> <span data-ttu-id="29076-118">[in] Ein Zeiger auf die Eintrags-ID für den Nachrichtenspeicher.</span><span class="sxs-lookup"><span data-stu-id="29076-118">[in] A pointer to the entry identifier for the message store.</span></span> <span data-ttu-id="29076-119">Übergeben von **null** in _LpEntryID_ gibt an, dass ein Nachrichtenspeicher noch nicht ausgewählt wurde und Dialogfelder, mit denen den Benutzer die Auswahl ein Nachrichtenspeichers präsentiert werden können.</span><span class="sxs-lookup"><span data-stu-id="29076-119">Passing **null** in  _lpEntryID_ indicates that a message store has not yet been selected and that dialog boxes that enable the user to select a message store can be presented.</span></span> 
    
 <span data-ttu-id="29076-120">_ulFlags_</span><span class="sxs-lookup"><span data-stu-id="29076-120">_ulFlags_</span></span>
  
> <span data-ttu-id="29076-121">[in] Eine Bitmaske aus Flags, die steuert, wie die Anmeldung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="29076-121">[in] A bitmask of flags that controls how the logon is performed.</span></span> <span data-ttu-id="29076-122">Die folgenden Kennzeichen können festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="29076-122">The following flags can be set:</span></span>
    
<span data-ttu-id="29076-123">MAPI_DEFERRED_ERRORS</span><span class="sxs-lookup"><span data-stu-id="29076-123">MAPI_DEFERRED_ERRORS</span></span> 
  
> <span data-ttu-id="29076-124">Der Aufruf ist zulässig, erfolgreich ausgeführt werden kann, auch wenn das zugrunde liegende Objekt nicht an die Implementierung der aufrufenden verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="29076-124">The call is allowed to succeed even if the underlying object is not available to the calling implementation.</span></span> <span data-ttu-id="29076-125">Wenn das Objekt nicht verfügbar ist, kann ein nachfolgender Aufruf für das Objekt ein Fehler ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="29076-125">If the object is not available, a subsequent call to the object might raise an error.</span></span>
    
<span data-ttu-id="29076-126">PARAMETER MAPI_UNICODE</span><span class="sxs-lookup"><span data-stu-id="29076-126">MAPI_UNICODE</span></span> 
  
> <span data-ttu-id="29076-127">Die übergebenen Zeichenfolgen sind im Unicode-Format.</span><span class="sxs-lookup"><span data-stu-id="29076-127">The passed-in strings are in Unicode format.</span></span> <span data-ttu-id="29076-128">Wenn der Parameter MAPI_UNICODE nicht festgelegt ist, sind die Zeichenfolgen in ANSI-Format.</span><span class="sxs-lookup"><span data-stu-id="29076-128">If MAPI_UNICODE is not set, the strings are in ANSI format.</span></span>
    
<span data-ttu-id="29076-129">MDB_NO_DIALOG</span><span class="sxs-lookup"><span data-stu-id="29076-129">MDB_NO_DIALOG</span></span> 
  
> <span data-ttu-id="29076-130">Verhindert die Anzeige von Dialogfeldern für die Anmeldung.</span><span class="sxs-lookup"><span data-stu-id="29076-130">Prevents the display of logon dialog boxes.</span></span> <span data-ttu-id="29076-131">Wenn dieses Flag festgelegt ist, wird der Fehlerwert MAPI_E_LOGON_FAILED zurückgegeben, wenn die Anmeldung nicht erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="29076-131">If this flag is set, the error value MAPI_E_LOGON_FAILED is returned if the logon is unsuccessful.</span></span> <span data-ttu-id="29076-132">Wenn dieses Flag nicht festgelegt ist, kann der Nachricht Speicheranbieter fordert den Benutzer an den richtigen einen Namen oder das Kennwort, das zum Einfügen von eines Datenträgers oder andere Aktionen auszuführen, die Verbindung zu den Speicher erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="29076-132">If this flag is not set, the message store provider can prompt the user to correct a name or password, to insert a disk, or to perform other actions that are necessary to establish connection to the store.</span></span>
    
<span data-ttu-id="29076-133">MDB_NO_MAIL</span><span class="sxs-lookup"><span data-stu-id="29076-133">MDB_NO_MAIL</span></span> 
  
> <span data-ttu-id="29076-134">Der Nachrichtenspeicher sollte nicht für das Senden oder Empfangen von e-Mail verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="29076-134">The message store should not be used for sending or receiving mail.</span></span> <span data-ttu-id="29076-135">Das Flag signalisiert MAPI nicht für der MAPI-Warteschlange benachrichtigen, dass dieses Nachrichtenspeichers geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="29076-135">The flag signals MAPI not to notify the MAPI spooler that this message store is being opened.</span></span> <span data-ttu-id="29076-136">Wenn dieses Attribut festgelegt, und der Nachrichtenspeicher ist eng mit eines Transportdienstes gekoppelt, muss der Anbieter nicht die [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="29076-136">If this flag is set and the message store is tightly coupled with a transport provider, the provider does not need to call the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method.</span></span> 
    
<span data-ttu-id="29076-137">MDB_TEMPORARY</span><span class="sxs-lookup"><span data-stu-id="29076-137">MDB_TEMPORARY</span></span> 
  
> <span data-ttu-id="29076-138">Protokolle für den Speicher, sodass Informationen aus dem Profilabschnitt programmgesteuert abgerufen werden kann verwenden, ohne Dialogfelder.</span><span class="sxs-lookup"><span data-stu-id="29076-138">Logs on the store so that information can be retrieved programmatically from the profile section, without use of dialog boxes.</span></span> <span data-ttu-id="29076-139">Dieses Kennzeichen weist MAPI, dass der Speicher ist nicht für die Nachricht Store-Tabelle hinzugefügt werden und der Speicher permanent hergestellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="29076-139">This flag instructs MAPI that the store is not to be added to the message store table and that the store cannot be made permanent.</span></span> <span data-ttu-id="29076-140">Wenn dieses Flag festgelegt ist, müssen Nachricht Anbieter nicht die [IMAPISupport::ModifyProfile](imapisupport-modifyprofile.md) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="29076-140">If this flag is set, message store providers do not need to call the [IMAPISupport::ModifyProfile](imapisupport-modifyprofile.md) method.</span></span> 
    
<span data-ttu-id="29076-141">MDB_WRITE</span><span class="sxs-lookup"><span data-stu-id="29076-141">MDB_WRITE</span></span> 
  
> <span data-ttu-id="29076-142">Anfragen Lese-/Schreibberechtigung.</span><span class="sxs-lookup"><span data-stu-id="29076-142">Requests read/write permission.</span></span>
    
 <span data-ttu-id="29076-143">_lpInterface_</span><span class="sxs-lookup"><span data-stu-id="29076-143">_lpInterface_</span></span>
  
> <span data-ttu-id="29076-144">[in] Ein Zeiger auf der Benutzeroberfläche IID (Identifier) für den Nachrichtenspeicher anmelden.</span><span class="sxs-lookup"><span data-stu-id="29076-144">[in] A pointer to the interface identifier (IID) for the message store to log on to.</span></span> <span data-ttu-id="29076-145">Übergeben von **null** gibt an, dass die MAPI-Schnittstelle für den Nachrichtenspeicher ( [IMsgStore](imsgstoreimapiprop.md)) zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="29076-145">Passing **null** indicates the MAPI interface for the message store ( [IMsgStore](imsgstoreimapiprop.md)) is returned.</span></span> <span data-ttu-id="29076-146">Der Parameter _LpInterface_ kann auch auf einen Bezeichner für eine entsprechende Schnittstelle für den Nachrichtenspeicher (beispielsweise IID_IUnknown oder IID_IMAPIProp) festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="29076-146">The  _lpInterface_ parameter can also be set to an identifier for an appropriate interface for the message store (for example, IID_IUnknown or IID_IMAPIProp).</span></span> 
    
 <span data-ttu-id="29076-147">_lpcbSpoolSecurity_</span><span class="sxs-lookup"><span data-stu-id="29076-147">_lpcbSpoolSecurity_</span></span>
  
> <span data-ttu-id="29076-148">[out] Ein Zeiger auf die Variable, die in der Speicheranbieter die Größe in Bytes, der im Parameter _LppbSpoolSecurity_ Validierungsdaten zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="29076-148">[out] A pointer to the variable in which the store provider returns the size, in bytes, of the validation data in the  _lppbSpoolSecurity_ parameter.</span></span> 
    
 <span data-ttu-id="29076-149">_lppbSpoolSecurity_</span><span class="sxs-lookup"><span data-stu-id="29076-149">_lppbSpoolSecurity_</span></span>
  
> <span data-ttu-id="29076-150">[out] Ein Zeiger auf den Zeiger auf das zurückgegebene Überprüfungsdaten.</span><span class="sxs-lookup"><span data-stu-id="29076-150">[out] A pointer to the pointer to the returned validation data.</span></span> <span data-ttu-id="29076-151">Diese Überprüfungsdaten werden bereitgestellt, sodass die [IMSProvider::SpoolerLogon](imsprovider-spoolerlogon.md) -Methode die MAPI-Warteschlange an den gleichen Speicher als den Anbieter für die Nachricht anmelden anmelden kann.</span><span class="sxs-lookup"><span data-stu-id="29076-151">This validation data is provided so the [IMSProvider::SpoolerLogon](imsprovider-spoolerlogon.md) method can log the MAPI spooler on to the same store as the message store provider.</span></span> 
    
 <span data-ttu-id="29076-152">_lppMAPIError_</span><span class="sxs-lookup"><span data-stu-id="29076-152">_lppMAPIError_</span></span>
  
> <span data-ttu-id="29076-153">[out] Ein Zeiger auf einen Zeiger auf das zurückgegebene [MAPIERROR](mapierror.md) Struktur, falls vorhanden, die Angaben zu Version, Komponente und Kontext für einen Fehler enthält.</span><span class="sxs-lookup"><span data-stu-id="29076-153">[out] A pointer to a pointer to the returned [MAPIERROR](mapierror.md) structure, if any, that contains version, component, and context information for an error.</span></span> <span data-ttu-id="29076-154">Der Parameter _LppMAPIError_ kann auf **null** festgelegt werden, wenn es keine **MAPIERROR** -Struktur ist zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="29076-154">The  _lppMAPIError_ parameter can be set to **null** if there is no **MAPIERROR** structure to return.</span></span> 
    
 <span data-ttu-id="29076-155">_lppMSLogon_</span><span class="sxs-lookup"><span data-stu-id="29076-155">_lppMSLogon_</span></span>
  
> <span data-ttu-id="29076-156">[out] Ein Zeiger auf den Zeiger auf die Nachricht speichern Objekt für die MAPI anmelden anmelden.</span><span class="sxs-lookup"><span data-stu-id="29076-156">[out] A pointer to the pointer to the message store logon object for MAPI to log on to.</span></span>
    
 <span data-ttu-id="29076-157">_lppMDB_</span><span class="sxs-lookup"><span data-stu-id="29076-157">_lppMDB_</span></span>
  
> <span data-ttu-id="29076-158">[out] Ein Zeiger auf den Zeiger auf die Nachricht speichern-Objekt für die MAPI-Warteschlange und Clientanwendungen anmelden.</span><span class="sxs-lookup"><span data-stu-id="29076-158">[out] A pointer to the pointer to the message store object for the MAPI spooler and client applications to log on to.</span></span>
    
## <a name="return-value"></a><span data-ttu-id="29076-159">R�ckgabewert</span><span class="sxs-lookup"><span data-stu-id="29076-159">Return value</span></span>

<span data-ttu-id="29076-160">S_OK</span><span class="sxs-lookup"><span data-stu-id="29076-160">S_OK</span></span> 
  
> <span data-ttu-id="29076-161">Der Aufruf erfolgreich ausgef�hrt und der erwartete Wert oder Werte zur�ckgegeben hat.</span><span class="sxs-lookup"><span data-stu-id="29076-161">The call succeeded and has returned the expected value or values.</span></span>
    
<span data-ttu-id="29076-162">MAPI_E_FAILONEPROVIDER</span><span class="sxs-lookup"><span data-stu-id="29076-162">MAPI_E_FAILONEPROVIDER</span></span> 
  
> <span data-ttu-id="29076-163">Diesen Anbieter können sich nicht anmelden, aber dieser Fehler sollten Sie den Dienst nicht deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="29076-163">This provider cannot log on, but this error should not disable the service.</span></span> 
    
<span data-ttu-id="29076-164">MAPI_E_LOGON_FAILED</span><span class="sxs-lookup"><span data-stu-id="29076-164">MAPI_E_LOGON_FAILED</span></span> 
  
> <span data-ttu-id="29076-165">Eine Sitzung konnte nicht hergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="29076-165">A logon session could not be established.</span></span>
    
<span data-ttu-id="29076-166">MAPI_E_UNCONFIGURED</span><span class="sxs-lookup"><span data-stu-id="29076-166">MAPI_E_UNCONFIGURED</span></span> 
  
> <span data-ttu-id="29076-167">Das Profil enthält nicht ausreichend Informationen für die Anmeldung für die Durchführung.</span><span class="sxs-lookup"><span data-stu-id="29076-167">The profile does not contain enough information for the logon to complete.</span></span> <span data-ttu-id="29076-168">Wenn dieser Wert zurückgegeben wird, ruft MAPI-Funktion die Nachricht Speicheranbieter Messagingdiensts Eintrag.</span><span class="sxs-lookup"><span data-stu-id="29076-168">When this value is returned, MAPI calls the message store provider's message-service entry point function.</span></span>
    
<span data-ttu-id="29076-169">MAPI_E_USER_CANCEL</span><span class="sxs-lookup"><span data-stu-id="29076-169">MAPI_E_USER_CANCEL</span></span> 
  
> <span data-ttu-id="29076-170">Der Benutzer hat den Vorgang in der Regel durch Klicken auf die Schaltfläche " **Abbrechen** " in einem Dialogfeld abgebrochen.</span><span class="sxs-lookup"><span data-stu-id="29076-170">The user canceled the operation, typically by clicking the **Cancel** button in a dialog box.</span></span> 
    
<span data-ttu-id="29076-171">MAPI_E_UNKNOWN_CPID</span><span class="sxs-lookup"><span data-stu-id="29076-171">MAPI_E_UNKNOWN_CPID</span></span> 
  
> <span data-ttu-id="29076-172">Der Server ist nicht zur Unterstützung der Codeseite für den Client konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="29076-172">The server is not configured to support the client's code page.</span></span>
    
<span data-ttu-id="29076-173">MAPI_E_UNKNOWN_LCID</span><span class="sxs-lookup"><span data-stu-id="29076-173">MAPI_E_UNKNOWN_LCID</span></span> 
  
> <span data-ttu-id="29076-174">Der Server ist nicht konfiguriert, um Gebietsschemainformationen des Clients zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="29076-174">The server is not configured to support the client's locale information.</span></span>
    
<span data-ttu-id="29076-175">MAPI_W_ERRORS_RETURNED</span><span class="sxs-lookup"><span data-stu-id="29076-175">MAPI_W_ERRORS_RETURNED</span></span> 
  
> <span data-ttu-id="29076-176">Der Aufruf war erfolgreich, aber der Nachricht Speicheranbieter hat Fehlerinformationen verfügbar.</span><span class="sxs-lookup"><span data-stu-id="29076-176">The call succeeded, but the message store provider has error information available.</span></span> <span data-ttu-id="29076-177">Wenn diese Warnung zurückgegeben wird, sollte der Anruf als erfolgreich verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="29076-177">When this warning is returned, the call should be handled as successful.</span></span> <span data-ttu-id="29076-178">Verwenden Sie das Makro **HR_FAILED** , um für diese Warnung zu testen.</span><span class="sxs-lookup"><span data-stu-id="29076-178">To test for this warning, use the **HR_FAILED** macro.</span></span> <span data-ttu-id="29076-179">Weitere Informationen finden Sie unter [Verwendung von Makros Fehlerbehandlung](using-macros-for-error-handling.md).</span><span class="sxs-lookup"><span data-stu-id="29076-179">For more information, see [Using Macros for Error Handling](using-macros-for-error-handling.md).</span></span> <span data-ttu-id="29076-180">Wenn Sie die Fehlerinformationen vom Anbieter erhalten möchten, rufen Sie die [IMAPISession::GetLastError](imapisession-getlasterror.md) -Methode.</span><span class="sxs-lookup"><span data-stu-id="29076-180">To get the error information from the provider, call the [IMAPISession::GetLastError](imapisession-getlasterror.md) method.</span></span> 
    
## <a name="remarks"></a><span data-ttu-id="29076-181">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="29076-181">Remarks</span></span>

<span data-ttu-id="29076-182">MAPI-Aufrufen die **IMSProvider::Logon** -Methode dazu die Mehrzahl der Verarbeitung erforderlich sind, um Zugriff auf einen Nachrichtenspeicher zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="29076-182">MAPI calls the **IMSProvider::Logon** method to do the majority of processing necessary to obtain access to a message store.</span></span> <span data-ttu-id="29076-183">Nachricht Anbieter Überprüfen von Anmeldeinformationen erforderlich sind, um Zugriff auf einen bestimmten Speicher und ein Message Store-Objekt zurückzugeben, der _LppMDB_ -Parameter, der die MAPI-Warteschlange und Clientanwendungen anmelden können.</span><span class="sxs-lookup"><span data-stu-id="29076-183">Message store providers validate any user credentials necessary to access a particular store and return a message store object in the  _lppMDB_ parameter that the MAPI spooler and client applications can log on to.</span></span> 
  
<span data-ttu-id="29076-184">Zusätzlich zu den zurückgegebenen Message Store-Objekts für Client- und MAPI-Warteschlange verwendet gibt den Anbieter auch ein Message Store Anmeldung-Objekt für die MAPI zum Steuern des geöffneten Speichers verwenden.</span><span class="sxs-lookup"><span data-stu-id="29076-184">In addition to the returned message store object for client and MAPI spooler use, the provider also returns a message store logon object for MAPI to use in controlling the opened store.</span></span> <span data-ttu-id="29076-185">Message Store Anmeldung-Objekts und Message Store-Objekts sollte eng innerhalb der Nachricht Informationsdienst verknüpft werden, sodass jede der anderen auswirken kann.</span><span class="sxs-lookup"><span data-stu-id="29076-185">The message store logon object and the message store object should be tightly linked inside the message store provider so each can affect the other.</span></span> <span data-ttu-id="29076-186">Die Verwendung von das Store-Objekt und das Anmeldeobjekt sollten identisch sein. So, dass die Objekte fungieren, als wären sie ein Objekt, das zwei Schnittstellen verfügbar macht sollte eine 1: 1-Beziehung zwischen der Anmeldung-Objekt und das Store-Objekt sein.</span><span class="sxs-lookup"><span data-stu-id="29076-186">The use of the store object and the logon object should be identical; there should be a one-to-one correspondence between the logon object and the store object such that the objects act as if they are one object that exposes two interfaces.</span></span> <span data-ttu-id="29076-187">Zwei Objekte sollten auch zusammen und freigegebenen zusammen erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="29076-187">The two objects should also be created together and freed together.</span></span> 
  
<span data-ttu-id="29076-188">Das MAPI-Support-Objekt von MAPI erstellt und an den Anbieter in der _LpMAPISup_ -Parameter übergebene bietet Zugriff auf Funktionen in MAPI, die der Anbieter erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="29076-188">The MAPI support object, created by MAPI and passed to the provider in the  _lpMAPISup_ parameter, provides access to functions in MAPI that the provider requires.</span></span> <span data-ttu-id="29076-189">Dazu gehören Funktionen, die zu speichern und Abrufen von Profilinformationen, Zugriff auf Adressbücher und so weiter.</span><span class="sxs-lookup"><span data-stu-id="29076-189">These include functions that save and retrieve profile information, access address books, and so on.</span></span> <span data-ttu-id="29076-190">Der Mauszeiger _LpMAPISup_ kann für jeden Speicher unterschiedlich sein, das geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="29076-190">The  _lpMAPISup_ pointer can be different for each store that is opened.</span></span> <span data-ttu-id="29076-191">Während der Verarbeitung für einen Nachrichtenspeicher nach der Anmeldung aufruft, sollten Speicheranbieter die Variable _LpMAPISup_ verwenden, die speziell für diesen Speicher ist.</span><span class="sxs-lookup"><span data-stu-id="29076-191">While processing calls for a message store after logon, the store provider should use the  _lpMAPISup_ variable that is specific to that store.</span></span> <span data-ttu-id="29076-192">Für jeden Anruf **Anmeldung** , die einen Nachrichtenspeicher öffnet und erfolgreich abgeschlossen wird, bei der Erstellung einer Nachricht Store Anmeldung-Objekt der Anbieter muss einen Zeiger auf das MAPI-Support-Objekt im Speicher Anmeldung Objekt speichern und muss die [IUnknown:: AddRef](http://msdn.microsoft.com/en-us/library/ms691379%28v=VS.85%29.aspx) -Methode zum Hinzufügen eines Verweises für aufrufen das Objekt unterstützt.</span><span class="sxs-lookup"><span data-stu-id="29076-192">For any **Logon** call that opens a message store and succeeds in creating a message store logon object, the provider must save a pointer to the MAPI support object in the store logon object and must call the [IUnknown::AddRef](http://msdn.microsoft.com/en-us/library/ms691379%28v=VS.85%29.aspx) method to add a reference for the support object.</span></span> 
  
<span data-ttu-id="29076-193">Der Parameter _UlUIParam_ sollte verwendet werden, wenn der Anbieter während des Anrufs **Anmeldung** Dialogfelder angezeigt.</span><span class="sxs-lookup"><span data-stu-id="29076-193">The  _ulUIParam_ parameter should be used if the provider presents dialog boxes during the **Logon** call.</span></span> <span data-ttu-id="29076-194">Dialogfelder sollte jedoch nicht angezeigt werden, wenn _UlFlags_ das MDB_NO_DIALOG-Flag enthält.</span><span class="sxs-lookup"><span data-stu-id="29076-194">However, dialog boxes should not be presented if  _ulFlags_ contains the MDB_NO_DIALOG flag.</span></span> <span data-ttu-id="29076-195">Wenn eine Benutzeroberfläche aufgerufen werden muss, aber _UlFlags_ nicht zulassen oder einem anderen Grund eine Benutzeroberfläche angezeigt werden kann, sollte der Anbieter MAPI_E_LOGON_FAILED zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="29076-195">If a user interface needs to be called but  _ulFlags_ does not allow it, or if for some other reason a user interface cannot be displayed, the provider should return MAPI_E_LOGON_FAILED.</span></span> <span data-ttu-id="29076-196">Wenn **Anmeldung** zeigt ein Dialogfeld an, und der Benutzer die Anmeldung abbricht, sollte in der Regel durch Klicken auf das Dialogfeld Schaltfläche **Abbrechen** des Anbieters MAPI_E_USER_CANCEL zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="29076-196">If **Logon** displays a dialog box and the user cancels the logon, typically by clicking the dialog box's **Cancel** button, the provider should return MAPI_E_USER_CANCEL.</span></span> 
  
<span data-ttu-id="29076-197">Der Parameter _LpEntryID_ kann entweder **null** sein oder zeigen Sie auf eine allein stehenden Store Eintrags-ID, die diese Meldung speichern zuvor erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="29076-197">The  _lpEntryID_ parameter can either be **null** or point to an unwrapped store entry identifier that this message store previously created.</span></span> <span data-ttu-id="29076-198">Wenn _LpEntryID_ auf einen Bezeichner allein stehenden Eintrag zeigt, kann die Eintrags-ID aus eine der verschiedenen Orten stammen:</span><span class="sxs-lookup"><span data-stu-id="29076-198">If  _lpEntryID_ points to an unwrapped entry identifier, that entry identifier can come from one of several places:</span></span> 
  
- <span data-ttu-id="29076-199">Eine Eintrags-ID kann sein, die Speicheranbieter zuvor eingeschlossen und in den Profilabschnitt als Eigenschaft **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) geschrieben haben.</span><span class="sxs-lookup"><span data-stu-id="29076-199">It can be an entry identifier that the store provider previously wrapped and wrote to the profile section as a **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property.</span></span>
    
- <span data-ttu-id="29076-200">Eine Eintrags-ID kann sein, die der Anbieter zuvor eingeschlossen und an einen aufrufenden Client als Eigenschaft **PR_STORE_ENTRYID** ([PidTagStoreEntryId](pidtagstoreentryid-canonical-property.md)) zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="29076-200">It can be an entry identifier that the provider previously wrapped and returned to a calling client as a **PR_STORE_ENTRYID** ([PidTagStoreEntryId](pidtagstoreentryid-canonical-property.md)) property.</span></span> 
    
- <span data-ttu-id="29076-201">Es kann eine Eintrags-ID sein, die der Anbieter zuvor eingeschlossen und an einen aufrufenden Client als die **PR_ENTRYID** -Eigenschaft des Store-Objekt "Message" zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="29076-201">It can be an entry identifier that the provider previously wrapped and returned to a calling client as the **PR_ENTRYID** property of a message store object.</span></span> 
    
<span data-ttu-id="29076-202">In einen dieser Fälle ist es möglich, dass die Eintrags-ID auf einem anderen Computer als die aktuell verwendeten erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="29076-202">In any of these cases, it is possible that the entry identifier was created on a different computer than the one currently being used.</span></span>
  
<span data-ttu-id="29076-203">Wenn _LpEntryID_ nicht **null**ist, sollten sie alle Informationen zum Identifizieren und Auffinden des Nachrichtenspeichers benötigt enthalten.</span><span class="sxs-lookup"><span data-stu-id="29076-203">When  _lpEntryID_ is not **null**, it should contain all of the information needed to identify and locate the message store.</span></span> <span data-ttu-id="29076-204">Diese Informationen kann Volume Netzwerknamen, Rufnummern, Benutzerkontonamen usw. enthalten.</span><span class="sxs-lookup"><span data-stu-id="29076-204">This information can include network volume names, phone numbers, user account names, and so on.</span></span> <span data-ttu-id="29076-205">Wenn die Verbindung mit den Speicher mit den Daten in die Eintrags-ID festgelegt werden kann, sollte der Anbieter ein Dialogfeld angezeigt, die dem Benutzer ermöglicht, wählen Sie den Speicher geöffnet werden soll.</span><span class="sxs-lookup"><span data-stu-id="29076-205">If the connection to the store cannot be made by using the data in the entry identifier, the store provider should display a dialog box that enables the user to select the store to be opened.</span></span> <span data-ttu-id="29076-206">Ein Dialogfeld wäre erforderlich, zum Beispiel ein Server umbenannt wurde, ein Kontonamen geändert wurde oder Teile des Netzwerks sind nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="29076-206">A dialog box might be required, for example, if a server has been renamed, an account name has changed, or portions of the network are not available.</span></span>
  
<span data-ttu-id="29076-207">Wenn _LpEntryID_ **null**ist, hat der Nachrichtenspeicher verwenden Sie noch nicht ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="29076-207">When  _lpEntryID_ is **null**, the message store to use has not yet been selected.</span></span> <span data-ttu-id="29076-208">Der Anbieter kann weiterhin einen Speicher zugreifen, ohne dass ein Dialogfeld angezeigt, wenn weitere Methoden zum Angeben der Speichers unterstützt.</span><span class="sxs-lookup"><span data-stu-id="29076-208">The provider can still access a store without displaying a dialog box if it supports further methods to specify the store.</span></span> <span data-ttu-id="29076-209">Beispielsweise der Anbieter seine Initialisierungsdatei überprüfen kann, oder es kann Suchen nach zusätzlichen Eigenschaften, die an den oder die Nachricht des Dienstes Profilabschnitt an der Konfiguration vom abgelegt wurden.</span><span class="sxs-lookup"><span data-stu-id="29076-209">For example, the provider can check its initialization file, or it can look for additional properties that were placed in its or its message service's profile section at configuration.</span></span>
  
<span data-ttu-id="29076-210">Wenn ein Anbieter, dass alle erforderliche Informationen ist nicht im Profil feststellt, sollte MAPI_E_UNCONFIGURED zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="29076-210">If a provider finds that all the required information is not in the profile, it should return MAPI_E_UNCONFIGURED.</span></span> <span data-ttu-id="29076-211">MAPI ruft dann den Anbieter Nachricht Service Eintrag Point-Funktion zum Aktivieren des Benutzers einen Speicher auswählen, oder sogar zu erstellen und benötigt, um einen Kontonamen und ein Kennwort, als einzugeben.</span><span class="sxs-lookup"><span data-stu-id="29076-211">MAPI will then call the provider's message service entry point function to enable the user to select a store, or even to create one, and to enter an account name and password, as needed.</span></span> <span data-ttu-id="29076-212">MAPI erstellt automatisch einen neuen Profilabschnitt für einen neuen Speicher. In diesem Profilabschnitt der neuen möglicherweise temporär oder dauerhaft, je nachdem, wie er hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="29076-212">MAPI automatically creates a new profile section for a new store; this new profile section can be temporary or permanent, depending on how it has been added.</span></span> <span data-ttu-id="29076-213">Wenn der Anbieter die **IMAPISupport::ModifyProfile** -Methode aufruft, der neuen Profilabschnitt dauerhaft entfernt wird, und der Speicher wird hinzugefügt, um die Liste der Informationsspeicher, die von der [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) -Methode zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="29076-213">If the store provider calls the **IMAPISupport::ModifyProfile** method, the new profile section becomes permanent and the store is added to the list of message stores returned by the [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) method.</span></span> 
  
<span data-ttu-id="29076-214">Der _LpInterface_ -Parameter gibt die ID der Schnittstelle für die neu geöffnete Store-Objekt erforderlich.</span><span class="sxs-lookup"><span data-stu-id="29076-214">The  _lpInterface_ parameter specifies the IID of the interface required for the newly opened store object.</span></span> <span data-ttu-id="29076-215">Übergeben von **null** in _LpInterface_ gibt an, dass die MAPI-Nachricht Store Schnittstelle **IMsgStore**, erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="29076-215">Passing **null** in  _lpInterface_ specifies that the MAPI message store interface, **IMsgStore**, is required.</span></span> <span data-ttu-id="29076-216">Übergeben das Objekt "Message" Store, IID_IMsgStore, gibt, dass **IMsgStore** erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="29076-216">Passing the message store object, IID_IMsgStore, also specifies that **IMsgStore** is required.</span></span> <span data-ttu-id="29076-217">Wenn IID_IUnknown _LpInterface_übergeben wird, sollte der Anbieter den Speicher öffnen Sie mithilfe der jeweilige Schnittstelle abgeleitet [IUnknown](http://msdn.microsoft.com/en-us/library/ms680509%28v=VS.85%29.aspx) ist am besten für den Anbieter (in diesem Fall ist dies in der Regel **IMsgStore**).</span><span class="sxs-lookup"><span data-stu-id="29076-217">If IID_IUnknown is passed in  _lpInterface_, the provider should open the store by using whatever interface derived from [IUnknown](http://msdn.microsoft.com/en-us/library/ms680509%28v=VS.85%29.aspx) is best for the provider (again, this is typically **IMsgStore**).</span></span> <span data-ttu-id="29076-218">Wenn IID_IUnknown übergeben wird, verwendet die aufrufende Implementierung die [QueryInterface](http://msdn.microsoft.com/en-us/library/ms682521%28v=VS.85%29.aspx) -Methode, eine Schnittstelle auszuwählen, nachdem der Vorgang zum Öffnen von Store erfolgreich war.</span><span class="sxs-lookup"><span data-stu-id="29076-218">When IID_IUnknown is passed, the calling implementation uses the [IUnknown::QueryInterface](http://msdn.microsoft.com/en-us/library/ms682521%28v=VS.85%29.aspx) method to select an interface after the store open operation succeeds.</span></span> 
  
<span data-ttu-id="29076-219">Der Anruf **IMSProvider::Logon** sollte über ausreichend Informationen, wie beispielsweise einen Pfad zu den Speicher und die Anmeldeinformationen für den Zugriff auf den Speicher, damit die MAPI-Warteschlange an den gleichen Speicher, die Speicheranbieter ausführt, ohne dass ein Dialogfeld anmelden können zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="29076-219">The **IMSProvider::Logon** call should return sufficient information, such as a path to the store and credentials for accessing the store, to allow the MAPI spooler to log on to the same store that the store provider does without presenting a dialog box.</span></span> <span data-ttu-id="29076-220">Die Parameter _LpcbSpoolSecurity_ und _LppbSpoolSecurity_ werden verwendet, um diese Informationen zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="29076-220">The  _lpcbSpoolSecurity_ and  _lppbSpoolSecurity_ parameters are used to return this information.</span></span> <span data-ttu-id="29076-221">Der Anbieter weist den Speicher für diese Daten, indem Sie einen Zeiger auf einen Puffer in die [MSProviderInit](msproviderinit.md) -Funktion _LpfAllocateBuffer_ -Parameter übergeben; der Anbieter platziert die Größe dieses Puffers in _LpcbSpoolSecurity_.</span><span class="sxs-lookup"><span data-stu-id="29076-221">The provider allocates the memory for this data by passing a pointer to a buffer in the [MSProviderInit](msproviderinit.md) function's  _lpfAllocateBuffer_ parameter; the provider places the size of this buffer in  _lpcbSpoolSecurity_.</span></span> 
  
<span data-ttu-id="29076-222">MAPI gibt dieser Puffer bei Bedarf frei.</span><span class="sxs-lookup"><span data-stu-id="29076-222">MAPI frees this buffer when appropriate.</span></span> <span data-ttu-id="29076-223">Wenn die MAPI-Warteschlange melden Sie sich an den Speicher von den Informationen im Profilabschnitt allein durchgeführt werden kann, kann der Anbieter in _LppbSpoolSecurity_ und 0 für die Informationen Größe in _LpcbSpoolSecurity_null zurück.</span><span class="sxs-lookup"><span data-stu-id="29076-223">If the MAPI spooler's logon to the store can be accomplished from the information in the profile section alone, the provider can return null in  _lppbSpoolSecurity_ and 0 for the information's size in  _lpcbSpoolSecurity_.</span></span> <span data-ttu-id="29076-224">Die MAPI-Warteschlange Anmeldung tritt im Rahmen von einem anderen Prozess als die Anmeldung Store; Da der Puffer, der die übergebene Informationen enthält, zwischen Prozessen kopiert Ruft ab, nicht im Arbeitsspeicher am selben Speicherort für den MAPI-Warteschlange Prozess wie bei der Speichervorgang Anbieter wird möglicherweise.</span><span class="sxs-lookup"><span data-stu-id="29076-224">The MAPI spooler logon occurs as part of a different process than the store logon; because the buffer that contains the passed information gets copied between processes, it might not be in memory at the same location for the MAPI spooler process as for the store provider process.</span></span> <span data-ttu-id="29076-225">Aus diesem Grund sollten kein Anbieter Adressen in dieser Puffer eingefügt.</span><span class="sxs-lookup"><span data-stu-id="29076-225">Therefore, a provider shouldn't put addresses into this buffer.</span></span> <span data-ttu-id="29076-226">Weitere Informationen zu MAPI-Warteschlange Anmeldung finden Sie unter der [IMSProvider::SpoolerLogon](imsprovider-spoolerlogon.md) -Methode.</span><span class="sxs-lookup"><span data-stu-id="29076-226">For more information about MAPI spooler logon, see the [IMSProvider::SpoolerLogon](imsprovider-spoolerlogon.md) method.</span></span> 
  
<span data-ttu-id="29076-227">Die meisten Anbieter verwenden die [IMAPISession::OpenProfileSection](imapisession-openprofilesection.md) -Methode des im Parameter _LpMAPISup_ zum Speichern und Abrufen von Benutzeranmeldeinformationen und Optionen übergebenen Support-Objekts.</span><span class="sxs-lookup"><span data-stu-id="29076-227">Most store providers use the [IMAPISession::OpenProfileSection](imapisession-openprofilesection.md) method of the support object passed in the  _lpMAPISup_ parameter for saving and retrieving user credentials and options.</span></span> <span data-ttu-id="29076-228">**"OpenProfileSection"** können einen Anbieter anmelden zum Speichern beliebiger Zusatzinformationen in einem Profilabschnitt, und ordnen Sie ihm eine bestimmte Ressource.</span><span class="sxs-lookup"><span data-stu-id="29076-228">**OpenProfileSection** enables a store provider to save additional arbitrary information in a profile section and associate it with a particular resource.</span></span> <span data-ttu-id="29076-229">Ein Anbieter anmelden kann beispielsweise den Benutzernamen und das Kennwort zugeordnet einer Ressource und Pfade oder andere Informationen, die für diese Ressource Zugriff auf Speichern.</span><span class="sxs-lookup"><span data-stu-id="29076-229">For example, a store provider can save the user account name and password associated with a resource and any paths or other information needed to access that resource.</span></span> 
  
<span data-ttu-id="29076-230">Eigenschaften mit Eigenschaftenbezeichner 0x6600 über 0x67FF sind sicheren Eigenschaften an den Anbieter zur eigenen Verwendung zum Speichern privater Daten im Profil Abschnitte zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="29076-230">Properties with property identifiers 0x6600 through 0x67FF are secure properties available to the provider for its own use to store private data in profile sections.</span></span> <span data-ttu-id="29076-231">Weitere Informationen zu den Verwendungsmöglichkeiten von Eigenschaften im Benutzerprofil Section-Objekten, finden Sie unter der [IProfSect: IMAPIProp](iprofsectimapiprop.md) Methode.</span><span class="sxs-lookup"><span data-stu-id="29076-231">For more information about the uses of properties in profile section objects, see the [IProfSect : IMAPIProp](iprofsectimapiprop.md) method.</span></span> 
  
<span data-ttu-id="29076-232">Zusätzlich zu privaten Daten in Eigenschaften mit Bezeichnern 0x6600 über 0x67FF sollten Speicheranbieter Informationen für die Eigenschaft **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) in einem Profilabschnitt bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="29076-232">In addition to any private data in properties with identifiers 0x6600 through 0x67FF, the store provider should provide information for the **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) property in its profile section.</span></span> <span data-ttu-id="29076-233">Sie sollten in **PR_DISPLAY_NAME** den Anzeigenamen des Anbieters selbst – eine Zeichenfolge zur Identifizierung (z. B. "Microsoft Personal Information Store"), die Benutzern angezeigt werden, damit sie dieses Nachrichtenspeichers von anderen unterscheiden können, sie möglicherweise Zugriff haben An.</span><span class="sxs-lookup"><span data-stu-id="29076-233">It should put in **PR_DISPLAY_NAME** the display name of the provider itself — an identifying string (for example, "Microsoft Personal Information Store") that is displayed to users so they can distinguish this message store from others they might have access to.</span></span> <span data-ttu-id="29076-234">**PR_DISPLAY_NAME** enthält häufig Servernamen, den Namen des Benutzerkontos oder den Pfad.</span><span class="sxs-lookup"><span data-stu-id="29076-234">**PR_DISPLAY_NAME** commonly contains a server name, user account name, or path.</span></span> 
  
<span data-ttu-id="29076-235">Einige im Abschnitt Benutzerprofileigenschaften sind in der Nachricht Store Tabelle angezeigt. andere Benutzer werden während des Setups, Installation und Konfiguration des MAPI-Subsystems angezeigt.</span><span class="sxs-lookup"><span data-stu-id="29076-235">Some profile section properties are visible in the message store table; others are visible during setup, installation, and configuration of the MAPI subsystem.</span></span> <span data-ttu-id="29076-236">Der Anbieter enthält in der Regel Informationen für diese sichtbaren Eigenschaften für einen neuen Profilabschnitt, der noch enthält keine gespeicherten Anmeldeinformationen und privaten Informationen, und wenn es findet, dass Eigenschaftsinformationen geändert hat.</span><span class="sxs-lookup"><span data-stu-id="29076-236">The provider typically provides information for these visible properties both for a new profile section, which does not yet include saved credentials or private information, and when it finds that property information has changed.</span></span> <span data-ttu-id="29076-237">Weitere Informationen über Profil Abschnitte finden Sie unter [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md).</span><span class="sxs-lookup"><span data-stu-id="29076-237">For more information about profile sections, see [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md).</span></span>
  
<span data-ttu-id="29076-238">Nach der erfolgreichen Anmeldung eines Benutzers und vor der Rückgabe MAPI, sollte der Anbieter das Array von Eigenschaften für die Statuszeile für die Ressource zu erstellen und die [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) -Methode aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="29076-238">After successfully logging on a user, and before returning to MAPI, the store provider should create the array of properties for the status row for the resource and call the [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) method.</span></span> 
  
 <span data-ttu-id="29076-239">**Anmeldung** -Anrufe, die Nachrichtenspeicher zu öffnen, die bereits für die aktuelle MAPI-Sitzung geöffnet sind überspringen Großteil der Verarbeitung weiter oben beschrieben.</span><span class="sxs-lookup"><span data-stu-id="29076-239">**Logon** calls that open message stores that are already open for the current MAPI session skip much of the processing previously described.</span></span> <span data-ttu-id="29076-240">Bei diesen anrufen führen Sie nicht Status Zeilen erstellen, Message Store Anmeldung Objekte zurückgeben, aufrufen, **AddRef** für das MAPI-Support-Objekt oder Daten für die MAPI-Warteschlange Anmeldung zurück.</span><span class="sxs-lookup"><span data-stu-id="29076-240">These calls do not create status rows, return message store logon objects, call **AddRef** for the MAPI support object, or return data for MAPI spooler logon.</span></span> <span data-ttu-id="29076-241">Bei diesen anrufen S_OK zurück und eine Nachricht Store-Objekt mit der angeforderten Schnittstelle zurück.</span><span class="sxs-lookup"><span data-stu-id="29076-241">These calls do return S_OK and return a message store object with the requested interface.</span></span> 
  
<span data-ttu-id="29076-242">Um solcher Anrufe zu erkennen, sollte der Anbieter eine Liste in Message-Speicher-Anbieter-Objekts der Speicher für dieses Anbieterobjekt bereits geöffnet zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="29076-242">To detect such calls, the provider should maintain a list in the message store provider object of stores already open for this provider object.</span></span> <span data-ttu-id="29076-243">Bei der Verarbeitung eines Anrufs **Anmeldung** sollte der Anbieter dieser Liste der open-Speicher zu überprüfen und bestimmen, ob der Speicher auf protokolliert werden bereits geöffnet ist.</span><span class="sxs-lookup"><span data-stu-id="29076-243">When processing a **Logon** call, the provider should scan this list of open stores and determine whether the store to be logged on to is already open.</span></span> <span data-ttu-id="29076-244">Wenn dies der Fall, Benutzeranmeldeinformationen müssen nicht überprüft werden soll, und die Anzeige eines Dialogfelds sollte vermieden werden, wenn möglich.</span><span class="sxs-lookup"><span data-stu-id="29076-244">If it is, user credentials do not need to be checked and the display of a dialog box should be avoided, if possible.</span></span> <span data-ttu-id="29076-245">Wenn Dialogfelder angezeigt werden müssen, sollte der Anbieter zurückgegebenen Informationen, um festzustellen, ob ein Speicher ein zweites Mal geöffnet wurde überprüfen.</span><span class="sxs-lookup"><span data-stu-id="29076-245">If dialog boxes must be displayed, the provider should check returned information to see whether a store has been opened a second time.</span></span> <span data-ttu-id="29076-246">Darüber hinaus der Anbieter sollte prüfen, ob doppelte öffnen mithilfe von _LpEntryID_ am Anfang der **Anmeldung** Anruf verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="29076-246">In addition, the provider should check for duplicate openings by using  _lpEntryID_ at the beginning of **Logon** call processing.</span></span> 
  
<span data-ttu-id="29076-247">Verarbeitung für eine **Anmeldung** Aufruf, der geöffneten Shop greift auf Standard lautet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="29076-247">Standard processing for a **Logon** call that accesses an open store is as follows:</span></span> 
  
1. <span data-ttu-id="29076-248">Speicheranbieter ruft **AddRef** für das vorhandene Store-Objekt, wenn die neue Benutzeroberfläche angefordert wird die Schnittstelle für den vorhandenen Store identisch ist.</span><span class="sxs-lookup"><span data-stu-id="29076-248">The store provider calls **AddRef** for the existing store object if the new interface being requested is the same as the interface for the existing store.</span></span> <span data-ttu-id="29076-249">Andernfalls wird die **QueryInterface** , um die neue Benutzeroberfläche zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="29076-249">Otherwise, it calls **QueryInterface** to get the new interface.</span></span> <span data-ttu-id="29076-250">Wenn der Informationsspeicher die neue Benutzeroberfläche nicht unterstützt, sollte der Anbieter den Fehlerwert MAPI_E_INTERFACE_NOT_SUPPORTED zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="29076-250">If the store does not support the new interface, the provider should return the error value MAPI_E_INTERFACE_NOT_SUPPORTED.</span></span> 
    
2. <span data-ttu-id="29076-251">Der Anbieter gibt einen Zeiger auf die erforderliche Schnittstelle des vorhandenen Store-Objekts in _LppMDB_.</span><span class="sxs-lookup"><span data-stu-id="29076-251">The provider returns a pointer to the required interface of the existing store object in  _lppMDB_.</span></span>
    
3. <span data-ttu-id="29076-252">Der Anbieter gibt in _LppMSLogon_ **null** zurück.</span><span class="sxs-lookup"><span data-stu-id="29076-252">The provider returns **null** in  _lppMSLogon_.</span></span>
    
4. <span data-ttu-id="29076-253">Der Anbieter sollte das Profil für den Anruf übergebenen Support-Objekt nicht geöffnet werden.</span><span class="sxs-lookup"><span data-stu-id="29076-253">The provider should not open the profile for the support object passed in the call.</span></span> <span data-ttu-id="29076-254">Darüber hinaus sollten nicht registrieren ein eindeutigen Bezeichners für Anbieter, Registrieren einer Statuszeile oder MAPI-Warteschlange Anmeldung Daten zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="29076-254">In addition, it should not register a provider unique identifier, register a status row, or return MAPI spooler logon data.</span></span>
    
5. <span data-ttu-id="29076-255">Der Anbieter sollte keine **AddRef** für das Objekt Support aufrufen, da einen Zeiger auf das Objekt nicht erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="29076-255">The provider should not call **AddRef** for the support object, because it does not require a pointer to the object.</span></span> 
    
<span data-ttu-id="29076-256">Wenn möglich, Anbieter sollte die entsprechende Fehlermeldung zurückgegeben und Warnung Zeichenfolgen für die **Anmeldung** Aufrufe, da dies erheblich erleichtert die Last der Benutzer bei der Bestimmung, warum etwas nicht funktioniert.</span><span class="sxs-lookup"><span data-stu-id="29076-256">Whenever possible, providers should return appropriate error and warning strings for **Logon** calls, because doing so greatly eases the burden of users in determining why something did not work.</span></span> <span data-ttu-id="29076-257">Wenn diese Zeichenfolgen zurückgeben möchten, legt ein Anbieter für die Mitglieder in der Struktur **MAPIERROR** fest.</span><span class="sxs-lookup"><span data-stu-id="29076-257">To return these strings, a provider sets the members in the **MAPIERROR** structure.</span></span> <span data-ttu-id="29076-258">MAPI für sucht, verwendet und die Struktur **MAPIERROR** frei, wenn es von einem Anbieter zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="29076-258">MAPI looks for, uses, and releases the **MAPIERROR** structure if it is returned by a provider.</span></span> 
  
<span data-ttu-id="29076-259">Arbeitsspeicher für diese Struktur **MAPIERROR** sollte mit dem Gespräch **MSProviderInit** _LpfAllocateBuffer_ übergebene Puffer zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="29076-259">Memory for this **MAPIERROR** structure should be allocated by using the buffer passed in  _lpfAllocateBuffer_ on the **MSProviderInit** call.</span></span> <span data-ttu-id="29076-260">Etwaige Fehler, die Zeichenfolgen in der zurückgegebenen Struktur enthalten im Unicode-Format werden soll, wenn der Parameter MAPI_UNICODE in die **Anmeldung** _UlFlags;_ andernfalls festgelegt ist, sollten sie in das ANSI-Zeichen festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="29076-260">Any error strings contained in the returned structure should be in Unicode format if MAPI_UNICODE is set in the **Logon** _ulFlags;_ otherwise, they should be in the ANSI character set.</span></span> 
  
<span data-ttu-id="29076-261">Für die meisten zurückgegebenen Fehlerwerte von **Anmeldung**deaktiviert MAPI die Message-Dienste zu denen der fehlerhaften Anbieter gehört.</span><span class="sxs-lookup"><span data-stu-id="29076-261">For most error values returned from **Logon**, MAPI disables the message services to which the failing provider belongs.</span></span> <span data-ttu-id="29076-262">MAPI rufen keine Anbieter, die zu dieser Dienste während der Lebensdauer der MAPI-Sitzung gehören.</span><span class="sxs-lookup"><span data-stu-id="29076-262">MAPI will not call any providers that belong to those services for the life of the MAPI session.</span></span> <span data-ttu-id="29076-263">Im Gegensatz dazu bei der **Anmeldung** von dessen Anmeldung den Fehlerwert MAPI_E_FAILONEPROVIDER zurückgibt, wird MAPI nicht den Dienst deaktiviert zu dem der Anbieter gehört.</span><span class="sxs-lookup"><span data-stu-id="29076-263">In contrast, when **Logon** returns the MAPI_E_FAILONEPROVIDER error value from its logon, MAPI does not disable the message service to which the provider belongs.</span></span> <span data-ttu-id="29076-264">**Anmeldung** sollte MAPI_E_FAILONEPROVIDER zurückgegeben, wenn ein Fehler auftritt, der nicht den gesamten Dienst für die Lebensdauer der Sitzung deaktivieren rechtfertigen ist.</span><span class="sxs-lookup"><span data-stu-id="29076-264">**Logon** should return MAPI_E_FAILONEPROVIDER if it encounters an error that does not warrant disabling the entire service for the life of the session.</span></span> <span data-ttu-id="29076-265">Beispielsweise könnte ein Anbieter dieser Fehler zurück, wenn nicht die Anzeige einer Benutzeroberfläche lässt und ein Kennwort erforderlich nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="29076-265">For example, a provider might return this error when it does not allow the display of a user interface and a required password is unavailable.</span></span> 
  
<span data-ttu-id="29076-266">Wenn ein Anbieter von dessen Anmeldung MAPI_E_UNCONFIGURED zurückgibt, wird MAPI Aufrufen des Anbieters Nachricht Service Eintrag-Funktion und wiederholen Sie die Anmeldung.</span><span class="sxs-lookup"><span data-stu-id="29076-266">If a provider returns MAPI_E_UNCONFIGURED from its logon, MAPI will call the provider's message service entry function and then retry the logon.</span></span> <span data-ttu-id="29076-267">MAPI übergibt MSG_SERVICE_CONFIGURE als Kontext aus, um dem Dienst selbst konfigurieren kann.</span><span class="sxs-lookup"><span data-stu-id="29076-267">MAPI passes MSG_SERVICE_CONFIGURE as the context to give the service a chance to configure itself.</span></span> <span data-ttu-id="29076-268">Wenn der Client sich entschieden hat, um eine Benutzeroberfläche für die Anmeldung zu ermöglichen, kann der Dienst das Eigenschaftenblatt Konfiguration darstellen, damit der Benutzer Informationen eingeben kann.</span><span class="sxs-lookup"><span data-stu-id="29076-268">If the client has chosen to allow a user interface on the logon, the service can present its configuration property sheet so the user can enter configuration information.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="29076-269">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="29076-269">See also</span></span>



[<span data-ttu-id="29076-270">IMAPISession::GetMsgStoresTable</span><span class="sxs-lookup"><span data-stu-id="29076-270">IMAPISession::GetMsgStoresTable</span></span>](imapisession-getmsgstorestable.md)
  
[<span data-ttu-id="29076-271">IMAPISession::OpenMsgStore</span><span class="sxs-lookup"><span data-stu-id="29076-271">IMAPISession::OpenMsgStore</span></span>](imapisession-openmsgstore.md)
  
[<span data-ttu-id="29076-272">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="29076-272">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md)
  
[<span data-ttu-id="29076-273">IMAPISupport::ModifyProfile</span><span class="sxs-lookup"><span data-stu-id="29076-273">IMAPISupport::ModifyProfile</span></span>](imapisupport-modifyprofile.md)
  
[<span data-ttu-id="29076-274">IMAPISupport::ModifyStatusRow</span><span class="sxs-lookup"><span data-stu-id="29076-274">IMAPISupport::ModifyStatusRow</span></span>](imapisupport-modifystatusrow.md)
  
[<span data-ttu-id="29076-275">IMsgStore: IMAPIProp</span><span class="sxs-lookup"><span data-stu-id="29076-275">IMsgStore : IMAPIProp</span></span>](imsgstoreimapiprop.md)
  
[<span data-ttu-id="29076-276">IMSProvider::SpoolerLogon</span><span class="sxs-lookup"><span data-stu-id="29076-276">IMSProvider::SpoolerLogon</span></span>](imsprovider-spoolerlogon.md)
  
[<span data-ttu-id="29076-277">IProfSect : IMAPIProp</span><span class="sxs-lookup"><span data-stu-id="29076-277">IProfSect : IMAPIProp</span></span>](iprofsectimapiprop.md)
  
[<span data-ttu-id="29076-278">MAPIERROR</span><span class="sxs-lookup"><span data-stu-id="29076-278">MAPIERROR</span></span>](mapierror.md)
  
[<span data-ttu-id="29076-279">MSProviderInit</span><span class="sxs-lookup"><span data-stu-id="29076-279">MSProviderInit</span></span>](msproviderinit.md)
  
[<span data-ttu-id="29076-280">IMSProvider : IUnknown</span><span class="sxs-lookup"><span data-stu-id="29076-280">IMSProvider : IUnknown</span></span>](imsprovideriunknown.md)

