---
title: Unterstützung der formatierte Text Nachrichtenspeicher Zuständigkeiten
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a97993c2-52e4-4b71-ac03-2c02d82447d8
description: 'Letzte �nderung: Montag, 9. M�rz 2015'
ms.openlocfilehash: 301ebbf8e7a3e2a2deb303af5b198fd11511d495
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19795649"
---
# <a name="supporting-formatted-text-message-store-responsibilities"></a><span data-ttu-id="9e622-103">Unterstützende formatierter Text: Nachrichtenspeicher Zuständigkeiten</span><span class="sxs-lookup"><span data-stu-id="9e622-103">Supporting Formatted Text: Message Store Responsibilities</span></span>

  
  
<span data-ttu-id="9e622-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="9e622-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="9e622-105">Nachricht Speicheranbieter verwenden Sie die Eigenschaft **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) um zu veröffentlichen, und zwar unabhängig davon, ob sie HTML-Text: Rich Text Format (RTF) verarbeitet werden können und, falls sie RTF-fähigen sind, ob das Speichern von formatierten Texts in ein komprimierte oder nicht komprimierten Format.</span><span class="sxs-lookup"><span data-stu-id="9e622-105">Message store providers use the **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property to publish whether or not they can handle Rich Text Format (RTF), HTML text and, if they are RTF-aware, whether they store the formatted text in a compressed or uncompressed format.</span></span> <span data-ttu-id="9e622-106">Nachricht Anbieter anzugeben, dass sie RTF-fähigen sind, indem Sie die STORE_RTF_OK Bit und sie den formatierten Text in einen nicht komprimierten Format speichern, indem Sie das STORE_UNCOMPRESSED_RTF Bit.</span><span class="sxs-lookup"><span data-stu-id="9e622-106">Message store providers indicate that they are RTF-aware by setting the STORE_RTF_OK bit and that they store the formatted text in an uncompressed form by setting the STORE_UNCOMPRESSED_RTF bit.</span></span> <span data-ttu-id="9e622-107">Nachricht Anbieter geben Sie an, dass sie HTML-fähigen sind, indem Sie die STORE_HTML_OK Bit.</span><span class="sxs-lookup"><span data-stu-id="9e622-107">Message store providers indicate they are HTML-aware by setting the STORE_HTML_OK bit.</span></span>
  
<span data-ttu-id="9e622-108">Es ist, zwar wichtig für ein RTF-fähigen Client zu prüfen, ob die STORE_RTF_OK bit, um zu bestimmen, ob ein Nachrichtenspeichers RTF unterstützt ist es nicht erforderlich, damit ein Client mit dem Format des formatierten Text ein RTF-fähigen Store betreffenden werden.</span><span class="sxs-lookup"><span data-stu-id="9e622-108">While it is important for an RTF-aware client to check for the STORE_RTF_OK bit to determine whether or not a message store supports RTF, it is not necessary for a client to be concerned with the format of an RTF-aware store's formatted text.</span></span> 
  
<span data-ttu-id="9e622-109">Alle Nachrichtenspeicher müssen nicht-RTF-fähigen Clients unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9e622-109">All message stores must support non-RTF-aware clients.</span></span> <span data-ttu-id="9e622-110">Ein Nachrichtenspeicher ohne RTF-Unterstützung muss die **PR_RTF_IN_SYNC** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md))-Eigenschaft während eines Anrufs an die Nachricht [IMAPIProp::SaveChanges](imapiprop-savechanges.md) -Methode löschen, wenn ein Client ohne **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) geändert hat Aktualisieren von **PR_RTF_IN_SYNC** oder **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="9e622-110">A non-RTF-aware message store must delete the **PR_RTF_IN_SYNC** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md)) property during a call to the message's [IMAPIProp::SaveChanges](imapiprop-savechanges.md) method if a client has changed **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) without updating either **PR_RTF_IN_SYNC** or **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)).</span></span> <span data-ttu-id="9e622-111">Löschen von **PR_RTF_IN_SYNC** bewirkt, dass die **PR_RTF_COMPRESSED** -Eigenschaft von der **PR_BODY** -Eigenschaft das nächste Mal neu berechnet werden, das ein RTF-fähigen Client [RTFSync](rtfsync.md)aufruft.</span><span class="sxs-lookup"><span data-stu-id="9e622-111">Deleting **PR_RTF_IN_SYNC** causes the **PR_RTF_COMPRESSED** property to be recomputed from the **PR_BODY** property the next time an RTF-aware client calls [RTFSync](rtfsync.md).</span></span> 
  
<span data-ttu-id="9e622-112">Die meisten RTF-fähigen Nachrichtenspeicher erhalten den Nachrichtentext nicht von Clients; Es muss auf Anforderung berechnet werden.</span><span class="sxs-lookup"><span data-stu-id="9e622-112">Most RTF-aware message stores are not given the message text by clients; it must be computed on request.</span></span> <span data-ttu-id="9e622-113">Da diese Berechnung zeitaufwändig und kostspielig ist, sollten Clients **PR_RTF_COMPRESSED** möglichst verwenden.</span><span class="sxs-lookup"><span data-stu-id="9e622-113">Because this computation is time consuming and expensive, clients should use **PR_RTF_COMPRESSED** whenever possible.</span></span> <span data-ttu-id="9e622-114">Um die **PR_BODY** -Eigenschaft zu berechnen, muss der Nachricht Speicheranbieter Dekomprimieren Sie die Inhalte der Eigenschaft **PR_RTF_COMPRESSED** und entfernt die rich-Text-Formatierung.</span><span class="sxs-lookup"><span data-stu-id="9e622-114">To compute the **PR_BODY** property, the message store provider must uncompress the contents of the **PR_RTF_COMPRESSED** property and remove the rich text formatting.</span></span> <span data-ttu-id="9e622-115">Clients, die nicht die **PR_RTF_COMPRESSED** -Eigenschaft unterstützen müssen diese Berechnung stattfinden für jede Nachricht.</span><span class="sxs-lookup"><span data-stu-id="9e622-115">Clients that do not support the **PR_RTF_COMPRESSED** property require this computation to take place for every message.</span></span> 
  
<span data-ttu-id="9e622-116">Beim Kopieren von Nachrichten speichern Nachricht Anbieter, die die **IMAPISupport::DoCopyProps** oder **IMAPISupport::DoCopyTo** -Methoden, die das Risiko eine Nachricht ohne Inhalt erstellen, wenn ihre Implementierung der **PR_BODY** schließt nicht verwenden Eigenschaft und **PR_RTF_COMPRESSED**nutzt.</span><span class="sxs-lookup"><span data-stu-id="9e622-116">When copying messages, message store providers that do not use the **IMAPISupport::DoCopyProps** or **IMAPISupport::DoCopyTo** methods run the risk of creating a message with no content if their implementation excludes the **PR_BODY** property and relies on **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="9e622-117">Es ist möglich, für die Daten in der Eigenschaft **PR_RTF_COMPRESSED** beschädigt.</span><span class="sxs-lookup"><span data-stu-id="9e622-117">It is possible for the data in the **PR_RTF_COMPRESSED** property to be corrupt.</span></span> <span data-ttu-id="9e622-118">Vor dem Ausschluss eines dieser Nachricht von Eigenschaften in den Kopiervorgang, überprüfen Sie eine Beschädigung wie folgt:</span><span class="sxs-lookup"><span data-stu-id="9e622-118">Before excluding either of these message content properties in the copy operation, check for corruption as follows:</span></span> 
  
1. <span data-ttu-id="9e622-119">Ist der Wert der **PR_RTF_COMPRESSED** nicht größer als die komprimierte RTF, ist beschädigt.</span><span class="sxs-lookup"><span data-stu-id="9e622-119">If the value of **PR_RTF_COMPRESSED** is not larger than the compressed RTF, the property is corrupt.</span></span> 
    
2. <span data-ttu-id="9e622-120">Wenn der magische Wert im RTF-Header nicht _DwMagicCompressedRTF_ oder _DwMagicUncompressedRTF_, die Eigenschaft ist beschädigt.</span><span class="sxs-lookup"><span data-stu-id="9e622-120">If the magic value in the RTF header is not  _dwMagicCompressedRTF_ or  _dwMagicUncompressedRTF_, the property is corrupt.</span></span>
    
<span data-ttu-id="9e622-121">Nachrichtenspeicher Anbieter mit Unterstützung des benötigten Methoden nicht betroffenen mit implementieren eine Prüfung **PR_RTF_COMPRESSED** Beschädigung werden; MAPI wird sichergestellt, dass die entsprechenden Eigenschaften vorhanden und gültig sind.</span><span class="sxs-lookup"><span data-stu-id="9e622-121">Message store providers using the support methods need not be concerned with implementing a check for **PR_RTF_COMPRESSED** corruption; MAPI ensures that the appropriate properties exist and are valid.</span></span> 
  
<span data-ttu-id="9e622-122">Es gibt drei verschiedene Ebenen von RTF-Unterstützung Nachricht-Anbieter implementiert werden können. MAPI empfiehlt, RTF-fähigen Nachricht-Anbieter die Unterstützung der mittleren oder höchste Ebene implementieren.</span><span class="sxs-lookup"><span data-stu-id="9e622-122">There are three different levels of RTF support that message store providers can implement; MAPI recommends that RTF-aware message store providers implement their support at the middle or highest level.</span></span> <span data-ttu-id="9e622-123">Alle RTF-fähigen Nachrichtenspeicher Anbieter übernehmen generieren **PR_BODY** aus die Daten in **PR_RTF_COMPRESSED** für ausgehende Nachrichten enthalten, und rufen Sie **RTFSync** zum Synchronisieren von Text und Formatierung für eingehende Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="9e622-123">All RTF-aware message store providers take care of generating **PR_BODY** from the data included in **PR_RTF_COMPRESSED** on outgoing messages and make a call to **RTFSync** to synchronize text and formatting on incoming messages.</span></span> 
  
<span data-ttu-id="9e622-124">In der folgenden Tabelle werden die Unterschiede zwischen diesen drei Ebenen beschrieben.</span><span class="sxs-lookup"><span data-stu-id="9e622-124">The differences between these three levels are described in the following table.</span></span> 
  
|<span data-ttu-id="9e622-125">**Unterstützungsumfang**</span><span class="sxs-lookup"><span data-stu-id="9e622-125">**Level of support**</span></span>|<span data-ttu-id="9e622-126">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="9e622-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="9e622-127">Low</span><span class="sxs-lookup"><span data-stu-id="9e622-127">Low</span></span>  <br/> |<span data-ttu-id="9e622-128">Nachricht Aufrufe eines **RTFSync** speichern, wenn Änderungen auf eine Nachricht gespeichert werden und extrahiert die Daten für die Eigenschaft **PR_BODY** aus **PR_RTF_COMPRESSED** statt erfordern Clients festgelegt.</span><span class="sxs-lookup"><span data-stu-id="9e622-128">Message store provider calls **RTFSync** whenever changes are saved to a message and extracts the data for the **PR_BODY** property from **PR_RTF_COMPRESSED** rather than requiring clients to set it.</span></span> <span data-ttu-id="9e622-129">**PR_BODY** und **PR_RTF_COMPRESSED** werden gespeichert.</span><span class="sxs-lookup"><span data-stu-id="9e622-129">Both **PR_BODY** and **PR_RTF_COMPRESSED** are stored.</span></span>  <br/> |
|<span data-ttu-id="9e622-130">Mitte</span><span class="sxs-lookup"><span data-stu-id="9e622-130">Middle</span></span>  <br/> |<span data-ttu-id="9e622-131">Nachrichtenspeicher Anbieter speichert nur die **PR_RTF_COMPRESSED** -Eigenschaft, Netzwerke **PR_BODY** bei Bedarf.</span><span class="sxs-lookup"><span data-stu-id="9e622-131">Message store provider stores only the **PR_RTF_COMPRESSED** property, computing **PR_BODY** when necessary.</span></span>  <br/> |
|<span data-ttu-id="9e622-132">High</span><span class="sxs-lookup"><span data-stu-id="9e622-132">High</span></span>  <br/> |<span data-ttu-id="9e622-133">Nachrichtenspeicher Anbieter Speicher weder **PR_BODY** oder die Hilfs RTF-Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="9e622-133">Message store provider stores neither **PR_BODY** or the auxiliary RTF properties.</span></span> <span data-ttu-id="9e622-134">**RTFSync** wird aufgerufen, wenn der Nachrichtentext geändert wurde und die Formatierung unverändert bleibt oder eine neue Nachricht von eines Transportdienstes heruntergeladen wird.</span><span class="sxs-lookup"><span data-stu-id="9e622-134">**RTFSync** is called when the message text has changed and the formatting remains unchanged or when a new message is downloaded by a transport provider.</span></span>  <br/> |
   

