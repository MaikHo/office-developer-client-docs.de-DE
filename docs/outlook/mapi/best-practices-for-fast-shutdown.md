---
title: Bewährte Methoden für das schnelle Herunterfahren
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ae8a9214-e53f-4c57-8dbe-aa7cc6903aa8
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 8c7225427b80d89c6dd8adfa85f7d91885850365
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32318144"
---
# <a name="best-practices-for-fast-shutdown"></a><span data-ttu-id="b6c92-103">Bewährte Methoden für das schnelle Herunterfahren</span><span class="sxs-lookup"><span data-stu-id="b6c92-103">Best Practices for Fast Shutdown</span></span>

  
  
<span data-ttu-id="b6c92-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="b6c92-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="b6c92-105">In diesem Thema werden bewährte Methoden für Administratoren, MAPI-Clients und MAPI-Anbieter empfohlen, die die Windows-Registrierungseinstellungen und die schnell heruntergefahrenen Schnittstellen verwenden, um Datenverluste beim Herunterfahren des Clients zu minimieren.</span><span class="sxs-lookup"><span data-stu-id="b6c92-105">This topic recommends best practices for administrators, MAPI clients, and MAPI providers to use Windows registry settings and the fast shutdown interfaces to minimize data loss during client shutdown.</span></span>
  
- <span data-ttu-id="b6c92-106">Damit ein MAPI-Client das schnelle Herunterfahren erfolgreich ausführen kann, sodass Anbieter Prozesse keinen Datenverlust verursachen, sollte der MAPI-Client zunächst die [IMAPIClientShutdown:: QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="b6c92-106">For a MAPI client to carry out fast shutdown successfully so that provider processes do not incur data loss, the MAPI client should first call the [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) method.</span></span> <span data-ttu-id="b6c92-107">Der Client sollte dann mit den Methoden [IMAPIClientShutdown:: NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) und [IMAPIClientShutdown::D ofastshutdown](imapiclientshutdown-dofastshutdown.md) basierend auf der Unterstützung des MAPI-Subsystems für schnelles Herunterfahren Vorgehen, wie durch den Rückgabewert von \*\* IMAPIClientShutdown:: QueryFastShutdown\*\*.</span><span class="sxs-lookup"><span data-stu-id="b6c92-107">The client should then proceed with the [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) and [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) methods based on the MAPI subsystem's support for fast shutdown, as indicated by the return value of **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="b6c92-108">Als MAPI-Client ruft Microsoft Outlook nicht **IMAPIClientShutdown:: NotifyProcessShutdown** oder **IMAPIClientShutdown::D ofastshutdown** auf, wenn **IMAPIClientShutdown:: QueryFastShutdown** einen Fehler zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="b6c92-108">As a MAPI client, Microsoft Outlook does not call **IMAPIClientShutdown::NotifyProcessShutdown** or **IMAPIClientShutdown::DoFastShutdown** if **IMAPIClientShutdown::QueryFastShutdown** returns an error.</span></span> <span data-ttu-id="b6c92-109">Wenn der Administrator das schnelle Herunterfahren in der Windows-Registrierung deaktiviert hat, würde das MAPI-Subsystem MAPI_E_NO_SUPPORT an **IMAPIClientShutdown:: QueryFastShutdown**zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="b6c92-109">If the administrator has disabled fast shutdown in the Windows registry, the MAPI subsystem would return MAPI_E_NO_SUPPORT to **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="b6c92-110">In diesem Fall informiert das MAPI-Subsystem MAPI-Anbieter nicht über einen sofortigen Clientprozess-Exit.</span><span class="sxs-lookup"><span data-stu-id="b6c92-110">In this case, the MAPI subsystem would not inform MAPI providers of an immediate client process exit.</span></span> <span data-ttu-id="b6c92-111">Wenn also ein MAPI-Client diesen Fehler zurückgibt, wird der Rückgabewert des Fehlers beendet, und alle externen Verweise werden getrennt, alle geladenen MAPI-Anbieter haben Datenverlust.</span><span class="sxs-lookup"><span data-stu-id="b6c92-111">Therefore, if a MAPI client disregards this error return code, proceeds to do fast shutdown, and disconnects all external references, all loaded MAPI providers will have data loss.</span></span> 
    
- <span data-ttu-id="b6c92-112">MAPI-Anbieter sollten die [IMAPIProviderShutdown: IUnknown](imapiprovidershutdowniunknown.md) -Schnittstelle implementieren, um rechtzeitige und erforderliche Schritte auszuführen, um Datenverluste zu vermeiden, da externe Verweise vom Client getrennt werden, bevor der Client beendet wird.</span><span class="sxs-lookup"><span data-stu-id="b6c92-112">MAPI providers should implement the [IMAPIProviderShutdown : IUnknown](imapiprovidershutdowniunknown.md) interface to carry out timely and necessary steps to avoid data loss due to the client disconnecting external references before the client exits.</span></span> <span data-ttu-id="b6c92-113">Ein Anbieter sollte alles andere verschieben, was nicht unbedingt erforderlich ist, um Daten in seinem primären Datenspeicher zu speichern.</span><span class="sxs-lookup"><span data-stu-id="b6c92-113">A provider should postpone everything else that is nonessential to saving data to its primary data store.</span></span> <span data-ttu-id="b6c92-114">Ein Transportanbieter sollte beispielsweise unnötige Hintergrundvorgänge verschieben, die auf neue e-Mails prüfen, ein Adressbuchanbieter sollte das Herunterladen der letzten Änderungen von seinem Server hinausschieben, und ein Speicheranbieter sollte Wartungsaufgaben wie komprimieren oder indizieren.</span><span class="sxs-lookup"><span data-stu-id="b6c92-114">For example, a transport provider should postpone unnecessary background operations that check for new mail, an address book provider should postpone downloading recent changes from its server, and a store provider should postpone maintenance tasks such as compacting or indexing.</span></span> 
    
- <span data-ttu-id="b6c92-115">Benutzer, die MAPI-Clients beenden sollen, sobald Sie Sie schließen, sollten die Standard Registrierungseinstellung verwenden, die das schnelle Herunterfahren ermöglicht, es sei denn, ein Anbieter wählt aus.</span><span class="sxs-lookup"><span data-stu-id="b6c92-115">Users who want MAPI clients to exit as soon as they close them should use the default registry setting that enables fast shutdown unless a provider opts out.</span></span>
    
- <span data-ttu-id="b6c92-116">Wenn ein MAPI-Client **IMAPIClientShutdown::D ofastshutdown**aufruft, dürfen keine weiteren Aufrufe an MAPI vorgenommen werden, einschließlich der [MAPIUninitialize](mapiuninitialize.md) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="b6c92-116">Once a MAPI client calls **IMAPIClientShutdown::DoFastShutdown**, it should not make any additional calls to MAPI, including the [MAPIUninitialize](mapiuninitialize.md) function.</span></span> <span data-ttu-id="b6c92-117">Der Client sollte MAPI für die restliche Lebensdauer des Clientprozesses nicht verwenden.</span><span class="sxs-lookup"><span data-stu-id="b6c92-117">The client should not use MAPI for the rest of the client process's lifetime.</span></span> 
    
- <span data-ttu-id="b6c92-118">Ein MAPI-Client sollte niemals die **IMAPIProviderShutdown** -Schnittstelle eines Anbieters direkt aufrufen.</span><span class="sxs-lookup"><span data-stu-id="b6c92-118">A MAPI client should never directly call a provider's **IMAPIProviderShutdown** interface.</span></span> <span data-ttu-id="b6c92-119">MAPI-Clients sollten immer die [IMAPIClientShutdown: IUnknown](imapiclientshutdowniunknown.md) -Schnittstelle verwenden.</span><span class="sxs-lookup"><span data-stu-id="b6c92-119">MAPI clients should always use the [IMAPIClientShutdown : IUnknown](imapiclientshutdowniunknown.md) interface.</span></span> 
    
- <span data-ttu-id="b6c92-120">Wenn ein MAPI-Anbieter sicherstellen muss, dass das schnelle Herunterfahren beim Laden nicht verwendet wird, sollte er die **IMAPIProviderShutdown** -Schnittstelle implementieren und MAPI_E_NO_SUPPORT für die **IMAPIProviderShutdown:: QueryFastShutdown** -Methode zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="b6c92-120">If a MAPI provider needs to ensure that fast shutdown is not used while it is loaded, it should implement the **IMAPIProviderShutdown** interface and return MAPI_E_NO_SUPPORT for the **IMAPIProviderShutdown::QueryFastShutdown** method.</span></span> <span data-ttu-id="b6c92-121">Für MAPI-Clients wie Outlook führt dies jedoch dazu, dass der Client das schnelle Herunterfahren aufgibt und das Herunterfahren länger dauert.</span><span class="sxs-lookup"><span data-stu-id="b6c92-121">However, for MAPI clients such as Outlook, this will cause the client to abandon fast shutdown and take a longer time to shut down.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="b6c92-122">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="b6c92-122">See also</span></span>



[<span data-ttu-id="b6c92-123">Herunterfahren von Clients in MAPI</span><span class="sxs-lookup"><span data-stu-id="b6c92-123">Client Shutdown in MAPI</span></span>](client-shutdown-in-mapi.md)
  
[<span data-ttu-id="b6c92-124">Übersicht über das schnelle Herunterfahren</span><span class="sxs-lookup"><span data-stu-id="b6c92-124">Fast Shutdown Overview</span></span>](fast-shutdown-overview.md)
  
[<span data-ttu-id="b6c92-125">Benutzeroptionen für das schnelle Herunterfahren</span><span class="sxs-lookup"><span data-stu-id="b6c92-125">Fast Shutdown User Options</span></span>](fast-shutdown-user-options.md)

