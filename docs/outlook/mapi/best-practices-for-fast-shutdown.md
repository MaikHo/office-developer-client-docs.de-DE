---
title: Bewährte Methoden für das schnelle Herunterfahren
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ae8a9214-e53f-4c57-8dbe-aa7cc6903aa8
description: 'Letzte �nderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 0d9e7caf43bcee654aa92652e94bc8c2ebba18e8
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19791375"
---
# <a name="best-practices-for-fast-shutdown"></a><span data-ttu-id="6ad07-103">Bewährte Methoden für das schnelle Herunterfahren</span><span class="sxs-lookup"><span data-stu-id="6ad07-103">Best Practices for Fast Shutdown</span></span>

  
  
<span data-ttu-id="6ad07-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="6ad07-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="6ad07-105">In diesem Thema empfiehlt bewährte Methoden für Administratoren, MAPI-Clients und MAPI-Anbieter, um die Einstellungen der Windows-Registrierung und das schnelle Herunterfahren-Schnittstellen verwenden, um während des Herunterfahrens Client Datenverluste zu minimieren.</span><span class="sxs-lookup"><span data-stu-id="6ad07-105">This topic recommends best practices for administrators, MAPI clients, and MAPI providers to use Windows registry settings and the fast shutdown interfaces to minimize data loss during client shutdown.</span></span>
  
- <span data-ttu-id="6ad07-106">Damit ein MAPI-Client, um Schnelles Herunterfahren erfolgreich auszuführen, sodass Anbieter Prozesse nicht ein gewisser Datenverlust auftreten muss der MAPI-Client zunächst die [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="6ad07-106">For a MAPI client to carry out fast shutdown successfully so that provider processes do not incur data loss, the MAPI client should first call the [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) method.</span></span> <span data-ttu-id="6ad07-107">Der Client sollte mit den Methoden [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) und [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) basierend auf den MAPI-Subsystems Unterstützung für schnelle Herunterfahren, fahren Sie durch den Rückgabewert der ** IMAPIClientShutdown::QueryFastShutdown**.</span><span class="sxs-lookup"><span data-stu-id="6ad07-107">The client should then proceed with the [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) and [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) methods based on the MAPI subsystem's support for fast shutdown, as indicated by the return value of **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="6ad07-108">Als MAPI-Client ist Microsoft Outlook nicht **IMAPIClientShutdown::NotifyProcessShutdown** oder **IMAPIClientShutdown::DoFastShutdown** aufrufen, wenn **IMAPIClientShutdown::QueryFastShutdown** einen Fehler zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="6ad07-108">As a MAPI client, Microsoft Outlook does not call **IMAPIClientShutdown::NotifyProcessShutdown** or **IMAPIClientShutdown::DoFastShutdown** if **IMAPIClientShutdown::QueryFastShutdown** returns an error.</span></span> <span data-ttu-id="6ad07-109">Wenn der Administrator Schnelles Herunterfahren in der Windows-Registrierung deaktiviert wurde, würde der MAPI-Subsystems MAPI_E_NO_SUPPORT an **IMAPIClientShutdown::QueryFastShutdown**zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="6ad07-109">If the administrator has disabled fast shutdown in the Windows registry, the MAPI subsystem would return MAPI_E_NO_SUPPORT to **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="6ad07-110">In diesem Fall würde des MAPI-Subsystems nicht darüber informiert, dass es sich bei MAPI-Anbieter über einen sofortigen Clientprozess beenden.</span><span class="sxs-lookup"><span data-stu-id="6ad07-110">In this case, the MAPI subsystem would not inform MAPI providers of an immediate client process exit.</span></span> <span data-ttu-id="6ad07-111">Wenn ein MAPI-Client dieser Fehler Rückgabecode ignoriert, geht zum Herunterfahren schnelle und alle externen Verweise trennt, müssen alle geladenen MAPI-Anbieter Datenverlust daher.</span><span class="sxs-lookup"><span data-stu-id="6ad07-111">Therefore, if a MAPI client disregards this error return code, proceeds to do fast shutdown, and disconnects all external references, all loaded MAPI providers will have data loss.</span></span> 
    
- <span data-ttu-id="6ad07-112">MAPI-Anbieter implementieren sollten die [IMAPIProviderShutdown: IUnknown](imapiprovidershutdowniunknown.md) Schnittstelle für die Durchführung rechtzeitig und die erforderlichen Schritte zur Vermeidung Verlust von Daten durch den Client externe Verweise trennen, bevor der Client beendet wird.</span><span class="sxs-lookup"><span data-stu-id="6ad07-112">MAPI providers should implement the [IMAPIProviderShutdown : IUnknown](imapiprovidershutdowniunknown.md) interface to carry out timely and necessary steps to avoid data loss due to the client disconnecting external references before the client exits.</span></span> <span data-ttu-id="6ad07-113">Ein Anbieter sollte alles verschieben, das zum Speichern von Daten als primären Datenspeicher nicht benötigte ist.</span><span class="sxs-lookup"><span data-stu-id="6ad07-113">A provider should postpone everything else that is nonessential to saving data to its primary data store.</span></span> <span data-ttu-id="6ad07-114">Beispiel ein Transportdienstes sollten unnötige Hintergrundvorgängen, die für neue Nachrichten überprüfen einer Adressbuchanbieter verschiebt sollte das Herunterladen von kürzlichen Änderungen vom Server verschieben und sollte ein Anbieter anmelden Wartungsaufgaben wie verschieben Komprimieren oder indizieren.</span><span class="sxs-lookup"><span data-stu-id="6ad07-114">For example, a transport provider should postpone unnecessary background operations that check for new mail, an address book provider should postpone downloading recent changes from its server, and a store provider should postpone maintenance tasks such as compacting or indexing.</span></span> 
    
- <span data-ttu-id="6ad07-115">Benutzer, die MAPI-Clients zu beenden, sobald sie diese schließen möchten, sollten die Standardeinstellung für die Registrierung verwenden, die Schnelles Herunterfahren aktiviert, es sei denn, ein Anbieter entscheidet.</span><span class="sxs-lookup"><span data-stu-id="6ad07-115">Users who want MAPI clients to exit as soon as they close them should use the default registry setting that enables fast shutdown unless a provider opts out.</span></span>
    
- <span data-ttu-id="6ad07-116">Nachdem ein MAPI-Client **IMAPIClientShutdown::DoFastShutdown**aufruft, sollte zusätzlichen Anrufe MAPI, einschließlich der [MAPIUninitialize](mapiuninitialize.md) -Funktion nicht ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="6ad07-116">Once a MAPI client calls **IMAPIClientShutdown::DoFastShutdown**, it should not make any additional calls to MAPI, including the [MAPIUninitialize](mapiuninitialize.md) function.</span></span> <span data-ttu-id="6ad07-117">Der Client sollte MAPI für den Rest der Lebensdauer des Clientprozesses nicht verwenden.</span><span class="sxs-lookup"><span data-stu-id="6ad07-117">The client should not use MAPI for the rest of the client process's lifetime.</span></span> 
    
- <span data-ttu-id="6ad07-118">Ein MAPI-Client sollte niemals direkt eine Anbieterschnittstelle **IMAPIProviderShutdown** aufrufen.</span><span class="sxs-lookup"><span data-stu-id="6ad07-118">A MAPI client should never directly call a provider's **IMAPIProviderShutdown** interface.</span></span> <span data-ttu-id="6ad07-119">Verwenden Sie MAPI-Clients sollte immer die [IMAPIClientShutdown: IUnknown](imapiclientshutdowniunknown.md) Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="6ad07-119">MAPI clients should always use the [IMAPIClientShutdown : IUnknown](imapiclientshutdowniunknown.md) interface.</span></span> 
    
- <span data-ttu-id="6ad07-120">Wenn ein MAPI-Anbieter muss sicherstellen, dass diese schnelle Herunterfahren nicht verwendet wird, während es geladen wird, muss die **IMAPIProviderShutdown** -Schnittstelle implementieren und MAPI_E_NO_SUPPORT für die **IMAPIProviderShutdown::QueryFastShutdown** -Methode zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6ad07-120">If a MAPI provider needs to ensure that fast shutdown is not used while it is loaded, it should implement the **IMAPIProviderShutdown** interface and return MAPI_E_NO_SUPPORT for the **IMAPIProviderShutdown::QueryFastShutdown** method.</span></span> <span data-ttu-id="6ad07-121">MAPI-Clients wie Outlook verursacht dies jedoch den Client Schnelles Herunterfahren abbrechen und zum Herunterfahren längere Zeit in Anspruch nehmen.</span><span class="sxs-lookup"><span data-stu-id="6ad07-121">However, for MAPI clients such as Outlook, this will cause the client to abandon fast shutdown and take a longer time to shut down.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="6ad07-122">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="6ad07-122">See also</span></span>



[<span data-ttu-id="6ad07-123">Herunterfahren von Clients in MAPI</span><span class="sxs-lookup"><span data-stu-id="6ad07-123">Client Shutdown in MAPI</span></span>](client-shutdown-in-mapi.md)
  
[<span data-ttu-id="6ad07-124">Schnelles Herunterfahren (Übersicht)</span><span class="sxs-lookup"><span data-stu-id="6ad07-124">Fast Shutdown Overview</span></span>](fast-shutdown-overview.md)
  
[<span data-ttu-id="6ad07-125">Schnelles Herunterfahren Benutzeroptionen</span><span class="sxs-lookup"><span data-stu-id="6ad07-125">Fast Shutdown User Options</span></span>](fast-shutdown-user-options.md)

