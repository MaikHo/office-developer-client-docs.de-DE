---
title: Anmelden bei MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 05bafe43-a78a-4659-92f0-0b4fe444c64f
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 1ae3c47964ff238f57e98e0005a966008192f7c7
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19792919"
---
# <a name="logging-on-to-mapi"></a><span data-ttu-id="3a6d0-103">Anmelden bei MAPI</span><span class="sxs-lookup"><span data-stu-id="3a6d0-103">Logging on to MAPI</span></span>
 
<span data-ttu-id="3a6d0-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="3a6d0-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="3a6d0-105">Clientanwendungen melden Sie sich an den MAPI-Subsystems durch Aufrufen der Funktion **MAPILogonEx** .</span><span class="sxs-lookup"><span data-stu-id="3a6d0-105">Client applications log on to the MAPI subsystem by calling the **MAPILogonEx** function.</span></span> <span data-ttu-id="3a6d0-106">Weitere Informationen finden Sie unter [MAPILogonEx](mapilogonex.md).</span><span class="sxs-lookup"><span data-stu-id="3a6d0-106">For more information, see [MAPILogonEx](mapilogonex.md).</span></span> <span data-ttu-id="3a6d0-107">**MAPILogonEx** überprüft die Profilauswahl und die Konfiguration der einzelnen-Dienstanbieter im Profil.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-107">**MAPILogonEx** validates the profile selection and the configuration of each service provider in the profile.</span></span> <span data-ttu-id="3a6d0-108">Nach der Konfiguration, startet MAPI der adressbuchanbietern implementierte vor dem Starten der Nachricht-Anbieter.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-108">Once configured, MAPI starts the address book providers before starting the message store providers.</span></span> <span data-ttu-id="3a6d0-109">Transportanbieter gestartet wurden, wenn ihre Dienste zuerst benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-109">Transport providers are started when their services are first required.</span></span> 
  
## <a name="choose-a-profile"></a><span data-ttu-id="3a6d0-110">Wählen Sie ein Profil</span><span class="sxs-lookup"><span data-stu-id="3a6d0-110">Choose a profile</span></span>
  
- <span data-ttu-id="3a6d0-111">Übergeben Sie eine Zeichenfolge, die den Namen des Profils im Parameter _LpszProfileName_ **MAPILogonEx**, darstellt oder...</span><span class="sxs-lookup"><span data-stu-id="3a6d0-111">Pass in a character string that represents the name of the profile in the  _lpszProfileName_ parameter to **MAPILogonEx**, or...</span></span>
    
- <span data-ttu-id="3a6d0-112">Ermöglicht es dem Benutzer das Profil, NULL in der _LpszProfileName_ -Parameter übergeben wird und die Kennzeichen MAPI_LOGON_UI angeben oder...</span><span class="sxs-lookup"><span data-stu-id="3a6d0-112">Allow the user to specify the profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_LOGON_UI flag, or...</span></span> 

- <span data-ttu-id="3a6d0-113">Wählen Sie das Standardprofil durch NULL im _LpszProfileName_ -Parameter übergeben, und das MAPI_USE_DEFAULT-Flag festlegen.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-113">Select the default profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_USE_DEFAULT flag.</span></span> 
    
<span data-ttu-id="3a6d0-114">Wenn Sie ein bestimmtes Profil als Standardprofil benötigen, müssen Sie deren Namen in Ihrer eigenen Konfigurationsdatenbank speichern oder eine spezielle Benennungskonvention verwenden.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-114">If you require a specific profile other than the default profile, you must save its name in your own configuration database or use a specific naming convention.</span></span> <span data-ttu-id="3a6d0-115">MAPI macht keine Profilattribute als das Flag Name und die Standardwerte in der Profiltabelle, und die Standard-Profil-Flag ist für die messaging-Client und zugehörige IPM Applikationen reserviert.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-115">MAPI does not expose any profile attributes other than the name and default flag in the profile table, and the default profile flag is reserved for messaging client and related IPM applications.</span></span>
  
<span data-ttu-id="3a6d0-116">Clients, die teilweise Profil oder Anbieter-Konfigurationsinformationen zu **MAPILogonEx** bereitstellen müssen den Benutzer für die zusätzlichen Daten auffordern, durch Zulassen der ein Dialogfeld angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-116">Clients that supply partial profile or provider configuration information to **MAPILogonEx** must prompt the user for the additional data by allowing a dialog box to be displayed.</span></span> <span data-ttu-id="3a6d0-117">Wenn Informationen fehlen und **MAPILogonEx** kann nicht der Benutzer aufgefordert, ihn angeben, schlägt die Anmeldung.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-117">If information is missing and **MAPILogonEx** cannot prompt the user to supply it, the logon fails.</span></span> <span data-ttu-id="3a6d0-118">Clients, die keine Notwendigkeit von Benutzereingaben nicht ausführen, können das Dialogfeld Feld Display unterdrücken.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-118">Clients that do not need user input can suppress the dialog box display.</span></span> 
  
<span data-ttu-id="3a6d0-119">Die Kennzeichen, die **MAPILogonEx** verwendet, um eine Benutzeroberfläche aktivieren schließen sich gegenseitig aus; nur kann festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-119">The flags that **MAPILogonEx** uses to enable a user interface are mutually exclusive; only one can be set.</span></span> <span data-ttu-id="3a6d0-120">Diese Flags nicht festgelegte verlassen unterdrückt die Anzeige einer Benutzeroberfläche, wodurch **MAPILogonEx** fehlschlagen, wenn die erforderlichen Informationen nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-120">Leaving these flags unset suppresses the display of a user interface, causing **MAPILogonEx** to fail if necessary information is missing.</span></span> <span data-ttu-id="3a6d0-121">D. h., wenn Sie die Benutzeroberfläche deaktivieren und übergeben Sie NULL für den Parameter _LpszProfileName_ , Sie die Kennzeichen MAPI_USE_DEFAULT nicht legen fehl **MAPILogonEx** , da er einen Profilnamen nicht abrufen kann.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-121">That is, if you disable the user interface and pass NULL for the  _lpszProfileName_ parameter and do not set the MAPI_USE_DEFAULT flag, **MAPILogonEx** will fail because it cannot retrieve a profile name.</span></span> 
  
<span data-ttu-id="3a6d0-122">Die Sitzung, die **MAPILogonEx** richtet kann ein einzelnes messaging-Sitzung, einen freigegebenen messaging-Sitzung oder eine nonmessaging Sitzung sein.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-122">The session that **MAPILogonEx** establishes can be an individual messaging session, a shared messaging session, or a nonmessaging session.</span></span> <span data-ttu-id="3a6d0-123">Einzelne messaging Sitzungen sind VPN-Verbindungen zwischen dem Client und MAPI-Subsystems und können durch Festlegen des MAPI_NEW_SESSION-Flags im Aufruf **MAPILogonEx**hergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-123">Individual messaging sessions are private connections between your client and the MAPI subsystem and can be established by setting the MAPI_NEW_SESSION flag in the call to **MAPILogonEx**.</span></span>
  
<span data-ttu-id="3a6d0-124">Freigegebene messaging-Sitzungen werden Verbindungen, die mehrere messaging-Clients verwenden können.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-124">Shared messaging sessions are connections that multiple messaging clients can use.</span></span> <span data-ttu-id="3a6d0-125">Freigegebene Sitzungen sind für die Verwendung durch Clients des gleichen Profils in der Regel eingerichtet.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-125">Shared sessions are typically established for clients use the same profile.</span></span> <span data-ttu-id="3a6d0-126">Um eine neue Sitzung als freigegebenen Sitzung herzustellen, legen Sie das MAPI_ALLOW_OTHERS-Flag.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-126">To establish a new session as a shared session, set the MAPI_ALLOW_OTHERS flag.</span></span> 
  
## <a name="use-an-existing-shared-session"></a><span data-ttu-id="3a6d0-127">Verwenden Sie eine vorhandene freigegebene Sitzung</span><span class="sxs-lookup"><span data-stu-id="3a6d0-127">Use an existing shared session</span></span>
  
- <span data-ttu-id="3a6d0-128">Das Flag MAPI_NEW_SESSION nicht festgelegt.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-128">Do not set the MAPI_NEW_SESSION flag.</span></span>
    
- <span data-ttu-id="3a6d0-129">Das Flag MAPI_ALLOW_OTHERS nicht festgelegt.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-129">Do not set the MAPI_ALLOW_OTHERS flag.</span></span>
    
- <span data-ttu-id="3a6d0-130">Übergeben Sie NULL für den Parameter _LpszProfileName_ .</span><span class="sxs-lookup"><span data-stu-id="3a6d0-130">Pass NULL for the  _lpszProfileName_ parameter.</span></span> 
    
- <span data-ttu-id="3a6d0-131">Übergeben Sie NULL für den Parameter _LpszPassword_ .</span><span class="sxs-lookup"><span data-stu-id="3a6d0-131">Pass NULL for the  _lpszPassword_ parameter.</span></span> 
    
<span data-ttu-id="3a6d0-132">Nonmessaging Sitzungen ermöglichen Clients das MAPI-Subsystem zugreifen, aber Nachrichten gesendet oder empfangen wurden nicht zulassen.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-132">Nonmessaging sessions allow clients to access the MAPI subsystem, but do not allow messages to be sent or received.</span></span> <span data-ttu-id="3a6d0-133">Konfiguration oder Verwaltung Applikationen sind Beispiele für Clients, die möglicherweise nonmessaging Sitzungen herstellen.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-133">Configuration or administration applications are examples of clients that might need to establish nonmessaging sessions.</span></span> <span data-ttu-id="3a6d0-134">Um eine nonmessaging Sitzung anzufordern, legen Sie das MAPI_NO_MAIL-Flag.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-134">To request a nonmessaging session, set the MAPI_NO_MAIL flag.</span></span> <span data-ttu-id="3a6d0-135">Wenn Sie dieses Flag anmeldet Ihrer Client ohne informiert die MAPI-Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-135">Setting this flag logs your client on without informing the MAPI spooler.</span></span> <span data-ttu-id="3a6d0-136">Clients, die mit diesem Flag MAPI anmelden können nicht erwarten jemals lesen Statusberichte.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-136">Clients that log on to MAPI with this flag cannot expect to ever receive read status reports.</span></span>
  
<span data-ttu-id="3a6d0-137">Das Flag MAPI_NO_MAIL sollte nur festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="3a6d0-137">The MAPI_NO_MAIL flag should only be set:</span></span>
  
- <span data-ttu-id="3a6d0-138">Wenn der Client wird nicht senden oder Empfangen von Nachrichten während der Sitzung.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-138">If your client will not send or receive messages during the session.</span></span>
    
- <span data-ttu-id="3a6d0-139">Wenn der Client hat die vollständige Kontrolle über den Inhalt des Profils und Nachrichten gesendet und Empfangen von eng gekoppelten Nachrichtenspeicher und transport-Anbieter, wie die Microsoft Exchange-Anbieter.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-139">If your client has complete control over the contents of the profile and messages are sent and received using tightly coupled message store and transport providers, such as the Microsoft Exchange providers.</span></span>
    
<span data-ttu-id="3a6d0-140">Messaging-Client kann eine Sitzung mit einem nonmessaging Client freigeben.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-140">A messaging client can share a session with a nonmessaging client.</span></span> <span data-ttu-id="3a6d0-141">Die Merkmale eines Elements einer freigegebenen Sitzung werden die Merkmale der anderen Elemente nicht betroffen.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-141">The characteristics of one member of a shared session are not affected by the characteristics of other members.</span></span> <span data-ttu-id="3a6d0-142">D. h., wenn Sie sich mit dem Flags MAPI_NO_MAIL und MAPI_ALLOW_OTHERS anmelden, wirkt sich ein messaging-Client anmelden, die Sitzung nicht auf den Vorgang des Clients und umgekehrt.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-142">That is, if you log on with the MAPI_NO_MAIL and MAPI_ALLOW_OTHERS flags set, a messaging client logging on to your session has no affect on the operation of your client and vice versa.</span></span> <span data-ttu-id="3a6d0-143">Der messaging-Client wird weiterhin in der Lage, senden und Empfangen von Nachrichten und der Client aber nicht.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-143">The messaging client will still be able to send and receive messages and your client will not.</span></span>
  
<span data-ttu-id="3a6d0-144">**MAPILogonEx** definiert ein paar Flags, die festgelegt werden können:</span><span class="sxs-lookup"><span data-stu-id="3a6d0-144">**MAPILogonEx** defines a few other flags that you can set:</span></span> 
  
- <span data-ttu-id="3a6d0-145">MAPI_FORCE_DOWNLOAD gibt an, dass eingehende Nachrichten heruntergeladen werden sollen, bevor **MAPILogonEx** zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-145">MAPI_FORCE_DOWNLOAD indicates that incoming messages should be downloaded before **MAPILogonEx** returns.</span></span> <span data-ttu-id="3a6d0-146">Nicht festlegen dieses Kennzeichen bewirkt, dass Nachrichten im Hintergrund zu einem späteren Zeitpunkt heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-146">Not setting this flag causes messages to be downloaded in the background at a later time.</span></span> 
    
- <span data-ttu-id="3a6d0-147">MAPI_SERVICE_UI_ALWAYS fordert an, dass jede Nachricht Dienste im Profil ein Konfigurationsdialogfeld angezeigt.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-147">MAPI_SERVICE_UI_ALWAYS requests that every message service in the profile display a configuration dialog box.</span></span>
    
- <span data-ttu-id="3a6d0-148">MAPI_NT_SERVICE gibt an, dass Ihre Clients als Windows-Dienst implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-148">MAPI_NT_SERVICE indicates that your client is implemented as a Windows service.</span></span> <span data-ttu-id="3a6d0-149">Dieses Kennzeichen müssen festgelegt werden, wenn der Client einen Dienst handelt.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-149">This flag must be set if your client is a service.</span></span>
    
<span data-ttu-id="3a6d0-150">Mit jeder erfolgreichen Anmeldung gibt **MAPILogonEx** einen Zeiger auf eine MAPI-Sitzung.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-150">With every successful logon, **MAPILogonEx** returns a pointer to a MAPI session.</span></span> <span data-ttu-id="3a6d0-151">Sie können diese Zeiger zum Aufrufen der Methoden der **IMAPISession** -Schnittstelle verwenden.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-151">You can use this pointer to call the methods of the **IMAPISession** interface.</span></span> <span data-ttu-id="3a6d0-152">Weitere Informationen finden Sie unter [IMAPISession: IUnknown](imapisessioniunknown.md).</span><span class="sxs-lookup"><span data-stu-id="3a6d0-152">For more information, see [IMAPISession : IUnknown](imapisessioniunknown.md).</span></span> <span data-ttu-id="3a6d0-153">Sitzung Zeigern, unabhängig von der Art der Sitzung, gelten nur für Clients, die empfangen werden und sind mehrere Vorgänge nicht gültig.</span><span class="sxs-lookup"><span data-stu-id="3a6d0-153">Session pointers, regardless of the type of session, are unique to the clients that receive them and are not valid across tasks.</span></span>
  

