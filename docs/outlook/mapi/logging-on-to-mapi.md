---
title: Anmelden bei MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 05bafe43-a78a-4659-92f0-0b4fe444c64f
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: cce43301ac73a5646e263b2ab92700e57804637d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419709"
---
# <a name="logging-on-to-mapi"></a><span data-ttu-id="a179d-103">Anmelden bei MAPI</span><span class="sxs-lookup"><span data-stu-id="a179d-103">Logging on to MAPI</span></span>
 
<span data-ttu-id="a179d-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a179d-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a179d-105">Client Anwendungen melden sich beim MAPI-Subsystem an, indem Sie die **MAPILogonEx** -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a179d-105">Client applications log on to the MAPI subsystem by calling the **MAPILogonEx** function.</span></span> <span data-ttu-id="a179d-106">Weitere Informationen finden Sie unter [MAPILogonEx](mapilogonex.md).</span><span class="sxs-lookup"><span data-stu-id="a179d-106">For more information, see [MAPILogonEx](mapilogonex.md).</span></span> <span data-ttu-id="a179d-107">**MAPILogonEx** überprüft die Profilauswahl und die Konfiguration der einzelnen Dienstanbieter im Profil.</span><span class="sxs-lookup"><span data-stu-id="a179d-107">**MAPILogonEx** validates the profile selection and the configuration of each service provider in the profile.</span></span> <span data-ttu-id="a179d-108">Nach der Konfiguration startet MAPI die Adressbuchanbieter, bevor der Nachrichtenspeicher Anbieter gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="a179d-108">Once configured, MAPI starts the address book providers before starting the message store providers.</span></span> <span data-ttu-id="a179d-109">Transport Anbieter werden gestartet, wenn ihre Dienste zuerst erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="a179d-109">Transport providers are started when their services are first required.</span></span> 
  
## <a name="choose-a-profile"></a><span data-ttu-id="a179d-110">Profil auswählen</span><span class="sxs-lookup"><span data-stu-id="a179d-110">Choose a profile</span></span>
  
- <span data-ttu-id="a179d-111">Übergeben Sie eine Zeichenfolge, die den Namen des Profils im _lpszProfileName_ -Parameter darstellt **MAPILogonEx**, oder...</span><span class="sxs-lookup"><span data-stu-id="a179d-111">Pass in a character string that represents the name of the profile in the  _lpszProfileName_ parameter to **MAPILogonEx**, or...</span></span>
    
- <span data-ttu-id="a179d-112">Geben Sie dem Benutzer die Möglichkeit, das Profil anzugeben, indem Sie im _lpszProfileName_ -Parameter den Wert NULL übergeben und das MAPI_LOGON_UI-Flag festlegen.</span><span class="sxs-lookup"><span data-stu-id="a179d-112">Allow the user to specify the profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_LOGON_UI flag, or...</span></span> 

- <span data-ttu-id="a179d-113">Wählen Sie das Standardprofil aus, indem Sie im _lpszProfileName_ -Parameter den Wert NULL übergeben und das MAPI_USE_DEFAULT-Flag festlegen.</span><span class="sxs-lookup"><span data-stu-id="a179d-113">Select the default profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_USE_DEFAULT flag.</span></span> 
    
<span data-ttu-id="a179d-114">Wenn Sie ein anderes Profil als das Standardprofil benötigen, müssen Sie den Namen in ihrer eigenen Konfigurationsdatenbank speichern oder eine bestimmte Benennungskonvention verwenden.</span><span class="sxs-lookup"><span data-stu-id="a179d-114">If you require a specific profile other than the default profile, you must save its name in your own configuration database or use a specific naming convention.</span></span> <span data-ttu-id="a179d-115">MAPI stellt keine anderen Profilattribute als den Namen und das Standardkennzeichen in der Profiltabelle zur Verfügung, und das standardmäßige Profil Kennzeichen ist für den Messaging Client und die zugehörigen IPM-Anwendungen reserviert.</span><span class="sxs-lookup"><span data-stu-id="a179d-115">MAPI does not expose any profile attributes other than the name and default flag in the profile table, and the default profile flag is reserved for messaging client and related IPM applications.</span></span>
  
<span data-ttu-id="a179d-116">Clients, die Teilprofil-oder Anbieter Konfigurationsinformationen für **MAPILogonEx** bereitstellen, müssen den Benutzer für die zusätzlichen Daten auffordern, indem ein Dialogfeld angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="a179d-116">Clients that supply partial profile or provider configuration information to **MAPILogonEx** must prompt the user for the additional data by allowing a dialog box to be displayed.</span></span> <span data-ttu-id="a179d-117">Wenn Informationen fehlen und **MAPILogonEx** den Benutzer nicht zur Verfügung stellen kann, schlägt die Anmeldung fehl.</span><span class="sxs-lookup"><span data-stu-id="a179d-117">If information is missing and **MAPILogonEx** cannot prompt the user to supply it, the logon fails.</span></span> <span data-ttu-id="a179d-118">Clients, die keine Benutzereingabe benötigen, können die Anzeige des Dialogfelds unterdrücken.</span><span class="sxs-lookup"><span data-stu-id="a179d-118">Clients that do not need user input can suppress the dialog box display.</span></span> 
  
<span data-ttu-id="a179d-119">Die Flags, die **MAPILogonEx** verwendet, um eine Benutzeroberfläche zu aktivieren, schließen sich gegenseitig aus; Es kann nur eine festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="a179d-119">The flags that **MAPILogonEx** uses to enable a user interface are mutually exclusive; only one can be set.</span></span> <span data-ttu-id="a179d-120">Wenn Sie diese Flags verlassen, wird die Anzeige einer Benutzeroberfläche unterdrückt, sodass **MAPILogonEx** fehlschlägt, wenn erforderliche Informationen fehlen.</span><span class="sxs-lookup"><span data-stu-id="a179d-120">Leaving these flags unset suppresses the display of a user interface, causing **MAPILogonEx** to fail if necessary information is missing.</span></span> <span data-ttu-id="a179d-121">Das heißt, wenn Sie die Benutzeroberfläche deaktivieren und NULL für den _lpszProfileName_ -Parameter übergeben und das MAPI_USE_DEFAULT-Flag nicht festlegen, schlägt **MAPILogonEx** fehl, da ein Profilname nicht abgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="a179d-121">That is, if you disable the user interface and pass NULL for the  _lpszProfileName_ parameter and do not set the MAPI_USE_DEFAULT flag, **MAPILogonEx** will fail because it cannot retrieve a profile name.</span></span> 
  
<span data-ttu-id="a179d-122">Bei der **MAPILogonEx** -Sitzung kann es sich um eine einzelne Messaging Sitzung, eine freigegebene Messaging Sitzung oder eine nonmessaging-Sitzung handeln.</span><span class="sxs-lookup"><span data-stu-id="a179d-122">The session that **MAPILogonEx** establishes can be an individual messaging session, a shared messaging session, or a nonmessaging session.</span></span> <span data-ttu-id="a179d-123">Einzelne Messagingsitzungen sind private Verbindungen zwischen dem Client und dem MAPI-Subsystem und können durch Festlegen des MAPI_NEW_SESSION-Kennzeichens im Aufruf an **MAPILogonEx**festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="a179d-123">Individual messaging sessions are private connections between your client and the MAPI subsystem and can be established by setting the MAPI_NEW_SESSION flag in the call to **MAPILogonEx**.</span></span>
  
<span data-ttu-id="a179d-124">FreigeGebene Messagingsitzungen sind Verbindungen, die von mehreren Messagingclients verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="a179d-124">Shared messaging sessions are connections that multiple messaging clients can use.</span></span> <span data-ttu-id="a179d-125">FreigeGebene Sitzungen werden in der Regel für Clients eingerichtet, die das gleiche Profil verwenden.</span><span class="sxs-lookup"><span data-stu-id="a179d-125">Shared sessions are typically established for clients use the same profile.</span></span> <span data-ttu-id="a179d-126">Legen Sie das MAPI_ALLOW_OTHERS-Flag fest, um eine neue Sitzung als freigegebene Sitzung einzurichten.</span><span class="sxs-lookup"><span data-stu-id="a179d-126">To establish a new session as a shared session, set the MAPI_ALLOW_OTHERS flag.</span></span> 
  
## <a name="use-an-existing-shared-session"></a><span data-ttu-id="a179d-127">Verwenden einer vorhandenen freigegebenen Sitzung</span><span class="sxs-lookup"><span data-stu-id="a179d-127">Use an existing shared session</span></span>
  
- <span data-ttu-id="a179d-128">Legen Sie das MAPI_NEW_SESSION-Flag nicht fest.</span><span class="sxs-lookup"><span data-stu-id="a179d-128">Do not set the MAPI_NEW_SESSION flag.</span></span>
    
- <span data-ttu-id="a179d-129">Legen Sie das MAPI_ALLOW_OTHERS-Flag nicht fest.</span><span class="sxs-lookup"><span data-stu-id="a179d-129">Do not set the MAPI_ALLOW_OTHERS flag.</span></span>
    
- <span data-ttu-id="a179d-130">Übergeben Sie NULL für den _lpszProfileName_ -Parameter.</span><span class="sxs-lookup"><span data-stu-id="a179d-130">Pass NULL for the  _lpszProfileName_ parameter.</span></span> 
    
- <span data-ttu-id="a179d-131">Übergeben Sie NULL für den _lpszPassword_ -Parameter.</span><span class="sxs-lookup"><span data-stu-id="a179d-131">Pass NULL for the  _lpszPassword_ parameter.</span></span> 
    
<span data-ttu-id="a179d-132">Nonmessaging-Sitzungen ermöglichen Clients den Zugriff auf das MAPI-Subsystem, lassen jedoch keine Nachrichten senden oder empfangen.</span><span class="sxs-lookup"><span data-stu-id="a179d-132">Nonmessaging sessions allow clients to access the MAPI subsystem, but do not allow messages to be sent or received.</span></span> <span data-ttu-id="a179d-133">Konfigurations-oder Verwaltungsanwendungen sind Beispiele für Clients, die möglicherweise nonmessaging-Sitzungen erstellen müssen.</span><span class="sxs-lookup"><span data-stu-id="a179d-133">Configuration or administration applications are examples of clients that might need to establish nonmessaging sessions.</span></span> <span data-ttu-id="a179d-134">Legen Sie das MAPI_NO_MAIL-Flag fest, um eine nonmessaging-Sitzung anzufordern.</span><span class="sxs-lookup"><span data-stu-id="a179d-134">To request a nonmessaging session, set the MAPI_NO_MAIL flag.</span></span> <span data-ttu-id="a179d-135">Durch Festlegen dieses Kennzeichens wird der Client protokolliert, ohne dass der MAPI-Spooler informiert wird.</span><span class="sxs-lookup"><span data-stu-id="a179d-135">Setting this flag logs your client on without informing the MAPI spooler.</span></span> <span data-ttu-id="a179d-136">Clients, die sich mit diesem Flag bei MAPI anmelden, können nicht erwarten, dass Sie jemals Lesestatus Berichte erhalten.</span><span class="sxs-lookup"><span data-stu-id="a179d-136">Clients that log on to MAPI with this flag cannot expect to ever receive read status reports.</span></span>
  
<span data-ttu-id="a179d-137">Das MAPI_NO_MAIL-Flag sollte nur festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="a179d-137">The MAPI_NO_MAIL flag should only be set:</span></span>
  
- <span data-ttu-id="a179d-138">Wenn Ihr Client während der Sitzung keine Nachrichten senden oder empfangen wird.</span><span class="sxs-lookup"><span data-stu-id="a179d-138">If your client will not send or receive messages during the session.</span></span>
    
- <span data-ttu-id="a179d-139">Wenn Ihr Client die vollständige Kontrolle über die Inhalte des Profils hat und Nachrichten mit eng gekoppelten Nachrichtenspeicher-und Transportanbietern, beispielsweise den Microsoft Exchange-Anbietern, gesendet und empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="a179d-139">If your client has complete control over the contents of the profile and messages are sent and received using tightly coupled message store and transport providers, such as the Microsoft Exchange providers.</span></span>
    
<span data-ttu-id="a179d-140">Ein Messaging Client kann eine Sitzung mit einem nicht-Messaging-Client gemeinsam nutzen.</span><span class="sxs-lookup"><span data-stu-id="a179d-140">A messaging client can share a session with a nonmessaging client.</span></span> <span data-ttu-id="a179d-141">Die Merkmale eines Members einer freigegebenen Sitzung sind von den Merkmalen anderer Mitglieder nicht betroffen.</span><span class="sxs-lookup"><span data-stu-id="a179d-141">The characteristics of one member of a shared session are not affected by the characteristics of other members.</span></span> <span data-ttu-id="a179d-142">Wenn Sie sich also mit der MAPI_NO_MAIL-und der MAPI_ALLOW_OTHERS-Flags-Gruppe anmelden, hat ein Messaging-Client, der sich an ihrer Sitzung anmeldet, keine Auswirkung auf den Betrieb Ihres Clients und umgekehrt.</span><span class="sxs-lookup"><span data-stu-id="a179d-142">That is, if you log on with the MAPI_NO_MAIL and MAPI_ALLOW_OTHERS flags set, a messaging client logging on to your session has no affect on the operation of your client and vice versa.</span></span> <span data-ttu-id="a179d-143">Der Messaging Client ist weiterhin in der Lage, Nachrichten zu senden und zu empfangen, und der Client nicht.</span><span class="sxs-lookup"><span data-stu-id="a179d-143">The messaging client will still be able to send and receive messages and your client will not.</span></span>
  
<span data-ttu-id="a179d-144">**MAPILogonEx** definiert einige andere Flags, die Sie festlegen können:</span><span class="sxs-lookup"><span data-stu-id="a179d-144">**MAPILogonEx** defines a few other flags that you can set:</span></span> 
  
- <span data-ttu-id="a179d-145">MAPI_FORCE_DOWNLOAD gibt an, dass eingehende Nachrichten heruntergeladen werden sollen, bevor **MAPILogonEx** zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="a179d-145">MAPI_FORCE_DOWNLOAD indicates that incoming messages should be downloaded before **MAPILogonEx** returns.</span></span> <span data-ttu-id="a179d-146">Wenn Sie dieses Flag nicht festlegen, werden Nachrichten zu einem späteren Zeitpunkt im Hintergrund heruntergeladen.</span><span class="sxs-lookup"><span data-stu-id="a179d-146">Not setting this flag causes messages to be downloaded in the background at a later time.</span></span> 
    
- <span data-ttu-id="a179d-147">MAPI_SERVICE_UI_ALWAYS fordert, dass jeder Nachrichtendienst im Profil ein Konfigurationsdialogfeld anzeigt.</span><span class="sxs-lookup"><span data-stu-id="a179d-147">MAPI_SERVICE_UI_ALWAYS requests that every message service in the profile display a configuration dialog box.</span></span>
    
- <span data-ttu-id="a179d-148">MAPI_NT_SERVICE gibt an, dass Ihr Client als Windows-Dienst implementiert ist.</span><span class="sxs-lookup"><span data-stu-id="a179d-148">MAPI_NT_SERVICE indicates that your client is implemented as a Windows service.</span></span> <span data-ttu-id="a179d-149">Dieses Flag muss festgelegt werden, wenn Ihr Client ein Dienst ist.</span><span class="sxs-lookup"><span data-stu-id="a179d-149">This flag must be set if your client is a service.</span></span>
    
<span data-ttu-id="a179d-150">Bei jeder erfolgreichen Anmeldung gibt **MAPILogonEx** einen Zeiger auf eine MAPI-Sitzung zurück.</span><span class="sxs-lookup"><span data-stu-id="a179d-150">With every successful logon, **MAPILogonEx** returns a pointer to a MAPI session.</span></span> <span data-ttu-id="a179d-151">Sie können diesen Zeiger verwenden, um die Methoden der **IMAPISession** -Schnittstelle aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="a179d-151">You can use this pointer to call the methods of the **IMAPISession** interface.</span></span> <span data-ttu-id="a179d-152">Weitere Informationen finden Sie unter [IMAPISession: IUnknown](imapisessioniunknown.md).</span><span class="sxs-lookup"><span data-stu-id="a179d-152">For more information, see [IMAPISession : IUnknown](imapisessioniunknown.md).</span></span> <span data-ttu-id="a179d-153">Sitzungs Zeiger, unabhängig vom Sitzungstyp, sind für die Clients eindeutig, die Sie empfangen und für alle Aufgaben nicht gültig sind.</span><span class="sxs-lookup"><span data-stu-id="a179d-153">Session pointers, regardless of the type of session, are unique to the clients that receive them and are not valid across tasks.</span></span>
  

