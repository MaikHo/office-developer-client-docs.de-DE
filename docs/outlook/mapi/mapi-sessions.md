---
title: MAPI-Sitzungen
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c5a7c137-393e-40ff-a2b9-afe02da2435a
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 3dd55d8ee3cb2751fb27184f0069ae831e2164ee
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32319583"
---
# <a name="mapi-sessions"></a><span data-ttu-id="83945-103">MAPI-Sitzungen</span><span class="sxs-lookup"><span data-stu-id="83945-103">MAPI sessions</span></span>

<span data-ttu-id="83945-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="83945-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="83945-105">Bevor der Clientanwendung aus eine zugrunde liegenden messaging-System aufrufen kann, m�ssen sie eine Sitzung oder bei einer Verbindung mit der MAPI-Subsystems einrichten.</span><span class="sxs-lookup"><span data-stu-id="83945-105">Before the client application can call an underlying messaging system, it must establish a session, or connection, with the MAPI subsystem.</span></span>
  
<span data-ttu-id="83945-p101">Sessions are initiated when a user logs on, a process that accesses a valid profile and validates the messaging system and the message service credentials. Then, the process ensures that all of the profile's message services are correctly configured. The client interface you use determines the logon call. MAPI clients call the [MAPILogonEx](mapilogonex.md) function.</span><span class="sxs-lookup"><span data-stu-id="83945-p101">Sessions are initiated when a user logs on, a process that accesses a valid profile and validates the messaging system and the message service credentials. Then, the process ensures that all of the profile's message services are correctly configured. The client interface you use determines the logon call. MAPI clients call the [MAPILogonEx](mapilogonex.md) function.</span></span> 
  
<span data-ttu-id="83945-110">Die Nachrichtendienst Konfiguration ist einer der wichtigsten Teile des Anmeldevorgangs.</span><span class="sxs-lookup"><span data-stu-id="83945-110">Message service configuration is one of the most important parts of the logon process.</span></span> <span data-ttu-id="83945-111">Das Profil ist die erste Quelle für Konfigurationsinformationen.</span><span class="sxs-lookup"><span data-stu-id="83945-111">The profile is the initial source for configuration information.</span></span> <span data-ttu-id="83945-112">Wenn Informationen für einen bestimmten Nachrichtendienst fehlen, versucht der Anmeldeprozess, den Benutzer aufzufordern, ihn bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="83945-112">If information for a particular message service is missing, the logon process tries to prompt the user to supply it.</span></span> <span data-ttu-id="83945-113">Dies ist aus zwei Gründen nicht immer erfolgreich: Erstens erfordert die Bestätigung des Benutzers, dass ein Dialogfeld angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="83945-113">This is not always successful for two reasons: First, prompting the user requires the display of a dialog box.</span></span> <span data-ttu-id="83945-114">Clients können die Anzeige einer Benutzeroberfläche nicht zulassen, indem Sie eine Kennzeichnung an den Anmelde Anruf übergeben.</span><span class="sxs-lookup"><span data-stu-id="83945-114">It is possible for clients to disallow the display of a user interface by passing a flag into the logon call.</span></span> <span data-ttu-id="83945-115">Zweitens könnte der Benutzer das Dialogfeld abbrechen, bevor die benötigten Informationen hinzugefügt werden können.</span><span class="sxs-lookup"><span data-stu-id="83945-115">Second, the user could cancel the dialog box before the needed information can be added.</span></span>
  
<span data-ttu-id="83945-116">Wenn ein Anmeldevorgang einmal fehlschlägt, wird der Benutzer über den Fehler informiert und hat die Möglichkeit, den Fehler zu wiederholen oder zu korrigieren.</span><span class="sxs-lookup"><span data-stu-id="83945-116">When a logon process fails one time, the user is informed of the failure and given the chance to retry or correct the error condition.</span></span> <span data-ttu-id="83945-117">Erneut wird eine Benutzeroberfläche angezeigt, wenn der Client dies zulässt, und der Benutzer wird aufgefordert, alle fehlenden Daten einzugeben.</span><span class="sxs-lookup"><span data-stu-id="83945-117">Once again, a user interface will be displayed, if the client allows it, and the user will be prompted to enter whatever data is missing.</span></span> <span data-ttu-id="83945-118">Wenn dieser zweite Versuch nicht erfolgreich ist, deaktiviert MAPI alle Dienstanbieter im Nachrichtendienst für die Dauer der Sitzung.</span><span class="sxs-lookup"><span data-stu-id="83945-118">If this second try is unsuccessful, MAPI disables all service providers in the message service for the duration of the session.</span></span> <span data-ttu-id="83945-119">Der gesamte Nachrichtendienst ist tatsächlich deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="83945-119">In effect, the whole message service is disabled.</span></span> <span data-ttu-id="83945-120">Dies führt dazu, dass keiner der Dienstanbieter im Nachrichtendienst funktionieren kann.</span><span class="sxs-lookup"><span data-stu-id="83945-120">This means that none of the service providers in the message service can work.</span></span> <span data-ttu-id="83945-121">Der Grund dafür ist, dass bei einem Ausfall eines Anbieters bei der Anmeldung die anderen Anbieter in der Regel auch fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="83945-121">This is done because if one provider fails logon, the other providers usually also fail.</span></span> <span data-ttu-id="83945-122">Der Anmeldeprozess kann aufgrund eines ungültigen Pfads für eine erforderliche Ressource, einer inkompatiblen MAPI-Version, eines nicht verfügbaren Messaging Servers oder einer Datenbeschädigung fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="83945-122">The logon process can fail due to an invalid path for a necessary resource, an incompatible version of MAPI, an unavailable messaging server, or data corruption.</span></span> 
  
<span data-ttu-id="83945-123">Clients können einen von zwei Sitzungstypen angeben, die im Anmelde Anruf festgelegt werden sollen: eine einzelne Sitzung oder eine freigegebene Sitzung.</span><span class="sxs-lookup"><span data-stu-id="83945-123">Clients can specify one of two types of sessions to be established in the logon call: an individual session or a shared session.</span></span> <span data-ttu-id="83945-124">Einzelne Sitzungen sind private Verbindungen; zwischen einer Clientanwendung und der verwendeten Sitzung besteht eine 1:1-Beziehung.</span><span class="sxs-lookup"><span data-stu-id="83945-124">Individual sessions are private connections; there is a one-to-one relationship between a client application and the session it is using.</span></span> <span data-ttu-id="83945-125">Clientanwendungen, die eine Sitzung gemeinsam nutzen, können daher auch ein Profil verwenden.</span><span class="sxs-lookup"><span data-stu-id="83945-125">As a consequence, client applications that share a session also share a profile.</span></span> <span data-ttu-id="83945-126">FreigeGebene Sitzungen werden einmalig eingerichtet, können jedoch von anderen Clientanwendungen verwendet werden, die Sie verwenden müssen.</span><span class="sxs-lookup"><span data-stu-id="83945-126">Shared sessions are established once but can be used by other client applications that need to use them.</span></span> <span data-ttu-id="83945-127">Das Profil und die Anmeldeinformationen werden nur bei der erstmaligen Anmeldung angegeben.</span><span class="sxs-lookup"><span data-stu-id="83945-127">The profile and credentials are specified only with the initial logon.</span></span> 
  
<span data-ttu-id="83945-128">Clients können sich mehrmals als derselbe Benutzer oder mehrere Benutzer anmelden.</span><span class="sxs-lookup"><span data-stu-id="83945-128">Clients can log on multiple times as the same user or as multiple users.</span></span> <span data-ttu-id="83945-129">Dies wird durch MAPI nicht verhindert.</span><span class="sxs-lookup"><span data-stu-id="83945-129">MAPI does not prevent this.</span></span> <span data-ttu-id="83945-130">Einige Dienstanbieter sind jedoch möglicherweise nicht so flexibel, und der Fehlerwert MAPI_E_SESSION_LIMIT wird bei nachfolgenden Anmeldeversuchen zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="83945-130">Some service providers, however, might not be as flexible, returning the error value MAPI_E_SESSION_LIMIT on subsequent logon attempts.</span></span> <span data-ttu-id="83945-131">Dienstanbieter mit zugrunde liegenden Hardwareeinschränkungen können zum Erzwingen eines Sitzungslimits erforderlich sein.</span><span class="sxs-lookup"><span data-stu-id="83945-131">Service providers with underlying hardware limitations can be required to enforce a session limit.</span></span>
  
<span data-ttu-id="83945-132">Die Funktionsaufrufe zum Einrichten einer Sitzung haben eine Auflistung von Flags und Parametern, die Steuern, wie die Sitzung erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="83945-132">The function calls for establishing a session have a collection of flags and parameters that control how the session is created.</span></span> <span data-ttu-id="83945-133">Der Client gibt einen optionalen Profilnamen und ein Fensterhandle an, das als übergeordnetes Fenster für alle angezeigten Dialogfelder fungiert.</span><span class="sxs-lookup"><span data-stu-id="83945-133">The client specifies an optional profile name and a window handle that acts as the parent window for any dialog boxes that are displayed.</span></span> <span data-ttu-id="83945-134">Zu den Flags gehört MAPI_NEW_SESSION, das eine neue, einzelne Sitzung (anstelle einer freigegebenen Sitzung) und das MAPI_LOGON_UI-Benutzeroberflächen Kennzeichen anfordert.</span><span class="sxs-lookup"><span data-stu-id="83945-134">The flags include MAPI_NEW_SESSION, which requests that a new, individual session (rather than a shared session) be established, and the MAPI_LOGON_UI user interface flag.</span></span> <span data-ttu-id="83945-135">Das Benutzeroberflächen Kennzeichen ist so festgelegt, dass ein Anmeldedialogfeld angefordert wird.</span><span class="sxs-lookup"><span data-stu-id="83945-135">The user interface flag is set to request a logon dialog box.</span></span>
  
<span data-ttu-id="83945-136">In der folgenden Abbildung wird gezeigt, wie diese verschiedenen Parameter und Flags eine MAPI-Sitzung herstellen.</span><span class="sxs-lookup"><span data-stu-id="83945-136">The following illustration shows how these various parameters and flags establish a MAPI session.</span></span>
  
<span data-ttu-id="83945-137">**Flussdiagramm für MAPI-Sitzung**</span><span class="sxs-lookup"><span data-stu-id="83945-137">**MAPI session flowchart**</span></span>
  
<span data-ttu-id="83945-138">![MAPI-Sitzungs Flussdiagramm] (media/amapi_47.gif "MAPI-Sitzungs Flussdiagramm")</span><span class="sxs-lookup"><span data-stu-id="83945-138">![MAPI session flowchart](media/amapi_47.gif "MAPI session flowchart")</span></span>
  
<span data-ttu-id="83945-139">Informationen zur Behandlung von Sitzungen innerhalb einer Clientanwendung finden Sie unter [MAPI-Sitzungs Verarbeitung](mapi-session-handling.md)</span><span class="sxs-lookup"><span data-stu-id="83945-139">For information about handling sessions from within a client application, see [MAPI Session Handling](mapi-session-handling.md)</span></span>
  
## <a name="see-also"></a><span data-ttu-id="83945-140">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="83945-140">See also</span></span>

- [<span data-ttu-id="83945-141">MAPILogonEx</span><span class="sxs-lookup"><span data-stu-id="83945-141">MAPILogonEx</span></span>](mapilogonex.md)  
- [<span data-ttu-id="83945-142">IMAPISession : IUnknown</span><span class="sxs-lookup"><span data-stu-id="83945-142">IMAPISession : IUnknown</span></span>](imapisessioniunknown.md)
- [<span data-ttu-id="83945-143">MAPI-Sitzungs Verarbeitung</span><span class="sxs-lookup"><span data-stu-id="83945-143">MAPI Session Handling</span></span>](mapi-session-handling.md)  
- [<span data-ttu-id="83945-144">�bersicht �ber die MAPI-Programmierung</span><span class="sxs-lookup"><span data-stu-id="83945-144">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

