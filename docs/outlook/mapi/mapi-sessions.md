---
title: MAPI-Sitzungen
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c5a7c137-393e-40ff-a2b9-afe02da2435a
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 45dc993c337249ed7d4dffbd5324267de82981d0
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19793082"
---
# <a name="mapi-sessions"></a><span data-ttu-id="1f531-103">MAPI-Sitzungen</span><span class="sxs-lookup"><span data-stu-id="1f531-103">MAPI sessions</span></span>

<span data-ttu-id="1f531-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="1f531-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="1f531-105">Bevor der Clientanwendung aus eine zugrunde liegenden messaging-System aufrufen kann, m�ssen sie eine Sitzung oder bei einer Verbindung mit der MAPI-Subsystems einrichten.</span><span class="sxs-lookup"><span data-stu-id="1f531-105">Before the client application can call an underlying messaging system, it must establish a session, or connection, with the MAPI subsystem.</span></span>
  
<span data-ttu-id="1f531-p101">Sessions are initiated when a user logs on, a process that accesses a valid profile and validates the messaging system and the message service credentials. Then, the process ensures that all of the profile's message services are correctly configured. The client interface you use determines the logon call. MAPI clients call the [MAPILogonEx](mapilogonex.md) function.</span><span class="sxs-lookup"><span data-stu-id="1f531-p101">Sessions are initiated when a user logs on, a process that accesses a valid profile and validates the messaging system and the message service credentials. Then, the process ensures that all of the profile's message services are correctly configured. The client interface you use determines the logon call. MAPI clients call the [MAPILogonEx](mapilogonex.md) function.</span></span> 
  
<span data-ttu-id="1f531-p102">Dienstkonfiguration Nachricht ist eine der interessantesten Teile des Anmeldevorgangs. Das Profil ist die urspr�ngliche Quelle f�r Konfigurationsinformationen. Wenn f�r eine bestimmte Nachrichtendienst nicht vorhanden ist, versucht der Anmeldevorgang den Benutzer auffordern, die sie bereitstellen. Dies ist nicht immer erfolgreich aus zwei Gr�nden: zuerst, den Benutzer aufzufordern, erfordert die Anzeige eines Dialogfelds. Es ist m�glich f�r Clients, um die Anzeige einer Benutzeroberfl�che deaktivieren, indem Sie ein Flag in den Anruf Anmeldung �bergeben. Zweitens kann der Benutzer das Dialogfeld abbrechen, bevor die ben�tigte Informationen hinzugef�gt werden kann.</span><span class="sxs-lookup"><span data-stu-id="1f531-p102">Message service configuration is one of the most important parts of the logon process. The profile is the initial source for configuration information. If information for a particular message service is missing, the logon process tries to prompt the user to supply it. This is not always successful for two reasons: First, prompting the user requires the display of a dialog box. It is possible for clients to disallow the display of a user interface by passing a flag into the logon call. Second, the user could cancel the dialog box before the needed information can be added.</span></span>
  
<span data-ttu-id="1f531-p103">Bei ein Anmeldevorgang einmal fehlschl�gt, wird der Benutzer des Fehlers dar�ber informiert und erhalten die M�glichkeit zum Wiederholen oder Fehlerbedingung zu korrigieren. Auch hier wird eine Benutzeroberfl�che angezeigt, wenn der Client dies zul�sst und der Benutzer aufgefordert wird, geben die Daten nicht vorhanden ist. Wenn diese zweite Versuch nicht erfolgreich ist, wird die MAPI alle-Dienstanbieter in der Nachricht Service f�r die Dauer der Sitzung deaktiviert. Im Grunde ist der gesamte Nachricht-Dienst deaktiviert. Dies bedeutet, dass keines der Dienstanbieter in der Nachrichtendienst arbeiten k�nnen. Dies erfolgt, da, wenn ein Anbieter Fehler bei der Anmeldung, die anderen Anbieter in der Regel auch fehl. Des Anmeldevorgangs kann aufgrund einer ung�ltigen Pfad f�r eine erforderliche Ressource eine inkompatible Version der MAPI, messaging-Server nicht verf�gbar oder besch�digte Daten fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="1f531-p103">When a logon process fails one time, the user is informed of the failure and given the chance to retry or correct the error condition. Once again, a user interface will be displayed, if the client allows it, and the user will be prompted to enter whatever data is missing. If this second try is unsuccessful, MAPI disables all service providers in the message service for the duration of the session. In effect, the whole message service is disabled. This means that none of the service providers in the message service can work. This is done because if one provider fails logon, the other providers usually also fail. The logon process can fail due to an invalid path for a necessary resource, an incompatible version of MAPI, an unavailable messaging server, or data corruption.</span></span> 
  
<span data-ttu-id="1f531-p104">Clients k�nnen einen von zwei Typen der Sitzungen in den Anruf Anmeldung eingerichtet werden angeben: eine einzelne Sitzung oder einer Freigabesitzung. Einzelne Sitzungen sind VPN-Verbindungen. Es ist eine 1: 1-Beziehung zwischen einer Clientanwendung und die Sitzungen, in denen, die es verwendet wird. Folglich freigeben Clientanwendungen, die eine Sitzung teilen auch ein Profil. Freigabesitzungen einmal hergestellt werden, aber Sie k�nnen von anderen Clientanwendungen, die sie verwenden m�ssen verwendet werden. Das Profil und die Anmeldeinformationen werden nur bei der ersten Anmeldung angegeben.</span><span class="sxs-lookup"><span data-stu-id="1f531-p104">Clients can specify one of two types of sessions to be established in the logon call: an individual session or a shared session. Individual sessions are private connections; there is a one-to-one relationship between a client application and the session it is using. As a consequence, client applications that share a session also share a profile. Shared sessions are established once but can be used by other client applications that need to use them. The profile and credentials are specified only with the initial logon.</span></span> 
  
<span data-ttu-id="1f531-p105">Clients k�nnen mehrere Male als derselbe Benutzer oder mehrere Benutzer anmelden. MAPI wird dies nicht verhindert. Einige Dienstanbieter, jedoch nicht so flexibel m�glicherweise den Fehlerwert MAPI_E_SESSION_LIMIT f�r nachfolgende Anmeldeversuche zur�ck. -Dienstanbietern mit zugrunde liegenden Hardwareeinschr�nkungen k�nnen es erforderlich sein, einen Grenzwert f�r Videositzung zu erzwingen.</span><span class="sxs-lookup"><span data-stu-id="1f531-p105">Clients can log on multiple times as the same user or as multiple users. MAPI does not prevent this. Some service providers, however, might not be as flexible, returning the error value MAPI_E_SESSION_LIMIT on subsequent logon attempts. Service providers with underlying hardware limitations can be required to enforce a session limit.</span></span>
  
<span data-ttu-id="1f531-p106">Aufrufe der Funktionen zum Einrichten einer Sitzung verf�gen �ber eine Auflistung von Flags und Parameter das Steuerelement, wie die Sitzung erstellt wird. Der Client gibt eine optionale Profilname und ein Fensterhandle, das als �bergeordnetes Fenster f�r alle Dialogfelder fungiert, die angezeigt werden. Die Kennzeichen z�hlen MAPI_NEW_SESSION, mit dem angefordert wird, dass eine neue, einzelne Sitzung (anstelle einer Freigabesitzung) hergestellt werden, und die MAPI_LOGON_UI Benutzer Schnittstelle-Flag. Die Benutzer-Flag-Schnittstelle wird festgelegt, so fordern Sie ein Anmeldedialogfeld an.</span><span class="sxs-lookup"><span data-stu-id="1f531-p106">The function calls for establishing a session have a collection of flags and parameters that control how the session is created. The client specifies an optional profile name and a window handle that acts as the parent window for any dialog boxes that are displayed. The flags include MAPI_NEW_SESSION, which requests that a new, individual session (rather than a shared session) be established, and the MAPI_LOGON_UI user interface flag. The user interface flag is set to request a logon dialog box.</span></span>
  
<span data-ttu-id="1f531-136">Die folgende Abbildung zeigt, wie diese verschiedenen Parameter und Flags eine MAPI-Sitzung herzustellen.</span><span class="sxs-lookup"><span data-stu-id="1f531-136">The following illustration shows how these various parameters and flags establish a MAPI session.</span></span>
  
<span data-ttu-id="1f531-137">**Flussdiagramm f�r MAPI-Sitzung**</span><span class="sxs-lookup"><span data-stu-id="1f531-137">**MAPI session flowchart**</span></span>
  
<span data-ttu-id="1f531-138">![Flussdiagramm für MAPI-Sitzung] (media/amapi_47.gif "Flussdiagramm für MAPI-Sitzung")</span><span class="sxs-lookup"><span data-stu-id="1f531-138">![MAPI session flowchart](media/amapi_47.gif "MAPI session flowchart")</span></span>
  
<span data-ttu-id="1f531-139">For information about handling sessions from within a client application, see [MAPI-Sitzung-Verarbeitung](mapi-session-handling.md)</span><span class="sxs-lookup"><span data-stu-id="1f531-139">For information about handling sessions from within a client application, see [MAPI Session Handling](mapi-session-handling.md)</span></span>
  
## <a name="see-also"></a><span data-ttu-id="1f531-140">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="1f531-140">See also</span></span>

- [<span data-ttu-id="1f531-141">MAPILogonEx</span><span class="sxs-lookup"><span data-stu-id="1f531-141">MAPILogonEx</span></span>](mapilogonex.md)  
- [<span data-ttu-id="1f531-142">IMAPISession: IUnknown</span><span class="sxs-lookup"><span data-stu-id="1f531-142">IMAPISession : IUnknown</span></span>](imapisessioniunknown.md)
- [<span data-ttu-id="1f531-143">MAPI-Sitzung-Verarbeitung</span><span class="sxs-lookup"><span data-stu-id="1f531-143">MAPI Session Handling</span></span>](mapi-session-handling.md)  
- [<span data-ttu-id="1f531-144">�bersicht �ber die MAPI-Programmierung</span><span class="sxs-lookup"><span data-stu-id="1f531-144">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

