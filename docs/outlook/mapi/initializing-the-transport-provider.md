---
title: Initialisieren des Transport Anbieters
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 474a8085ca8b82d11efd68c9fd4d8719fe239207
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416601"
---
# <a name="initializing-the-transport-provider"></a><span data-ttu-id="33e91-103">Initialisieren des Transport Anbieters</span><span class="sxs-lookup"><span data-stu-id="33e91-103">Initializing the Transport Provider</span></span>

  
  
<span data-ttu-id="33e91-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="33e91-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="33e91-105">Die Transport-Spooler-Schnittstelle definiert Aufrufe, die der MAPI-Spooler an einen Transportanbieter stellt.</span><span class="sxs-lookup"><span data-stu-id="33e91-105">The transport-spooler interface defines calls the MAPI spooler makes to a transport provider.</span></span> <span data-ttu-id="33e91-106">Transport Anbieter implementieren diese Routinen in einer Dynamic Link Library (DLL).</span><span class="sxs-lookup"><span data-stu-id="33e91-106">Transport providers implement these routines in a dynamic-link library (DLL).</span></span> <span data-ttu-id="33e91-107">Der erste direkte Einstiegspunkt in die DLL, der vom MAPI-Spooler verwendet wird, muss die Initialisierungsfunktion des Transportanbieters [XPProviderInit](xpproviderinit.md)sein.</span><span class="sxs-lookup"><span data-stu-id="33e91-107">The first direct entry point into the DLL used by the MAPI spooler must be the transport provider initialization function [XPProviderInit](xpproviderinit.md).</span></span>
  
<span data-ttu-id="33e91-108">MAPI verwendet die Routine- **GetProcAddress** , um die Adresse der Initialisierungsroutine des Dienstanbieters abzurufen und diese Routine aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="33e91-108">MAPI uses the routine **GetProcAddress** to get the address of the service provider's initialization routine and then calls that routine.</span></span> <span data-ttu-id="33e91-109">Der Name der Initialisierungsroutine ist **XPProviderInit** für Transportanbieter.</span><span class="sxs-lookup"><span data-stu-id="33e91-109">The name of the initialization routine is **XPProviderInit** for transport providers.</span></span> <span data-ttu-id="33e91-110">Es unterscheidet sich für andere Arten von MAPI-Dienstanbietern, sodass eine DLL eine beliebige Kombination von Dienstanbieter Typen enthalten kann, aber nur ein Dienstanbieter eines bestimmten Typs.</span><span class="sxs-lookup"><span data-stu-id="33e91-110">It is different for other types of MAPI service providers so that one DLL can contain any combination of service provider types, but only one service provider of a particular type.</span></span> <span data-ttu-id="33e91-111">Ein Dienstanbieter eines bestimmten Typs kann jedoch mehrere Dienste seines Typs implementieren.</span><span class="sxs-lookup"><span data-stu-id="33e91-111">However, one service provider of a given type can implement multiple services of its type.</span></span> <span data-ttu-id="33e91-112">Ein Transportanbieter kann beispielsweise Nachrichtentransport Funktionen in mehrere Nachrichtendienste implementieren.</span><span class="sxs-lookup"><span data-stu-id="33e91-112">For example, one transport provider can implement message transport functionality to multiple message services.</span></span> 
  
<span data-ttu-id="33e91-113">Die Headerdatei mapispi. h enthält eine Typdefinition für den Funktionsprototyp der Initialisierungsfunktion des Transportanbieters und einen vordefinierten Prozedurnamen dafür.</span><span class="sxs-lookup"><span data-stu-id="33e91-113">The mapispi.h header file has a type definition for the function prototype of the transport provider initialization function, and a predefined procedure name for it.</span></span> <span data-ttu-id="33e91-114">Durch Benennen der Initialisierungsroutinen in Ihren C-und C++-Dateien mit den gleichen Namen, die von **GetProcAddress** verwendet werden, und mithilfe einer einfachen Export Deklaration in der dll. DEF-Datei, erhalten Sie automatisch eine Typüberprüfung der Parameter in der Initialisierungsroutine.</span><span class="sxs-lookup"><span data-stu-id="33e91-114">By naming the initialization routines in your C and C++ files with the same names used by **GetProcAddress** and by using a straightforward export declaration in your DLL.DEF file, you automatically get type checking of the parameters on your initialization routine.</span></span> <span data-ttu-id="33e91-115">Beispiele finden Sie im Beispiel zum Transportanbieter-Quellcode.</span><span class="sxs-lookup"><span data-stu-id="33e91-115">See the sample transport provider source code for examples.</span></span> <span data-ttu-id="33e91-116">Weitere Informationen finden Sie unter [Transport Provider Sample](transport-provider-sample.md).</span><span class="sxs-lookup"><span data-stu-id="33e91-116">For more information, see [Transport Provider Sample](transport-provider-sample.md).</span></span>
  
<span data-ttu-id="33e91-117">Wenn der Initialisierungsaufruf eines Dienstanbieters erfolgreich ist, aber die Versionsnummer einer Dienstanbieter-Schnittstelle zurückgibt, die für MAPI zu klein ist, ruft MAPI sofort die **Release** -Methode des dienstanbieterobjekts auf und fährt fort, als ob der Initialisierungsaufruf fehlgeschlagen mit MAPI_E_VERSION.</span><span class="sxs-lookup"><span data-stu-id="33e91-117">If a service provider's initialization call succeeds but returns a service provider interface version number too small for MAPI to handle, MAPI immediately calls the **Release** method of the service provider object and proceeds as if the initialization call had failed with MAPI_E_VERSION.</span></span> <span data-ttu-id="33e91-118">Auf diese Weise definieren MAPI und der Dienstanbieter gemeinsam den Umfang der Versionsnummern der Dienstanbieter-Schnittstelle, die Sie verarbeiten können, und wenn nichts übereinstimmt, schlägt der Dienstanbieter Ladevorgang mit einem MAPI_E_VERSION-Rückgabewert fehl.</span><span class="sxs-lookup"><span data-stu-id="33e91-118">This way MAPI and the service provider jointly define the range of service provider interface version numbers they can handle, and if nothing matches then service provider loading fails with a MAPI_E_VERSION return value.</span></span> 
  
<span data-ttu-id="33e91-119">Der letzte Schritt für den MAPI-Spooler beim Zugriff auf Dienstanbieter Ressourcen besteht darin, sich beim Transportanbieter anzumelden.</span><span class="sxs-lookup"><span data-stu-id="33e91-119">The last step for the MAPI spooler in getting access to service provider resources is to log on to the transport provider.</span></span> <span data-ttu-id="33e91-120">Der MAPI-Spooler Ruft die [IXPProvider:: TransportLogon](ixpprovider-transportlogon.md) -Methode des [IXPProvider: IUnknown](ixpprovideriunknown.md) -Objekts auf, das von **XPProviderInit**zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="33e91-120">The MAPI spooler calls the [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) method of the [IXPProvider : IUnknown](ixpprovideriunknown.md) object returned from **XPProviderInit**.</span></span> <span data-ttu-id="33e91-121">Dies ist der Anruf, bei dem die Anmeldeinformationen, falls verwendet, aktiviert sind und Dialogfelder zugelassen werden können.</span><span class="sxs-lookup"><span data-stu-id="33e91-121">This is the call where credentials, if used, are checked and dialog boxes can be allowed.</span></span>
  
<span data-ttu-id="33e91-122">Wenn ein Prozess eine zweite Transportsitzung für denselben Transportanbieter und dieselbe MAPI-Sitzung öffnet, sollte die Transportanbieter-DLL kein zweites Anbieterobjekt erstellen.</span><span class="sxs-lookup"><span data-stu-id="33e91-122">If a process opens a second transport session on the same transport provider and MAPI session, the transport provider DLL should not create a second provider object.</span></span> <span data-ttu-id="33e91-123">Das erste Anbieterobjekt sollte für die Anmeldung bei der zweiten Transportsitzung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="33e91-123">The first provider object should be used to log on to the second transport session.</span></span> <span data-ttu-id="33e91-124">Ein Transportanbieter sollte so programmiert werden, dass er mehrere Transportsitzungen in einem einzelnen Anbieterobjekt unterstützt.</span><span class="sxs-lookup"><span data-stu-id="33e91-124">A transport provider should be programmed to support multiple transport sessions in a single provider object.</span></span> <span data-ttu-id="33e91-125">Ein zweites Provider-Objekt sollte nur erstellt werden, wenn im gleichen Prozess unterschiedliche MAPI-Sitzungen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="33e91-125">A second provider object should only be created if different MAPI sessions are used in the same process.</span></span>
  

