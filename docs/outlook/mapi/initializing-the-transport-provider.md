---
title: Initialisieren des Transportanbieters
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 423b03d674028a2f81b4c042d6e65e9acfb57274
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19792698"
---
# <a name="initializing-the-transport-provider"></a><span data-ttu-id="2874d-103">Initialisieren des Transportanbieters</span><span class="sxs-lookup"><span data-stu-id="2874d-103">Initializing the Transport Provider</span></span>

  
  
<span data-ttu-id="2874d-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="2874d-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="2874d-105">Die Transport-Warteschlange-Schnittstelle definiert aufgerufen, der die MAPI-Warteschlange eines Transportdienstes gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="2874d-105">The transport-spooler interface defines calls the MAPI spooler makes to a transport provider.</span></span> <span data-ttu-id="2874d-106">Transportanbieter implementieren diese Routinen in einer Dynamic-Link Library (DLL).</span><span class="sxs-lookup"><span data-stu-id="2874d-106">Transport providers implement these routines in a dynamic-link library (DLL).</span></span> <span data-ttu-id="2874d-107">Der erste direkte Einstiegspunkt in der DLL, die durch die MAPI-Warteschlange verwendet muss die Transport Anbieter Initialisierungsfunktion [XPProviderInit](xpproviderinit.md).</span><span class="sxs-lookup"><span data-stu-id="2874d-107">The first direct entry point into the DLL used by the MAPI spooler must be the transport provider initialization function [XPProviderInit](xpproviderinit.md).</span></span>
  
<span data-ttu-id="2874d-108">MAPI wird die Routine **GetProcAddress** verwendet, um die Adresse des Initialisierungsroutine des Dienstanbieters abzurufen und Sie erhalten diese Routine.</span><span class="sxs-lookup"><span data-stu-id="2874d-108">MAPI uses the routine **GetProcAddress** to get the address of the service provider's initialization routine and then calls that routine.</span></span> <span data-ttu-id="2874d-109">Der Name des die Initialisierungsroutine ist **XPProviderInit** für Transportanbieter.</span><span class="sxs-lookup"><span data-stu-id="2874d-109">The name of the initialization routine is **XPProviderInit** for transport providers.</span></span> <span data-ttu-id="2874d-110">Es ist für andere Typen von MAPI-Dienstanbieter, sodass eine DLL-Datei eine beliebige Kombination von Anbieter Diensttypen, jedoch nur ein Dienstanbieter eines bestimmten Typs enthalten kann.</span><span class="sxs-lookup"><span data-stu-id="2874d-110">It is different for other types of MAPI service providers so that one DLL can contain any combination of service provider types, but only one service provider of a particular type.</span></span> <span data-ttu-id="2874d-111">Einen Dienstanbieter eines bestimmten Typs kann jedoch mehrere Dienste dieses Typs implementieren.</span><span class="sxs-lookup"><span data-stu-id="2874d-111">However, one service provider of a given type can implement multiple services of its type.</span></span> <span data-ttu-id="2874d-112">Beispielsweise kann eine Adressbuchhierarchie Nachricht Transport Funktionalität für mehrere Nachrichtendienste für die implementieren.</span><span class="sxs-lookup"><span data-stu-id="2874d-112">For example, one transport provider can implement message transport functionality to multiple message services.</span></span> 
  
<span data-ttu-id="2874d-113">Die Headerdatei mapispi.h verfügt über eine Typdefinition für die Funktionsprototyp der Initialisierungsfunktion Transport Anbieter und eine vordefinierte Prozedurname dafür.</span><span class="sxs-lookup"><span data-stu-id="2874d-113">The mapispi.h header file has a type definition for the function prototype of the transport provider initialization function, and a predefined procedure name for it.</span></span> <span data-ttu-id="2874d-114">Durch die Initialisierung benennen Routinen in Ihrer C und C++-Dateien mit den gleichen Namen von **GetProcAddress** verwendet und mithilfe von ein einfaches exportieren Deklaration in der DLL. DEF-Datei, erhalten Sie automatisch der Parameter auf Ihre Initialisierungsroutine Überprüfung.</span><span class="sxs-lookup"><span data-stu-id="2874d-114">By naming the initialization routines in your C and C++ files with the same names used by **GetProcAddress** and by using a straightforward export declaration in your DLL.DEF file, you automatically get type checking of the parameters on your initialization routine.</span></span> <span data-ttu-id="2874d-115">Finden Sie unter dem Transport Anbieter Beispielquellcode für Beispiele.</span><span class="sxs-lookup"><span data-stu-id="2874d-115">See the sample transport provider source code for examples.</span></span> <span data-ttu-id="2874d-116">Weitere Informationen finden Sie unter [Transport Provider Sample](transport-provider-sample.md).</span><span class="sxs-lookup"><span data-stu-id="2874d-116">For more information, see [Transport Provider Sample](transport-provider-sample.md).</span></span>
  
<span data-ttu-id="2874d-117">Wenn einem Dienstanbieter Initialisierungsaufruf erfolgreich ist, jedoch gibt einem Dienstanbieter Versionsnummer der Benutzeroberfläche für die Behandlung von MAPI zu klein, MAPI sofort die **Release** -Methode des Service Provider-Objekts aufgerufen und wird fortgesetzt, als ob die Initialisierung aufrufen Installationsfehler mit MAPI_E_VERSION.</span><span class="sxs-lookup"><span data-stu-id="2874d-117">If a service provider's initialization call succeeds but returns a service provider interface version number too small for MAPI to handle, MAPI immediately calls the **Release** method of the service provider object and proceeds as if the initialization call had failed with MAPI_E_VERSION.</span></span> <span data-ttu-id="2874d-118">Auf diese Weise MAPI und dem Dienstanbieter gemeinsam definieren den Bereich von Service Provider-Schnittstelle Versionsnummern, die sie bearbeiten können, und wenn nichts entspricht-Dienstanbieter laden funktioniert nicht mit einem MAPI_E_VERSION-Wert zurück.</span><span class="sxs-lookup"><span data-stu-id="2874d-118">This way MAPI and the service provider jointly define the range of service provider interface version numbers they can handle, and if nothing matches then service provider loading fails with a MAPI_E_VERSION return value.</span></span> 
  
<span data-ttu-id="2874d-119">Der letzte Schritt für die MAPI-Warteschlange in die erste Zugriff auf Service Provider Ressourcen ist zur Anmeldung bei der Adressbuchhierarchie.</span><span class="sxs-lookup"><span data-stu-id="2874d-119">The last step for the MAPI spooler in getting access to service provider resources is to log on to the transport provider.</span></span> <span data-ttu-id="2874d-120">Die MAPI-Warteschlange Ruft die [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) -Methode von der [IXPProvider: IUnknown](ixpprovideriunknown.md) Objekt aus der **XPProviderInit**zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="2874d-120">The MAPI spooler calls the [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) method of the [IXPProvider : IUnknown](ixpprovideriunknown.md) object returned from **XPProviderInit**.</span></span> <span data-ttu-id="2874d-121">Dies ist der Anruf, in denen Sie Anmeldeinformationen verwendet, werden geprüft und Dialogfelder zugelassen werden können.</span><span class="sxs-lookup"><span data-stu-id="2874d-121">This is the call where credentials, if used, are checked and dialog boxes can be allowed.</span></span>
  
<span data-ttu-id="2874d-122">Wenn ein Vorgang eine zweite Transport-Sitzung auf der gleichen Adressbuchhierarchie und MAPI-Sitzung geöffnet wird, sollte der Adressbuchhierarchie DLL kein zweites Anbieterobjekt erstellen.</span><span class="sxs-lookup"><span data-stu-id="2874d-122">If a process opens a second transport session on the same transport provider and MAPI session, the transport provider DLL should not create a second provider object.</span></span> <span data-ttu-id="2874d-123">Das erste Anbieterobjekt sollte verwendet werden, an die zweite Transport-Sitzung anmelden.</span><span class="sxs-lookup"><span data-stu-id="2874d-123">The first provider object should be used to log on to the second transport session.</span></span> <span data-ttu-id="2874d-124">Ein Transportdienstes sollte so programmiert werden zur Unterstützung mehrerer Transport Sitzungen in einem einzigen Anbieter-Objekt.</span><span class="sxs-lookup"><span data-stu-id="2874d-124">A transport provider should be programmed to support multiple transport sessions in a single provider object.</span></span> <span data-ttu-id="2874d-125">Ein zweites Anbieterobjekt sollte nur erstellt werden, wenn andere MAPI-Sitzungen in demselben Prozess verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="2874d-125">A second provider object should only be created if different MAPI sessions are used in the same process.</span></span>
  

