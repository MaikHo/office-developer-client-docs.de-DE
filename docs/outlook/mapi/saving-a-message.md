---
title: Speichern einer Nachricht
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 97bff16b-dc7c-4eed-8834-d0c076d83ca3
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: d5ceeb46bded101700aec696a17d690bde80ce6d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33420931"
---
# <a name="saving-a-message"></a><span data-ttu-id="64301-103">Speichern einer Nachricht</span><span class="sxs-lookup"><span data-stu-id="64301-103">Saving a Message</span></span>

  
  
<span data-ttu-id="64301-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="64301-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="64301-105">Bevor eine Nachricht gespeichert wird, rufen Clients in der Regel die [IMAPIProp::](imapiprop-setprops.md) SetProps-Methode der Nachricht auf, um zusätzlich zu den Nachrichtentext Eigenschaften, Anlageneigenschaften, **PR_Subject** ([PidTagSubject](pidtagsubject-canonical-property.md)) und Eigenschaften eine Reihe von Eigenschaften festzulegen. der Empfängerliste zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="64301-105">Before a message is saved, clients typically call the message's [IMAPIProp::SetProps](imapiprop-setprops.md) method to set a few properties in addition to the message text properties, attachment properties, **PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md)), and properties associated with the recipient list.</span></span>
  
<span data-ttu-id="64301-106">Legen Sie die **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md))-Eigenschaft auf eine Zeichenfolge wie IPM. Beachten Sie, dass die Klasse der ausgehenden Nachricht beschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="64301-106">Set the **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)) property to a character string such as IPM.Note that describes the class of the outgoing message.</span></span> <span data-ttu-id="64301-107">Obwohl Clients **PR_MESSAGE_CLASS** für alle ausgehenden Nachrichten festlegen sollen, wird vom Nachrichtenspeicher Anbieter ein Standardwert angegeben, wenn Sie ihn nicht festlegen.</span><span class="sxs-lookup"><span data-stu-id="64301-107">Although clients should set **PR_MESSAGE_CLASS** on all outgoing messages, a default value is supplied by the message store provider if you do not set it.</span></span> <span data-ttu-id="64301-108">Die Standardnachrichtenklasse für ausgehende Nachrichten ist IPM.</span><span class="sxs-lookup"><span data-stu-id="64301-108">The default message class for outgoing messages is IPM.</span></span> 
  
<span data-ttu-id="64301-109">Legen Sie das MSGFLAG_UNSENT-Flag in der **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md))-Eigenschaft fest.</span><span class="sxs-lookup"><span data-stu-id="64301-109">Set the MSGFLAG_UNSENT flag in the **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) property.</span></span> <span data-ttu-id="64301-110">Legen Sie, falls gewünscht, auch die MSGFLAG_READ-und MSGFLAG_UNMODIFIED-Flags fest.</span><span class="sxs-lookup"><span data-stu-id="64301-110">If desired, also set the MSGFLAG_READ and MSGFLAG_UNMODIFIED flags.</span></span> <span data-ttu-id="64301-111">Das Festlegen des MSGFLAG_UNMODIFIED ermöglicht es einer Nachricht Unterkomposition, eine zugestellte Nachricht zu simulieren.</span><span class="sxs-lookup"><span data-stu-id="64301-111">Setting the MSGFLAG_UNMODIFIED allows a message under composition to simulate a delivered message.</span></span> <span data-ttu-id="64301-112">MSGFLAG_UNMODIFIED kann nur von Clients festgelegt werden, bevor eine Nachricht zum ersten Mal gespeichert wurde.</span><span class="sxs-lookup"><span data-stu-id="64301-112">MSGFLAG_UNMODIFIED can only be set by clients before a message has been saved for the first time.</span></span> 
  
<span data-ttu-id="64301-113">Wenn Sie bereit sind, eine dauerhafte Kopie einer nicht gesendeten Nachricht zu erstellen, rufen Sie [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) für die Nachricht und alle zugehörigen Anlagen auf.</span><span class="sxs-lookup"><span data-stu-id="64301-113">When you are ready to make a permanent copy of an unsent message, call [IMAPIProp::SaveChanges](imapiprop-savechanges.md) on the message and all of its attachments.</span></span> <span data-ttu-id="64301-114">Wenn Sie die Nachricht sofort senden möchten, müssen Sie **SaveChanges**nicht aufrufen.</span><span class="sxs-lookup"><span data-stu-id="64301-114">If you intend to send the message right away, you do not need to call **SaveChanges**.</span></span> <span data-ttu-id="64301-115">Der Aufruf von **SubmitMessage** speichert die Nachricht intern als Teil ihrer Verarbeitung.</span><span class="sxs-lookup"><span data-stu-id="64301-115">The call to **SubmitMessage** internally saves the message as part of its processing.</span></span> 
  
<span data-ttu-id="64301-116">Beim Aufrufen \*\*\*\* von SaveChanges empfiehlt es sich, das KEEP_OPEN_READWRITE-Flag anzugeben, mit dem die Nachricht zu einem späteren Zeitpunkt geändert werden kann.</span><span class="sxs-lookup"><span data-stu-id="64301-116">When calling **SaveChanges**, it is a good idea to specify the KEEP_OPEN_READWRITE flag, which allows the message to be modified at a later time.</span></span> <span data-ttu-id="64301-117">Weitere Settable-Flags sind FORCE_SAVE, was darauf hinweist, dass die Nachricht oder Anlage nach dem Commit der Änderungen geschlossen werden soll, KEEP_OPEN_READONLY, was bedeutet, dass keine weiteren Änderungen vorgenommen werden, und die Kennzeichnung, die es dem Nachrichtenspeicher Anbieter ermöglichen soll, Batch Clientanforderungen, MAPI_DEFERRED_ERRORS.</span><span class="sxs-lookup"><span data-stu-id="64301-117">Other settable flags include FORCE_SAVE, which indicates that the message or attachment should be closed after changes are committed, KEEP_OPEN_READONLY, which indicates that no further changes will be made, and the flag to allow the message store provider to batch client requests, MAPI_DEFERRED_ERRORS.</span></span>
  
<span data-ttu-id="64301-118">Es ist wichtig, dass Sie **SaveChanges** für jede Anlage in der Nachricht aufrufen, bevor \*\*\*\* Sie SaveChanges für die Nachricht aufrufen.</span><span class="sxs-lookup"><span data-stu-id="64301-118">It is essential that you call **SaveChanges** for every attachment in the message before you call **SaveChanges** for the message.</span></span> <span data-ttu-id="64301-119">Wenn Sie eine Anlage nicht speichern, wird die Anlage nicht in die Nachricht aufgenommen, wenn Sie gesendet wird, und Sie wird nicht in der Anlagentabelle der Nachricht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="64301-119">If you fail to save an attachment, the attachment will not be included with the message when it is sent and it will not appear in the message's attachment table.</span></span> <span data-ttu-id="64301-120">Wenn Sie die Nachricht nach dem Speichern aller Anlagen nicht speichern, gehen sowohl die Nachricht als auch die Anlagen verloren.</span><span class="sxs-lookup"><span data-stu-id="64301-120">If you fail to save the message after saving all of the attachments, both the message and the attachments will be lost.</span></span> 
  
<span data-ttu-id="64301-121">Wenn **SaveChanges** aufgerufen wird, aktualisiert der Nachrichtenspeicher Anbieter die folgenden Eigenschaften:</span><span class="sxs-lookup"><span data-stu-id="64301-121">When **SaveChanges** is called, the message store provider updates the following properties:</span></span> 
  
- <span data-ttu-id="64301-122">**PR_DISPLAY_TO** ([PidTagDisplayTo](pidtagdisplayto-canonical-property.md)) Listet alle primären Empfänger auf.</span><span class="sxs-lookup"><span data-stu-id="64301-122">**PR_DISPLAY_TO** ([PidTagDisplayTo](pidtagdisplayto-canonical-property.md)) lists all primary recipients.</span></span>
    
- <span data-ttu-id="64301-123">**PR_DISPLAY_TO** listet alle Empfänger von Kohlenstoff Kopien auf.</span><span class="sxs-lookup"><span data-stu-id="64301-123">**PR_DISPLAY_TO** lists all carbon copy recipients.</span></span> 
    
- <span data-ttu-id="64301-124">**PR_DISPLAY_BCC** ([Pidtagdisplaybcc (](pidtagdisplaybcc-canonical-property.md)) Listet alle Blind Carbon Copy-Empfänger auf.</span><span class="sxs-lookup"><span data-stu-id="64301-124">**PR_DISPLAY_BCC** ([PidTagDisplayBcc](pidtagdisplaybcc-canonical-property.md)) lists all blind carbon copy recipients.</span></span>
    
- <span data-ttu-id="64301-125">**PR_LAST_MODIFICATION_TIME** ([PidTagLastModificationTime](pidtaglastmodificationtime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="64301-125">**PR_LAST_MODIFICATION_TIME** ([PidTagLastModificationTime](pidtaglastmodificationtime-canonical-property.md))</span></span>
    
- <span data-ttu-id="64301-126">**PR_MESSAGE_FLAGS** legt MSGFLAG_HASATTACH fest, wenn eine oder mehrere Anlagen gespeichert wurden, und löscht MSGFLAG_UNMODIFIED, um anzuzeigen, dass die Nachricht geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="64301-126">**PR_MESSAGE_FLAGS** sets MSGFLAG_HASATTACH if one or more attachments have been saved and clears MSGFLAG_UNMODIFIED to show the message has changed.</span></span> 
    
- <span data-ttu-id="64301-127">**PR_MESSAGE_SIZE** ([Pidtagmessagesize (](pidtagmessagesize-canonical-property.md)) enthält die aktuelle Größe der Nachricht.</span><span class="sxs-lookup"><span data-stu-id="64301-127">**PR_MESSAGE_SIZE** ([PidTagMessageSize](pidtagmessagesize-canonical-property.md)) contains the most current size of the message.</span></span>
    
- <span data-ttu-id="64301-128">**PR_MESSAGE_ATTACHMENTS** ([Pidtagmessageattachments (](pidtagmessageattachments-canonical-property.md)) ermöglicht den Zugriff auf die Attachment-Tabelle.</span><span class="sxs-lookup"><span data-stu-id="64301-128">**PR_MESSAGE_ATTACHMENTS** ([PidTagMessageAttachments](pidtagmessageattachments-canonical-property.md)) provides access to the attachment table.</span></span>
    
- <span data-ttu-id="64301-129">**PR_MESSAGE_RECIPIENTS** ([Pidtagmessagerecipients (](pidtagmessagerecipients-canonical-property.md)) ermöglicht den Zugriff auf die Empfängertabelle.</span><span class="sxs-lookup"><span data-stu-id="64301-129">**PR_MESSAGE_RECIPIENTS** ([PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)) provides access to the recipient table.</span></span>
    
<span data-ttu-id="64301-130">Einige Nachrichteneigenschaften werden in der Regel von Clients oder Dienstanbietern bereitgestellt, wenn eine Nachricht erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="64301-130">Some message properties are typically supplied by clients or service providers when a message is created.</span></span> <span data-ttu-id="64301-131">Wenn ein Client diese Einstellung vernachlässigt, muss der Nachrichtenspeicher Anbieter Sie zu dem Zeitpunkt aktualisieren, zu dem SaveChanges aufgerufen \*\*\*\* wird.</span><span class="sxs-lookup"><span data-stu-id="64301-131">If a client neglects to set them, it is up to the message store provider to update them at the time **SaveChanges** is called.</span></span> <span data-ttu-id="64301-132">Wenn beispielsweise die Eigenschaften **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) und **PR_RECORD_KEY** ([pidtagrecordkey (](pidtagrecordkey-canonical-property.md)) einer Nachricht beim Erstellen der Nachricht festgelegt wurden, müssen Sie nicht zu einem bestimmten Zeitpunkt geändert werden.</span><span class="sxs-lookup"><span data-stu-id="64301-132">For example, if a message's **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) and **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)) properties were set when the message was created, they need not be modified at save time.</span></span> <span data-ttu-id="64301-133">Nachrichtenspeicher Anbieter, die Sie bei der Nachrichtenerstellung nicht festlegen, müssen Sie jedoch beim ersten Aufruf von **SaveChanges** festlegen.</span><span class="sxs-lookup"><span data-stu-id="64301-133">However, message store providers that neglect to set them at message creation must set them the first time that **SaveChanges** is called.</span></span> 
  
<span data-ttu-id="64301-134">Wenn **SaveChanges** MAPI_E_CORRUPT_DATA zurückgibt, gehen Sie davon aus, dass die gespeicherten Daten jetzt verloren gehen.</span><span class="sxs-lookup"><span data-stu-id="64301-134">If **SaveChanges** returns MAPI_E_CORRUPT_DATA, assume that the data being saved is now lost.</span></span> <span data-ttu-id="64301-135">Nachrichtenspeicher Anbieter, die ein Client-Server-Modell für Ihre Implementierung verwenden, können diesen Wert zurückgeben, wenn eine Netzwerkverbindung verloren geht oder der Server nicht aktiv ist.</span><span class="sxs-lookup"><span data-stu-id="64301-135">Message store providers that use a client-server model for their implementation might return this value when a network connection is lost or the server is not running.</span></span> <span data-ttu-id="64301-136">Bevor Sie einen Fehler an den Benutzer zurückgeben, versuchen Sie, die Daten ein zweites Mal zu schreiben und zu speichern \*\*\*\* , indem Sie SetProps gefolgt von einem weiteren Aufruf von **SaveChanges**aufrufen.</span><span class="sxs-lookup"><span data-stu-id="64301-136">Before returning an error to the user, try to write and save the data a second time by making a call to **SetProps** followed by another call to **SaveChanges**.</span></span> <span data-ttu-id="64301-137">Wenn die Daten lokal zwischengespeichert werden, sollte dies kein Problem darstellen.</span><span class="sxs-lookup"><span data-stu-id="64301-137">If the data is cached locally, this should not be a problem.</span></span> <span data-ttu-id="64301-138">Wenn jedoch kein lokaler Cache vorhanden ist oder wenn der zweite **SaveChanges** -Aufruf fehlschlägt, wird ein Fehler angezeigt, um den Benutzer auf das Problem hinzuweisen.</span><span class="sxs-lookup"><span data-stu-id="64301-138">However, if there is no local cache or the second **SaveChanges** call fails, display an error to alert the user to the problem.</span></span> 
  

