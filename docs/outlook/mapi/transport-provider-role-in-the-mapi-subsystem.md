---
title: Transportanbieterrolle des MAPI-Subsystems
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 263370590a35f19482cc5ad7e56c65f6df0087fa
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/23/2018
ms.locfileid: "22581300"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a><span data-ttu-id="c65b3-103">Transportanbieterrolle des MAPI-Subsystems</span><span class="sxs-lookup"><span data-stu-id="c65b3-103">Transport provider role in the MAPI subsystem</span></span>
  
<span data-ttu-id="c65b3-104">**Betrifft**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c65b3-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c65b3-105">Transport-Anbieter Dynamic Link Libraries (DLLs) stellen die Schnittstelle zwischen der MAPI-Warteschlange und das Webpart von einem verantwortlich für die Nachricht senden und Empfangen von messaging-System.</span><span class="sxs-lookup"><span data-stu-id="c65b3-105">Transport provider dynamic-link libraries (DLLs) provide the interface between the MAPI spooler and the part of a messaging system responsible for message sending and receiving.</span></span> <span data-ttu-id="c65b3-106">Die MAPI-Warteschlange und der Adressbuchhierarchie arbeiten zusammen, um die Aufgaben der eine Nachricht senden oder Empfangen einer Nachricht zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="c65b3-106">The MAPI spooler and the transport provider work together to handle the responsibilities of sending a message or receiving a message.</span></span> <span data-ttu-id="c65b3-107">Die MAPI-Warteschlange wird der Adressbuchhierarchie DLL geladen, wenn es zuerst verwendet wird, und gibt es frei, wenn es nicht mehr benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="c65b3-107">The MAPI spooler loads the transport provider DLL when it is first used and releases it when it is no longer needed.</span></span> <span data-ttu-id="c65b3-108">Mehrere Transportanbieter auf dem gleichen System installiert werden können, aber MAPI bereitstellt, die eine Warteschlange erforderlich.</span><span class="sxs-lookup"><span data-stu-id="c65b3-108">Multiple transport providers can be installed on the same system, but MAPI supplies the one spooler required.</span></span>
  
<span data-ttu-id="c65b3-109">Clientanwendungen kommunizieren in der Regel nicht direkt mit der Adressbuchhierarchie.</span><span class="sxs-lookup"><span data-stu-id="c65b3-109">Client applications do not typically communicate directly with the transport provider.</span></span> <span data-ttu-id="c65b3-110">Vielmehr Clients Übermitteln von Nachrichten über einen Anbieter anmelden und die MAPI-Warteschlange ausgehende Nachrichten an den entsprechenden Transport gesendet und eingehende Nachrichten mit dem entsprechenden Nachrichtenspeicher übermittelt.</span><span class="sxs-lookup"><span data-stu-id="c65b3-110">Rather, clients submit messages through a store provider and the MAPI spooler sends outgoing messages to the appropriate transport provider and delivers incoming messages to the appropriate message store.</span></span> <span data-ttu-id="c65b3-111">Die MAPI-Warteschlange führt diese Aufgaben und seine Aufrufe der Anbieter Transport, wenn Vordergrund Applikationen im Leerlauf befinden.</span><span class="sxs-lookup"><span data-stu-id="c65b3-111">The MAPI spooler does its work and makes its calls to transport providers when foreground applications are idle.</span></span> <span data-ttu-id="c65b3-112">Nachdem optional Dialogfelder anzeigen, wenn der Adressbuchhierarchie zuerst angemeldet, Betrieb Transportanbieter im Hintergrund, wenn vom Client zu leeren senden und Empfangen von Warteschlangen aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="c65b3-112">After optionally displaying dialog boxes when the transport provider is first logged on, transport providers operate in the background unless called by the client to flush send and receive queues.</span></span> 
  
<span data-ttu-id="c65b3-113">Transportanbieter haben folgende Aufgaben in MAPI-messaging-System:</span><span class="sxs-lookup"><span data-stu-id="c65b3-113">Transport providers have the following responsibilities in a MAPI messaging system:</span></span>
  
- <span data-ttu-id="c65b3-114">Registrieren Sie die Adresstypen, den, die Sie annehmen können, die MAPI-Warteschlange, damit die MAPI-Warteschlange Nachrichten an die entsprechenden Adressbuchhierarchie je nach die Zieladresse der Nachrichten senden kann.</span><span class="sxs-lookup"><span data-stu-id="c65b3-114">Register the address types they can accept with the MAPI spooler so the MAPI spooler can submit messages to the appropriate transport provider depending on the destination address of the messages.</span></span> <span data-ttu-id="c65b3-115">Eine Adressbuchhierarchie kann mehrere Adresstyp registrieren.</span><span class="sxs-lookup"><span data-stu-id="c65b3-115">One transport provider can register more than one address type.</span></span> <span data-ttu-id="c65b3-116">Transportanbieter können auch bestimmte Empfänger-Adressen mit der MAPI-Warteschlange registrieren.</span><span class="sxs-lookup"><span data-stu-id="c65b3-116">Transport providers can also register specific recipients' addresses with the MAPI spooler.</span></span> <span data-ttu-id="c65b3-117">Nachrichten an eine dieser Adressen werden an der Adressbuchhierarchie gesendet werden, die die Adresse für die MAPI-Warteschlange registriert.</span><span class="sxs-lookup"><span data-stu-id="c65b3-117">Messages addressed to one of these addresses will be submitted to the transport provider that registered the address with the MAPI spooler.</span></span> <span data-ttu-id="c65b3-118">Weitere Informationen finden Sie unter [Adressbuchhierarchie und MAPI-Warteschlange betriebliche Modell](transport-provider-and-mapi-spooler-operational-model.md).</span><span class="sxs-lookup"><span data-stu-id="c65b3-118">For more information, see [Transport Provider and MAPI Spooler Operational Model](transport-provider-and-mapi-spooler-operational-model.md).</span></span>
    
- <span data-ttu-id="c65b3-119">Übermitteln Sie eingehende Nachrichten an die Warteschlange MAPI.</span><span class="sxs-lookup"><span data-stu-id="c65b3-119">Deliver incoming messages to the MAPI spooler.</span></span> <span data-ttu-id="c65b3-120">Abhängig von der Art der messaging-System kann ein Transportdienstes entweder direkt benachrichtigt werden, die MAPI-Warteschlange beim Eintreffen einer neuen Nachricht, oder es anfordern kann, dass die MAPI-Warteschlange der Adressbuchhierarchie in regelmäßigen Abständen zu prüfen, ob neue Nachrichten abzufragen.</span><span class="sxs-lookup"><span data-stu-id="c65b3-120">Depending on the nature of the messaging system, a transport provider can either directly notify the MAPI spooler when a new message arrives, or it can request that the MAPI spooler poll the transport provider periodically to check for new messages.</span></span>
    
- <span data-ttu-id="c65b3-121">Konvertieren von MAPI-Eigenschaften zu und von Nachrichteneigenschaften einheitlich in Messagingsystem bereit.</span><span class="sxs-lookup"><span data-stu-id="c65b3-121">Convert MAPI message properties to and from message properties native to the messaging system.</span></span> <span data-ttu-id="c65b3-122">Beispielsweise möglicherweise der Adressbuchhierarchie des Senders und des Empfängers Adressen in ausgehenden Nachrichten in ein Format konvertiert, die an die messaging-System akzeptabel ist.</span><span class="sxs-lookup"><span data-stu-id="c65b3-122">For example, the transport provider might have to convert the sender's and recipient's addresses in an outgoing message to a form that is acceptable to the messaging system.</span></span> <span data-ttu-id="c65b3-123">Einige Messagingsysteme unterstützen nicht alle Eigenschaften MAPI-Nachricht.</span><span class="sxs-lookup"><span data-stu-id="c65b3-123">Some messaging systems do not support all of the MAPI message properties.</span></span> <span data-ttu-id="c65b3-124">Weitere Informationen zum Beibehalten von MAPI-Nachrichteneigenschaften bei der Übermittlung von Nachrichten mit einem Messagingsystem finden Sie unter [Developing eines Transportdienstes TNEF-Enabled](developing-a-tnef-enabled-transport-provider.md).</span><span class="sxs-lookup"><span data-stu-id="c65b3-124">For more information about preserving MAPI message properties when delivering messages to a messaging system, see [Developing a TNEF-Enabled Transport Provider](developing-a-tnef-enabled-transport-provider.md).</span></span>
    
- <span data-ttu-id="c65b3-125">Registrieren Sie Nachrichten- und Empfänger Optionen speziell für den Transportdienst.</span><span class="sxs-lookup"><span data-stu-id="c65b3-125">Register message and recipient options specific to the transport provider.</span></span>
    
- <span data-ttu-id="c65b3-126">Führen Sie die Überprüfung von Anmeldeinformationen, die von der messaging-System erforderlich.</span><span class="sxs-lookup"><span data-stu-id="c65b3-126">Perform any verification of credentials required by the messaging system.</span></span>
    
- <span data-ttu-id="c65b3-127">Zugriff auf ausgehende Nachrichten mithilfe des Message-Objekts übergeben die MAPI-Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="c65b3-127">Access outbound messages using the message object passed to it by the MAPI spooler.</span></span>
    
- <span data-ttu-id="c65b3-128">Nachrichtenformat gemäß dem zugrunde liegenden messaging-System zu übersetzen.</span><span class="sxs-lookup"><span data-stu-id="c65b3-128">Translate message format as required by the underlying messaging system.</span></span>
    
- <span data-ttu-id="c65b3-129">Benachrichtigen Sie der MAPI-Warteschlange der Empfänger von ausgehenden Nachrichten der Adressbuchhierarchie Verantwortung für die Behandlung durch Festlegen der **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md))-Eigenschaft für diese Empfänger angenommen hat.</span><span class="sxs-lookup"><span data-stu-id="c65b3-129">Notify the MAPI spooler which recipients of an outgoing message the transport provider has accepted responsibility for handling by setting the **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property for those recipients.</span></span>
    
- <span data-ttu-id="c65b3-130">Informieren Sie die MAPI-Warteschlange, wenn eine eingehende Nachricht behandelt werden muss.</span><span class="sxs-lookup"><span data-stu-id="c65b3-130">Inform the MAPI spooler when an incoming message needs to be handled.</span></span>
    
- <span data-ttu-id="c65b3-131">Übergeben Sie Daten der eingehenden Nachricht an die MAPI-Warteschlange mithilfe von Message-Objekten.</span><span class="sxs-lookup"><span data-stu-id="c65b3-131">Pass incoming message data to the MAPI spooler by using message objects.</span></span>
    
- <span data-ttu-id="c65b3-132">Alle erforderlichen MAPI Nachrichteneigenschaften für eingehende Nachrichten Werte zuweisen.</span><span class="sxs-lookup"><span data-stu-id="c65b3-132">Assign values to all required MAPI message properties on incoming messages.</span></span>
    
- <span data-ttu-id="c65b3-133">Löschen der Nachricht aus dem zugrunde liegenden messaging-System nach der Übermittlung, falls erforderlich.</span><span class="sxs-lookup"><span data-stu-id="c65b3-133">Delete the message from the underlying messaging system after delivery, if necessary.</span></span>
    
- <span data-ttu-id="c65b3-134">Bereitzustellen Sie Statusinformationen für den MAPI-Warteschlange und Clientanwendungen.</span><span class="sxs-lookup"><span data-stu-id="c65b3-134">Provide status information for the MAPI spooler and client applications.</span></span>
    
<span data-ttu-id="c65b3-135">Die folgende Abbildung zeigt eine Adressbuchhierarchie Rolle in Bezug auf die anderen Komponenten der MAPI-Architektur.</span><span class="sxs-lookup"><span data-stu-id="c65b3-135">The following illustration shows a transport provider's role with respect to the other components of the MAPI architecture.</span></span>
  
<span data-ttu-id="c65b3-136">**Transportanbieterrolle in einem Messaging-System**</span><span class="sxs-lookup"><span data-stu-id="c65b3-136">**Transport provider role in a messaging system**</span></span>
  
<span data-ttu-id="c65b3-137">![Transport-Anbieter-Rolle in einem messaging-system] (media/xp01.gif "Transport-Anbieter-Rolle in einem messaging-system")</span><span class="sxs-lookup"><span data-stu-id="c65b3-137">![Transport provider role in a messaging system](media/xp01.gif "Transport provider role in a messaging system")</span></span>
  

