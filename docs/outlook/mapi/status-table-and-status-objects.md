---
title: Statustabelle und Statusobjekte
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 203765c1-4b08-4032-a5bf-18f3e752a899
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 3eb190069b43ea1960c3b6edf30a9e0b782d2c41
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425176"
---
# <a name="status-table-and-status-objects"></a><span data-ttu-id="564c7-103">Statustabelle und Statusobjekte</span><span class="sxs-lookup"><span data-stu-id="564c7-103">Status Table and Status Objects</span></span>

  
  
<span data-ttu-id="564c7-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="564c7-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="564c7-105">MAPI stellt eine Tabelle mit Informationen zum Status des MAPI-Subsystems, des MAPI-Spoolers, des Adressbuchs oder eines bestimmten Dienstanbieters bereit.</span><span class="sxs-lookup"><span data-stu-id="564c7-105">MAPI provides a table with information about the status of the MAPI subsystem, MAPI spooler, address book, or a particular service provider.</span></span> <span data-ttu-id="564c7-106">Sie können auf diese Tabelle zugreifen, indem Sie [IMAPISession::](imapisession-getstatustable.md)getstatusable aufrufen.</span><span class="sxs-lookup"><span data-stu-id="564c7-106">You can access this table by calling [IMAPISession::GetStatusTable](imapisession-getstatustable.md).</span></span>
  
<span data-ttu-id="564c7-107">Jede Zeile in der Statustabelle stellt ein Statusobjekt dar, das von MAPI oder einem Dienstanbieter implementiert wurde.</span><span class="sxs-lookup"><span data-stu-id="564c7-107">Each row in the status table represents a status object implemented by MAPI or a service provider.</span></span> <span data-ttu-id="564c7-108">Sie können ein Status-Objekt verwenden, um das Konfigurationseigenschaften Fenster eines Anbieters anzuzeigen, ein Anbieter Kennwort zu ändern, Nachrichten hochzuladen oder herunterzuladen und mit einem bestimmten Transportanbieter zu kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="564c7-108">You can use a status object to display a provider's configuration property sheet, to change a provider password, to upload or download messages, and to communicate with a particular transport provider.</span></span> 
  
<span data-ttu-id="564c7-109">Es gibt zwei Möglichkeiten, auf ein Status-Objekt zuzugreifen:</span><span class="sxs-lookup"><span data-stu-id="564c7-109">There are two ways to access a status object:</span></span>
  
- <span data-ttu-id="564c7-110">Über die Statustabelle</span><span class="sxs-lookup"><span data-stu-id="564c7-110">Through the status table</span></span>
    
- <span data-ttu-id="564c7-111">Über die **OpenStatusEntry** -Methode eines LOGON-Objekts</span><span class="sxs-lookup"><span data-stu-id="564c7-111">Through a logon object's **OpenStatusEntry** method</span></span> 
    
<span data-ttu-id="564c7-112">Da Anmeldeobjekte für Clients nicht verfügbar sind, müssen Sie die Status-Tabelle verwenden, um auf Statusobjekte zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="564c7-112">Because logon objects are unavailable to clients, you must use the status table to access status objects.</span></span> <span data-ttu-id="564c7-113">Der Statustabellen Ansatz ist indirekt, erfordert ein paar Aufrufe, bevor das Status-Objekt geöffnet wird und ein Zeiger auf die **IMAPIStatus** -Implementierung zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="564c7-113">The status table approach is indirect, requiring a few calls before the status object is opened and a pointer to its **IMAPIStatus** implementation returned.</span></span> 
  
 <span data-ttu-id="564c7-114">**So öffnen Sie ein Statusobjekt mithilfe der Status-Tabelle**</span><span class="sxs-lookup"><span data-stu-id="564c7-114">**To use the status table to open a status object**</span></span>
  
1. <span data-ttu-id="564c7-115">Rufen Sie **IMAPIStatus::** getstatusable auf, um einen [IMAPITable](imapitableiunknown.md) -Zeiger abzurufen.</span><span class="sxs-lookup"><span data-stu-id="564c7-115">Call **IMAPIStatus::GetStatusTable** to retrieve an [IMAPITable](imapitableiunknown.md) pointer.</span></span> 
    
2. <span data-ttu-id="564c7-116">Rufen Sie die [IMAPITable::](imapitable-setcolumns.md) SetColumns-Methode der Statustabelle auf, um den Spaltensatz auf **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)), **PR_RESOURCE_TYPE** ([pidtagresourcetype (](pidtagresourcetype-canonical-property.md)) und **PR_DISPLAY_NAME** ([ PidTagDisplayName](pidtagdisplayname-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="564c7-116">Call the status table's [IMAPITable::SetColumns](imapitable-setcolumns.md) method to limit the column set to **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)), **PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)), and **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)).</span></span>
    
3. <span data-ttu-id="564c7-117">Schränkt die Tabellenansicht auf ein bestimmtes Statusobjekt ein.</span><span class="sxs-lookup"><span data-stu-id="564c7-117">Limit the table view to a particular status object.</span></span> <span data-ttu-id="564c7-118">Bei MAPI-Implementierungen kann ein Client mithilfe von **PR_RESOURCE_TYPE**eine Eigenschaftseinschränkung definieren.</span><span class="sxs-lookup"><span data-stu-id="564c7-118">For MAPI implementations, a client can define a property restriction using **PR_RESOURCE_TYPE**.</span></span> <span data-ttu-id="564c7-119">Bei Implementierungen von Dienstanbietern kann ein Client die **PR_PROVIDER_DISPLAY** ([pidtagproviderdisplay (](pidtagproviderdisplay-canonical-property.md)), den Namen des Anbieters oder **PR_PROVIDER_DLL_NAME** ([pidtagproviderdllname (](pidtagproviderdllname-canonical-property.md)), den Namen der Anbieter-DLL einschränken. Datei.</span><span class="sxs-lookup"><span data-stu-id="564c7-119">For service provider implementations, a client can restrict on **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)), the name of the provider, or on **PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md)), the name of the provider DLL file.</span></span>
    
4. <span data-ttu-id="564c7-120">Rufen Sie [IMAPITable:: Restrict](imapitable-restrict.md) auf, um die Einschränkung festzulegen.</span><span class="sxs-lookup"><span data-stu-id="564c7-120">Call [IMAPITable::Restrict](imapitable-restrict.md) to set the restriction.</span></span> 
    
5. <span data-ttu-id="564c7-121">Rufen Sie [HrQueryAllRows](hrqueryallrows.md)auf, und übergeben Sie die [SPropertyRestriction](spropertyrestriction.md) -Struktur, um die Zeile abzurufen, die den Status des Anbieters darstellt.</span><span class="sxs-lookup"><span data-stu-id="564c7-121">Call [HrQueryAllRows](hrqueryallrows.md), passing in the [SPropertyRestriction](spropertyrestriction.md) structure, to retrieve the row that represents the status of the provider.</span></span> 
    
6. <span data-ttu-id="564c7-122">Rufen Sie [IMAPISession:: OpenEntry](imapisession-openentry.md)auf, indem Sie die Eintrags-ID aus der Zeile der Statustabelle angeben, um das Status-Objekt zu öffnen und einen **IMAPIStatus** -Zeiger abzurufen.</span><span class="sxs-lookup"><span data-stu-id="564c7-122">Call [IMAPISession::OpenEntry](imapisession-openentry.md), specifying the entry identifier from the status table row, to open the status object and retrieve an **IMAPIStatus** pointer.</span></span> 
    
<span data-ttu-id="564c7-123">Zum Anzeigen eines Eigenschaftenblatts rufen Sie die [IMAPIStatus:: Settingsdialog](imapistatus-settingsdialog.md) -Methode des Status-Objekts für den Zielanbieter auf.</span><span class="sxs-lookup"><span data-stu-id="564c7-123">To display a property sheet, call the status object's [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) method for the target provider.</span></span> <span data-ttu-id="564c7-124">**Settingsdialog** zeigt ein Eigenschaftenfenster zum Anzeigen und in einigen Fällen die Konfigurationseigenschaften eines Anbieters an.</span><span class="sxs-lookup"><span data-stu-id="564c7-124">**SettingsDialog** displays a property sheet for viewing and in some cases, changing the configuration properties of a provider.</span></span> 
  
<span data-ttu-id="564c7-125">Wenn Sie mit einem Transportanbieter kommunizieren möchten, rufen Sie die [IMAPIStatus:: ValidateState](imapistatus-validatestate.md) -Methode des Status-Objekts auf.</span><span class="sxs-lookup"><span data-stu-id="564c7-125">To communicate with a transport provider, call its status object's [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method.</span></span> <span data-ttu-id="564c7-126">**ValidateState** kann einen Transportanbieter neu konfigurieren, den Anbieter daran hindern, eine Benutzeroberfläche anzuzeigen und eine Sitzung zu steuern, die das Herunterladen von Nachrichtenkopfzeilen von einem Remoteserver abhängig von den übertragenen Kennzeichen umfasst.</span><span class="sxs-lookup"><span data-stu-id="564c7-126">**ValidateState** can reconfigure a transport provider, prevent the provider from displaying a user interface, and control a session that involves downloading message headers from a remote server, depending on the flags that you pass in.</span></span> <span data-ttu-id="564c7-127">Wenn Sie beispielsweise das Herunterladen von Remoteheadern abbrechen möchten, müssen Sie das ABORT_XP_HEADER_OPERATION-Flag an **ValidateState**.</span><span class="sxs-lookup"><span data-stu-id="564c7-127">For example, to cancel the downloading of remote headers, pass the ABORT_XP_HEADER_OPERATION flag to **ValidateState**.</span></span> <span data-ttu-id="564c7-128">Zum Verbinden oder Trennen vom Remoteserver führen Sie FORCE_XP_CONNECT oder FORCE_XP_DISCONNECT.</span><span class="sxs-lookup"><span data-stu-id="564c7-128">To connect or disconnect from the remote server, pass FORCE_XP_CONNECT or FORCE_XP_DISCONNECT.</span></span> <span data-ttu-id="564c7-129">Um den Anbieter neu zu konfigurieren, führen Sie CONFIG_CHANGED.</span><span class="sxs-lookup"><span data-stu-id="564c7-129">To reconfigure the provider, pass CONFIG_CHANGED.</span></span> 
  
<span data-ttu-id="564c7-130">Clients, die das Senden oder empfangen von Nachrichten bei Bedarf implementieren, rufen entweder die [IMAPIStatus:: FlushQueues](imapistatus-flushqueues.md) -Methode eines Transportanbieters oder eines MAPI-Spoolers auf.</span><span class="sxs-lookup"><span data-stu-id="564c7-130">Clients that implement sending or receiving of messages on demand call either a transport provider's or the MAPI spooler's [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md) method.</span></span> <span data-ttu-id="564c7-131">Sie können drei Flags an die-Methode weiterleiten: FLUSH_UPLOAD, FLUSH_DOWNLOAD und FLUSH_FORCE.</span><span class="sxs-lookup"><span data-stu-id="564c7-131">You can pass three flags into the method: FLUSH_UPLOAD, FLUSH_DOWNLOAD, and FLUSH_FORCE.</span></span> <span data-ttu-id="564c7-132">FLUSH_UPLOAD weist den Anbieter oder die MAPI-Warteschlange an, alle Nachrichten zu senden, die in der Ausgabewarteschlange warten, während FLUSH_DOWNLOAD den Anbieter oder den MAPI-Spooler anweist, eingehende Nachrichten zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="564c7-132">FLUSH_UPLOAD instructs the provider or the MAPI spooler to send any messages waiting in the output queue while FLUSH_DOWNLOAD instructs the provider or the MAPI spooler to receive any incoming messages.</span></span> <span data-ttu-id="564c7-133">FLUSH_FORCE kann mit einem der anderen Flags festgelegt werden, damit das Status-Objekt den Flush unabhängig vom Timing ausführt.</span><span class="sxs-lookup"><span data-stu-id="564c7-133">FLUSH_FORCE can be set with either of the other flags to cause the status object to perform the flush regardless of the timing.</span></span> 
  
<span data-ttu-id="564c7-134">Erwarten Sie nicht, dass Sie **Settingsdialog** oder [CHANGEPASSWORD](imapistatus-changepassword.md) für ein MAPI-Subsystem, MAPI-Spooler oder Adressbuch Status-Objekte aufrufen können.</span><span class="sxs-lookup"><span data-stu-id="564c7-134">Do not expect to be able to call **SettingsDialog** or [ChangePassword](imapistatus-changepassword.md) on any of the MAPI subsystem, MAPI spooler, or address book status objects.</span></span> <span data-ttu-id="564c7-135">Sowohl das Subsystem als auch das Adressbuch-Statusobjekt unterstützen nur **ValidateState**; das MAPI-Spooler Status-Objekt unterstützt **FlushQueues** zusätzlich zu **ValidateState**.</span><span class="sxs-lookup"><span data-stu-id="564c7-135">Both the subsystem and address book status objects only support **ValidateState**; the MAPI spooler status object supports **FlushQueues** in addition to **ValidateState**.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="564c7-136">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="564c7-136">See also</span></span>



[<span data-ttu-id="564c7-137">Status Tabellen</span><span class="sxs-lookup"><span data-stu-id="564c7-137">Status Tables</span></span>](status-tables.md)
  
[<span data-ttu-id="564c7-138">MAPI-Status Objekte</span><span class="sxs-lookup"><span data-stu-id="564c7-138">MAPI Status Objects</span></span>](mapi-status-objects.md)

