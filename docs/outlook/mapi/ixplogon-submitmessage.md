---
title: IXPLogonSubmitMessage
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPLogon.SubmitMessage
api_type:
- COM
ms.assetid: a261ba0d-cb56-4935-b745-1d4bbd0b8b9d
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 28e7874d1e61c0a4fe0ad702f206ca03a9a1096a
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/23/2018
ms.locfileid: "22575875"
---
# <a name="ixplogonsubmitmessage"></a><span data-ttu-id="8c2c1-103">IXPLogon::SubmitMessage</span><span class="sxs-lookup"><span data-stu-id="8c2c1-103">IXPLogon::SubmitMessage</span></span>

  
  
<span data-ttu-id="8c2c1-104">**Betrifft**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8c2c1-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="8c2c1-105">Gibt an, dass die MAPI-Warteschlange eine Nachricht an der Adressbuchhierarchie übermittelt wurde.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-105">Indicates that the MAPI spooler has a message for the transport provider to deliver.</span></span>
  
```cpp
HRESULT SubmitMessage(
  ULONG ulFlags,
  LPMESSAGE lpMessage,
  ULONG FAR * lpulMsgRef,
  ULONG FAR * lpulReturnParm
);
```

## <a name="parameters"></a><span data-ttu-id="8c2c1-106">Parameter</span><span class="sxs-lookup"><span data-stu-id="8c2c1-106">Parameters</span></span>

 <span data-ttu-id="8c2c1-107">_ulFlags_</span><span class="sxs-lookup"><span data-stu-id="8c2c1-107">_ulFlags_</span></span>
  
> <span data-ttu-id="8c2c1-108">[in] Eine Bitmaske aus Flags, die steuert, wie die Nachricht gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-108">[in] A bitmask of flags that controls how the message is submitted.</span></span> <span data-ttu-id="8c2c1-109">Das folgende Flag kann festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="8c2c1-109">The following flag can be set:</span></span>
    
<span data-ttu-id="8c2c1-110">BEGIN_DEFERRED</span><span class="sxs-lookup"><span data-stu-id="8c2c1-110">BEGIN_DEFERRED</span></span> 
  
> <span data-ttu-id="8c2c1-111">Die MAPI-Warteschlange ist der Aufruf eines Transportdienstes mit einer Meldung, die zuvor zurückgestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-111">The MAPI spooler is calling a transport provider with a message that was previously deferred.</span></span> <span data-ttu-id="8c2c1-112">Die Eintrags-ID der Nachricht ist identisch, wenn sie verschoben wurde.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-112">The entry identifier of the message is the same as when it was deferred.</span></span> <span data-ttu-id="8c2c1-113">Die Nachricht wurde zurückgestellt, indem Sie die Eintrags-ID an die MAPI-Warteschlange mithilfe der [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) -Methode mit dem NOTIFY_SENTDEFERRED-Flag übergeben.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-113">The message was deferred by passing its entry identifier back to the MAPI spooler by using the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method with the NOTIFY_SENTDEFERRED flag.</span></span> 
    
 <span data-ttu-id="8c2c1-114">_lpMessage_</span><span class="sxs-lookup"><span data-stu-id="8c2c1-114">_lpMessage_</span></span>
  
> <span data-ttu-id="8c2c1-115">[in] Ein Zeiger auf ein Objekt "Message" (für die Nachricht übermitteln), der über Lese-/Schreibberechtigung, verfügt der Adressbuchhierarchie aufrufen und Bearbeiten dieser Nachricht verwendet.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-115">[in] A pointer to a message object (representing the message to deliver) that has read/write permission, which the transport provider uses to access and manipulate that message.</span></span> <span data-ttu-id="8c2c1-116">Dieses Objekt bleibt gültig bis, nachdem der Adressbuchhierarchie aus einer nachfolgenden Aufruf der [IXPLogon::EndMessage](ixplogon-endmessage.md) -Methode zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-116">This object remains valid until after the transport provider returns from a subsequent call to the [IXPLogon::EndMessage](ixplogon-endmessage.md) method.</span></span> 
    
 <span data-ttu-id="8c2c1-117">_lpulMsgRef_</span><span class="sxs-lookup"><span data-stu-id="8c2c1-117">_lpulMsgRef_</span></span>
  
> <span data-ttu-id="8c2c1-118">[out] Ein Zeiger auf eine Variable, die in der der Adressbuchhierarchie den Verweiswert zurückgibt, den sie diese Meldung zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-118">[out] A pointer to a variable in which the transport provider returns the reference value it assigned to this message.</span></span> <span data-ttu-id="8c2c1-119">Die MAPI-Warteschlange übergibt dieser Verweiswert nachfolgende Aufrufe für diese Nachricht.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-119">The MAPI spooler passes this reference value in subsequent calls for this message.</span></span> <span data-ttu-id="8c2c1-120">Die MAPI-Warteschlange initialisiert den Wert auf 0 vor der Rückgabe an den Transportanbieter.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-120">The MAPI spooler initializes the value to 0 before returning it to the transport provider.</span></span>
    
 <span data-ttu-id="8c2c1-121">_lpulReturnParm_</span><span class="sxs-lookup"><span data-stu-id="8c2c1-121">_lpulReturnParm_</span></span>
  
> <span data-ttu-id="8c2c1-122">[out] Ein Zeiger auf eine Variable, die den Fehlerwert MAPI_E_WAIT oder MAPI_E_NETWORK_ERROR **SubmitMessage**zurückgegebene entspricht.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-122">[out] A pointer to a variable that corresponds to the MAPI_E_WAIT or MAPI_E_NETWORK_ERROR error value returned by **SubmitMessage**.</span></span>
    
## <a name="return-value"></a><span data-ttu-id="8c2c1-123">R�ckgabewert</span><span class="sxs-lookup"><span data-stu-id="8c2c1-123">Return value</span></span>

<span data-ttu-id="8c2c1-124">S_OK</span><span class="sxs-lookup"><span data-stu-id="8c2c1-124">S_OK</span></span> 
  
> <span data-ttu-id="8c2c1-125">Der Aufruf erfolgreich ausgeführt und der erwartete Wert oder Werte zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-125">The call succeeded and returned the expected value or values.</span></span>
    
<span data-ttu-id="8c2c1-126">MAPI_E_BUSY</span><span class="sxs-lookup"><span data-stu-id="8c2c1-126">MAPI_E_BUSY</span></span> 
  
> <span data-ttu-id="8c2c1-127">Der Adressbuchhierarchie kann nicht die Meldung, zu behandeln, da es einen anderen Vorgang ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-127">The transport provider cannot handle the message, because it is performing another operation.</span></span> <span data-ttu-id="8c2c1-128">Ein Anbieter sollten dieser Rückgabewert verwenden, um anzugeben, dass keine Verarbeitung aufgetreten ist und dass die MAPI-Warteschlange **EndMessage**nicht aufrufen soll.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-128">A provider should use this return value to indicate that no processing occurred and that the MAPI spooler should not call **EndMessage**.</span></span> <span data-ttu-id="8c2c1-129">Die MAPI-Warteschlange wird den Anruf **SubmitMessage** einem späteren Zeitpunkt erneut versuchen.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-129">The MAPI spooler will try the **SubmitMessage** call again later.</span></span> 
    
<span data-ttu-id="8c2c1-130">MAPI_E_CANCEL</span><span class="sxs-lookup"><span data-stu-id="8c2c1-130">MAPI_E_CANCEL</span></span> 
  
> <span data-ttu-id="8c2c1-131">Obwohl der Adressbuchhierarchie angefordert, dass die MAPI-Warteschlange die Nachricht in einem vorherigen Aufruf der **SpoolerNotify** erneut übermitteln, Bedingungen haben inzwischen geändert, und die Nachricht nicht erneut gesendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-131">Although the transport provider requested that the MAPI spooler resubmit the message on a previous **SpoolerNotify** call, conditions have since changed, and the message should not be resent.</span></span> <span data-ttu-id="8c2c1-132">Die MAPI-Warteschlange wird wechseln Sie auf einen anderen Suchbegriff behandelt.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-132">The MAPI spooler will go on to handle something else.</span></span> 
    
<span data-ttu-id="8c2c1-133">MAPI_E_NETWORK_ERROR</span><span class="sxs-lookup"><span data-stu-id="8c2c1-133">MAPI_E_NETWORK_ERROR</span></span> 
  
> <span data-ttu-id="8c2c1-134">Ein Netzwerkfehler verhindert erfolgreichen Abschluss des Vorgangs.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-134">A network error prevented successful completion of the operation.</span></span> <span data-ttu-id="8c2c1-135">Der Parameter _LpulReturnParm_ sollte auf die Anzahl der Sekunden festgelegt werden, die verstreichen die MAPI-Warteschlange werden die Nachricht erneut übermittelt.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-135">The  _lpulReturnParm_ parameter should be set to the number of seconds that will elapse before the MAPI spooler resubmits the message.</span></span> 
    
<span data-ttu-id="8c2c1-136">MAPI_E_NOT_ME</span><span class="sxs-lookup"><span data-stu-id="8c2c1-136">MAPI_E_NOT_ME</span></span> 
  
> <span data-ttu-id="8c2c1-137">Diese Meldung kann nicht der Adressbuchhierarchie behandeln.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-137">The transport provider cannot handle this message.</span></span> <span data-ttu-id="8c2c1-138">Die MAPI-Warteschlange sollte versuchen, an einen anderen Transportanbieter zu finden.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-138">The MAPI spooler should try to find another transport provider for it.</span></span> <span data-ttu-id="8c2c1-139">Ein Anbieter sollten dieser Rückgabewert verwenden, um anzugeben, dass keine Verarbeitung aufgetreten ist und dass die MAPI-Warteschlange **EndMessage**nicht aufrufen soll.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-139">A provider should use this return value to indicate that no processing occurred and that the MAPI spooler should not call **EndMessage**.</span></span>
    
<span data-ttu-id="8c2c1-140">MAPI_E_WAIT</span><span class="sxs-lookup"><span data-stu-id="8c2c1-140">MAPI_E_WAIT</span></span> 
  
> <span data-ttu-id="8c2c1-141">Ein vorübergehendes Problem wird verhindert, dass der Adressbuchhierarchie Behandlung der Nachricht.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-141">A temporary problem prevents the transport provider from handling the message.</span></span> <span data-ttu-id="8c2c1-142">Der Parameter _LpulReturnParm_ sollte auf die Anzahl der Sekunden festgelegt werden, die verstreichen die MAPI-Warteschlange werden die Nachricht erneut übermittelt.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-142">The  _lpulReturnParm_ parameter should be set to the number of seconds that will elapse before the MAPI spooler resubmits the message.</span></span> 
    
## <a name="remarks"></a><span data-ttu-id="8c2c1-143">HinwBemerkungeneise</span><span class="sxs-lookup"><span data-stu-id="8c2c1-143">Remarks</span></span>

<span data-ttu-id="8c2c1-144">Die MAPI-Warteschlange Ruft die **IXPLogon::SubmitMessage** -Methode auf, wenn es sich um eine Nachricht an der Adressbuchhierarchie übermittelt hat.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-144">The MAPI spooler calls the **IXPLogon::SubmitMessage** method when it has a message for the transport provider to deliver.</span></span> <span data-ttu-id="8c2c1-145">Die Nachricht wird an der Adressbuchhierarchie übergeben, mit dem Parameter _LpMessage_ .</span><span class="sxs-lookup"><span data-stu-id="8c2c1-145">The message is passed to the transport provider by using the  _lpMessage_ parameter.</span></span> 
  
<span data-ttu-id="8c2c1-146">Wenn der Anbieter die Nachricht anzunehmen bereit ist, muss einen Verweiswert zurück, mit dem Parameter _LpulMsgRef_ , Prozess der übergebene Objekt und den entsprechenden Wert (normalerweise S_OK) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-146">If the provider is ready to accept the message, it should return a reference value by using the  _lpulMsgRef_ parameter, process the passed object, and return the appropriate value (usually S_OK).</span></span> <span data-ttu-id="8c2c1-147">Wenn der Anbieter nicht vorbereitete zum Verarbeiten der Weiterleitung ist, sollte es einen Fehlerwert zurückgegeben, und optional einen anderen MAPI-Wert zurück, in _LpulReturnParm_ , um anzugeben, wie lange die MAPI-Warteschlange warten soll, bevor die erneute Übermittlung der Nachricht.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-147">If the provider is not prepared to handle the transfer, it should return an error value and, optionally, another MAPI return value in  _lpulReturnParm_ to indicate how long the MAPI spooler should wait before resubmitting the message.</span></span> 
  
<span data-ttu-id="8c2c1-148">Eines Transportdienstes Implementierung dieser Methode kann die folgenden Aufgaben ausführen:</span><span class="sxs-lookup"><span data-stu-id="8c2c1-148">A transport provider's implementation of this method can do the following:</span></span>
  
- <span data-ttu-id="8c2c1-149">Stellen Sie die Nachricht in einer internen Warteschlange, die für die Übertragung, kopieren die Nachricht möglicherweise an den lokalen Speicher warten und zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-149">Put the message into an internal queue to wait for transmission, possibly copying the message to local storage, and return.</span></span>
    
- <span data-ttu-id="8c2c1-150">Versuchen Sie, führen Sie die tatsächliche Übertragung und zurückgeben, wenn die Übertragung erfolgreich oder nicht erfolgreich abgeschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-150">Attempt to perform the actual transmission and return when the transmission completes, either successfully or unsuccessfully.</span></span>
    
- <span data-ttu-id="8c2c1-151">Bestimmen Sie, ob die Nachricht gesendet werden, nachdem die Beteiligten Ressource überprüft.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-151">Determine whether to send the message after checking the resource involved.</span></span> <span data-ttu-id="8c2c1-152">In diesem Fall ist die Ressource frei, kann der Anbieter die Ressource zu sperren, Vorbereiten die Nachricht und senden sie Sie.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-152">In this case, if the resource is free, the provider can lock the resource, prepare the message, and submit it.</span></span> <span data-ttu-id="8c2c1-153">Wenn die Ressource ausgelastet ist, kann der Anbieter vorbereiten die Nachricht und Senden an einem späteren Zeitpunkt verzögern.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-153">If the resource is busy, the provider can prepare the message and defer sending to a later time.</span></span>
    
<span data-ttu-id="8c2c1-154">Das bevorzugte Verfahren für die Nachrichtenübermittlung hängt davon ab, der Adressbuchhierarchie und der erwarteten Anzahl von Prozesse konkurrieren für Systemressourcen.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-154">The preferred technique for message transmission depends on the transport provider and the expected number of processes competing for system resources.</span></span> 
  
<span data-ttu-id="8c2c1-155">Während eines Anrufs **SubmitMessage** steuert der Adressbuchhierarchie die Übertragung von Nachrichtendaten von Message-Objekts.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-155">During a **SubmitMessage** call, the transport provider controls the transfer of message data from the message object.</span></span> <span data-ttu-id="8c2c1-156">Jedoch sollte der Adressbuchhierarchie einen Verweiswert der Nachricht zuweisen, der einen Zeiger in _LpulMsgRef_, wird vor der Weiterleitung von Daten.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-156">However, the transport provider should assign a reference value to the message, to which it returns a pointer in  _lpulMsgRef_, before transferring data.</span></span> <span data-ttu-id="8c2c1-157">Darin wird, da jederzeit während des Aktivierungsvorgangs die MAPI-Warteschlange die [IXPLogon::TransportNotify](ixplogon-transportnotify.md) -Methode mit dem NOTIFY_CANCEL_MESSAGE-Flag aufrufen kann so festgelegt, um dem Anbieter zu signalisieren, dass es sollten alle geöffneten Objekte freigeben und Beenden der Nachrichtenübermittlung.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-157">It does so because at any point during the process, the MAPI spooler can call the [IXPLogon::TransportNotify](ixplogon-transportnotify.md) method with the NOTIFY_CANCEL_MESSAGE flag set to signal the provider that it should release any open objects and stop message transfer.</span></span> 
  
<span data-ttu-id="8c2c1-158">Der Transportdienst sollte keine Nontransmittable Eigenschaften der Nachricht senden.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-158">The transport provider should not send any nontransmittable properties of the message.</span></span> <span data-ttu-id="8c2c1-159">Wenn eine solche Eigenschaft gefunden wird, sollten sie wechseln Sie auf die nächste Eigenschaft verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-159">When it finds such a property, it should go on to process the next property.</span></span> <span data-ttu-id="8c2c1-160">Der Anbieter sollte bemüht nicht für MAPI_P1 als Teil des Inhalts übertragene Nachricht Empfängerinformationen stellen. der Anbieter sollte diese Empfängerinformationen nur zum Umgang mit Zwecke verwenden.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-160">The provider should make every effort not to display MAPI_P1 recipient information as part of the transmitted message content; the provider should use this recipient information only for addressing purposes.</span></span> <span data-ttu-id="8c2c1-161">MAPI_P1 Empfänger sind intern generierten Empfänger, die für erneutes Senden von Nachrichten verwendet werden. Sie sollten nicht übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-161">MAPI_P1 recipients are internally generated recipients that are used for resending messages; they should not be transmitted.</span></span> <span data-ttu-id="8c2c1-162">Verwenden Sie stattdessen die anderen Empfänger für die Übertragung von Empfängerinformationen.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-162">Instead, use the other recipients for transmitting recipient information.</span></span> <span data-ttu-id="8c2c1-163">Diese Anordnung dient gestatten erneut Empfänger genauen derselben Tabelle Empfänger als die ursprünglichen Empfänger zu sehen.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-163">The purpose of this arrangement is to permit resend recipients to see the exact same recipient table as the original recipients.</span></span>
  
<span data-ttu-id="8c2c1-164">Während eines Anrufs **SubmitMessage** die MAPI-Warteschlange verarbeitet Methoden für Objekte, die während der Übertragung der Nachricht geöffnet werden, und alle Anlagen verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-164">During a **SubmitMessage** call, the MAPI spooler processes methods for objects that are opened during the transfer of the message, and it processes any attachments.</span></span> <span data-ttu-id="8c2c1-165">Diese Verarbeitung kann sehr lange dauern.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-165">This processing can take a long time.</span></span> <span data-ttu-id="8c2c1-166">Transportanbieter können die [IMAPISupport::SpoolerYield](imapisupport-spooleryield.md) -Methode für die MAPI-Warteschlange während diese Verarbeitung freizugebende CPU-Zeit für andere Systemaufgaben häufig aufrufen.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-166">Transport providers can call the [IMAPISupport::SpoolerYield](imapisupport-spooleryield.md) method for the MAPI spooler frequently during this processing to release CPU time for other system tasks.</span></span> 
  
<span data-ttu-id="8c2c1-167">Alle Empfänger der Nachricht werden in der Tabelle Empfänger der Nachricht, die die MAPI-Warteschlange ursprünglich übergeben angezeigt.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-167">All message recipients are visible in the recipient table of the message that the MAPI spooler originally passed.</span></span> <span data-ttu-id="8c2c1-168">Der Transportdienst sollten nur die Empfänger, die es verarbeiten kann verarbeiten – basierend auf Eintrags-ID und/oder Adresstyp – und noch keine ihrer **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md))-Eigenschaft auf TRUE festgelegt haben.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-168">The transport provider should process only those recipients that it can handle — based on entry identifier, address type, or both — and that do not already have their **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property set to TRUE.</span></span> <span data-ttu-id="8c2c1-169">Wenn **PR_RESPONSIBILITY** bereits auf "true" festgelegt ist, hat einen anderen Transportanbieter, die der Empfänger behandelt.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-169">If **PR_RESPONSIBILITY** is already set to TRUE, another transport provider has handled that recipient.</span></span> <span data-ttu-id="8c2c1-170">Nach Abschluss der Anbieter über ausreichende Verarbeitung eines Empfängers, um festzustellen, ob sie Nachrichten für diesen Empfänger behandelt werden kann, sollte es des Empfängers **PR_RESPONSIBILITY** -Eigenschaft in der übergebenen Meldung auf TRUE festgelegt.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-170">When the provider completes sufficient processing of a recipient to determine whether it can handle messages for that recipient, it should set that recipient's **PR_RESPONSIBILITY** property to TRUE in the passed message.</span></span> <span data-ttu-id="8c2c1-171">In der Regel wird der Anbieter hierbei nach Abschluss der Nachrichtenübermittlung.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-171">Usually, the provider makes this determination after message delivery is complete.</span></span> 
  
<span data-ttu-id="8c2c1-172">Der Adressbuchhierarchie gibt in der Regel nicht von einem Aufruf **SubmitMessage** zurück, erst nach die Übertragung von Meldungsdaten Abschluss.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-172">Typically, the transport provider does not return from a **SubmitMessage** call until it completes the transfer of message data.</span></span> <span data-ttu-id="8c2c1-173">Wenn kein Fehler zurückgegeben wird, ist der nächste Aufruf aus die MAPI-Warteschlange an den Anbieter einen Aufruf der [IXPLogon::EndMessage](ixplogon-endmessage.md) -Methode.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-173">If no error is returned, the next call from the MAPI spooler to the provider is a call to the [IXPLogon::EndMessage](ixplogon-endmessage.md) method.</span></span> 
  
<span data-ttu-id="8c2c1-174">Wenn **SubmitMessage** einen Fehler zurückgibt, gibt die MAPI-Warteschlange die Nachricht im Prozess frei, ohne Änderungen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-174">If **SubmitMessage** returns an error, the MAPI spooler releases the message in process without saving changes.</span></span> <span data-ttu-id="8c2c1-175">Benötigt der Adressbuchhierarchie Nachricht Änderungen gespeichert werden soll, muss er die [IMAPIProp::SaveChanges](imapiprop-savechanges.md) -Methode für die Nachricht vor der Rückgabe aufrufen.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-175">If the transport provider requires message changes to be saved, it must call the [IMAPIProp::SaveChanges](imapiprop-savechanges.md) method on the message before returning.</span></span> 
  
<span data-ttu-id="8c2c1-176">Bei Fehlern, die aufgrund von Transport Probleme auftreten, die MAPI-Warteschlange behält die Nachricht, aber sie verzögert erneute Übermittlung der Nachricht an der Adressbuchhierarchie basierend auf dem Wert in _LpulReturnParm_zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-176">In case of errors that occur because of transport problems, the MAPI spooler retains the message, but it delays resubmitting the message to the transport provider based on the value returned in  _lpulReturnParm_.</span></span> <span data-ttu-id="8c2c1-177">Wenn der Rückgabewert aus **SubmitMessage** MAPI_E_WAIT oder MAPI_E_NETWORK_ERROR ist, muss diesen Wert der Adressbuchhierarchie ausfüllen.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-177">The transport provider must fill in that value if its return value from **SubmitMessage** is MAPI_E_WAIT or MAPI_E_NETWORK_ERROR.</span></span> <span data-ttu-id="8c2c1-178">Wenn eine Bedingung Schwerwiegender Fehler auftritt, muss der Adressbuchhierarchie die [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) -Methode mit dem NOTIFY_CRITICAL_ERROR-Flag aufrufen.</span><span class="sxs-lookup"><span data-stu-id="8c2c1-178">If a severe error condition occurs, the transport provider must call the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method with the NOTIFY_CRITICAL_ERROR flag.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="8c2c1-179">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="8c2c1-179">See also</span></span>



[<span data-ttu-id="8c2c1-180">IMAPIProp::SaveChanges</span><span class="sxs-lookup"><span data-stu-id="8c2c1-180">IMAPIProp::SaveChanges</span></span>](imapiprop-savechanges.md)
  
[<span data-ttu-id="8c2c1-181">IMAPISupport::SpoolerNotify</span><span class="sxs-lookup"><span data-stu-id="8c2c1-181">IMAPISupport::SpoolerNotify</span></span>](imapisupport-spoolernotify.md)
  
[<span data-ttu-id="8c2c1-182">IMAPISupport::SpoolerYield</span><span class="sxs-lookup"><span data-stu-id="8c2c1-182">IMAPISupport::SpoolerYield</span></span>](imapisupport-spooleryield.md)
  
[<span data-ttu-id="8c2c1-183">IXPLogon::EndMessage</span><span class="sxs-lookup"><span data-stu-id="8c2c1-183">IXPLogon::EndMessage</span></span>](ixplogon-endmessage.md)
  
[<span data-ttu-id="8c2c1-184">IXPLogon::TransportNotify</span><span class="sxs-lookup"><span data-stu-id="8c2c1-184">IXPLogon::TransportNotify</span></span>](ixplogon-transportnotify.md)
  
[<span data-ttu-id="8c2c1-185">IXPLogon : IUnknown</span><span class="sxs-lookup"><span data-stu-id="8c2c1-185">IXPLogon : IUnknown</span></span>](ixplogoniunknown.md)

