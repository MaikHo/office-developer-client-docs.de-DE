---
title: Primäre MAPI-Identität
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8787a873-6752-4b17-8ea3-8fed793e1371
description: 'Letzte �nderung: Montag, 9. M�rz 2015'
ms.openlocfilehash: 5bf88de280b012c54d4caaac6bdfe877f476ac37
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32345795"
---
# <a name="mapi-primary-identity"></a><span data-ttu-id="39da8-103">Primäre MAPI-Identität</span><span class="sxs-lookup"><span data-stu-id="39da8-103">MAPI Primary Identity</span></span>

  
  
<span data-ttu-id="39da8-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="39da8-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="39da8-105">Die meisten MAPI-Sitzungen verfügen über einen bestimmten Dienstanbieter, der die primäre Identität für die Sitzung bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="39da8-105">Most MAPI sessions have a particular service provider that supplies the primary identity for the session.</span></span> <span data-ttu-id="39da8-106">In der Regel handelt es sich um einen Adressbuchanbieter, der die Identität über eines seiner Messaging-Benutzerobjekte oder-Verteilerlisten bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="39da8-106">Typically, it is an address book provider, which supplies identity through one of its messaging user objects or distribution lists.</span></span> <span data-ttu-id="39da8-107">In der Tat empfiehlt MAPI, dass Nachrichtendienste, die einen Adressbuchanbieter einbeziehen, eines ihrer Objekte für die primäre Identität verwenden.</span><span class="sxs-lookup"><span data-stu-id="39da8-107">In fact, MAPI recommends that message services that include an address book provider use one of its objects for the primary identity.</span></span> <span data-ttu-id="39da8-108">Wenn ein Dienstanbieter, der zu einem Nachrichtendienst gehört, die primäre Identität bereitstellt, teilen alle anderen Dienstanbieter im Nachrichtendienst diese Identität.</span><span class="sxs-lookup"><span data-stu-id="39da8-108">When a service provider that belongs to a message service supplies the primary identity, all of the other service providers in the message service share this identity.</span></span>
  
<span data-ttu-id="39da8-109">Die MAPISVC. Die INF-Konfigurationsdatei enthält Einträge, die sich auf die Identität der Nachrichtendienst-und Dienstanbieter Ebene beziehen.</span><span class="sxs-lookup"><span data-stu-id="39da8-109">The MAPISVC.INF configuration file has entries relating to identity at both the message service and service provider level.</span></span> <span data-ttu-id="39da8-110">Nachrichtendienst Abschnitte müssen einen Eintrag enthalten, der angibt, ob der Dienst die primäre Identität angeben kann. Dienstanbieter Abschnitte enthalten einen ähnlichen Eintrag nur, wenn der Anbieter eine Identität angeben kann.</span><span class="sxs-lookup"><span data-stu-id="39da8-110">Message service sections must include an entry that states whether or not the service can supply the primary identity; service provider sections include a similar entry only when the provider can supply an identity.</span></span>
  
<span data-ttu-id="39da8-111">In der folgenden Tabelle sind die Einträge aufgeführt, die in den Abschnitten Nachrichtendienst und Dienstanbieter in der MAPISVC angezeigt werden. INF-Datei.</span><span class="sxs-lookup"><span data-stu-id="39da8-111">The following table lists the entries that appear in the message service and service provider sections in the MAPISVC.INF file.</span></span>
  
|<span data-ttu-id="39da8-112">**Primärer Identitäts Lieferant**</span><span class="sxs-lookup"><span data-stu-id="39da8-112">**Primary identity supplier**</span></span>|<span data-ttu-id="39da8-113">**PR_RESOURCE_FLAGS-Einstellung**</span><span class="sxs-lookup"><span data-stu-id="39da8-113">**PR_RESOURCE_FLAGS setting**</span></span>|
|:-----|:-----|
|<span data-ttu-id="39da8-114">Nachrichtendienst</span><span class="sxs-lookup"><span data-stu-id="39da8-114">Message service</span></span>  <br/> | `SERVICE_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="39da8-115">Nicht der Nachrichtendienst</span><span class="sxs-lookup"><span data-stu-id="39da8-115">Not the message service</span></span>  <br/> | `SERVICE_NO_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="39da8-116">Dienstanbieter</span><span class="sxs-lookup"><span data-stu-id="39da8-116">Service provider</span></span>  <br/> | `STATUS_PRIMARY_IDENTITY` <br/> |
   
<span data-ttu-id="39da8-117">Obwohl mehrere Nachrichtendienste ihre Fähigkeit zur Bereitstellung der primären Identität einer Sitzung deklarieren können, wird nur ein Nachrichtendienst dafür ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="39da8-117">Although multiple message services can declare their ability to provide a session's primary identity, only one message service is selected to do so.</span></span> <span data-ttu-id="39da8-118">Diese Auswahl kann auftreten:</span><span class="sxs-lookup"><span data-stu-id="39da8-118">This selection can occur:</span></span>
  
- <span data-ttu-id="39da8-119">Beim Erstellen eines Profils.</span><span class="sxs-lookup"><span data-stu-id="39da8-119">When a profile is created.</span></span>
    
- <span data-ttu-id="39da8-120">Wenn ein Client **IMsgServiceAdmin:: SetPrimaryIdentity** aufruft, um einen bestimmten Nachrichtendienst explizit als Anbieter der Sitzungs Identität einzurichten.</span><span class="sxs-lookup"><span data-stu-id="39da8-120">When a client calls **IMsgServiceAdmin::SetPrimaryIdentity** to explicitly establish a particular message service as the provider of the session identity.</span></span> <span data-ttu-id="39da8-121">Weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="39da8-121">For more information.</span></span> <span data-ttu-id="39da8-122">Weitere Informationen finden Sie unter [IMsgServiceAdmin:: SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="39da8-122">See [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span></span>
    
<span data-ttu-id="39da8-123">Bei der Erstellung eines Profils bestimmt MAPI den ersten zu konfigurierenden Nachrichtendienst, der einen Anbieter mit dem STATUS_PRIMARY_IDENTITY-Flag enthält, das in seiner **PR_RESOURCE_FLAGS** ([pidtagresourceflags (](pidtagresourceflags-canonical-property.md))-Eigenschaft festgelegt ist, um die primäre Identität bereitzustellen. .</span><span class="sxs-lookup"><span data-stu-id="39da8-123">When a profile is created, MAPI designates the first message service to be configured that includes a provider with the STATUS_PRIMARY_IDENTITY flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property to supply the primary identity.</span></span> <span data-ttu-id="39da8-124">Innerhalb des angegebenen Nachrichtendiensts wird der erste Anbieter, der mit diesem Ressourcen-Flagsatz konfiguriert werden soll, ausgewählt, um die Identität für den Dienst anzugeben.</span><span class="sxs-lookup"><span data-stu-id="39da8-124">Within the designated message service, the first provider to be configured with this resource flag set is chosen to provide the identity for the service.</span></span> <span data-ttu-id="39da8-125">Das STATUS_PRIMARY_IDENTITY-Flag wird für alle anderen Anbieter im angegebenen Dienst und andere Nachrichtendienste im Profil deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="39da8-125">The STATUS_PRIMARY_IDENTITY flag is cleared for all other providers in the designated service and other message services in the profile.</span></span> <span data-ttu-id="39da8-126">Wenn der Anbieter, der primäre Identität bereitstellt, zu einem beliebigen Zeitpunkt aus dem Profil entfernt wird, weist MAPI die Rolle dem nächsten zu konfigurierenden Anbieter zu, der die Identität angeben kann.</span><span class="sxs-lookup"><span data-stu-id="39da8-126">If at any time the provider supplying primary identity is removed from the profile, MAPI assigns the role to the next provider to be configured that can supply identity.</span></span> <span data-ttu-id="39da8-127">Dies wird durch die Darstellung des `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` Eintrags im Abschnitt des Anbieters in MAPISVC. inf bestimmt.</span><span class="sxs-lookup"><span data-stu-id="39da8-127">This is determined by the appearance of the  `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` entry in the provider's section in MAPISVC.INF.</span></span> 
  
<span data-ttu-id="39da8-128">Wenn ein Client die **IMsgServiceAdmin:: SetPrimaryIdentity** -Methode eines Nachrichtendiensts aufruft, gibt er die MAPIUID für einen Dienstanbieter innerhalb des Zieldiensts an.</span><span class="sxs-lookup"><span data-stu-id="39da8-128">When a client calls a message service's **IMsgServiceAdmin::SetPrimaryIdentity** method, it specifies the MAPIUID for a service provider within the target service.</span></span> <span data-ttu-id="39da8-129">Weitere Informationen finden Sie unter [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="39da8-129">For more information, see [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="39da8-130">Der Dienstanbieter, der durch das **MAPIUID** dargestellt wird, wird zugewiesen, um die primäre Identität für den Nachrichtendienst und für die Sitzung bereitzustellen, und alle anderen Anbieter im Dienst teilen diese Identität.</span><span class="sxs-lookup"><span data-stu-id="39da8-130">The service provider represented by the **MAPIUID** is assigned to supply the primary identity for the message service and for the session, and all of the other providers in the service will share this identity.</span></span> 
  
<span data-ttu-id="39da8-131">Jeder Anbieter im Nachrichtendienst, der für die primäre Identität zuständig ist, aktualisiert seine Zeile in der Statustabelle mit den folgenden Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="39da8-131">Every provider in the message service responsible for supplying the primary identity updates its row in the status table to include the following properties.</span></span>
  
|<span data-ttu-id="39da8-132">**Primäre Identitätseigenschaft**</span><span class="sxs-lookup"><span data-stu-id="39da8-132">**Primary identity property**</span></span>|<span data-ttu-id="39da8-133">**Festgelegt auf**</span><span class="sxs-lookup"><span data-stu-id="39da8-133">**Set to**</span></span>|
|:-----|:-----|
|<span data-ttu-id="39da8-134">**PR_IDENTITY_DISPLAY** ([Pidtagidentitydisplay (](pidtagidentitydisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39da8-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="39da8-135">Anzeigename des Objekts, das die primäre Identität bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="39da8-135">Display name of the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="39da8-136">**PR_IDENTITY_SEARCH_KEY** ([Pidtagidentitysearchkey (](pidtagidentitysearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39da8-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="39da8-137">Suchschlüssel für das Objekt, das die primäre Identität bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="39da8-137">Search key for the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="39da8-138">**PR_IDENTITY_ENTRYID** ([Pidtagidentityentryid (](pidtagidentityentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="39da8-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="39da8-139">Eintragsbezeichner für das Objekt, das die primäre Identität bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="39da8-139">Entry identifier for the object supplying the primary identity.</span></span>  <br/> |
   
 <span data-ttu-id="39da8-140">**So rufen Sie die Eintrags-ID für das Objekt ab, das die primäre Identität bereitstellt**</span><span class="sxs-lookup"><span data-stu-id="39da8-140">**To retrieve the entry identifier for the object supplying the primary identity**</span></span>
  
- <span data-ttu-id="39da8-141">Rufen Sie die **IMAPISession:: QueryIdentity** -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="39da8-141">Call the **IMAPISession::QueryIdentity** method.</span></span> <span data-ttu-id="39da8-142">Weitere Informationen finden Sie unter [IMAPISession:: QueryIdentity](imapisession-queryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="39da8-142">For more information, see [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span></span> <span data-ttu-id="39da8-143">**QueryIdentity** durchsucht die Statustabelle nach der Zeile, die den Wert STATUS_PRIMARY_IDENTITY in der **PR_RESOURCE_FLAGS** -Spalte enthält, und gibt die entsprechende **PR_IDENTITY_ENTRYID** als Eintrags-ID für den primären Identität.</span><span class="sxs-lookup"><span data-stu-id="39da8-143">**QueryIdentity** searches the status table for the row that contains the value STATUS_PRIMARY_IDENTITY in its **PR_RESOURCE_FLAGS** column and returns the corresponding **PR_IDENTITY_ENTRYID** as the entry identifier for the primary identity.</span></span> 
    

