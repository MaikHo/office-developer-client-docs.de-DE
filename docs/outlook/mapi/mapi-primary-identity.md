---
title: Primäre MAPI-Identität
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8787a873-6752-4b17-8ea3-8fed793e1371
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: de1fe8fd5ef5a6e79934478c62b2403c48f85b5e
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/23/2018
ms.locfileid: "22565879"
---
# <a name="mapi-primary-identity"></a><span data-ttu-id="139f9-103">Primäre MAPI-Identität</span><span class="sxs-lookup"><span data-stu-id="139f9-103">MAPI Primary Identity</span></span>

  
  
<span data-ttu-id="139f9-104">**Betrifft**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="139f9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="139f9-105">Die meisten MAPI-Sitzungen vorhanden sind, einen bestimmten Dienstanbieter, der die primäre Identität für die Sitzung bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="139f9-105">Most MAPI sessions have a particular service provider that supplies the primary identity for the session.</span></span> <span data-ttu-id="139f9-106">In der Regel ist es Adressbuch-Dienstanbieter, die Identität über Verteilerlisten oder messaging User-Objekte bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="139f9-106">Typically, it is an address book provider, which supplies identity through one of its messaging user objects or distribution lists.</span></span> <span data-ttu-id="139f9-107">Tatsächlich empfiehlt MAPI Message-Dienste, die ein Adressbuchanbieter einschließen eines seiner Objekte für die primäre Identität verwenden.</span><span class="sxs-lookup"><span data-stu-id="139f9-107">In fact, MAPI recommends that message services that include an address book provider use one of its objects for the primary identity.</span></span> <span data-ttu-id="139f9-108">Bei ein Dienstanbieter, der eine Message Service gehört die primäre Identität bereitstellt, teilen sich alle anderen-Dienstanbieter in den Dienst diese Identität.</span><span class="sxs-lookup"><span data-stu-id="139f9-108">When a service provider that belongs to a message service supplies the primary identity, all of the other service providers in the message service share this identity.</span></span>
  
<span data-ttu-id="139f9-109">Die Datei MAPISVC. INF-Konfigurationsdatei hat Einträge zu Identität am Dienst Message und Service Provider-Ebene.</span><span class="sxs-lookup"><span data-stu-id="139f9-109">The MAPISVC.INF configuration file has entries relating to identity at both the message service and service provider level.</span></span> <span data-ttu-id="139f9-110">Nachricht Service Abschnitte müssen einen Eintrag enthalten, der angibt, ob der Dienst die primäre Identität angeben kann. Service Provider Abschnitte enthalten einen solchen Eintrag nur, wenn der Anbieter eine Identität angeben kann.</span><span class="sxs-lookup"><span data-stu-id="139f9-110">Message service sections must include an entry that states whether or not the service can supply the primary identity; service provider sections include a similar entry only when the provider can supply an identity.</span></span>
  
<span data-ttu-id="139f9-111">Die folgende Tabelle enthält die Einträge, die in den Messagingdiensts und Service Provider Abschnitte in die Datei MAPISVC angezeigt werden. INF-Datei.</span><span class="sxs-lookup"><span data-stu-id="139f9-111">The following table lists the entries that appear in the message service and service provider sections in the MAPISVC.INF file.</span></span>
  
|<span data-ttu-id="139f9-112">**Primäre Identität Lieferanten**</span><span class="sxs-lookup"><span data-stu-id="139f9-112">**Primary identity supplier**</span></span>|<span data-ttu-id="139f9-113">**PR_RESOURCE_FLAGS-Einstellung**</span><span class="sxs-lookup"><span data-stu-id="139f9-113">**PR_RESOURCE_FLAGS setting**</span></span>|
|:-----|:-----|
|<span data-ttu-id="139f9-114">Messagingdiensts</span><span class="sxs-lookup"><span data-stu-id="139f9-114">Message service</span></span>  <br/> | `SERVICE_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="139f9-115">Nicht den Dienst</span><span class="sxs-lookup"><span data-stu-id="139f9-115">Not the message service</span></span>  <br/> | `SERVICE_NO_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="139f9-116">Dienstanbieter</span><span class="sxs-lookup"><span data-stu-id="139f9-116">Service provider</span></span>  <br/> | `STATUS_PRIMARY_IDENTITY` <br/> |
   
<span data-ttu-id="139f9-117">Mehrere Nachrichtendienste für die können Sie ihre Fähigkeit zum Bereitstellen einer Sitzung primäre Identität deklarieren, wird nur eine Messagingdiensts dazu ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="139f9-117">Although multiple message services can declare their ability to provide a session's primary identity, only one message service is selected to do so.</span></span> <span data-ttu-id="139f9-118">Auswahl dieser Option kann auftreten:</span><span class="sxs-lookup"><span data-stu-id="139f9-118">This selection can occur:</span></span>
  
- <span data-ttu-id="139f9-119">Wenn ein Profil erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="139f9-119">When a profile is created.</span></span>
    
- <span data-ttu-id="139f9-120">Wenn ein Client **IMsgServiceAdmin::SetPrimaryIdentity** explizit einen bestimmte Nachricht-Dienst als Anbieter der Sitzung Identität herstellen aufruft.</span><span class="sxs-lookup"><span data-stu-id="139f9-120">When a client calls **IMsgServiceAdmin::SetPrimaryIdentity** to explicitly establish a particular message service as the provider of the session identity.</span></span> <span data-ttu-id="139f9-121">Weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="139f9-121">For more information.</span></span> <span data-ttu-id="139f9-122">Finden Sie unter [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="139f9-122">See [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span></span>
    
<span data-ttu-id="139f9-123">Wenn ein Profil erstellt wird, legt MAPI den ersten Nachrichtendienst konfiguriert werden soll, der mit dem STATUS_PRIMARY_IDENTITY-Flag, legen Sie in dessen **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))-Eigenschaft auf die primäre Identität angeben ein Anbieters enthält fest. .</span><span class="sxs-lookup"><span data-stu-id="139f9-123">When a profile is created, MAPI designates the first message service to be configured that includes a provider with the STATUS_PRIMARY_IDENTITY flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property to supply the primary identity.</span></span> <span data-ttu-id="139f9-124">Innerhalb der festgelegten Messagingdiensts wird der erste Anbieter mit dieser Kennzeichnung Ressourcensatz konfiguriert werden ausgewählt, um die Identität für den Dienst bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="139f9-124">Within the designated message service, the first provider to be configured with this resource flag set is chosen to provide the identity for the service.</span></span> <span data-ttu-id="139f9-125">Das Flag STATUS_PRIMARY_IDENTITY ist für alle anderen Anbieter in den festgelegten Dienst und andere Nachrichtendienste im Profil gelöscht.</span><span class="sxs-lookup"><span data-stu-id="139f9-125">The STATUS_PRIMARY_IDENTITY flag is cleared for all other providers in the designated service and other message services in the profile.</span></span> <span data-ttu-id="139f9-126">Wenn können Sie jederzeit der Anbieter angeben primären Identität aus dem Profil entfernt wird, weist MAPI die Rolle an den nächsten Anbieter konfiguriert werden soll, die Identität angeben kann.</span><span class="sxs-lookup"><span data-stu-id="139f9-126">If at any time the provider supplying primary identity is removed from the profile, MAPI assigns the role to the next provider to be configured that can supply identity.</span></span> <span data-ttu-id="139f9-127">Dies wird durch die Darstellung des bestimmt die `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` Eintrag im Abschnitt MAPISVC.INF des Anbieters.</span><span class="sxs-lookup"><span data-stu-id="139f9-127">This is determined by the appearance of the  `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` entry in the provider's section in MAPISVC.INF.</span></span> 
  
<span data-ttu-id="139f9-128">Wenn ein Client eine Messagingdiensts **IMsgServiceAdmin::SetPrimaryIdentity** -Methode aufruft, gibt die MAPIUID für einen Dienstanbieter innerhalb der Zieldienst an.</span><span class="sxs-lookup"><span data-stu-id="139f9-128">When a client calls a message service's **IMsgServiceAdmin::SetPrimaryIdentity** method, it specifies the MAPIUID for a service provider within the target service.</span></span> <span data-ttu-id="139f9-129">Weitere Informationen finden Sie unter [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="139f9-129">For more information, see [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="139f9-130">Der Dienstanbieter, dargestellt durch die **MAPIUID** zugeordnet ist, geben Sie die primäre Identität für den Dienst und für die Sitzung, und alle anderen Anbieter im Dienst wird diese Identität freigeben.</span><span class="sxs-lookup"><span data-stu-id="139f9-130">The service provider represented by the **MAPIUID** is assigned to supply the primary identity for the message service and for the session, and all of the other providers in the service will share this identity.</span></span> 
  
<span data-ttu-id="139f9-131">Jeder Anbieter in den Dienst verantwortlich für die Angabe der primären Identität aktualisiert eine Zeile in der Statustabelle "auf die folgenden Eigenschaften enthalten.</span><span class="sxs-lookup"><span data-stu-id="139f9-131">Every provider in the message service responsible for supplying the primary identity updates its row in the status table to include the following properties.</span></span>
  
|<span data-ttu-id="139f9-132">**Primäre Identity-Eigenschaft**</span><span class="sxs-lookup"><span data-stu-id="139f9-132">**Primary identity property**</span></span>|<span data-ttu-id="139f9-133">**Festgelegt auf**</span><span class="sxs-lookup"><span data-stu-id="139f9-133">**Set to**</span></span>|
|:-----|:-----|
|<span data-ttu-id="139f9-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="139f9-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="139f9-135">Der Anzeigename des-Objekts die primäre Identität angeben.</span><span class="sxs-lookup"><span data-stu-id="139f9-135">Display name of the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="139f9-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="139f9-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="139f9-137">Search-Schlüssel für das Objekt, das die primäre Identität angeben.</span><span class="sxs-lookup"><span data-stu-id="139f9-137">Search key for the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="139f9-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="139f9-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="139f9-139">Entry-ID für das Objekt, das die primäre Identität angeben.</span><span class="sxs-lookup"><span data-stu-id="139f9-139">Entry identifier for the object supplying the primary identity.</span></span>  <br/> |
   
 <span data-ttu-id="139f9-140">**Zum Abrufen der Eintrags-ID für das Objekt, das die primäre Identität angeben**</span><span class="sxs-lookup"><span data-stu-id="139f9-140">**To retrieve the entry identifier for the object supplying the primary identity**</span></span>
  
- <span data-ttu-id="139f9-141">Rufen Sie die **IMAPISession::QueryIdentity** -Methode.</span><span class="sxs-lookup"><span data-stu-id="139f9-141">Call the **IMAPISession::QueryIdentity** method.</span></span> <span data-ttu-id="139f9-142">Weitere Informationen finden Sie unter [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="139f9-142">For more information, see [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span></span> <span data-ttu-id="139f9-143">**QueryIdentity** sucht in der Statustabelle "für die Zeile, die den Wert STATUS_PRIMARY_IDENTITY in die Spalte **PR_RESOURCE_FLAGS** enthält, und gibt die entsprechenden **PR_IDENTITY_ENTRYID** als die Eintrags-ID für die primäre Identität.</span><span class="sxs-lookup"><span data-stu-id="139f9-143">**QueryIdentity** searches the status table for the row that contains the value STATUS_PRIMARY_IDENTITY in its **PR_RESOURCE_FLAGS** column and returns the corresponding **PR_IDENTITY_ENTRYID** as the entry identifier for the primary identity.</span></span> 
    

