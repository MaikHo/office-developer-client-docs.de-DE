---
title: Öffnen eines Nachrichtenspeichers
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 43b23fd7-999a-42c0-8f4d-47f5de266bdb
description: 'Letzte �nderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 39d6df6db329abf7509f816165341ea0eda8331b
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19793295"
---
# <a name="opening-a-message-store"></a><span data-ttu-id="2c6d0-103">Öffnen eines Nachrichtenspeichers</span><span class="sxs-lookup"><span data-stu-id="2c6d0-103">Opening a message store</span></span>

<span data-ttu-id="2c6d0-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="2c6d0-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="2c6d0-105">Je nach dem Profil müssen ein Client einen oder mehrere Nachrichtenspeicher während einer normalen Sitzung zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-105">Depending on the profile, a client will need to open one or more message stores during a typical session.</span></span> <span data-ttu-id="2c6d0-106">Öffnen eines Nachrichtenspeichers bedeutet den Zugriff auf einen Zeiger auf seine [IMsgStore: IMAPIProp](imsgstoreimapiprop.md) Implementierung.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-106">Opening a message store means gaining access to a pointer to its [IMsgStore : IMAPIProp](imsgstoreimapiprop.md) implementation.</span></span> <span data-ttu-id="2c6d0-107">Die **IMsgStore** -Schnittstelle stellt Methoden für die Benachrichtigung, Ordner Aufgaben durchführen und den Zugriff auf Ordner und Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-107">The **IMsgStore** interface provides methods for notification, making folder assignments, and accessing folders and messages.</span></span> 
  
<span data-ttu-id="2c6d0-108">Öffnen Clients Nachrichtenspeicher bei der Anmeldung und ein Profil geändert wird.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-108">Clients open message stores at logon and when a profile is being modified.</span></span> <span data-ttu-id="2c6d0-109">Wenn Ihre Client Benutzer Nachrichtenspeicher während einer aktiven Sitzung auf das Profil hinzufügen können, können Sie sofort zu öffnen oder bis zum nächsten Sitzung zu ignorieren.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-109">If your client allows users to add message stores to the profile during an active session, you can either open them immediately or ignore them until the next session.</span></span> <span data-ttu-id="2c6d0-110">Durch die Registrierung für Benachrichtigungen auf die Tabelle Store, werden Sie für die Verfügbarkeit von einem neuen Nachrichtenspeicher benachrichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-110">By registering for notifications on the message store table, you will be alerted to the availability of a new message store.</span></span>
  
<span data-ttu-id="2c6d0-111">Um einen Nachrichtenspeicher zu öffnen, benötigen Sie die Eintrags-ID verfügbar.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-111">To open a message store, you must have its entry identifier available.</span></span> <span data-ttu-id="2c6d0-112">Die meisten Clients Zugriff auf den Eintrag-IDs für die Nachrichtenspeicher, den, die Sie durch die Nachricht Store Tabelle öffnen möchten.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-112">Most clients access the entry identifiers for the message stores they wish to open through the message store table.</span></span> <span data-ttu-id="2c6d0-113">Eine Nachricht wird jedoch das Format der ihre Eintragsbezeichner, wodurch Clients zu umgehen die Nachricht Store Tabelle und erstellen die erforderlichen Eintrags-ID Dokument gespeichert.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-113">However, some message stores document the format of their entry identifiers, thereby enabling clients to bypass the message store table and construct the necessary entry identifier.</span></span> <span data-ttu-id="2c6d0-114">Sie können dieses Eintrags-ID direkt an [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) übergeben und MAPI erstellt automatisch Profile-Abschnitt für den Anbieter ohne alle Messagingdiensts zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-114">They can pass this entry identifier directly to [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) and MAPI automatically creates a profile section for the provider without associating it with any message service.</span></span> 
  
## <a name="retrieve-an-entry-identifier-from-the-message-store-table"></a><span data-ttu-id="2c6d0-115">Abrufen eines Eintrags-ID aus der Nachricht Store-Tabelle</span><span class="sxs-lookup"><span data-stu-id="2c6d0-115">Retrieve an entry identifier from the message store table</span></span>
  
1. <span data-ttu-id="2c6d0-116">Rufen Sie [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) , um die Nachricht Store-Tabelle zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-116">Call [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) to open the message store table.</span></span> 
    
2. <span data-ttu-id="2c6d0-117">Rufen Sie **IMAPITable::SetColumns** zum Beschränken der Tabelle einen Satz kleine Spalte, die die folgenden Spalten enthält:</span><span class="sxs-lookup"><span data-stu-id="2c6d0-117">Call **IMAPITable::SetColumns** to limit the table to a small column set that includes the following columns:</span></span> 
    
   - <span data-ttu-id="2c6d0-118">**PR_PROVIDER_DISPLAY** oder **PR_DISPLAY_NAME**</span><span class="sxs-lookup"><span data-stu-id="2c6d0-118">**PR_PROVIDER_DISPLAY** or **PR_DISPLAY_NAME**</span></span>
   - <span data-ttu-id="2c6d0-119">**PR_ENTRYID** -Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="2c6d0-119">**PR_ENTRYID** properties</span></span> 
   - <span data-ttu-id="2c6d0-120">**PR_MDB_PROVIDER**</span><span class="sxs-lookup"><span data-stu-id="2c6d0-120">**PR_MDB_PROVIDER**</span></span>
   - <span data-ttu-id="2c6d0-121">**PR_RESOURCE_FLAGS**</span><span class="sxs-lookup"><span data-stu-id="2c6d0-121">**PR_RESOURCE_FLAGS**</span></span>
    
3. <span data-ttu-id="2c6d0-122">Erstellen Sie eine Einschränkung, die Zeile herauszufiltern, die zum Öffnen des Nachrichtenspeichers darstellt.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-122">Build a restriction to filter out the row that represents the message store to be opened.</span></span> <span data-ttu-id="2c6d0-123">Weitere Informationen zu den standardmäßigen Nachrichtenspeicher Nachrichtensymbol finden Sie unter [Standard-Informationsspeicher zu öffnen](opening-the-default-message-store.md).</span><span class="sxs-lookup"><span data-stu-id="2c6d0-123">For more information about looking for the default message store, see [Opening the Default Message Store](opening-the-default-message-store.md).</span></span> <span data-ttu-id="2c6d0-124">Um für einen Nachrichtenspeicher nach Namen zu suchen, wenden Sie eines der folgenden Suchkriterien in Eigenschaft:</span><span class="sxs-lookup"><span data-stu-id="2c6d0-124">To look for a message store by name, apply any of the following property restrictions:</span></span>
    
   - <span data-ttu-id="2c6d0-125">Übereinstimmung **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) mit den allgemeinen Namen für diesen Nachrichtenspeicher.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-125">Match **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) with the general name for this type of message store.</span></span> <span data-ttu-id="2c6d0-126">Beispielsweise könnte PR_PROVIDER_DISPLAY auf "Persönliche Ordner" festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-126">For example, PR_PROVIDER_DISPLAY might be set to "Personal Folders".</span></span>
    
   - <span data-ttu-id="2c6d0-127">Übereinstimmung **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) mit der bestimmte **MAPIUID** für diese Art von Nachrichtenspeicher.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-127">Match **PR_MDB_PROVIDER** ([PidTagStoreProvider](pidtagstoreprovider-canonical-property.md)) with the specific **MAPIUID** for this type of message store.</span></span> 
    
   - <span data-ttu-id="2c6d0-128">Übereinstimmung **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) mit dem Namen für diese bestimmten Nachrichtenspeicher.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-128">Match **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) with the name for this particular message store.</span></span> <span data-ttu-id="2c6d0-129">Beispielsweise kann auf "Meine Nachrichten für das Geschäftsjahr 2010" **PR_DISPLAY_NAME** festgelegt werden</span><span class="sxs-lookup"><span data-stu-id="2c6d0-129">For example, **PR_DISPLAY_NAME** might be set to "My Messages for Fiscal Year 2010."</span></span> 
    
4. <span data-ttu-id="2c6d0-130">Rufen Sie [HrQueryAllRows](hrqueryallrows.md) zum Abrufen der entsprechenden Zeile aus der Nachricht Store-Tabelle.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-130">Call [HrQueryAllRows](hrqueryallrows.md) to retrieve the appropriate row from the message store table.</span></span> <span data-ttu-id="2c6d0-131">Die Eintrags-ID für die Zeile wird im Array Eigenschaft-Wert für die **aRow** Mitglied der Zeile auf das durch den Parameter _Pprows_ enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-131">The entry identifier for the row will be included in the property value array for the **aRow** member of the row set pointed to by the  _pprows_ parameter.</span></span> 
    
5. <span data-ttu-id="2c6d0-132">Rufen Sie [FreeProws](freeprows.md) , um das Rowset fest, die auf den _Pprows_freizugeben.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-132">Call [FreeProws](freeprows.md) to free the row set pointed to by  _pprows_.</span></span>
    
6. <span data-ttu-id="2c6d0-133">Version der Nachricht Store Tabelle durch die **IUnknown** -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-133">Release the message store table by calling its **IUnknown::Release** method.</span></span> 
    
<span data-ttu-id="2c6d0-134">Wenn Sie einen benutzerdefinierten Eintrag Bezeichner für den Nachrichtenspeicher geöffnet werden erstellt haben, rufen Sie die [WrapStoreEntryID](wrapstoreentryid.md) -Funktion, um es in einer standard-Eintrags-ID zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-134">If you have created a custom entry identifier for the message store to be opened, call the [WrapStoreEntryID](wrapstoreentryid.md) function to convert it to a standard entry identifier.</span></span> 
  
<span data-ttu-id="2c6d0-135">Nachdem Sie einen Nachrichtenspeicher Eintrags-ID haben, rufen Sie eine der folgenden Methoden zu öffnen:</span><span class="sxs-lookup"><span data-stu-id="2c6d0-135">After you have a message store's entry identifier, call one of the following methods to open it:</span></span>
  
- [<span data-ttu-id="2c6d0-136">IMAPISession::OpenMsgStore</span><span class="sxs-lookup"><span data-stu-id="2c6d0-136">IMAPISession::OpenMsgStore</span></span>](imapisession-openmsgstore.md)
- [<span data-ttu-id="2c6d0-137">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2c6d0-137">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md)
    
<span data-ttu-id="2c6d0-138">Rufen Sie **OpenMsgStore** , wenn Sie eine Vielzahl von speziellen Optionen für den Nachrichtenspeicher angeben müssen.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-138">Call **OpenMsgStore** if you need to specify a variety of special options for the message store.</span></span> <span data-ttu-id="2c6d0-139">**OpenMsgStore** können Sie zum Identifizieren des Nachrichtenspeichers als temporär oder als nonmessaging Speicher, Festlegen von Zugriffsebenen, unterdrückt die Anzeige von Dialogfeldern und Fehler zu verzögern.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-139">**OpenMsgStore** allows you to suppress the display of dialog boxes, identify the message store as temporary or as a nonmessaging store, set access levels, and to defer errors.</span></span> <span data-ttu-id="2c6d0-140">**OpenEntry** können Sie nur zum Festlegen von Zugriffsebenen und Fehler verzögern.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-140">**OpenEntry** allows you only to set access levels and defer errors.</span></span> 
  
<span data-ttu-id="2c6d0-141">Festlegen der MDB_NO_MAIL gibt an, Flag MAPI, dass der Nachrichtenspeicher nicht für das Senden oder Empfangen von Nachrichten verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-141">Setting the MDB_NO_MAIL flag indicates to MAPI that the message store will not be used for sending or receiving messages.</span></span> <span data-ttu-id="2c6d0-142">Informationen über das Vorhandensein dieses Nachrichtenspeichers informiert MAPI nicht die MAPI-Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-142">MAPI does not inform the MAPI spooler about the existence of this message store.</span></span> <span data-ttu-id="2c6d0-143">Das Flag MDB_TEMPORARY kennzeichnet einen Nachrichtenspeicher als temporären, sagen, dass sie zum Speichern von Daten verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-143">The MDB_TEMPORARY flag designates a message store as temporary, implying that it cannot be used to store permanent information.</span></span> <span data-ttu-id="2c6d0-144">Temporäre Nachrichtenspeicher werden nicht in der Nachricht Store Tabelle angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2c6d0-144">Temporary message stores do not appear in the message store table.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2c6d0-145">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="2c6d0-145">See also</span></span>

- [<span data-ttu-id="2c6d0-146">IMAPITable::SetColumns</span><span class="sxs-lookup"><span data-stu-id="2c6d0-146">IMAPITable::SetColumns</span></span>](imapitable-setcolumns.md)

