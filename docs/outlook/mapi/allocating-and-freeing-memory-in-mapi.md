---
title: Reservieren und Freigeben von Arbeitsspeicher in MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e238f6bc-e9f6-4ea4-a2e4-ff5da2a04bd5
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: dc97abcb4b316b696032f2788f4e653717e1396b
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19791287"
---
# <a name="allocating-and-freeing-memory-in-mapi"></a><span data-ttu-id="ef1a7-103">Reservieren und Freigeben von Arbeitsspeicher in MAPI</span><span class="sxs-lookup"><span data-stu-id="ef1a7-103">Allocating and Freeing Memory in MAPI</span></span>

  
  
<span data-ttu-id="ef1a7-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="ef1a7-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="ef1a7-105">Zusätzlich zum angeben, wie zuordnen und Freigeben von Arbeitsspeicher, definiert MAPI ein Modell zu wissen, wenn Speicher übergeben zwischen öffentliche Schnittstelle-Methode und die API-Funktion, die Anrufe freigegeben werden soll.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-105">In addition to specifying how to allocate and free memory, MAPI defines a model for knowing when memory passed between public interface method and API function calls should be freed.</span></span> <span data-ttu-id="ef1a7-106">Das Modell gilt nur für Arbeitsspeichers für Parameter, die nicht Zeigern auf Schnittstellen, wie Zeichenfolgen und Zeiger auf Strukturen sind.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-106">The model applies only to memory allocated for parameters that are not pointers to interfaces, such as strings and pointers to structures.</span></span> <span data-ttu-id="ef1a7-107">Schnittstellenzeiger verwenden Sie die Referenz zählen Mechanismus über **IUnknown**implementiert.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-107">Interface pointers use the reference counting mechanism implemented through **IUnknown**.</span></span> <span data-ttu-id="ef1a7-108">Verwenden Sie beim Zuordnen und Freigeben von nicht-MAPI-Speicher intern innerhalb einer Clientanwendung oder -Dienstanbieter verbunden, geeigneter Mechanismus sinnvoll ist.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-108">When allocating and freeing non-MAPI related memory internally within a client application or service provider, use whatever mechanism makes sense.</span></span> 
  
<span data-ttu-id="ef1a7-109">Das Modell definiert Parameter als eine der drei Typen.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-109">The model defines parameters as one of three types.</span></span> <span data-ttu-id="ef1a7-110">Sie können Eingaben werden Parameter, festgelegt vom Anrufer mit Informationen, die von der aufgerufenen Funktion oder Methode verwendet werden Ausgabeparameter, von der aufgerufenen Funktion oder Methode festgelegt und an den Anrufer oder Input-Output-Parameter, eine Kombination aus den beiden Typen zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-110">They can be input parameters, set by the caller with information to be used by the called function or method, output parameters, set by the called function or method and returned to the caller, or input-output parameters, a combination of the two types.</span></span> <span data-ttu-id="ef1a7-111">Ausgabeparameter sind häufig Zeiger auf Daten oder Zeiger auf Zeiger auf Daten.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-111">Output parameters are frequently pointers to data or pointers to pointers to data.</span></span> <span data-ttu-id="ef1a7-112">Obwohl die aufgerufene Funktion zur Zuweisung von Daten für Ausgabeparameter zuständig ist, weist der Anrufer den Speicher für den Zeiger.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-112">Although the called function is responsible for allocating the data for output parameters, the caller allocates the memory for the pointer.</span></span> 
  
<span data-ttu-id="ef1a7-113">In der folgenden Tabelle werden die Regeln für das zuordnen und Freigeben von Arbeitsspeicher für diese Typen von Parametern erläutert.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-113">The rules for allocating and releasing memory for these types of parameters are explained in the following table.</span></span>
  
|<span data-ttu-id="ef1a7-114">**Typ**</span><span class="sxs-lookup"><span data-stu-id="ef1a7-114">**Type**</span></span>|<span data-ttu-id="ef1a7-115">**Zuweisung von virtuellem Speicher**</span><span class="sxs-lookup"><span data-stu-id="ef1a7-115">**Memory allocation**</span></span>|<span data-ttu-id="ef1a7-116">**Arbeitsspeicher-Version**</span><span class="sxs-lookup"><span data-stu-id="ef1a7-116">**Memory release**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="ef1a7-117">Eingabe</span><span class="sxs-lookup"><span data-stu-id="ef1a7-117">Input</span></span>  <br/> |<span data-ttu-id="ef1a7-118">Anrufer ist dafür verantwortlich, und einen Mechanismus verwenden kann.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-118">Caller is responsible and can use any mechanism.</span></span>  <br/> |<span data-ttu-id="ef1a7-119">Anrufer ist dafür verantwortlich, und einen Mechanismus verwenden kann.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-119">Caller is responsible and can use any mechanism.</span></span>  <br/> |
|<span data-ttu-id="ef1a7-120">Ausgabe</span><span class="sxs-lookup"><span data-stu-id="ef1a7-120">Output</span></span>  <br/> |<span data-ttu-id="ef1a7-121">Aufgerufene Funktion ist dafür verantwortlich, und muss **MAPIAllocateBuffer**verwenden.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-121">Called function is responsible and must use **MAPIAllocateBuffer**.</span></span> <span data-ttu-id="ef1a7-122">Weitere Informationen finden Sie unter [MAPIAllocateBuffer](mapiallocatebuffer.md).</span><span class="sxs-lookup"><span data-stu-id="ef1a7-122">For more information, see [MAPIAllocateBuffer](mapiallocatebuffer.md).</span></span>  <br/> |<span data-ttu-id="ef1a7-123">Anrufer ist dafür verantwortlich, und muss **MAPIFreeBuffer**verwenden.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-123">Caller is responsible and must use **MAPIFreeBuffer**.</span></span> <span data-ttu-id="ef1a7-124">Weitere Informationen finden Sie unter [MAPIFreeBuffer](mapifreebuffer.md).</span><span class="sxs-lookup"><span data-stu-id="ef1a7-124">For more information, see [MAPIFreeBuffer](mapifreebuffer.md).</span></span>  <br/> |
|<span data-ttu-id="ef1a7-125">Ein-/ Ausgabe</span><span class="sxs-lookup"><span data-stu-id="ef1a7-125">Input-output</span></span>  <br/> |<span data-ttu-id="ef1a7-126">Anrufer ist verantwortlich für die ursprüngliche Zuordnung und aufgerufene Funktion bei Bedarf neu zuordnen können **MAPIAllocateBuffer**verwenden.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-126">Caller is responsible for the initial allocation and called function can reallocate if necessary using **MAPIAllocateBuffer**.</span></span>  <br/> |<span data-ttu-id="ef1a7-127">Aufgerufene Funktion ist verantwortlich für die anfängliche freigeben, wenn Neubelegung notwendig wird.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-127">Called function is responsible for initial freeing if reallocation is necessary.</span></span> <span data-ttu-id="ef1a7-128">Anrufer muss den letzten Rückgabewert frei.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-128">Caller must free the final return value.</span></span>  <br/> |
   
<span data-ttu-id="ef1a7-129">Während der fehlerbedingungen müssen Implementierer Schnittstellenmethoden, da der Aufrufer im Allgemeinen keine Möglichkeit hat, diese zu bereinigen Ausgabe und Input Output-Parameter achten.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-129">During failure conditions, implementers of interface methods need to pay attention to output and input-output parameters because the caller generally has no way to clean them up.</span></span> <span data-ttu-id="ef1a7-130">Wenn ein Fehler zurückgegeben wird, darf klicken Sie dann jede Ausgabe oder Input Output-Parameter entweder gelassen werden am Wert initialisiert vom Anrufer oder einen Wert, die ohne alle Unternehmensbereiche der Aufrufer bereinigt werden können.</span><span class="sxs-lookup"><span data-stu-id="ef1a7-130">If an error is returned, then each output or input-output parameter must either be left at the value initialized by the caller or set to a value that can be cleaned up without any action on the part of the caller.</span></span> <span data-ttu-id="ef1a7-131">Beispielsweise einen Zeiger-Ausgabeparameter des `void ** ppv` muss bleiben, wie sie bei der Eingabe wurde oder auf NULL festgelegt werden kann ( `*ppv = NULL`).</span><span class="sxs-lookup"><span data-stu-id="ef1a7-131">For example, an output pointer-parameter of  `void ** ppv` must be left as it was on input or can be set to NULL (  `*ppv = NULL`).</span></span>
  

