---
title: Fungiert als ein Host-Adressbuchanbieter
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f06a1034-ee49-4a09-831e-9752713228a8
description: 'Letzte �nderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: cf52062eacbd13b45087df9d8558bffd43ccd744
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19791257"
---
# <a name="acting-as-a-host-address-book-provider"></a><span data-ttu-id="b5e55-103">Fungiert als ein Host-Adressbuchanbieter</span><span class="sxs-lookup"><span data-stu-id="b5e55-103">Acting as a Host Address Book Provider</span></span>

  
  
<span data-ttu-id="b5e55-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="b5e55-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="b5e55-105">Ein Hostanbieter ist Adressbuch-Dienstanbieter, die von anderen Anbietern Empfänger in den Containern enthält und setzt die Implementierung der Empfänger der anderen Anbieter ihre Wartung teilweise steuern.</span><span class="sxs-lookup"><span data-stu-id="b5e55-105">A host provider is an address book provider that includes recipients from other providers in its containers and relies on the implementation of the recipients by the other providers to partially control their maintenance.</span></span> <span data-ttu-id="b5e55-106">Ein Hostanbieter verwendet die Vorlage Bezeichner dieser fremden Empfänger, um die Daten für diese Empfänger Code im fremden Anbieter zu binden.</span><span class="sxs-lookup"><span data-stu-id="b5e55-106">A host provider uses the template identifiers of these foreign recipients to bind the data for these recipients to code in the foreign provider.</span></span> <span data-ttu-id="b5e55-107">Diese Bindungsprozess wird initiiert, wenn der Anbieter die Eigenschaft **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) eines Empfängers abgerufen und in einem Aufruf von [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md)übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="b5e55-107">This binding process is initiated when your provider retrieves the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property of a recipient and passes it in a call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
  
<span data-ttu-id="b5e55-108">Wenn Ihre Anrufe Anbieter **IMAPISupport::OpenTemplateID**, MAPI entspricht der **MAPIUID** innerhalb der Vorlagenbezeichner mit einer **MAPIUID** von einem Anbieter registriert und des Anbieters [OpenTemplateID](iablogon-opentemplateid.md) -Methode aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="b5e55-108">When your provider calls **IMAPISupport::OpenTemplateID**, MAPI matches the **MAPIUID** within the template identifier with a **MAPIUID** registered by a provider and calls the provider's [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) method.</span></span> <span data-ttu-id="b5e55-109">Der fremde Anbieter möglicherweise ein Zeiger auf Ihres Anbieters Property-Objekt ist eine eigene Implementierung Eigenschaft-Objekts zurückgegeben oder zu einer Implementierung umschließt, die vom Dienstanbieter-Objekt.</span><span class="sxs-lookup"><span data-stu-id="b5e55-109">The foreign provider might return a pointer to your provider's property object, to its own property object implementation, or to an implementation that wraps your provider's object.</span></span> <span data-ttu-id="b5e55-110">Der zurückgegebene Zeiger wird in den Inhalt des Parameters _LppMAPIPropNew_ platziert.</span><span class="sxs-lookup"><span data-stu-id="b5e55-110">The returned pointer is placed in the contents of the  _lppMAPIPropNew_ parameter.</span></span> 
  
<span data-ttu-id="b5e55-111">Vom Dienstanbieter kann, ob **IMAPISupport::OpenTemplateID** mit FILL_ENTRY Flag aufrufen möchten.</span><span class="sxs-lookup"><span data-stu-id="b5e55-111">Your provider can choose whether or not to call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag set.</span></span> <span data-ttu-id="b5e55-112">Legen Sie dieses Flag, wenn der Empfänger erstellt wird oder ein längeren Zeitraum abgelaufen ist, da der Anbieter die Eigenschaften des Empfängers aktualisiert wurde.</span><span class="sxs-lookup"><span data-stu-id="b5e55-112">Set this flag when the recipient is being created or when a long time has passed since your provider has refreshed the recipient's properties.</span></span> <span data-ttu-id="b5e55-113">Eine häufige Verwendung von FILL_ENTRY-Flag wird an einen Empfänger im Anbieter mit der ursprünglichen synchronisiert halten.</span><span class="sxs-lookup"><span data-stu-id="b5e55-113">A common use of the FILL_ENTRY flag is to keep a recipient in your provider synchronized with the original.</span></span> <span data-ttu-id="b5e55-114">Diese Art von Synchronisierungszeitplan implementieren, wird die Leistung verbessert.</span><span class="sxs-lookup"><span data-stu-id="b5e55-114">Implementing this type of synchronization schedule enhances performance.</span></span> 
  
 <span data-ttu-id="b5e55-115">**Um einen fremden Empfänger synchronisiert zu halten.**</span><span class="sxs-lookup"><span data-stu-id="b5e55-115">**To keep a foreign recipient synchronized**</span></span>
  
1. <span data-ttu-id="b5e55-116">Bestimmen einer angemessenen Zeitraum regelmäßig nach Updates suchen.</span><span class="sxs-lookup"><span data-stu-id="b5e55-116">Determine an appropriate interval for periodic updates.</span></span> 
    
2. <span data-ttu-id="b5e55-117">Zeitstempel jeder Anruf auf [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="b5e55-117">Timestamp each call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
    
3. <span data-ttu-id="b5e55-118">Überprüfen Sie, ob es ist erforderlich, führen Sie eine vollständige Aktualisierung basierend auf die Zeitspanne, die seit dem letzten Aufruf abgelaufen ist oder nicht.</span><span class="sxs-lookup"><span data-stu-id="b5e55-118">Evaluate whether or not it is necessary to perform a full update based on the amount of time that has expired since the last call.</span></span> <span data-ttu-id="b5e55-119">Wenn eine vollständige Aktualisierung erforderlich ist, rufen Sie **IMAPISupport::OpenTemplateID** mit dem FILL_ENTRY-Flag.</span><span class="sxs-lookup"><span data-stu-id="b5e55-119">If a full update is necessary, call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag.</span></span> <span data-ttu-id="b5e55-120">Wenn es nicht erforderlich ist, legen Sie die Kennzeichen nicht auf den Anruf.</span><span class="sxs-lookup"><span data-stu-id="b5e55-120">If it is not necessary, do not set the flag on the call.</span></span> 
    
<span data-ttu-id="b5e55-121">Wenn ein Client eine Anforderung für eine der Eigenschaften des Empfängers kopierten ernannt werden, kann vom Dienstanbieter auswählen, ob die Anforderung selbst verarbeiten oder verwenden Sie den Code, der vom fremden Provider.</span><span class="sxs-lookup"><span data-stu-id="b5e55-121">When a client makes a request for one of the copied recipient's properties, your provider can choose whether to handle the request itself or use the code supplied by the foreign provider.</span></span> <span data-ttu-id="b5e55-122">Des Anbieters den fremden Anbieter abgefangen werden am häufigsten zu erwarten, wenn nicht alle, Aufrufe von **IMAPIProp** außer [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span><span class="sxs-lookup"><span data-stu-id="b5e55-122">Your provider can expect the foreign provider to intercept most, if not all, calls to **IMAPIProp** except for [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span></span> <span data-ttu-id="b5e55-123">Ein Aufruf von **OpenProperty** Anfordern der **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md))-Eigenschaft ist immer an Ihren Anbieter weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="b5e55-123">A call to **OpenProperty** requesting the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property is always forwarded to your provider.</span></span>
  
 <span data-ttu-id="b5e55-124">**Zugriff auf Vorlage Bezeichner code**</span><span class="sxs-lookup"><span data-stu-id="b5e55-124">**To access template identifier code**</span></span>
  
1. <span data-ttu-id="b5e55-125">Öffnen Sie den Empfänger, und rufen Sie die [IMAPIProp::GetProps](imapiprop-getprops.md) -Methode zum Abrufen der Eigenschaft **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="b5e55-125">Open the recipient and call its [IMAPIProp::GetProps](imapiprop-getprops.md) method to retrieve the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property.</span></span> <span data-ttu-id="b5e55-126">Wenn **GetProps** fehlschlägt, da **PR_TEMPLATEID** nicht verfügbar ist, unterstützt der fremde Anbieter eine Vorlagenbezeichner und zugehörige Code für diesen Empfänger nicht.</span><span class="sxs-lookup"><span data-stu-id="b5e55-126">If **GetProps** fails because **PR_TEMPLATEID** is unavailable, the foreign provider does not support a template identifier and related code for this recipient.</span></span> <span data-ttu-id="b5e55-127">Der Anbieter muss seine Implementierung des Empfängers für alle Wartung verwenden.</span><span class="sxs-lookup"><span data-stu-id="b5e55-127">Your provider will need to use its implementation of the recipient for all maintenance.</span></span> 
    
2. <span data-ttu-id="b5e55-128">Wenn der Vorlagenbezeichner aus **GetProps**zurückgegeben wird, werden übergeben Sie es und einen Zeiger des Empfängers **IMAPIProp** Implementierung in einem Aufruf der **IMAPISupport::OpenTemplateID** -Methode.</span><span class="sxs-lookup"><span data-stu-id="b5e55-128">If the template identifier is returned from **GetProps**, pass it and a pointer to the recipient's **IMAPIProp** implementation in a call to the **IMAPISupport::OpenTemplateID** method.</span></span> <span data-ttu-id="b5e55-129">Legen Sie das Flag FILL_ENTRY, wenn die meisten oder alle Eigenschaften des Empfängers werden müssen aktualisierte, wie unter Zeitpunkt der Erstellung oder wenn sie eine Zeitlang nicht aktualisiert wurden.</span><span class="sxs-lookup"><span data-stu-id="b5e55-129">Set the FILL_ENTRY flag if most or all of the recipient's properties need to be updated, such as at creation time or if they have not been updated for a while.</span></span> 
    
3. <span data-ttu-id="b5e55-130">Wenn **OpenTemplateID** des fremden Anbieters **IMAPIProp** Implementierung zurückgibt, zurück an den Client einen Zeiger auf diese Implementierung.</span><span class="sxs-lookup"><span data-stu-id="b5e55-130">If **OpenTemplateID** returns the foreign provider's **IMAPIProp** implementation, return to the client a pointer to this implementation.</span></span> 
    
4. <span data-ttu-id="b5e55-131">Wenn **OpenTemplateID** keine Implementierung zurückgibt, in der Regel, da der fremde Anbieter nicht in das Profil ist zurück an den Client einen Zeiger auf die **IMAPIProp** Implementierung Ihres Anbieters.</span><span class="sxs-lookup"><span data-stu-id="b5e55-131">If **OpenTemplateID** does not return an implementation, typically because the foreign provider is not in the profile, return to the client a pointer to your provider's **IMAPIProp** implementation.</span></span> <span data-ttu-id="b5e55-132">Der Client sollte entwickelt, die Eigenschaften des Objekts entweder-Schnittstelle verwenden können.</span><span class="sxs-lookup"><span data-stu-id="b5e55-132">The client should be able to work with the object's properties using either interface.</span></span> 
    

