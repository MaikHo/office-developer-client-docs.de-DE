---
title: Fungieren als Host-Adressbuchanbieter
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f06a1034-ee49-4a09-831e-9752713228a8
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 202d4b4391de7553e39e50dc527df5502ebcefb3
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32331269"
---
# <a name="acting-as-a-host-address-book-provider"></a><span data-ttu-id="3079e-103">Fungieren als Host-Adressbuchanbieter</span><span class="sxs-lookup"><span data-stu-id="3079e-103">Acting as a Host Address Book Provider</span></span>

  
  
<span data-ttu-id="3079e-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3079e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3079e-105">Ein Hostanbieter ist ein Adressbuchanbieter, der Empfänger von anderen Anbietern in seinen Containern enthält und die Implementierung der Empfänger durch die anderen Anbieter verwendet, um die Wartung teilweise zu steuern.</span><span class="sxs-lookup"><span data-stu-id="3079e-105">A host provider is an address book provider that includes recipients from other providers in its containers and relies on the implementation of the recipients by the other providers to partially control their maintenance.</span></span> <span data-ttu-id="3079e-106">Ein Hostanbieter verwendet die Vorlagenbezeichner dieser fremden Empfänger, um die Daten für diese Empfänger an Code im fremden Anbieter zu binden.</span><span class="sxs-lookup"><span data-stu-id="3079e-106">A host provider uses the template identifiers of these foreign recipients to bind the data for these recipients to code in the foreign provider.</span></span> <span data-ttu-id="3079e-107">Dieser Bindungsprozess wird initiiert, wenn Ihr Anbieter die **PR_TEMPLATEID** ([pidtagtemplateid (](pidtagtemplateid-canonical-property.md))-Eigenschaft eines Empfängers abruft und diesen in einem Aufruf von [IMAPISupport::](imapisupport-opentemplateid.md)opentemplatecollection übergibt.</span><span class="sxs-lookup"><span data-stu-id="3079e-107">This binding process is initiated when your provider retrieves the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property of a recipient and passes it in a call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
  
<span data-ttu-id="3079e-108">Wenn Ihr Anbieter **IMAPISupport::** opentemplatecode aufruft, vergleicht MAPI die **MAPIUID** innerhalb des Vorlagen Bezeichners mit einem von einem Anbieter registrierten **MAPIUID** und ruft die [IABLogon:: OpenTemplate](iablogon-opentemplateid.md) -Methode des Anbieters auf.</span><span class="sxs-lookup"><span data-stu-id="3079e-108">When your provider calls **IMAPISupport::OpenTemplateID**, MAPI matches the **MAPIUID** within the template identifier with a **MAPIUID** registered by a provider and calls the provider's [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) method.</span></span> <span data-ttu-id="3079e-109">Der fremde Anbieter gibt möglicherweise einen Zeiger auf das Property-Objekt des Anbieters zurück, auf seine eigene Implementierung des Property-Objekts oder auf eine Implementierung, die das Objekt des Anbieters umschließt.</span><span class="sxs-lookup"><span data-stu-id="3079e-109">The foreign provider might return a pointer to your provider's property object, to its own property object implementation, or to an implementation that wraps your provider's object.</span></span> <span data-ttu-id="3079e-110">Der zurückgegebene Zeiger wird in den Inhalt des _lppMAPIPropNew_ -Parameters gesetzt.</span><span class="sxs-lookup"><span data-stu-id="3079e-110">The returned pointer is placed in the contents of the  _lppMAPIPropNew_ parameter.</span></span> 
  
<span data-ttu-id="3079e-111">Ihr Anbieter kann wählen, ob **IMAPISupport::** opentemplatecode mit dem FILL_ENTRY-Flagsatz aufgerufen werden soll.</span><span class="sxs-lookup"><span data-stu-id="3079e-111">Your provider can choose whether or not to call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag set.</span></span> <span data-ttu-id="3079e-112">Legen Sie dieses Flag fest, wenn der Empfänger erstellt wird oder wenn eine lange Zeit vergangen ist, seit der Anbieter die Eigenschaften des Empfängers aktualisiert hat.</span><span class="sxs-lookup"><span data-stu-id="3079e-112">Set this flag when the recipient is being created or when a long time has passed since your provider has refreshed the recipient's properties.</span></span> <span data-ttu-id="3079e-113">Eine häufige Verwendung des FILL_ENTRY-Flags besteht darin, dass ein Empfänger in Ihrem Anbieter mit dem Original synchronisiert bleibt.</span><span class="sxs-lookup"><span data-stu-id="3079e-113">A common use of the FILL_ENTRY flag is to keep a recipient in your provider synchronized with the original.</span></span> <span data-ttu-id="3079e-114">Durch die Implementierung dieses Typs des Synchronisierungszeitplans wird die Leistung verbessert.</span><span class="sxs-lookup"><span data-stu-id="3079e-114">Implementing this type of synchronization schedule enhances performance.</span></span> 
  
 <span data-ttu-id="3079e-115">**So halten Sie einen fremden Empfänger synchronisiert**</span><span class="sxs-lookup"><span data-stu-id="3079e-115">**To keep a foreign recipient synchronized**</span></span>
  
1. <span data-ttu-id="3079e-116">Bestimmen Sie ein entsprechendes Intervall für regelmäßige Aktualisierungen.</span><span class="sxs-lookup"><span data-stu-id="3079e-116">Determine an appropriate interval for periodic updates.</span></span> 
    
2. <span data-ttu-id="3079e-117">Zeitstempel für jeden Aufruf von [IMAPISupport::](imapisupport-opentemplateid.md)opentemplatecode.</span><span class="sxs-lookup"><span data-stu-id="3079e-117">Timestamp each call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
    
3. <span data-ttu-id="3079e-118">Bewerten Sie, ob es erforderlich ist, eine vollständige Aktualisierung basierend auf der Zeitdauer auszuführen, die seit dem letzten Aufruf abgelaufen ist.</span><span class="sxs-lookup"><span data-stu-id="3079e-118">Evaluate whether or not it is necessary to perform a full update based on the amount of time that has expired since the last call.</span></span> <span data-ttu-id="3079e-119">Wenn eine vollständige Aktualisierung erforderlich ist, rufen Sie **IMAPISupport::** opentemplatecode mit dem FILL_ENTRY-Flag auf.</span><span class="sxs-lookup"><span data-stu-id="3079e-119">If a full update is necessary, call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag.</span></span> <span data-ttu-id="3079e-120">Wenn dies nicht erforderlich ist, legen Sie die Kennzeichnung für den Anruf nicht fest.</span><span class="sxs-lookup"><span data-stu-id="3079e-120">If it is not necessary, do not set the flag on the call.</span></span> 
    
<span data-ttu-id="3079e-121">Wenn ein Client eine Anforderung für eine der Eigenschaften des kopierten Empfängers stellt, kann der Anbieter auswählen, ob die Anforderung selbst verarbeitet werden soll, oder den vom fremden Anbieter bereitgestellten Code verwenden.</span><span class="sxs-lookup"><span data-stu-id="3079e-121">When a client makes a request for one of the copied recipient's properties, your provider can choose whether to handle the request itself or use the code supplied by the foreign provider.</span></span> <span data-ttu-id="3079e-122">Ihr Anbieter kann davon ausgehen, dass der ausländische Anbieter die meisten, wenn nicht alle, Aufrufe an **IMAPIProp** abfängt, mit Ausnahme von [IMAPIProp:: OpenProperty](imapiprop-openproperty.md).</span><span class="sxs-lookup"><span data-stu-id="3079e-122">Your provider can expect the foreign provider to intercept most, if not all, calls to **IMAPIProp** except for [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span></span> <span data-ttu-id="3079e-123">Ein Aufruf von **OpenProperty** , der die **PR_DETAILS_TABLE** ([pidtagdetailstable (](pidtagdetailstable-canonical-property.md))-Eigenschaft anfordert, wird immer an Ihren Anbieter weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="3079e-123">A call to **OpenProperty** requesting the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property is always forwarded to your provider.</span></span>
  
 <span data-ttu-id="3079e-124">**So greifen Sie auf den Code der Vorlagenkennung zu**</span><span class="sxs-lookup"><span data-stu-id="3079e-124">**To access template identifier code**</span></span>
  
1. <span data-ttu-id="3079e-125">Öffnen Sie den Empfänger, und rufen Sie die [IMAPIProp::](imapiprop-getprops.md) GetProps-Methode auf, um die **PR_TEMPLATEID** ([pidtagtemplateid (](pidtagtemplateid-canonical-property.md))-Eigenschaft abzurufen.</span><span class="sxs-lookup"><span data-stu-id="3079e-125">Open the recipient and call its [IMAPIProp::GetProps](imapiprop-getprops.md) method to retrieve the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property.</span></span> <span data-ttu-id="3079e-126">Wenn \*\*\*\* GetProps fehlschlägt, weil **PR_TEMPLATEID** nicht verfügbar ist, unterstützt der ausländische Anbieter keinen Vorlagenbezeichner und zugehörigen Code für diesen Empfänger.</span><span class="sxs-lookup"><span data-stu-id="3079e-126">If **GetProps** fails because **PR_TEMPLATEID** is unavailable, the foreign provider does not support a template identifier and related code for this recipient.</span></span> <span data-ttu-id="3079e-127">Ihr Anbieter muss seine Implementierung des Empfängers für alle Wartungsarbeiten verwenden.</span><span class="sxs-lookup"><span data-stu-id="3079e-127">Your provider will need to use its implementation of the recipient for all maintenance.</span></span> 
    
2. <span data-ttu-id="3079e-128">Wenn der Vorlagenbezeichner von getProps zurückgegeben wird, führen Sie ihn und einen Zeiger auf die **IMAPIProp** -Implementierung des Empfängers in einem Aufruf der **IMAPISupport::** opentemplatecollection-Methode. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="3079e-128">If the template identifier is returned from **GetProps**, pass it and a pointer to the recipient's **IMAPIProp** implementation in a call to the **IMAPISupport::OpenTemplateID** method.</span></span> <span data-ttu-id="3079e-129">Legen Sie das FILL_ENTRY-Flag fest, wenn die meisten oder alle Eigenschaften des Empfängers aktualisiert werden müssen, beispielsweise zum Zeitpunkt der Erstellung oder wenn Sie für eine Weile nicht aktualisiert wurden.</span><span class="sxs-lookup"><span data-stu-id="3079e-129">Set the FILL_ENTRY flag if most or all of the recipient's properties need to be updated, such as at creation time or if they have not been updated for a while.</span></span> 
    
3. <span data-ttu-id="3079e-130">Wenn \*\*\*\* opentemplatecollection die **IMAPIProp** -Implementierung des fremden Anbieters zurückgibt, kehren Sie zum Client einen Zeiger auf diese Implementierung zurück.</span><span class="sxs-lookup"><span data-stu-id="3079e-130">If **OpenTemplateID** returns the foreign provider's **IMAPIProp** implementation, return to the client a pointer to this implementation.</span></span> 
    
4. <span data-ttu-id="3079e-131">Wenn \*\*\*\* opentemplatecollection keine Implementierung zurückgibt, in der Regel, weil der fremde Anbieter nicht im Profil ist, kehren Sie zum Client einen Zeiger auf die **IMAPIProp** -Implementierung Ihres Anbieters zurück.</span><span class="sxs-lookup"><span data-stu-id="3079e-131">If **OpenTemplateID** does not return an implementation, typically because the foreign provider is not in the profile, return to the client a pointer to your provider's **IMAPIProp** implementation.</span></span> <span data-ttu-id="3079e-132">Der Client sollte in der Lage sein, mit den Eigenschaften des Objekts über eine der beiden Schnittstellen zu arbeiten.</span><span class="sxs-lookup"><span data-stu-id="3079e-132">The client should be able to work with the object's properties using either interface.</span></span> 
    

