---
title: Registrieren für eine Benachrichtigung
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 45625387-dbd2-4ca8-926b-ef87998d01d7
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: ccc2758b59a9227afbc50360102e793892bbdc52
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424903"
---
# <a name="registering-for-a-notification"></a><span data-ttu-id="9664c-103">Registrieren für eine Benachrichtigung</span><span class="sxs-lookup"><span data-stu-id="9664c-103">Registering for a Notification</span></span>

  
  
<span data-ttu-id="9664c-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="9664c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="9664c-105">Ein Client kann im Rahmen seines Initialisierungsvorgangs für Adressbuch-oder Nachrichtenspeicher Benachrichtigungen registrieren.</span><span class="sxs-lookup"><span data-stu-id="9664c-105">A client can register for address book or message store notifications as part of its initialization process.</span></span>
  
<span data-ttu-id="9664c-106">MAPI unterstützt Benachrichtigungen im Adressbuch, unabhängig davon, ob der Adressbuchanbieter Sie unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9664c-106">MAPI supports notification on the address book regardless of whether any of the address book providers support it.</span></span> <span data-ttu-id="9664c-107">Die Unterstützung für Benachrichtigungen in Nachrichtenspeicher hängt vom jeweiligen Nachrichtenspeicher Anbieter ab.</span><span class="sxs-lookup"><span data-stu-id="9664c-107">Support for notification on message stores depends on the particular message store provider.</span></span> <span data-ttu-id="9664c-108">Um zu ermitteln, ob ein bestimmter Nachrichtenspeicher Anbieter Benachrichtigungen unterstützt, überprüfen Sie die **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md))-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="9664c-108">To determine whether a particular message store provider supports notifications, check its **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span> <span data-ttu-id="9664c-109">Wenn der Nachrichtenspeicher Benachrichtigungen unterstützt, wird das STORE_NOTIFY_OK-Bit festgelegt.</span><span class="sxs-lookup"><span data-stu-id="9664c-109">If the message store supports notifications, the STORE_NOTIFY_OK bit will be set.</span></span> 
  
<span data-ttu-id="9664c-110">Registrieren Sie sich für Benachrichtigungen, indem Sie die **Advise** -Methode eines Advise-Quellobjekts aufrufen.</span><span class="sxs-lookup"><span data-stu-id="9664c-110">Register for notifications by calling an advise source object's **Advise** method.</span></span> <span data-ttu-id="9664c-111">Viele Objekte implementieren **Advise** und Clients können sich auf verschiedene Arten bei diesen Objekten registrieren.</span><span class="sxs-lookup"><span data-stu-id="9664c-111">Many objects implement **Advise** and clients can register with those objects in a variety of ways.</span></span> 
  
 <span data-ttu-id="9664c-112">**So registrieren Sie sich für eine Benachrichtigung**</span><span class="sxs-lookup"><span data-stu-id="9664c-112">**To register for a notification**</span></span>
  
1. <span data-ttu-id="9664c-113">Erstellen Sie ein MAPI-Advise-Objekt, und erhöhen Sie den Verweiszähler.</span><span class="sxs-lookup"><span data-stu-id="9664c-113">Create a MAPI advise sink object and increment its reference count.</span></span>
    
2. <span data-ttu-id="9664c-114">Rufen Sie gegebenenfalls [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) auf, um ein Advise-Senke-Objekt zu erstellen, das Ihre ursprüngliche Advise-Senke umschließt, und geben Sie dann die ursprüngliche Beratungs Senke frei..</span><span class="sxs-lookup"><span data-stu-id="9664c-114">If appropriate, call [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) to create an advise sink object that wraps your original advise sink, then release the original advice sink..</span></span> 
    
3. <span data-ttu-id="9664c-115">Rufen Sie eine der folgenden \*\*\*\* Methoden zum Abschließen der Registrierung auf:</span><span class="sxs-lookup"><span data-stu-id="9664c-115">Call one of the following **Advise** methods to complete the registration:</span></span> 
    
  - <span data-ttu-id="9664c-116">Rufen Sie [IMAPISession:: Advise](imapisession-advise.md) an, um sich für Sitzungs Benachrichtigungen oder für Benachrichtigungen in einem Adressbuch-oder Nachrichtenspeicherobjekt zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="9664c-116">Call [IMAPISession::Advise](imapisession-advise.md) to register for session notifications or for notifications on an address book or message store object.</span></span> 
    
  - <span data-ttu-id="9664c-117">Call [IAddrBook:: Advise](iaddrbook-advise.md) to Register for Address Book notifications or for Notifications on a Messaging User, Container, or Distribution List.</span><span class="sxs-lookup"><span data-stu-id="9664c-117">Call [IAddrBook::Advise](iaddrbook-advise.md) to register for address book notifications or for notifications on a messaging user, container, or distribution list.</span></span> 
    
  - <span data-ttu-id="9664c-118">Rufen Sie [IABLogon:: Raten](iablogon-advise.md) Sie auf, sich direkt bei einem Adressbuchanbieter für Benachrichtigungen für einen Messagingbenutzer,-Container oder eine Verteilerliste zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="9664c-118">Call [IABLogon::Advise](iablogon-advise.md) to register directly with an address book provider for notifications on a messaging user, container, or distribution list.</span></span> 
    
  - <span data-ttu-id="9664c-119">Rufen Sie [IMsgStore:: Advise](imsgstore-advise.md) an, um Benachrichtigungen für Nachrichtenspeicher oder Benachrichtigungen für einen Ordner oder eine Nachricht zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="9664c-119">Call [IMsgStore::Advise](imsgstore-advise.md) to register for message store notifications or for notifications on a folder or message.</span></span> 
    
  - <span data-ttu-id="9664c-120">Rufen Sie [IMSLogon:: Raten](imslogon-advise.md) Sie auf, sich direkt bei einem Nachrichtenspeicher Anbieter für Benachrichtigungen zu einem Ordner oder einer Nachricht zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="9664c-120">Call [IMSLogon::Advise](imslogon-advise.md) to register directly with a message store provider for notifications on a folder or message.</span></span> 
    
  - <span data-ttu-id="9664c-121">Rufen Sie [IMAPITable:: Advise](imapitable-advise.md) auf, um Tabellen Benachrichtigungen zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="9664c-121">Call [IMAPITable::Advise](imapitable-advise.md) to register for table notifications.</span></span> 
    
4. <span data-ttu-id="9664c-122">Zwischenspeichern der von **Advise**zurückgegebenen Verbindungsnummer.</span><span class="sxs-lookup"><span data-stu-id="9664c-122">Cache the connection number returned from **Advise**.</span></span>
    
5. <span data-ttu-id="9664c-123">Wenn Sie eine verpackte Advise-Senke verwenden, lassen Sie sie los.</span><span class="sxs-lookup"><span data-stu-id="9664c-123">If using a wrapped advise sink, release it.</span></span> <span data-ttu-id="9664c-124">Nachdem die eingebundene Advise-Senke registriert wurde, benötigen Sie Sie nicht mehr.</span><span class="sxs-lookup"><span data-stu-id="9664c-124">Once the wrapped advise sink is registered, you no longer need it.</span></span>
    
<span data-ttu-id="9664c-125">Durch Aufrufen von \* \* IMAPISession:: Advise \* \* können Sie sich für kritische Fehlerbenachrichtigungen in der Gesamt Sitzung oder für verschiedene Benachrichtigungen für einzelne Objekte registrieren.</span><span class="sxs-lookup"><span data-stu-id="9664c-125">Calling \*\* IMAPISession::Advise \*\* enables you to register for critical error notifications on the overall session or for various notifications on individual objects.</span></span> <span data-ttu-id="9664c-126">Sitzungen senden wichtige Fehlerbenachrichtigungen an Clients, die bei freigegebenen Sitzungen angemeldet sind, wenn ein anderer Client, der die freigegebene Sitzung verwendet, die [IMAPISession:: Abmelde](imapisession-logoff.md) Methode aufruft.</span><span class="sxs-lookup"><span data-stu-id="9664c-126">Sessions send critical error notifications to clients logged on to shared sessions when another client using the shared session calls the [IMAPISession::Logoff](imapisession-logoff.md) method.</span></span> <span data-ttu-id="9664c-127">Um sich für Sitzungs Benachrichtigungen zu registrieren, übergeben Sie NULL für den Parameter Entry Identifier.</span><span class="sxs-lookup"><span data-stu-id="9664c-127">To register for session notifications, pass NULL for the entry identifier parameter.</span></span> <span data-ttu-id="9664c-128">Um Benachrichtigungen für ein einzelnes Objekt zu registrieren, müssen Sie die Eintrags-ID des Objekts weiterleiten.</span><span class="sxs-lookup"><span data-stu-id="9664c-128">To register for notifications on an individual object, pass the object's entry identifier.</span></span> <span data-ttu-id="9664c-129">Die **IMAPISession** -Methode leitet den Aufruf an den entsprechenden Dienstanbieter weiter, der durch den **MAPIUID** -Teil der Eintrags-ID bestimmt wird.</span><span class="sxs-lookup"><span data-stu-id="9664c-129">The **IMAPISession** method forwards the call to the appropriate service provider, as determined by the **MAPIUID** portion of the entry identifier.</span></span> <span data-ttu-id="9664c-130">Das Aufrufen von **IMAPISession:: Advise** to Register for Object Notifications ist einfacher als das Aufrufen der **Advise** -Methode eines Dienstanbieters.</span><span class="sxs-lookup"><span data-stu-id="9664c-130">Calling **IMAPISession::Advise** to register for object notifications is simpler than calling a service provider's **Advise** method.</span></span> 
  
<span data-ttu-id="9664c-131">Die Registrierung beim Adressbuch ähnelt der Registrierung für die Sitzung.</span><span class="sxs-lookup"><span data-stu-id="9664c-131">Registering with the address book is similar to registering with the session.</span></span> <span data-ttu-id="9664c-132">Wenn Sie sich für eine kritische Fehlerbenachrichtigung aus dem Adressbuch registrieren möchten, führen Sie NULL für die Eintrags-ID aus.</span><span class="sxs-lookup"><span data-stu-id="9664c-132">To register for critical error notification from the address book, pass NULL for the entry identifier.</span></span> <span data-ttu-id="9664c-133">Um Benachrichtigungen für ein bestimmtes Adressbuchobjekt zu registrieren, geben Sie die entsprechende Eintrags-ID und das Ereignis oder die Ereignisse von Interesse an.</span><span class="sxs-lookup"><span data-stu-id="9664c-133">To register for notifications on a particular address book object, specify the appropriate entry identifier and event or events of interest.</span></span> <span data-ttu-id="9664c-134">Beachten Sie, dass viele Adressbuchanbieter Benachrichtigungen für einzelne Objekte nicht unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9664c-134">Be aware that many address book providers do not support notifications on individual objects.</span></span> <span data-ttu-id="9664c-135">Sie unterstützen vielmehr Tabellen Benachrichtigungen für Ihre Inhalts-und Hierarchietabellen.</span><span class="sxs-lookup"><span data-stu-id="9664c-135">Rather, they support table notifications on their contents and hierarchy tables.</span></span> 
  
<span data-ttu-id="9664c-136">Es empfiehlt sich, die Advise-Senke, die Sie mit [HrAllocAdviseSink](hrallocadvisesink.md) implementieren oder erstellen, unmittelbar nach einer erfolgreichen Rückkehr aus einem **Advise** -Aufruf zu veröffentlichen.</span><span class="sxs-lookup"><span data-stu-id="9664c-136">It is good practice to release the advise sink that you implement or create with [HrAllocAdviseSink](hrallocadvisesink.md) immediately after a successful return from an **Advise** call.</span></span> <span data-ttu-id="9664c-137">Dies liegt daran, dass Dienstanbieter Ihre Advise-Senke nach dem **Advise** -Aufruf freigeben können, aber bevor \*\*\*\* ein Unadvise-Anruf getätigt wird.</span><span class="sxs-lookup"><span data-stu-id="9664c-137">This is because it is possible for service providers to release your advise sink after the **Advise** call, but before an **Unadvise** call is made.</span></span> <span data-ttu-id="9664c-138">Sobald Sie der Advise-Quelle einen Zeiger auf Ihre Advise-Senke gegeben haben und die Referenzanzahl für diese Advise-Senke erhöht wurde, ist es ratsam, Sie freizugeben, es sei denn, Sie haben eine langfristige Verwendung dafür.</span><span class="sxs-lookup"><span data-stu-id="9664c-138">Once you have given the advise source a pointer to your advise sink and the reference count has been incremented on this advise sink, it is wise to release it unless you have a long term use for it.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="9664c-139">Alle Verbindungsnummern, die gültige Beratungs Registrierungen darstellen, werden erst freigegeben \*\*\*\* , wenn der Unadvise-Aufruf erfolgt ist.</span><span class="sxs-lookup"><span data-stu-id="9664c-139">All connection numbers that represent valid advisory registrations will not be released until the **Unadvise** call is made.</span></span> 
  

