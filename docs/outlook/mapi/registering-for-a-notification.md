---
title: Registrieren für eine Benachrichtigung
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 45625387-dbd2-4ca8-926b-ef87998d01d7
description: 'Letzte �nderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 2d01527bb3c5176087aabeb69dbc8d99738df772
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19795372"
---
# <a name="registering-for-a-notification"></a><span data-ttu-id="08e02-103">Registrieren für eine Benachrichtigung</span><span class="sxs-lookup"><span data-stu-id="08e02-103">Registering for a Notification</span></span>

  
  
<span data-ttu-id="08e02-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="08e02-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="08e02-105">Ein Client kann als Teil der Initialisierungsprozesses für Address Book oder einer Nachricht Store Benachrichtigungen registrieren.</span><span class="sxs-lookup"><span data-stu-id="08e02-105">A client can register for address book or message store notifications as part of its initialization process.</span></span>
  
<span data-ttu-id="08e02-106">MAPI unterstützt Benachrichtigung auf das Adressbuch, unabhängig davon, ob eines der adressbuchanbietern implementierte unterstützen.</span><span class="sxs-lookup"><span data-stu-id="08e02-106">MAPI supports notification on the address book regardless of whether any of the address book providers support it.</span></span> <span data-ttu-id="08e02-107">Unterstützung für die Benachrichtigung auf Nachrichtenspeicher hängt von dem Anbieter für bestimmte Nachricht anmelden.</span><span class="sxs-lookup"><span data-stu-id="08e02-107">Support for notification on message stores depends on the particular message store provider.</span></span> <span data-ttu-id="08e02-108">Überprüfen Sie die **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md))-Eigenschaft, um zu bestimmen, ob eine bestimmte Nachricht Speicheranbieter Benachrichtigungen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="08e02-108">To determine whether a particular message store provider supports notifications, check its **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span> <span data-ttu-id="08e02-109">Wenn der Nachrichtenspeicher Benachrichtigungen unterstützt, wird das Bit STORE_NOTIFY_OK festgelegt.</span><span class="sxs-lookup"><span data-stu-id="08e02-109">If the message store supports notifications, the STORE_NOTIFY_OK bit will be set.</span></span> 
  
<span data-ttu-id="08e02-110">Registrieren Sie sich für Benachrichtigungen, durch eine Advise-Quellobjekt **Advise** -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="08e02-110">Register for notifications by calling an advise source object's **Advise** method.</span></span> <span data-ttu-id="08e02-111">Viele Objekte **Advise** implementieren, und Clients können mit diesen Objekten in verschiedene Arten registrieren.</span><span class="sxs-lookup"><span data-stu-id="08e02-111">Many objects implement **Advise** and clients can register with those objects in a variety of ways.</span></span> 
  
 <span data-ttu-id="08e02-112">**Registrieren für eine Benachrichtigung**</span><span class="sxs-lookup"><span data-stu-id="08e02-112">**To register for a notification**</span></span>
  
1. <span data-ttu-id="08e02-113">Erstellen von MAPI advise-Empfängerobjekt und erhöht den Referenzzähler.</span><span class="sxs-lookup"><span data-stu-id="08e02-113">Create a MAPI advise sink object and increment its reference count.</span></span>
    
2. <span data-ttu-id="08e02-114">Gegebenenfalls [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) um ein Advise-Empfängerobjekt zu erstellen, der Ihrer ursprünglichen Advise-Empfänger umbrochen wird und dann den ursprünglichen Empfänger Ratschläge für die Version.</span><span class="sxs-lookup"><span data-stu-id="08e02-114">If appropriate, call [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) to create an advise sink object that wraps your original advise sink, then release the original advice sink..</span></span> 
    
3. <span data-ttu-id="08e02-115">Rufen Sie eine der folgenden Methoden **Advise** zur Durchführung der Registrierung:</span><span class="sxs-lookup"><span data-stu-id="08e02-115">Call one of the following **Advise** methods to complete the registration:</span></span> 
    
  - <span data-ttu-id="08e02-116">Rufen Sie [IMAPISession::Advise](imapisession-advise.md) für Sitzung Benachrichtigungen oder für Benachrichtigungen für ein Objekt Address Book oder einer Nachricht Store zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="08e02-116">Call [IMAPISession::Advise](imapisession-advise.md) to register for session notifications or for notifications on an address book or message store object.</span></span> 
    
  - <span data-ttu-id="08e02-117">Rufen Sie [IAddrBook::Advise](iaddrbook-advise.md) für Address Book Benachrichtigungen oder für Benachrichtigungen messaging Benutzer, Container oder Verteilung Liste zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="08e02-117">Call [IAddrBook::Advise](iaddrbook-advise.md) to register for address book notifications or for notifications on a messaging user, container, or distribution list.</span></span> 
    
  - <span data-ttu-id="08e02-118">Rufen Sie [IABLogon::Advise](iablogon-advise.md) direkt mit Adressbuch-Dienstanbieter für Benachrichtigungen messaging Benutzer, Container oder Verteilung Liste registrieren.</span><span class="sxs-lookup"><span data-stu-id="08e02-118">Call [IABLogon::Advise](iablogon-advise.md) to register directly with an address book provider for notifications on a messaging user, container, or distribution list.</span></span> 
    
  - <span data-ttu-id="08e02-119">Rufen Sie [IMsgStore::Advise](imsgstore-advise.md) für Benachrichtigungen über Textnachrichten Store oder für Benachrichtigungen auf einen Ordner oder eine Nachricht zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="08e02-119">Call [IMsgStore::Advise](imsgstore-advise.md) to register for message store notifications or for notifications on a folder or message.</span></span> 
    
  - <span data-ttu-id="08e02-120">Rufen Sie [IMSLogon::Advise](imslogon-advise.md) direkt mit einem Message-Anbieter für Benachrichtigungen auf einen Ordner oder eine Nachricht zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="08e02-120">Call [IMSLogon::Advise](imslogon-advise.md) to register directly with a message store provider for notifications on a folder or message.</span></span> 
    
  - <span data-ttu-id="08e02-121">Rufen Sie [IMAPITable::Advise](imapitable-advise.md) für Tabelle Benachrichtigungen registriert.</span><span class="sxs-lookup"><span data-stu-id="08e02-121">Call [IMAPITable::Advise](imapitable-advise.md) to register for table notifications.</span></span> 
    
4. <span data-ttu-id="08e02-122">Zwischenspeichern von **Advise**zurückgegebene Verbindungsnummer.</span><span class="sxs-lookup"><span data-stu-id="08e02-122">Cache the connection number returned from **Advise**.</span></span>
    
5. <span data-ttu-id="08e02-123">Wenn Sie eine gepackten Advise-Empfänger verwenden, freigeben.</span><span class="sxs-lookup"><span data-stu-id="08e02-123">If using a wrapped advise sink, release it.</span></span> <span data-ttu-id="08e02-124">Sobald der gepackten Advise-Empfänger registriert ist, werden nicht mehr es benötigen.</span><span class="sxs-lookup"><span data-stu-id="08e02-124">Once the wrapped advise sink is registered, you no longer need it.</span></span>
    
<span data-ttu-id="08e02-125">Aufrufen von ** IMAPISession::Advise ** können Sie für kritische Fehler Benachrichtigungen auf die gesamte Sitzung oder für verschiedene Benachrichtigungen für einzelne Objekte zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="08e02-125">Calling ** IMAPISession::Advise ** enables you to register for critical error notifications on the overall session or for various notifications on individual objects.</span></span> <span data-ttu-id="08e02-126">Sitzungen senden Schwerwiegender Fehler Benachrichtigungen an Clients angemeldet sind auf freigegebene Sitzungen, wenn ein anderer Client mit freigegebenen Sitzung die [IMAPISession::Logoff](imapisession-logoff.md) -Methode aufruft.</span><span class="sxs-lookup"><span data-stu-id="08e02-126">Sessions send critical error notifications to clients logged on to shared sessions when another client using the shared session calls the [IMAPISession::Logoff](imapisession-logoff.md) method.</span></span> <span data-ttu-id="08e02-127">Um für die Sitzung Benachrichtigungen zu registrieren, übergeben Sie NULL für den Eintrag ID-Parameter.</span><span class="sxs-lookup"><span data-stu-id="08e02-127">To register for session notifications, pass NULL for the entry identifier parameter.</span></span> <span data-ttu-id="08e02-128">Übergeben Sie zum Registrieren für Benachrichtigungen auf ein einzelnes Objekt Eintrags-ID für das Objekt.</span><span class="sxs-lookup"><span data-stu-id="08e02-128">To register for notifications on an individual object, pass the object's entry identifier.</span></span> <span data-ttu-id="08e02-129">Die **IMAPISession** -Methode leitet den Anruf an den entsprechenden Dienstanbieter, wie durch den **MAPIUID** Teil der Eintrags-ID bestimmt.</span><span class="sxs-lookup"><span data-stu-id="08e02-129">The **IMAPISession** method forwards the call to the appropriate service provider, as determined by the **MAPIUID** portion of the entry identifier.</span></span> <span data-ttu-id="08e02-130">Aufrufen von **IMAPISession::Advise** für Objekt Benachrichtigungen registriert ist einfacher als einem Dienstanbieter **Advise** -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="08e02-130">Calling **IMAPISession::Advise** to register for object notifications is simpler than calling a service provider's **Advise** method.</span></span> 
  
<span data-ttu-id="08e02-131">Registrieren mit dem Adressbuch ähnelt dem Registrieren mit der Sitzung.</span><span class="sxs-lookup"><span data-stu-id="08e02-131">Registering with the address book is similar to registering with the session.</span></span> <span data-ttu-id="08e02-132">Zum Registrieren für kritische Fehler Benachrichtigung aus dem Adressbuch, übergeben Sie NULL für die Eintrags-ID ein.</span><span class="sxs-lookup"><span data-stu-id="08e02-132">To register for critical error notification from the address book, pass NULL for the entry identifier.</span></span> <span data-ttu-id="08e02-133">Geben Sie zum Registrieren für Benachrichtigungen für ein bestimmtes Adresse Adressbuch-Objekt der entsprechenden Eintrags-ID und das Ereignis oder die Ereignisse von Interesse.</span><span class="sxs-lookup"><span data-stu-id="08e02-133">To register for notifications on a particular address book object, specify the appropriate entry identifier and event or events of interest.</span></span> <span data-ttu-id="08e02-134">Beachten Sie, dass viele adressbuchanbietern implementierte Benachrichtigungen nicht für einzelne Objekte unterstützen.</span><span class="sxs-lookup"><span data-stu-id="08e02-134">Be aware that many address book providers do not support notifications on individual objects.</span></span> <span data-ttu-id="08e02-135">Vielmehr unterstützen sie die Tabelle Benachrichtigungen auf ihren Inhalt und Hierarchietabellen.</span><span class="sxs-lookup"><span data-stu-id="08e02-135">Rather, they support table notifications on their contents and hierarchy tables.</span></span> 
  
<span data-ttu-id="08e02-136">Es wird empfohlen freizugebende Advise-Empfänger, den Sie implementieren, oder erstellen Sie mit [HrAllocAdviseSink](hrallocadvisesink.md) sofort nach dem erfolgreichen Beenden von einem **Advise** -Aufruf.</span><span class="sxs-lookup"><span data-stu-id="08e02-136">It is good practice to release the advise sink that you implement or create with [HrAllocAdviseSink](hrallocadvisesink.md) immediately after a successful return from an **Advise** call.</span></span> <span data-ttu-id="08e02-137">Dies ist, da es ist möglich für Dienstanbieter Advise-Empfänger nach dem Aufruf der **Advise** -Version, aber bevor ein **Unadvise** wird aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="08e02-137">This is because it is possible for service providers to release your advise sink after the **Advise** call, but before an **Unadvise** call is made.</span></span> <span data-ttu-id="08e02-138">Nachdem Sie der Advise-Quelle einen Zeiger, an der Advise-Empfänger gegeben haben und der Referenzzähler wurde auf diese Advise-Empfänger inkrementiert, ist es empfehlenswert, die sie freigeben, es sei denn, Sie haben eine langfristige dafür verwenden.</span><span class="sxs-lookup"><span data-stu-id="08e02-138">Once you have given the advise source a pointer to your advise sink and the reference count has been incremented on this advise sink, it is wise to release it unless you have a long term use for it.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="08e02-139">Alle Verbindung Zahlen, die gültige Advise Registrierungen darstellen werden nicht freigegeben werden, bis der Anruf **Unadvise** hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="08e02-139">All connection numbers that represent valid advisory registrations will not be released until the **Unadvise** call is made.</span></span> 
  

