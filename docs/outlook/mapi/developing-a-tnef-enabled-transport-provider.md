---
title: Entwickeln eines TNEF-fähigen Transport Anbieters
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7525eee1-4016-49b8-9509-5ebbe1db819f
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 282b1866699b695c647caedd130ce5abc1bcbc2c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439002"
---
# <a name="developing-a-tnef-enabled-transport-provider"></a><span data-ttu-id="7dc8e-103">Entwickeln eines TNEF-fähigen Transport Anbieters</span><span class="sxs-lookup"><span data-stu-id="7dc8e-103">Developing a TNEF-Enabled Transport Provider</span></span>

  
  
<span data-ttu-id="7dc8e-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="7dc8e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="7dc8e-105">Zur Förderung der Interoperabilität zwischen Messagingsystemen, die unterschiedliche MAPI-Funktionen unterstützen, stellt MAPI das Transport Neutral Encapsulation Format (TNEF) als Standardmethode zum Übertragen von Daten bereit.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-105">To promote interoperability between messaging systems that support different sets of MAPI features, MAPI provides the Transport Neutral Encapsulation Format (TNEF) as a standard way to transfer data.</span></span> <span data-ttu-id="7dc8e-106">Dieses Format kapselt MAPI-Eigenschaften, die nicht von einem zugrunde liegenden Messagingsystem unterstützt werden, in einen binären Datenstrom, der zusammen mit der Nachricht übertragen werden kann, wenn ein Transportanbieter Sie sendet.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-106">This format encapsulates MAPI properties not supported by an underlying messaging system into a binary stream that can be transferred along with the message when a transport provider sends it.</span></span> <span data-ttu-id="7dc8e-107">Der Transportanbieter, der die Nachricht empfängt, kann dann den binären Datenstrom decodieren, um alle Eigenschaften der ursprünglichen Nachricht abzurufen und für Clientanwendungen zur Verfügung zu stellen.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-107">The transport provider that receives the message can then decode the binary stream to retrieve all the properties of the original message and make them available to client applications.</span></span> <span data-ttu-id="7dc8e-108">Das Betriebsmodell für TNEF lautet:</span><span class="sxs-lookup"><span data-stu-id="7dc8e-108">The operational model for TNEF is:</span></span>
  
- <span data-ttu-id="7dc8e-109">Messaging-Clients senden und empfangen Nachrichten wie gewohnt an einen TNEF-Transport.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-109">Messaging clients submit and receive messages to a TNEF transport as normal.</span></span>
    
- <span data-ttu-id="7dc8e-110">Der Transport trennt die Eigenschaften von ausgehenden Nachrichten in zwei Kategorien: die, die vom zugrunde liegenden Nachrichtensystem unterstützt werden, und die nicht.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-110">The transport separates the properties on outgoing messages into two categories: those that the underlying message system supports and those that it does not.</span></span> <span data-ttu-id="7dc8e-111">Die Werte der Eigenschaften, die vom zugrunde liegenden Messagingsystem unterstützt werden, werden in das erforderliche Format übersetzt.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-111">The values of the properties that are supported by the underlying messaging system are translated into the required format.</span></span>
    
- <span data-ttu-id="7dc8e-112">Der Transport verwendet die MAPI-TNEF-Methoden, um alle nicht unterstützten Eigenschaften in einem einzelnen Datenstrom zu codieren.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-112">The transport uses the MAPI TNEF methods to encode any unsupported properties into a single data stream.</span></span> <span data-ttu-id="7dc8e-113">Der Transport wandelt dann diesen Datenstrom in eine spezielle Anlage der ausgehenden Nachricht um, wobei das Anlagenmodell des zugrunde liegenden Messagingsystems verwendet wird, bevor die Nachricht gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-113">The transport then turns that data stream into a special attachment on the outgoing message, using the underlying messaging system's attachment model, before sending the message.</span></span>
    
- <span data-ttu-id="7dc8e-114">Ein TNEF-fähiger Transport, der eine solche Nachricht empfängt, hat zwei Möglichkeiten.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-114">A TNEF enabled transport that receives such a message does two things.</span></span> <span data-ttu-id="7dc8e-115">Zunächst werden die Eigenschaften der eingehenden Nachricht, die vom zugrunde liegenden Nachrichtensystem unterstützt werden, in MAPI-Eigenschaften übersetzt.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-115">First, it translates the incoming message's properties — the ones supported by the underlying message system — into MAPI properties.</span></span> <span data-ttu-id="7dc8e-116">Zweitens verwendet es die MAPI-TNEF-Methoden, um zusätzliche MAPI-Eigenschaften aus der Anlage abzurufen, bevor die Nachricht an eine Clientanwendung übermittelt wird.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-116">Second, if the special attachment is present, it uses the MAPI TNEF methods to retrieve additional MAPI properties from the attachment before delivering the message to a client application.</span></span>
    
<span data-ttu-id="7dc8e-117">MAPI stellt eine Implementierung der **ITnef** -Schnittstelle zur Verwendung durch MAPI-Transportanbieter beim Arbeiten mit TNEF-Objekten bereit.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-117">MAPI supplies an implementation of the **ITnef** interface for use by MAPI transport providers when working with TNEF objects.</span></span> <span data-ttu-id="7dc8e-118">Die [OpenTnefStreamEx](opentnefstreamex.md) -Funktion wird verwendet, um TNEF-Objekte zu erstellen und diese einer Nachricht zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-118">The [OpenTnefStreamEx](opentnefstreamex.md) function is used to create TNEF objects and associate them with a message.</span></span> <span data-ttu-id="7dc8e-119">TNEF-Streams basieren auf der OLE **IStream** -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-119">TNEF streams are built on top of the OLE **IStream** interface</span></span> 
  
> [!NOTE]
> <span data-ttu-id="7dc8e-120">Verwenden Sie **OpenTnefStreamEx** zum Erstellen von TNEF-Objekten.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-120">You use **OpenTnefStreamEx** to create TNEF objects.</span></span> <span data-ttu-id="7dc8e-121">Die alte **OpenTnefStream** -Funktion ist weiterhin zur Kompatibilität mit altem Quellcode vorhanden und sollte in nichts neuem verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-121">The old **OpenTnefStream** function still exists for compatibility with old source code and should not be used in anything new.</span></span> 
  
<span data-ttu-id="7dc8e-122">Die **ITnef** -Schnittstelle stellt die folgenden Methoden bereit:</span><span class="sxs-lookup"><span data-stu-id="7dc8e-122">The **ITnef** interface provides the following methods:</span></span> 
  
- [<span data-ttu-id="7dc8e-123">AddProps</span><span class="sxs-lookup"><span data-stu-id="7dc8e-123">AddProps</span></span>](itnef-addprops.md)
    
- [<span data-ttu-id="7dc8e-124">EncodeRecips</span><span class="sxs-lookup"><span data-stu-id="7dc8e-124">EncodeRecips</span></span>](itnef-encoderecips.md)
    
- [<span data-ttu-id="7dc8e-125">ExtractProps</span><span class="sxs-lookup"><span data-stu-id="7dc8e-125">ExtractProps</span></span>](itnef-extractprops.md)
    
- [<span data-ttu-id="7dc8e-126">Finish</span><span class="sxs-lookup"><span data-stu-id="7dc8e-126">Finish</span></span>](itnef-finish.md)
    
- [<span data-ttu-id="7dc8e-127">FinishComponent</span><span class="sxs-lookup"><span data-stu-id="7dc8e-127">FinishComponent</span></span>](itnef-finishcomponent.md)
    
- [<span data-ttu-id="7dc8e-128">OpenTaggedBody</span><span class="sxs-lookup"><span data-stu-id="7dc8e-128">OpenTaggedBody</span></span>](itnef-opentaggedbody.md)
    
- [<span data-ttu-id="7dc8e-129">SetProps</span><span class="sxs-lookup"><span data-stu-id="7dc8e-129">SetProps</span></span>](itnef-setprops.md)
    
<span data-ttu-id="7dc8e-130">Das MAPI-TNEF-Implementierungsmodell unterstützt:</span><span class="sxs-lookup"><span data-stu-id="7dc8e-130">The MAPI TNEF implementation model supports:</span></span>
  
- <span data-ttu-id="7dc8e-131">Alle MAPI-Eigenschaften ohne Auswirkungen auf andere Nachrichteneigenschaften.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-131">All MAPI properties without affecting other message properties.</span></span> <span data-ttu-id="7dc8e-132">Damit MAPI-Nachrichten den Transport über ein Messagingsystem überstehen, müssen alle Eigenschaften gekapselt werden, die nicht als Eigenschaften des Messagingsystems codiert werden können.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-132">In order for MAPI messages to survive transport through a messaging system, all properties that cannot be encoded as properties of the messaging system must be encapsulated.</span></span> <span data-ttu-id="7dc8e-133">Da es fast nie zu dem Zeitpunkt bekannt ist, zu dem eine Nachricht gesendet wird, unabhängig davon, ob ein MAPI-kompatibler Client die Nachricht empfängt, ermöglicht das Kapselungs Schema einem Transportanbieter, nur die MAPI-Nachrichteneigenschaften zu codieren, die das Messagingsystem nicht nativ unterstützt.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-133">Because it is almost never known at the time a message is sent whether or not a MAPI-compliant client will receive the message, the encapsulation scheme allows a transport provider to encode only those MAPI message properties that the messaging system does not natively support.</span></span> <span data-ttu-id="7dc8e-134">Dies führt dazu, dass Nachrichten, die TNEF verwenden, nicht für Messagingsysteme, die nicht auf MAPI basieren, wie SMTP-basierte UNIX-Messagingsysteme, undurchsichtig sind.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-134">This means that messages which use TNEF are not "opaque" to messaging systems that are not based on MAPI such as SMTP-based UNIX messaging systems.</span></span> <span data-ttu-id="7dc8e-135">Diese Systeme erhalten die Eigenschaften, die Sie unterstützen, in welcher Weise auch immer, und andere Eigenschaften werden als codierter TNEF-Datenstrom empfangen.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-135">These systems receive the properties they support in whatever manner is typical for them, and other properties are received as an encoded TNEF data stream.</span></span> <span data-ttu-id="7dc8e-136">Der TNEF-Transportanbieter ist für die Differenzierung zwischen diesen beiden Eigenschaftensätzen und dem Senden der unterstützten Gruppe für das Messagingsystem verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-136">The TNEF transport provider is responsible for differentiating between these two sets of properties and sending the supported set in the proper manner for the messaging system.</span></span> <span data-ttu-id="7dc8e-137">TNEF stellt keine Annahmen hinsichtlich der von einem Messagingsystem bereitgestellten Unterstützungsstufe dar.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-137">TNEF makes no assumptions as to the level of support provided by a messaging system.</span></span> <span data-ttu-id="7dc8e-138">In den Beispielen für die TNEF-Verwendung in diesem Abschnitt wird jedoch davon ausgegangen, dass das Messagingsystem mindestens eine einzelne Anlage neben der Nachricht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-138">However, in the examples of TNEF usage included in this section, the assumption is made that the messaging system supports at least one single attachment aside from the message.</span></span> <span data-ttu-id="7dc8e-139">In einigen Fällen kann die Anlage nur über einen UUEncode-Stream unterstützt und als Teil des Nachrichtentexts übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-139">In some cases, the attachment can only be supported through a uuencoded stream and transmitted as part of the message text.</span></span> <span data-ttu-id="7dc8e-140">Nur in sehr seltenen Fällen wird das Messagingsystem so wenig Unterstützung für Nachrichteneigenschaften haben, dass die vollständige TNEF-Codierung aller Eigenschaften erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-140">Only in very rare circumstances will the messaging system have so little support for message properties that full TNEF encoding of all properties is necessary.</span></span>
    
- <span data-ttu-id="7dc8e-141">Ein Mechanismus zum bestimmen, ob ein TNEF-Stream für eine eingehende Nachricht zu der Nachricht gehört, basierend auf der MAPI-Eigenschaft **PR_TNEF_CORRELATION_KEY** ([pidtagtnefcorrelationkey (](pidtagtnefcorrelationkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="7dc8e-141">A mechanism for determining whether a TNEF stream on an incoming message belongs to the message, based on the MAPI property **PR_TNEF_CORRELATION_KEY** ([PidTagTnefCorrelationKey](pidtagtnefcorrelationkey-canonical-property.md)).</span></span> <span data-ttu-id="7dc8e-142">Diese Eigenschaft sollte sowohl im TNEF-Stream als auch in einem entsprechenden Nachrichtenkopf gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-142">This property should be found both in the TNEF stream and in an appropriate message header.</span></span> <span data-ttu-id="7dc8e-143">Wenn die Eigenschaft an beiden Stellen denselben Wert aufweist oder fehlt, wird davon ausgegangen, dass der TNEF-Stream zur Nachricht gehört.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-143">If the property has the same value in both places, or is missing in either place, the TNEF stream is assumed to belong to the message.</span></span> <span data-ttu-id="7dc8e-144">Andernfalls wird der TNEF-Stream ignoriert.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-144">Otherwise, the TNEF stream is ignored.</span></span> <span data-ttu-id="7dc8e-145">TNEF-aktivierte Übertragungen sind für die Auswahl eines Werts für diese Eigenschaft in ausgehenden Nachrichten und die Codierung in einem entsprechenden Nachrichtenkopf (beispielsweise der Message-ID:-Kopfzeile für SMTP-Nachrichten) und im TNEF-Datenstrom verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="7dc8e-145">TNEF enabled transports are responsible for choosing a value for this property on outbound messages and encoding it in an appropriate message header (for example, the Message-ID: header for SMTP messages) and in the TNEF stream.</span></span>
    

