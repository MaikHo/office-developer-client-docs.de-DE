---
title: Entwickeln eines TNEF-fähigen Transportanbieters
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7525eee1-4016-49b8-9509-5ebbe1db819f
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 9f80feecda219e3bcebbf8ceb346b5034e821470
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19791538"
---
# <a name="developing-a-tnef-enabled-transport-provider"></a><span data-ttu-id="ad1bc-103">Entwickeln eines TNEF-fähigen Transportanbieters</span><span class="sxs-lookup"><span data-stu-id="ad1bc-103">Developing a TNEF-Enabled Transport Provider</span></span>

  
  
<span data-ttu-id="ad1bc-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="ad1bc-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="ad1bc-105">Um Interoperabilität zwischen Messagingsystemen zu fördern, die unterschiedliche Gruppen von MAPI-Funktionen zu unterstützen, stellt MAPI Transport Neutral Encapsulation Format (TNEF) als standard Möglichkeit zum Übertragen von Daten an.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-105">To promote interoperability between messaging systems that support different sets of MAPI features, MAPI provides the Transport Neutral Encapsulation Format (TNEF) as a standard way to transfer data.</span></span> <span data-ttu-id="ad1bc-106">Dieses Format kapselt MAPI-Eigenschaften, die von einem zugrunde liegenden Messagingsystem in einen binären Datenstrom, der beim Senden eines Transportdienstes zusammen mit der Nachricht übertragen werden nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-106">This format encapsulates MAPI properties not supported by an underlying messaging system into a binary stream that can be transferred along with the message when a transport provider sends it.</span></span> <span data-ttu-id="ad1bc-107">Der Adressbuchhierarchie, die die Nachricht empfängt kann dann decodieren den binären Stream zum Abrufen aller Eigenschaften der ursprünglichen Nachricht und deren Clientanwendungen zur Verfügung zu stellen.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-107">The transport provider that receives the message can then decode the binary stream to retrieve all the properties of the original message and make them available to client applications.</span></span> <span data-ttu-id="ad1bc-108">Das betriebliche Modell für TNEF wird:</span><span class="sxs-lookup"><span data-stu-id="ad1bc-108">The operational model for TNEF is:</span></span>
  
- <span data-ttu-id="ad1bc-109">Messaging-Clients senden und Empfangen von Nachrichten in einem TNEF Transport wie gewohnt.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-109">Messaging clients submit and receive messages to a TNEF transport as normal.</span></span>
    
- <span data-ttu-id="ad1bc-110">Das Übertragungsprotokoll trennt die Eigenschaften für ausgehende Nachrichten in zwei Kategorien:, die das zugrunde liegenden Nachrichtensystem unterstützt und Prozeduren, die es nicht der Fall ist.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-110">The transport separates the properties on outgoing messages into two categories: those that the underlying message system supports and those that it does not.</span></span> <span data-ttu-id="ad1bc-111">Die Werte der Eigenschaften, die von der zugrunde liegenden messaging-System unterstützt werden, werden in das erforderliche Format übersetzt.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-111">The values of the properties that are supported by the underlying messaging system are translated into the required format.</span></span>
    
- <span data-ttu-id="ad1bc-112">Der Transport verwendet die MAPI TNEF-Methoden zum Codieren von nicht unterstützten Eigenschaften in einen einzelnen Datenstrom.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-112">The transport uses the MAPI TNEF methods to encode any unsupported properties into a single data stream.</span></span> <span data-ttu-id="ad1bc-113">Das Übertragungsprotokoll verwandelt klicken Sie dann diesen Datenstrom Daten in eine spezielle Anlage die ausgehende Nachricht, die mithilfe des Objektmodells für die zugrunde liegenden messaging-System-Anlage, vor dem Senden der Nachricht.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-113">The transport then turns that data stream into a special attachment on the outgoing message, using the underlying messaging system's attachment model, before sending the message.</span></span>
    
- <span data-ttu-id="ad1bc-114">Ein Transport TNEF aktiviert, der eine solche Nachricht empfängt hat zwei Funktionen.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-114">A TNEF enabled transport that receives such a message does two things.</span></span> <span data-ttu-id="ad1bc-115">Erstens übersetzt es der eingehenden Nachricht Eigenschaften – unterstützt werden vom zugrunde liegenden Nachrichtensystem – in MAPI-Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-115">First, it translates the incoming message's properties — the ones supported by the underlying message system — into MAPI properties.</span></span> <span data-ttu-id="ad1bc-116">Zweitens Wenn spezielle Anlage vorhanden ist, verwendet er die MAPI TNEF-Methoden zum Abrufen von zusätzlicher MAPI-Eigenschaften aus der Anlage vor dem übermitteln der Nachricht an eine Clientanwendung.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-116">Second, if the special attachment is present, it uses the MAPI TNEF methods to retrieve additional MAPI properties from the attachment before delivering the message to a client application.</span></span>
    
<span data-ttu-id="ad1bc-117">MAPI stellt eine Implementierung der **ITnef** -Schnittstelle für die Verwendung von MAPI-Transport-Anbietern beim Arbeiten mit TNEF-Objekten.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-117">MAPI supplies an implementation of the **ITnef** interface for use by MAPI transport providers when working with TNEF objects.</span></span> <span data-ttu-id="ad1bc-118">Die [OpenTnefStreamEx](opentnefstreamex.md) -Funktion wird verwendet, um TNEF-Objekte erstellen und Zuordnen einer Nachricht.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-118">The [OpenTnefStreamEx](opentnefstreamex.md) function is used to create TNEF objects and associate them with a message.</span></span> <span data-ttu-id="ad1bc-119">TNEF-Streams basieren auf der Basis der OLE- **IStream** -Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="ad1bc-119">TNEF streams are built on top of the OLE **IStream** interface</span></span> 
  
> [!NOTE]
> <span data-ttu-id="ad1bc-120">Verwenden Sie **OpenTnefStreamEx** zum Erstellen von TNEF-Objekten.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-120">You use **OpenTnefStreamEx** to create TNEF objects.</span></span> <span data-ttu-id="ad1bc-121">Die alte **OpenTNEFStream nicht ausgeführt werden** -Funktion noch vorhanden ist, für die Kompatibilität mit alten Quellcode und sollte nicht verwendet werden in einem anderen Element neu.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-121">The old **OpenTnefStream** function still exists for compatibility with old source code and should not be used in anything new.</span></span> 
  
<span data-ttu-id="ad1bc-122">Die **ITnef** -Schnittstelle stellt die folgenden Methoden bereit:</span><span class="sxs-lookup"><span data-stu-id="ad1bc-122">The **ITnef** interface provides the following methods:</span></span> 
  
- [<span data-ttu-id="ad1bc-123">AddProps</span><span class="sxs-lookup"><span data-stu-id="ad1bc-123">AddProps</span></span>](itnef-addprops.md)
    
- [<span data-ttu-id="ad1bc-124">EncodeRecips</span><span class="sxs-lookup"><span data-stu-id="ad1bc-124">EncodeRecips</span></span>](itnef-encoderecips.md)
    
- [<span data-ttu-id="ad1bc-125">ExtractProps</span><span class="sxs-lookup"><span data-stu-id="ad1bc-125">ExtractProps</span></span>](itnef-extractprops.md)
    
- [<span data-ttu-id="ad1bc-126">Finish</span><span class="sxs-lookup"><span data-stu-id="ad1bc-126">Finish</span></span>](itnef-finish.md)
    
- [<span data-ttu-id="ad1bc-127">FinishComponent</span><span class="sxs-lookup"><span data-stu-id="ad1bc-127">FinishComponent</span></span>](itnef-finishcomponent.md)
    
- [<span data-ttu-id="ad1bc-128">OpenTaggedBody</span><span class="sxs-lookup"><span data-stu-id="ad1bc-128">OpenTaggedBody</span></span>](itnef-opentaggedbody.md)
    
- [<span data-ttu-id="ad1bc-129">SetProps</span><span class="sxs-lookup"><span data-stu-id="ad1bc-129">SetProps</span></span>](itnef-setprops.md)
    
<span data-ttu-id="ad1bc-130">Das Implementierungsmodell MAPI TNEF unterstützt:</span><span class="sxs-lookup"><span data-stu-id="ad1bc-130">The MAPI TNEF implementation model supports:</span></span>
  
- <span data-ttu-id="ad1bc-131">Alle MAPI-Eigenschaften wirkt sich weitere Nachrichteneigenschaften.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-131">All MAPI properties without affecting other message properties.</span></span> <span data-ttu-id="ad1bc-132">In der Reihenfolge für MAPI-Nachrichten über einem messaging-System Transport überstehen müssen alle Eigenschaften, die als Eigenschaften des Messagingsystems codiert wird, können nicht gekapselte werden.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-132">In order for MAPI messages to survive transport through a messaging system, all properties that cannot be encoded as properties of the messaging system must be encapsulated.</span></span> <span data-ttu-id="ad1bc-133">Da fast nie zum Zeitpunkt bekannt ist, die eine Nachricht gesendet wird, unabhängig davon, ob ein MAPI-kompatibles Client die Meldung angezeigt wird, kann das Schema Kapselung ein Transportdienstes nur MAPI-Nachrichteneigenschaften zu codieren, die das messaging-System nicht der Fall ist systemintern unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-133">Because it is almost never known at the time a message is sent whether or not a MAPI-compliant client will receive the message, the encapsulation scheme allows a transport provider to encode only those MAPI message properties that the messaging system does not natively support.</span></span> <span data-ttu-id="ad1bc-134">Dies bedeutet, dass Nachrichten, die TNEF verwenden nicht "transparent" messaging-Systemen, die nicht auf MAPI wie UNIX SMTP-basierte messaging-Systeme.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-134">This means that messages which use TNEF are not "opaque" to messaging systems that are not based on MAPI such as SMTP-based UNIX messaging systems.</span></span> <span data-ttu-id="ad1bc-135">Diese Systeme erhalten die Eigenschaften, die sie unterstützen, in welcher Weise typisch ist für diese und andere Eigenschaften als eine codierte TNEF-Datenstrom empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-135">These systems receive the properties they support in whatever manner is typical for them, and other properties are received as an encoded TNEF data stream.</span></span> <span data-ttu-id="ad1bc-136">Der Transportdienst TNEF ist verantwortlich für die Unterscheidung zwischen diesen zwei Sätze von Eigenschaften und senden die unterstützte Gruppe in der richtigen Form für die messaging-System.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-136">The TNEF transport provider is responsible for differentiating between these two sets of properties and sending the supported set in the proper manner for the messaging system.</span></span> <span data-ttu-id="ad1bc-137">TNEF Annahmen keine über die Ebene der Unterstützung von einem messaging-System aus.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-137">TNEF makes no assumptions as to the level of support provided by a messaging system.</span></span> <span data-ttu-id="ad1bc-138">Jedoch ist in den Beispielen in diesem Abschnitt enthalten TNEF-Auslastung der Annahme ausgegangen, dass das messaging-System abgesehen davon, dass die Nachricht mindestens eine Anlage unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-138">However, in the examples of TNEF usage included in this section, the assumption is made that the messaging system supports at least one single attachment aside from the message.</span></span> <span data-ttu-id="ad1bc-139">In einigen Fällen kann die Anlage nur über einen Datenstrom UUENCODE unterstützt und als Teil des Nachrichtentexts übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-139">In some cases, the attachment can only be supported through a uuencoded stream and transmitted as part of the message text.</span></span> <span data-ttu-id="ad1bc-140">Nur in seltenen Fällen müssen das messaging-System so wenig Unterstützung für Nachrichteneigenschaften, vollständige TNEF-Codierung alle Eigenschaften erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-140">Only in very rare circumstances will the messaging system have so little support for message properties that full TNEF encoding of all properties is necessary.</span></span>
    
- <span data-ttu-id="ad1bc-141">Ein Mechanismus zum Bestimmen basierend, ob ein TNEF-Stream auf eine eingehende Nachricht an die Nachricht gehört auf der MAPI-Eigenschaft **PR_TNEF_CORRELATION_KEY** ([PidTagTnefCorrelationKey](pidtagtnefcorrelationkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="ad1bc-141">A mechanism for determining whether a TNEF stream on an incoming message belongs to the message, based on the MAPI property **PR_TNEF_CORRELATION_KEY** ([PidTagTnefCorrelationKey](pidtagtnefcorrelationkey-canonical-property.md)).</span></span> <span data-ttu-id="ad1bc-142">Diese Eigenschaft sollte sowohl in der TNEF-Stream eine entsprechende Meldung-Kopfzeile gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-142">This property should be found both in the TNEF stream and in an appropriate message header.</span></span> <span data-ttu-id="ad1bc-143">Wenn die-Eigenschaft denselben Wert an beiden Stellen hat oder an beiden Stellen fehlt, wird angenommen, dass der TNEF-Stream an die Nachricht gehören.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-143">If the property has the same value in both places, or is missing in either place, the TNEF stream is assumed to belong to the message.</span></span> <span data-ttu-id="ad1bc-144">Andernfalls wird der TNEF-Stream ignoriert.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-144">Otherwise, the TNEF stream is ignored.</span></span> <span data-ttu-id="ad1bc-145">TNEF aktiviert Transporten sind verantwortlich für die Auswahl eines Wertes für diese Eigenschaft für ausgehende Nachrichten und codiert ihn in eine entsprechende Meldung-Kopfzeile (beispielsweise der Nachrichten-ID: Kopfzeile für SMTP-Nachrichten) und in der TNEF-Stream.</span><span class="sxs-lookup"><span data-stu-id="ad1bc-145">TNEF enabled transports are responsible for choosing a value for this property on outbound messages and encoding it in an appropriate message header (for example, the Message-ID: header for SMTP messages) and in the TNEF stream.</span></span>
    

