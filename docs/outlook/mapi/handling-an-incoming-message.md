---
title: Behandeln von eingehenden Nachrichten
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d45d5ed9-41cd-4aaf-91d2-1e4a27bb16d4
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: f3fbe34793e3520b26b984f4bd6b14fbcab7a951
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32299405"
---
# <a name="handling-an-incoming-message"></a><span data-ttu-id="c2b95-103">Behandeln von eingehenden Nachrichten</span><span class="sxs-lookup"><span data-stu-id="c2b95-103">Handling an incoming message</span></span>

<span data-ttu-id="c2b95-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c2b95-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c2b95-105">Eine eingehende Nachricht ist eine Nachricht, die über ein oder mehrere Messagingsysteme gesendet wurde.</span><span class="sxs-lookup"><span data-stu-id="c2b95-105">An incoming message is a message that has been sent across one or more messaging systems.</span></span> <span data-ttu-id="c2b95-106">Sie wurde möglicherweise nur an Sie oder an viele andere Empfänger gesendet.</span><span class="sxs-lookup"><span data-stu-id="c2b95-106">It may have been sent only to you or to many other recipients.</span></span> <span data-ttu-id="c2b95-107">Eingehende Nachrichten werden in einem Empfangsordner gespeichert, der zum Speichern von Nachrichten einer bestimmten Klasse bestimmt ist.</span><span class="sxs-lookup"><span data-stu-id="c2b95-107">Incoming messages are placed in a receive folder designated to hold messages of a particular class.</span></span> <span data-ttu-id="c2b95-108">Sie können für jede Nachrichtenklasse, die Sie behandeln, oder einen Ordner für alle Klassen verwenden, einen anderen Empfangsordner einrichten.</span><span class="sxs-lookup"><span data-stu-id="c2b95-108">You can set up a different receive folder for each message class that you handle or use one folder for all of the classes.</span></span>
  
<span data-ttu-id="c2b95-109">Wenn Sie sich mit dem Nachrichtenspeicher für neue e-Mail-Benachrichtigungen registriert haben, werden Sie benachrichtigt, wenn eine Nachricht in einem Empfangsordner gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="c2b95-109">If you have registered for new mail notifications with the message store, you will be notified whenever a message is placed in a receive folder.</span></span> <span data-ttu-id="c2b95-110">Wenn Sie sich noch nicht für neue e-Mail-Benachrichtigungen registriert haben, müssen Sie den entsprechenden Empfangsordner regelmäßig öffnen, um manuell nach der Ankunft neuer Nachrichten zu suchen.</span><span class="sxs-lookup"><span data-stu-id="c2b95-110">If you have not registered for new mail notifications, you must open the appropriate receive folder periodically to manually check for the arrival of new messages.</span></span>
  
<span data-ttu-id="c2b95-111">Clients registrieren für neue e-Mail-Benachrichtigungen, indem Sie die Parameter auf [IMsgStore:: Advise](imsgstore-advise.md) wie folgt festlegen:</span><span class="sxs-lookup"><span data-stu-id="c2b95-111">Clients register for new mail notifications by setting the parameters to [IMsgStore::Advise](imsgstore-advise.md) as follows:</span></span> 
  
- <span data-ttu-id="c2b95-112">Legen Sie _cbEntryID_ auf 0 fest.</span><span class="sxs-lookup"><span data-stu-id="c2b95-112">Set  _cbEntryID_ to 0.</span></span> 
    
- <span data-ttu-id="c2b95-113">Legen Sie _lpEntryID_ auf NULL fest.</span><span class="sxs-lookup"><span data-stu-id="c2b95-113">Set  _lpEntryID_ to NULL.</span></span> 
    
- <span data-ttu-id="c2b95-114">Legen Sie _ulEventMask_ auf uleventmaskfnevnewmail.</span><span class="sxs-lookup"><span data-stu-id="c2b95-114">Set  _ulEventMask_ to fnevNewMail.</span></span> 
    
<span data-ttu-id="c2b95-115">Der _lpNotifications_ -Parameter im Aufruf Ihrer **IMAPIAdviseSink:: OnNotify** -Methode verweist auf eine **NEWMAIL\_** -Benachrichtigungsstruktur, die Informationen über die eingehende Nachricht enthält, beispielsweise Ihre Nachrichtenklasse, Ihren Eintrag Bezeichner, die Eintrags-ID des übergeordneten Ordners und der Inhalt seiner **PR_MESSAGE_FLAGS** -Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="c2b95-115">The  _lpNotifications_ parameter in the call to your **IMAPIAdviseSink::OnNotify** method points to a **NEWMAIL\_NOTIFICATION** structure that contains information about the incoming message, such as its message class, its entry identifier, the entry identifier of its parent folder, and the contents of its **PR_MESSAGE_FLAGS** property.</span></span> <span data-ttu-id="c2b95-116">Weitere Informationen zum Registrieren und behandeln von Benachrichtigungen finden Sie unter [IMAPIAdviseSink:: OnNotify](imapiadvisesink-onnotify.md), [NEWMAIL_NOTIFICATION](newmail_notification.md), **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) und [Handling Notifications](handling-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="c2b95-116">For more information about registering for and handling notifications, see [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md), [NEWMAIL_NOTIFICATION](newmail_notification.md), **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)), and [Handling Notifications](handling-notifications.md).</span></span> 
  
<span data-ttu-id="c2b95-117">Bevor Sie einem Benutzer eine eingehende Nachricht anzeigen, bestimmen Sie, ob es sich bei der Nachrichtenklasse um eine vom Client unterstützte Klasse handelt.</span><span class="sxs-lookup"><span data-stu-id="c2b95-117">Before displaying an incoming message to a user, determine if its message class is a class that your client supports.</span></span> <span data-ttu-id="c2b95-118">Wenn dies nicht der Fall ist, ignorieren Sie die Nachricht.</span><span class="sxs-lookup"><span data-stu-id="c2b95-118">If not, ignore the message.</span></span> <span data-ttu-id="c2b95-119">Wenn die Klasse unterstützt wird, können Sie die Nachricht mit einem für die Nachrichtenklasse der Nachricht geeigneten Formular öffnen und anzeigen.</span><span class="sxs-lookup"><span data-stu-id="c2b95-119">If the class is one that you support, you can open and display the message with a form that is appropriate for the message class of the message.</span></span> <span data-ttu-id="c2b95-120">Die Auswahl der Formulare basiert auf der Nachrichtenklasse.</span><span class="sxs-lookup"><span data-stu-id="c2b95-120">The choice of forms is based on message class.</span></span> <span data-ttu-id="c2b95-121">Nachrichten, die zur IPM-Klasse gehören, verwenden ein Standardformular, das von MAPI implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="c2b95-121">Messages that belong to the IPM class use a default form implemented by MAPI.</span></span> <span data-ttu-id="c2b95-122">Nachrichten, die zu benutzerdefinierten Klassen gehören, die von Clients definiert werden, können entweder Client definierte spezialisierte Formulare oder das MAPI-Standardformular verwenden.</span><span class="sxs-lookup"><span data-stu-id="c2b95-122">Messages that belong to custom classes defined by clients can use either client-defined specialized forms or the MAPI default form.</span></span>
  
## <a name="open-and-display-an-incoming-message"></a><span data-ttu-id="c2b95-123">Öffnen und Anzeigen einer eingehenden Nachricht</span><span class="sxs-lookup"><span data-stu-id="c2b95-123">Open and display an incoming message</span></span>
  
1. <span data-ttu-id="c2b95-124">Rufen Sie **IMsgStore:: GetReceiveFolder** auf, um den Eintragsbezeichner des Empfänger Ordners für die Nachrichtenklasse der Nachricht abzurufen, und führen Sie diese Eintrags-ID an **IMsgStore:: OpenEntry** , um den Ordner zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="c2b95-124">Call **IMsgStore::GetReceiveFolder** to retrieve the entry identifier of the receive folder for the message class of the message and pass this entry identifier to **IMsgStore::OpenEntry** to open the folder.</span></span> <span data-ttu-id="c2b95-125">Weitere Informationen finden Sie unter [IMsgStore:: GetReceiveFolder](imsgstore-getreceivefolder.md), [IMsgStore:: OpenEntry](imsgstore-openentry.md)und [Öffnen eines Nachrichtenspeicher Ordners](opening-a-message-store-folder.md).</span><span class="sxs-lookup"><span data-stu-id="c2b95-125">For more information, see [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md), [IMsgStore::OpenEntry](imsgstore-openentry.md), and [Opening a Message Store Folder](opening-a-message-store-folder.md).</span></span>
    
2. <span data-ttu-id="c2b95-126">Rufen Sie die **IMAPIContainer::** getContents-Methode des empfangen-Ordners auf, um die Inhaltstabelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="c2b95-126">Call the receive folder's **IMAPIContainer::GetContentsTable** method to retrieve its contents table.</span></span> <span data-ttu-id="c2b95-127">Weitere Informationen finden Sie unter [IMAPIContainer::](imapicontainer-getcontentstable.md)getcontentable.</span><span class="sxs-lookup"><span data-stu-id="c2b95-127">For more information, see [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span></span> <span data-ttu-id="c2b95-128">Rufen Sie die **IMAPITable:: QueryRows** -Methode der Tabelle auf, um alle Zeilen in der Tabelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="c2b95-128">Call the table's **IMAPITable::QueryRows** method to retrieve all the rows in the table.</span></span> <span data-ttu-id="c2b95-129">Weitere Informationen finden Sie unter [IMAPITable:: QueryRows](imapitable-queryrows.md) -und [Inhaltstabellen](contents-tables.md).</span><span class="sxs-lookup"><span data-stu-id="c2b95-129">For more information see [IMAPITable::QueryRows](imapitable-queryrows.md) and [Contents Tables](contents-tables.md).</span></span> <span data-ttu-id="c2b95-130">Weitere Informationen zum Anzeigen einer Inhaltstabelle finden Sie unter [Anzeigen einer Ordnerinhaltstabelle](displaying-a-folder-contents-table.md).</span><span class="sxs-lookup"><span data-stu-id="c2b95-130">For more information about displaying a contents table, see [Displaying a Folder Contents Table](displaying-a-folder-contents-table.md).</span></span>
    
3. <span data-ttu-id="c2b95-131">Wenn Ihr Client interaktiv ist, lassen Sie den Benutzer eine Nachricht aus der Tabelle auswählen und bestimmen, welches Formular zum Anzeigen dieser Nachricht verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="c2b95-131">If your client is interactive, allow the user to select a message from the table and determine the form to be used to display that message.</span></span> <span data-ttu-id="c2b95-132">Clients können das von MAPI bereitgestellte Standardformular oder ein benutzerdefiniertes Formular verwenden.</span><span class="sxs-lookup"><span data-stu-id="c2b95-132">Clients can use the default form provided by MAPI or a custom form.</span></span> <span data-ttu-id="c2b95-133">Weitere Informationen finden Sie unter [Behandeln von MAPI-Formularen](handling-mapi-forms.md).</span><span class="sxs-lookup"><span data-stu-id="c2b95-133">For more information, see [Handling MAPI Forms](handling-mapi-forms.md).</span></span>
    
4. <span data-ttu-id="c2b95-134">Rufen Sie **IMsgStore:: OpenEntry** auf, um die Nachricht zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="c2b95-134">Call **IMsgStore::OpenEntry** to open the message.</span></span> <span data-ttu-id="c2b95-135">Weitere Informationen finden Sie unter [Öffnen einer Nachricht](opening-a-message.md).</span><span class="sxs-lookup"><span data-stu-id="c2b95-135">For more information, see [Opening a Message](opening-a-message.md).</span></span>
    
5. <span data-ttu-id="c2b95-136">Verarbeiten Sie den Nachrichtentext.</span><span class="sxs-lookup"><span data-stu-id="c2b95-136">Process the message text.</span></span> <span data-ttu-id="c2b95-137">Weitere Informationen finden Sie unter [Öffnen von Nachrichten Text](opening-message-text.md).</span><span class="sxs-lookup"><span data-stu-id="c2b95-137">For more information, see [Opening Message Text](opening-message-text.md).</span></span>
    
6. <span data-ttu-id="c2b95-138">Rendern Sie die einzelnen Nachrichtenanlagen.</span><span class="sxs-lookup"><span data-stu-id="c2b95-138">Render each of the message attachments.</span></span> <span data-ttu-id="c2b95-139">Weitere Informationen finden Sie unter [Rendern einer Anlage im nur-Text](rendering-an-attachment-in-plain-text.md) -Format oder [Rendern einer Anlage in RTF-Text](rendering-an-attachment-in-rtf-text.md).</span><span class="sxs-lookup"><span data-stu-id="c2b95-139">For more information, see [Rendering an Attachment in Plain Text](rendering-an-attachment-in-plain-text.md) or [Rendering an Attachment in RTF Text](rendering-an-attachment-in-rtf-text.md).</span></span>
    
7. <span data-ttu-id="c2b95-140">Öffnen Sie eine Anlage, falls gewünscht.</span><span class="sxs-lookup"><span data-stu-id="c2b95-140">Open an attachment if desired.</span></span> <span data-ttu-id="c2b95-141">Weitere Informationen finden Sie unter [Öffnen einer Anlage](opening-an-attachment.md).</span><span class="sxs-lookup"><span data-stu-id="c2b95-141">For more information see [Opening an Attachment](opening-an-attachment.md).</span></span>
    
## <a name="in-this-section"></a><span data-ttu-id="c2b95-142">Inhalt dieses Abschnitts</span><span class="sxs-lookup"><span data-stu-id="c2b95-142">In this section</span></span>

- <span data-ttu-id="c2b95-143">[Öffnen des Nachrichtentexts](opening-message-text.md): Beschreibt, wie der Nachrichtentext geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="c2b95-143">[Opening Message Text](opening-message-text.md): Describes how to open the message text.</span></span>
    
- <span data-ttu-id="c2b95-144">[Rendern einer Anlage im Klartext](rendering-an-attachment-in-plain-text.md): Beschreibt, wie eine Anlage im nur-Text-Format gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="c2b95-144">[Rendering an Attachment in Plain Text](rendering-an-attachment-in-plain-text.md): Describes how to render an attachment in plain text.</span></span>
    
- <span data-ttu-id="c2b95-145">[Rendern einer Anlage in RTF-Text](rendering-an-attachment-in-rtf-text.md): Beschreibt, wie eine Anlage in formatiertem Text gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="c2b95-145">[Rendering an Attachment in RTF Text](rendering-an-attachment-in-rtf-text.md): Describes how to render an attachment in formatted text.</span></span>
    
- <span data-ttu-id="c2b95-146">[Öffnen einer Anlage](opening-an-attachment.md): Beschreibt, wie Sie eine Anlage öffnen.</span><span class="sxs-lookup"><span data-stu-id="c2b95-146">[Opening an Attachment](opening-an-attachment.md): Describes how to open an attachment.</span></span>
    

