---
title: Nachrichtendienste und Profile
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 78a13bacf13b019bbf9436830ad66db7fdfaf425
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33415467"
---
# <a name="message-services-and-profiles"></a><span data-ttu-id="887d0-103">Nachrichtendienste und Profile</span><span class="sxs-lookup"><span data-stu-id="887d0-103">Message services and profiles</span></span>
  
<span data-ttu-id="887d0-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="887d0-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="887d0-105">Einige Benutzer benötigen die Dienste mehrerer Messagingsysteme, die jeweils einen oder mehrere Dienstanbieter aufweisen.</span><span class="sxs-lookup"><span data-stu-id="887d0-105">Some users require the services of several messaging systems, each with one or more service providers.</span></span> <span data-ttu-id="887d0-106">Da es umständlich ist, jeden dieser Dienstanbieter einzeln zu installieren und zu konfigurieren, und da ein Messaging Server in der Regel eine Gruppe verwandter Anbieter benötigt, um alle Funktionen verfügbar zu machen, enthält MAPI das Konzept eines Nachrichtendiensts.</span><span class="sxs-lookup"><span data-stu-id="887d0-106">Because it is cumbersome to install and configure each of these service providers individually, and because a messaging server usually requires a group of related providers to expose all its functionality, MAPI includes the concept of a message service.</span></span> <span data-ttu-id="887d0-107">Nachrichtendienste helfen Benutzern bei der Installation und Konfiguration Ihrer Dienstanbieter.</span><span class="sxs-lookup"><span data-stu-id="887d0-107">Message services help users install and configure their service providers.</span></span>
  
<span data-ttu-id="887d0-108">Zum Erstellen eines Nachrichtendiensts schreibt ein Entwickler ein Entry Point-Programm für den Nachrichtendienst, um die Konfiguration der einzelnen Anbieter im Dienst und ein Setupprogramm für Folgendes zu übernehmen:</span><span class="sxs-lookup"><span data-stu-id="887d0-108">To create a message service, a developer writes a message-service entry point program to handle the configuration of each provider in the service and a setup program to do the following:</span></span>
  
- <span data-ttu-id="887d0-109">Installieren Sie jeden Anbieter im Dienst.</span><span class="sxs-lookup"><span data-stu-id="887d0-109">Install each provider in the service.</span></span>
    
- <span data-ttu-id="887d0-110">Erstellen Sie Registrierungs-und Initialisierungsdatei Einträge.</span><span class="sxs-lookup"><span data-stu-id="887d0-110">Create registry and initialization file entries.</span></span>
    
- <span data-ttu-id="887d0-111">Erstellen Sie Einträge in der MAPI-Konfigurationsdatei MAPISVC. inf.</span><span class="sxs-lookup"><span data-stu-id="887d0-111">Create entries in the MAPI configuration file, Mapisvc.inf.</span></span>
    
<span data-ttu-id="887d0-112">Die Datei MAPISVC. inf enthält Informationen zur Konfiguration aller Nachrichtendienste und Dienstanbieter, die auf dem Computer installiert sind.</span><span class="sxs-lookup"><span data-stu-id="887d0-112">The Mapisvc.inf file contains information that relates to the configuration of all message services and service providers installed on the computer.</span></span> <span data-ttu-id="887d0-113">Sie ist in hierarchischen Abschnitten gegliedert, wobei jede Ebene mit der nächsten verknüpft ist.</span><span class="sxs-lookup"><span data-stu-id="887d0-113">It is organized in hierarchical sections, with each level linked to the next.</span></span> <span data-ttu-id="887d0-114">Oben befinden sich drei Abschnitte, die Folgendes enthalten:</span><span class="sxs-lookup"><span data-stu-id="887d0-114">At the top are three sections that contain the following:</span></span> 
  
- <span data-ttu-id="887d0-115">Eine Liste der Hilfedateien des Nachrichtendiensts.</span><span class="sxs-lookup"><span data-stu-id="887d0-115">A list of message service Help files.</span></span>
    
- <span data-ttu-id="887d0-116">Eine Liste der wichtigsten oder standardmäßigen Nachrichtendienste.</span><span class="sxs-lookup"><span data-stu-id="887d0-116">A list of the most important, or default, message services.</span></span>
    
- <span data-ttu-id="887d0-117">Eine Liste aller Dienste auf dem Computer.</span><span class="sxs-lookup"><span data-stu-id="887d0-117">A list of all the services on the computer.</span></span>
    
<span data-ttu-id="887d0-118">Die nächste Ebene enthält Abschnitte für jeden Nachrichtendienst, und die letzte Ebene enthält Abschnitte für jeden Dienstanbieter in einem Dienst.</span><span class="sxs-lookup"><span data-stu-id="887d0-118">The next level contains sections for each message service, and the last level contains sections for each service provider in a service.</span></span> <span data-ttu-id="887d0-119">MAPI erfordert, dass Entwickler von Dienstanbietern und Nachrichtendiensten bestimmte Einträge zu MAPISVC. inf hinzufügen; Entwickler können weitere Einträge nach eigenem Ermessen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="887d0-119">MAPI requires that developers of service providers and message services add certain entries to Mapisvc.inf; developers can add other entries at their own discretion.</span></span> <span data-ttu-id="887d0-120">Die meisten Informationen in MAPISVC. inf enden in einem oder mehreren Profilen, einer Sammlung von Konfigurationsinformationen für die bevorzugten Nachrichtendienste eines Benutzers.</span><span class="sxs-lookup"><span data-stu-id="887d0-120">Most of the information in Mapisvc.inf ends up in one or more profiles, a collection of configuration information for a user's preferred set of message services.</span></span> <span data-ttu-id="887d0-121">Da ein Computer mehrere Benutzer haben kann und ein einzelner Benutzer über mehrere Einstellungssätze verfügen kann, können viele Profile auf einem Computer vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="887d0-121">Because a computer can have multiple users and a single user can have multiple sets of preferences, many profiles can exist on a computer.</span></span> <span data-ttu-id="887d0-122">Jedes Profil beschreibt einen anderen Satz von Nachrichtendiensten.</span><span class="sxs-lookup"><span data-stu-id="887d0-122">Each profile describes a different set of message services.</span></span> <span data-ttu-id="887d0-123">Durch die Verwendung mehrerer Profile kann ein Benutzer beispielsweise zu Hause mit einem Satz von Nachrichtendiensten und im Büro mit einem anderen Satz arbeiten.</span><span class="sxs-lookup"><span data-stu-id="887d0-123">Having multiple profiles enables a user to work, for example, at home with one set of message services and at the office with a different set.</span></span>
  
<span data-ttu-id="887d0-124">Profile werden bei der Installation oder Anmeldezeit des Nachrichtendiensts von einer Clientanwendung erstellt, die Konfigurationsunterstützung bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="887d0-124">Profiles are created at message service installation or logon time by a client application that provides configuration support.</span></span> <span data-ttu-id="887d0-125">MAPI bietet zwei solcher Clientanwendungen: ein Element der Systemsteuerung und den Profil-Assistenten.</span><span class="sxs-lookup"><span data-stu-id="887d0-125">MAPI provides two such client applications: a Control Panel item and the Profile Wizard.</span></span> <span data-ttu-id="887d0-126">Bei dem Element der Systemsteuerung handelt es sich um eine vollständige Konfigurationsanwendung, mit der Benutzerprofile erstellen, löschen, bearbeiten und kopieren sowie Änderungen an den Einträgen in einem Profil vornehmen können.</span><span class="sxs-lookup"><span data-stu-id="887d0-126">The Control Panel item is a full-service configuration application with which users can create, delete, edit, and copy profiles, as well as make modifications to the entries in a profile.</span></span> <span data-ttu-id="887d0-127">Der Profil-Assistent ist eine einfache Anwendung, die das Hinzufügen eines Nachrichtendiensts zu einem Profil so einfach wie möglich macht.</span><span class="sxs-lookup"><span data-stu-id="887d0-127">The Profile Wizard is a simple application designed to make adding a message service to a profile as easy as possible.</span></span> <span data-ttu-id="887d0-128">Der Profil-Assistent besteht aus einer Reihe von Dialogfeldern, die als Eigenschaftenseiten bezeichnet werden und den Benutzer bei der Installation und Konfiguration eines Diensts auffordern.</span><span class="sxs-lookup"><span data-stu-id="887d0-128">The Profile Wizard consists of a series of dialog boxes, called property pages, that prompt the user through the process of installing and configuring a service.</span></span> <span data-ttu-id="887d0-129">Der Benutzer wird nur für Werte für die kritischsten Einstellungen aufgefordert; alle anderen Einstellungen erben die Standardwerte.</span><span class="sxs-lookup"><span data-stu-id="887d0-129">The user is prompted only for values for the most critical settings; all other settings inherit default values.</span></span> <span data-ttu-id="887d0-130">Nachdem das Profil erstellt wurde, dürfen Benutzer keine Änderungen vornehmen.</span><span class="sxs-lookup"><span data-stu-id="887d0-130">Once the profile has been created, users are not allowed to make changes.</span></span> 
  
<span data-ttu-id="887d0-131">Während das Element der Systemsteuerung immer über die Systemsteuerung aufgerufen wird, gibt es eine Reihe von Szenarien, die dazu führen können, dass der Profil-Assistent aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="887d0-131">Whereas the Control Panel item is always invoked through the Control Panel, there are a variety of scenarios that can cause the Profile Wizard to be called.</span></span> <span data-ttu-id="887d0-132">Client Anwendungen können den Profil-Assistenten aufrufen, um ein Standardprofil zum Zeitpunkt der Anmeldung zu erstellen, wenn noch keine erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="887d0-132">Client applications can call the Profile Wizard to create a default profile at logon time when one has not yet been created.</span></span> <span data-ttu-id="887d0-133">Anstatt Code erneut zu implementieren, um ein Profil hinzuzufügen, kann das Element der Systemsteuerung oder eine andere Clientanwendung die Funktionen verwenden, die sich bereits im Profil-Assistenten befinden.</span><span class="sxs-lookup"><span data-stu-id="887d0-133">Rather than reimplementing code to add a profile, the Control Panel item or another client application can rely on the functionality already in the Profile Wizard.</span></span> <span data-ttu-id="887d0-134">Ein Nachrichtendienst kann in seiner Einstiegspunktfunktion den Profil-Assistenten aufrufen, wenn der Dienst dem Standardprofil hinzugefügt werden muss.</span><span class="sxs-lookup"><span data-stu-id="887d0-134">A message service, in its entry point function, can call the Profile Wizard when the service needs to be added to the default profile.</span></span> <span data-ttu-id="887d0-135">Nachrichtendienste, die den Profil-Assistenten verwenden, müssen eine zusätzliche Einstiegspunktfunktion und eine Windows-Standarddialogfelder-Prozedur schreiben.</span><span class="sxs-lookup"><span data-stu-id="887d0-135">Message services that use the Profile Wizard must write an extra entry point function and a standard Windows dialog box procedure.</span></span> <span data-ttu-id="887d0-136">Der Profil-Assistent ruft die Einstiegspunktfunktion auf, um das Konfigurationsdialogfeld des Diensts abzurufen, während die Dialogfeldprozedur die Nachrichten verarbeitet, die bei Verwendung dieses Dialogfelds generiert werden.</span><span class="sxs-lookup"><span data-stu-id="887d0-136">The Profile Wizard calls the entry point function to retrieve the service's configuration dialog box while the dialog box procedure handles the messages that are generated when this dialog box is in use.</span></span> 
  
<span data-ttu-id="887d0-137">Profile werden ähnlich wie die Datei "Mapisvc. inf" organisiert.</span><span class="sxs-lookup"><span data-stu-id="887d0-137">Profiles are organized in a similar way to the Mapisvc.inf file.</span></span> <span data-ttu-id="887d0-138">Profile haben verknüpfte hierarchische Abschnitte; Dienstanbieter eigene Abschnitte in der untersten Ebene, Nachrichtendienste eigene Abschnitte in der mittleren Ebene und MAPI besitzt Abschnitte auf höchster Ebene.</span><span class="sxs-lookup"><span data-stu-id="887d0-138">Profiles have linked hierarchical sections; service providers own sections in the lowest level, message services own sections in the middle level, and MAPI owns sections in the highest level.</span></span> <span data-ttu-id="887d0-139">Jeder Abschnitt wird mit einem eindeutigen Bezeichner identifiziert, der als [MAPIUID](mapiuid.md)bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="887d0-139">Each section is identified with a unique identifier known as a [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="887d0-140">Die MAPI-Abschnitte enthalten interne Informationen zu MAPI, wie die Bezeichner aller Profile des Nachrichtendienst Profils und Links zu den einzelnen Abschnitten.</span><span class="sxs-lookup"><span data-stu-id="887d0-140">The MAPI sections contain information internal to MAPI, such as the identifiers of all of the message service profile sections and links to each of the other sections.</span></span> <span data-ttu-id="887d0-141">Jeder Nachrichtendienst Abschnitt speichert Links zu seinen Anbieter Abschnitten, und jeder Anbieterabschnitt speichert einen Link zu seinem Dienst Abschnitt.</span><span class="sxs-lookup"><span data-stu-id="887d0-141">Each message service section stores links to its provider sections, and each provider section stores a link to its service section.</span></span> 
  
<span data-ttu-id="887d0-142">Die folgende Abbildung zeigt die Inhalte von zwei typischen Profilen.</span><span class="sxs-lookup"><span data-stu-id="887d0-142">The following illustration shows the contents of two typical profiles.</span></span> <span data-ttu-id="887d0-143">Sam hat zwei Profile auf seinem Computer, eine für die private Nutzung und eine für die Office-Verwendung.</span><span class="sxs-lookup"><span data-stu-id="887d0-143">Sam has two profiles on his computer, one for home use and one for office use.</span></span> <span data-ttu-id="887d0-144">Das Startprofil enthält drei Nachrichtendienste.</span><span class="sxs-lookup"><span data-stu-id="887d0-144">The home profile contains three message services.</span></span> <span data-ttu-id="887d0-145">Message Service X ist ein einzelner Anbieterdienst für die Adressbuchverwaltung.</span><span class="sxs-lookup"><span data-stu-id="887d0-145">Message Service X is a single provider service for address book management.</span></span> <span data-ttu-id="887d0-146">Nachrichtendienste Y und Z verfügen über drei Anbieter: einen Adressbuchanbieter, einen Nachrichtenspeicher Anbieter und einen Transportanbieter.</span><span class="sxs-lookup"><span data-stu-id="887d0-146">Message Services Y and Z have three providers — an address book provider, a message store provider, and a transport provider.</span></span> <span data-ttu-id="887d0-147">Sams Arbeitsprofil enthält zwei verschiedene Nachrichtendienste, von denen jeder einen Adressbuchanbieter, einen Nachrichtenspeicher Anbieter und einen Transportanbieter besitzt.</span><span class="sxs-lookup"><span data-stu-id="887d0-147">Sam's Work Profile contains two different message services, each of which has an address book provider, a message store provider, and a transport provider.</span></span> 
  
<span data-ttu-id="887d0-148">**Profilbeispiel**</span><span class="sxs-lookup"><span data-stu-id="887d0-148">**Profile example**</span></span>
  
<span data-ttu-id="887d0-149">![Profil Beispiel] (media/amapi_56.gif "Profil Beispiel")</span><span class="sxs-lookup"><span data-stu-id="887d0-149">![Profile example](media/amapi_56.gif "Profile example")</span></span>
  
<span data-ttu-id="887d0-150">Die folgende Abbildung zeigt ein Profil mit zwei Nachrichtendiensten.</span><span class="sxs-lookup"><span data-stu-id="887d0-150">The following illustration shows a profile that includes two message services.</span></span> <span data-ttu-id="887d0-151">Der Code für die Installation und Konfiguration der Dienstanbieter, die zum Nachrichtendienst gehören, befindet sich in derselben DLL wie der Code für die Anbieter.</span><span class="sxs-lookup"><span data-stu-id="887d0-151">The code for installing and configuring the service providers that belong to the message service resides in the same DLL as the code for the providers.</span></span> <span data-ttu-id="887d0-152">Dieser Code liest Informationen aus dem Profil bei der Anmeldung, um die Dienstanbieter zu konfigurieren, und fordert den Benutzer auf, wenn möglich und erforderlich, fehlende Informationen zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="887d0-152">This code reads information from the profile at logon time to configure the service providers, and it prompts the user, if possible and necessary, for missing information.</span></span> <span data-ttu-id="887d0-153">Anforderungen von einem Client zum Anzeigen oder Ändern von Konfigurationseinstellungen für einen der Anbieter werden ebenfalls durch diesen gemeinsamen Code behandelt.</span><span class="sxs-lookup"><span data-stu-id="887d0-153">Requests from a client to view or change configuration settings for any of the providers are also handled by this common code.</span></span>
  
<span data-ttu-id="887d0-154">**Installieren und Konfigurieren von Serviceanbietern**</span><span class="sxs-lookup"><span data-stu-id="887d0-154">**Installing and configuring service providers**</span></span>
  
<span data-ttu-id="887d0-155">![Installieren und Konfigurieren von Dienstanbietern] (media/amapi_55.gif "Installieren und Konfigurieren von Dienstanbietern")</span><span class="sxs-lookup"><span data-stu-id="887d0-155">![Installing and configuring service providers](media/amapi_55.gif "Installing and configuring service providers")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="887d0-156">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="887d0-156">See also</span></span>

- [<span data-ttu-id="887d0-157">MAPIUID</span><span class="sxs-lookup"><span data-stu-id="887d0-157">MAPIUID</span></span>](mapiuid.md)
- [<span data-ttu-id="887d0-158">Übersicht über die MAPI-Programmierung</span><span class="sxs-lookup"><span data-stu-id="887d0-158">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

