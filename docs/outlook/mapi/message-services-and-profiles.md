---
title: Message-Dienste und Profile
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 0f55d4cda013810884177a0f47e861e3693defd7
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19793273"
---
# <a name="message-services-and-profiles"></a><span data-ttu-id="9ff57-103">Message-Dienste und Profile</span><span class="sxs-lookup"><span data-stu-id="9ff57-103">Message services and profiles</span></span>
  
<span data-ttu-id="9ff57-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="9ff57-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="9ff57-105">Einige Benutzer benötigen die Dienste von verschiedenen Messagingsystemen, jeweils mit mindestens einem Dienstanbieter.</span><span class="sxs-lookup"><span data-stu-id="9ff57-105">Some users require the services of several messaging systems, each with one or more service providers.</span></span> <span data-ttu-id="9ff57-106">Da es ist schwierig zu installieren und konfigurieren Sie jeden dieser Dienstanbieter einzeln und messaging-Server in der Regel eine Gruppe von verwandten Anbieter alle seine Funktionen verfügbar machen muss, enthält MAPI das Konzept eines Diensts Nachricht.</span><span class="sxs-lookup"><span data-stu-id="9ff57-106">Because it is cumbersome to install and configure each of these service providers individually, and because a messaging server usually requires a group of related providers to expose all its functionality, MAPI includes the concept of a message service.</span></span> <span data-ttu-id="9ff57-107">Message-Dienste unterstützen Benutzer beim Installieren und Konfigurieren von ihren Dienstanbieter.</span><span class="sxs-lookup"><span data-stu-id="9ff57-107">Message services help users install and configure their service providers.</span></span>
  
<span data-ttu-id="9ff57-108">Erstellen eines Diensts Nachricht ein Entwickler schreibt eine Nachricht-Diensteintrag Point-Programm, die Konfiguration der einzelnen Anbieter in der Dienst und ein Setup-Programm für folgende Aufgaben behandelt:</span><span class="sxs-lookup"><span data-stu-id="9ff57-108">To create a message service, a developer writes a message-service entry point program to handle the configuration of each provider in the service and a setup program to do the following:</span></span>
  
- <span data-ttu-id="9ff57-109">Installieren Sie aller Dienstanbieter im Dienst.</span><span class="sxs-lookup"><span data-stu-id="9ff57-109">Install each provider in the service.</span></span>
    
- <span data-ttu-id="9ff57-110">Erstellen Sie Registrierung und Initialisierung Einträge in der Datei.</span><span class="sxs-lookup"><span data-stu-id="9ff57-110">Create registry and initialization file entries.</span></span>
    
- <span data-ttu-id="9ff57-111">Erstellen Sie Einträge in der MAPI-Konfigurationsdatei Mapisvc.inf.</span><span class="sxs-lookup"><span data-stu-id="9ff57-111">Create entries in the MAPI configuration file, Mapisvc.inf.</span></span>
    
<span data-ttu-id="9ff57-112">Die Datei "Mapisvc.inf" enthält Informationen zur Konfiguration aller Message-Dienste und-Dienstanbieter, die auf dem Computer installiert.</span><span class="sxs-lookup"><span data-stu-id="9ff57-112">The Mapisvc.inf file contains information that relates to the configuration of all message services and service providers installed on the computer.</span></span> <span data-ttu-id="9ff57-113">Es wird mit jeder verknüpft zur nächsten Stufe in hierarchische Abschnitten angeordnet.</span><span class="sxs-lookup"><span data-stu-id="9ff57-113">It is organized in hierarchical sections, with each level linked to the next.</span></span> <span data-ttu-id="9ff57-114">Klicken Sie oben sind drei Abschnitte, die Folgendes enthalten:</span><span class="sxs-lookup"><span data-stu-id="9ff57-114">At the top are three sections that contain the following:</span></span> 
  
- <span data-ttu-id="9ff57-115">Eine Liste der Nachricht Service-Hilfedateien.</span><span class="sxs-lookup"><span data-stu-id="9ff57-115">A list of message service Help files.</span></span>
    
- <span data-ttu-id="9ff57-116">Eine Liste der wichtigsten oder in der Standardeinstellung Message-Dienste.</span><span class="sxs-lookup"><span data-stu-id="9ff57-116">A list of the most important, or default, message services.</span></span>
    
- <span data-ttu-id="9ff57-117">Eine Liste aller Dienste auf dem Computer.</span><span class="sxs-lookup"><span data-stu-id="9ff57-117">A list of all the services on the computer.</span></span>
    
<span data-ttu-id="9ff57-118">Die nächste Ebene enthält Abschnitte für jeden Nachrichtendienst und die letzte Ebene enthält Abschnitte für jeden Anbieter in einem Dienst.</span><span class="sxs-lookup"><span data-stu-id="9ff57-118">The next level contains sections for each message service, and the last level contains sections for each service provider in a service.</span></span> <span data-ttu-id="9ff57-119">MAPI erfordert, dass Entwickler der Dienstanbieter und Message Dienste Mapisvc.inf bestimmte Einträge hinzufügen. Entwickler können ihre eigenen Ermessen anderen Einträge hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="9ff57-119">MAPI requires that developers of service providers and message services add certain entries to Mapisvc.inf; developers can add other entries at their own discretion.</span></span> <span data-ttu-id="9ff57-120">Die meisten Informationen in Mapisvc.inf letztendlich in eine oder mehrere Profile, eine Auflistung von Konfigurationsinformationen für eines Benutzers bevorzugte Satz von Message-Dienste.</span><span class="sxs-lookup"><span data-stu-id="9ff57-120">Most of the information in Mapisvc.inf ends up in one or more profiles, a collection of configuration information for a user's preferred set of message services.</span></span> <span data-ttu-id="9ff57-121">Da mehrere Benutzer über einen Computer verfügen kann und ein einzelner Benutzer kann mehrere Sätze von Voreinstellungen haben, können auf einem Computer viele Profile vorhanden.</span><span class="sxs-lookup"><span data-stu-id="9ff57-121">Because a computer can have multiple users and a single user can have multiple sets of preferences, many profiles can exist on a computer.</span></span> <span data-ttu-id="9ff57-122">Jedes Profil wird eine andere Menge von Message-Dienste beschrieben.</span><span class="sxs-lookup"><span data-stu-id="9ff57-122">Each profile describes a different set of message services.</span></span> <span data-ttu-id="9ff57-123">Mehrere Profile ermöglicht einen Benutzer, beispielsweise zu Hause einen Satz mit einem anderen Satz von Message-Dienste und sich im Büro entwickelt.</span><span class="sxs-lookup"><span data-stu-id="9ff57-123">Having multiple profiles enables a user to work, for example, at home with one set of message services and at the office with a different set.</span></span>
  
<span data-ttu-id="9ff57-124">Profile werden während der Installation von Message Service oder Anmeldung von einer Clientanwendung erstellt, die Konfiguration unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9ff57-124">Profiles are created at message service installation or logon time by a client application that provides configuration support.</span></span> <span data-ttu-id="9ff57-125">MAPI bietet zwei solche Client Applications: eines Systemsteuerungsobjekts und der Profil-Assistent.</span><span class="sxs-lookup"><span data-stu-id="9ff57-125">MAPI provides two such client applications: a Control Panel item and the Profile Wizard.</span></span> <span data-ttu-id="9ff57-126">Das Systemsteuerungselement ist eine kompletter Service Configuration-Anwendung, mit der Benutzer können erstellen, löschen, bearbeiten, und Kopieren von Profilen sowie nehmen Sie Änderungen vor, um die Einträge in einem Profil.</span><span class="sxs-lookup"><span data-stu-id="9ff57-126">The Control Panel item is a full-service configuration application with which users can create, delete, edit, and copy profiles, as well as make modifications to the entries in a profile.</span></span> <span data-ttu-id="9ff57-127">Der Profil-Assistent ist eine einfache Anwendung, die mit dem Hinzufügen einer Messagingdiensts zu einem Profil so einfach wie möglich.</span><span class="sxs-lookup"><span data-stu-id="9ff57-127">The Profile Wizard is a simple application designed to make adding a message service to a profile as easy as possible.</span></span> <span data-ttu-id="9ff57-128">Der Profil-Assistent besteht aus einer Reihe von Dialogfeldern, aufgerufen, die den Benutzer durch den Prozess der Installation und Konfiguration eines Diensts auffordern Eigenschaftenseiten.</span><span class="sxs-lookup"><span data-stu-id="9ff57-128">The Profile Wizard consists of a series of dialog boxes, called property pages, that prompt the user through the process of installing and configuring a service.</span></span> <span data-ttu-id="9ff57-129">Der Benutzer ist nur für Werte für die wichtigsten Einstellungen aufgefordert. Alle anderen Einstellungen erben die Standardwerte.</span><span class="sxs-lookup"><span data-stu-id="9ff57-129">The user is prompted only for values for the most critical settings; all other settings inherit default values.</span></span> <span data-ttu-id="9ff57-130">Nachdem das Profil erstellt wurde, sind Benutzer nicht zulässig, um Änderungen vorzunehmen.</span><span class="sxs-lookup"><span data-stu-id="9ff57-130">Once the profile has been created, users are not allowed to make changes.</span></span> 
  
<span data-ttu-id="9ff57-131">Während der das Systemsteuerungselement immer über die Systemsteuerung aufgerufen wird, sind eine Vielzahl von Szenarien, in denen der Profil-Assistent aus aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="9ff57-131">Whereas the Control Panel item is always invoked through the Control Panel, there are a variety of scenarios that can cause the Profile Wizard to be called.</span></span> <span data-ttu-id="9ff57-132">Clientanwendungen können Aufrufen der Profil-Assistent zum Erstellen eines Standardprofils bei der Anmeldung, wenn eine nicht noch erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="9ff57-132">Client applications can call the Profile Wizard to create a default profile at logon time when one has not yet been created.</span></span> <span data-ttu-id="9ff57-133">Statt die Implementierung von Code zum Hinzufügen eines Profils, kann das Systemsteuerungselement oder einer anderen Clientanwendung auf die Funktionalität bereits in der Profil-Assistent verlassen.</span><span class="sxs-lookup"><span data-stu-id="9ff57-133">Rather than reimplementing code to add a profile, the Control Panel item or another client application can rely on the functionality already in the Profile Wizard.</span></span> <span data-ttu-id="9ff57-134">Ein Nachrichtendienst kann im zugehörigen Eintrag Punkt der Profil-Assistent beim Aufrufen der Dienst muss das Standardprofil hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="9ff57-134">A message service, in its entry point function, can call the Profile Wizard when the service needs to be added to the default profile.</span></span> <span data-ttu-id="9ff57-135">Message-Dienste, die den Profil-Assistenten verwenden, müssen ein zusätzlicher Eintrag-Funktion und standardmäßigen Windows-Dialogfeld Feld Prozedur schreiben.</span><span class="sxs-lookup"><span data-stu-id="9ff57-135">Message services that use the Profile Wizard must write an extra entry point function and a standard Windows dialog box procedure.</span></span> <span data-ttu-id="9ff57-136">Der Profil-Assistent Ruft die Eintrags-Funktion, um im Dialogfeld Konfiguration des Dienstes abzurufen, während das Dialogfeld Feld Verfahren die Nachrichten, die generiert werden verarbeitet, wenn das Dialogfeld verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9ff57-136">The Profile Wizard calls the entry point function to retrieve the service's configuration dialog box while the dialog box procedure handles the messages that are generated when this dialog box is in use.</span></span> 
  
<span data-ttu-id="9ff57-137">Profile sind in der Datei "Mapisvc.inf" ähnlich wie organisiert.</span><span class="sxs-lookup"><span data-stu-id="9ff57-137">Profiles are organized in a similar way to the Mapisvc.inf file.</span></span> <span data-ttu-id="9ff57-138">Profile haben hierarchische Abschnitte verknüpft. Service Provider eigenen Abschnitte in der untersten Ebene, Message Dienste besitzen Abschnitte in der mittleren Ebene, und MAPI Abschnitte in der höchsten Ebene besitzt.</span><span class="sxs-lookup"><span data-stu-id="9ff57-138">Profiles have linked hierarchical sections; service providers own sections in the lowest level, message services own sections in the middle level, and MAPI owns sections in the highest level.</span></span> <span data-ttu-id="9ff57-139">Jeder Abschnitt wird durch eine eindeutige ID, die als eine [MAPIUID](mapiuid.md)bezeichnet identifiziert.</span><span class="sxs-lookup"><span data-stu-id="9ff57-139">Each section is identified with a unique identifier known as a [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="9ff57-140">Die MAPI-Abschnitte enthalten Informationen, die interne MAPI, wie die IDs aller die Nachricht Service Profil Abschnitte und Links zu den anderen Abschnitten.</span><span class="sxs-lookup"><span data-stu-id="9ff57-140">The MAPI sections contain information internal to MAPI, such as the identifiers of all of the message service profile sections and links to each of the other sections.</span></span> <span data-ttu-id="9ff57-141">Jeder Abschnitt Nachricht Service speichert Links zu den Abschnitten Anbieter und jede Anbieterabschnitt speichert einen Link zu einem Abschnitt Service.</span><span class="sxs-lookup"><span data-stu-id="9ff57-141">Each message service section stores links to its provider sections, and each provider section stores a link to its service section.</span></span> 
  
<span data-ttu-id="9ff57-142">Die folgende Abbildung zeigt den Inhalt der beiden typische Profile.</span><span class="sxs-lookup"><span data-stu-id="9ff57-142">The following illustration shows the contents of two typical profiles.</span></span> <span data-ttu-id="9ff57-143">SAM hat zwei Profile auf seinem Computer, einen für die private Nutzung und einen für die Verwendung von Office.</span><span class="sxs-lookup"><span data-stu-id="9ff57-143">Sam has two profiles on his computer, one for home use and one for office use.</span></span> <span data-ttu-id="9ff57-144">Das private Profil enthält drei Message-Dienste.</span><span class="sxs-lookup"><span data-stu-id="9ff57-144">The home profile contains three message services.</span></span> <span data-ttu-id="9ff57-145">Nachricht Service X ist ein einzelner Anbieterdienst für die adressbuchverwaltung.</span><span class="sxs-lookup"><span data-stu-id="9ff57-145">Message Service X is a single provider service for address book management.</span></span> <span data-ttu-id="9ff57-146">Nachricht Services Y und Z haben drei Anbieter – Adressbuch-Dienstanbieter, eine Nachricht Speicheranbieter und eines Transportdienstes.</span><span class="sxs-lookup"><span data-stu-id="9ff57-146">Message Services Y and Z have three providers — an address book provider, a message store provider, and a transport provider.</span></span> <span data-ttu-id="9ff57-147">SAM Arbeit Profil enthält zwei unterschiedlichen Nachrichten, die Dienste, von die jedes Adressbuch-Dienstanbieter, eine Nachricht Speicheranbieter und eines Transportdienstes hat.</span><span class="sxs-lookup"><span data-stu-id="9ff57-147">Sam's Work Profile contains two different message services, each of which has an address book provider, a message store provider, and a transport provider.</span></span> 
  
<span data-ttu-id="9ff57-148">**Profilbeispiel**</span><span class="sxs-lookup"><span data-stu-id="9ff57-148">**Profile example**</span></span>
  
<span data-ttu-id="9ff57-149">![Profilbeispiel] (media/amapi_56.gif "Profilbeispiel")</span><span class="sxs-lookup"><span data-stu-id="9ff57-149">![Profile example](media/amapi_56.gif "Profile example")</span></span>
  
<span data-ttu-id="9ff57-150">Die folgende Abbildung zeigt ein Profil, das zwei Nachrichtendienste enthält.</span><span class="sxs-lookup"><span data-stu-id="9ff57-150">The following illustration shows a profile that includes two message services.</span></span> <span data-ttu-id="9ff57-151">Der Code zum Installieren und Konfigurieren der Dienstanbieter, die den Dienst angehören, befindet sich in derselben DLL-Datei wie der Code für den Anbieter.</span><span class="sxs-lookup"><span data-stu-id="9ff57-151">The code for installing and configuring the service providers that belong to the message service resides in the same DLL as the code for the providers.</span></span> <span data-ttu-id="9ff57-152">Dieser Code liest Informationen aus dem Profil bei der Anmeldung die-Dienstanbieter zu konfigurieren, und sie werden aufgefordert, den Benutzer, wenn möglich und gegebenenfalls fehlende Informationen.</span><span class="sxs-lookup"><span data-stu-id="9ff57-152">This code reads information from the profile at logon time to configure the service providers, and it prompts the user, if possible and necessary, for missing information.</span></span> <span data-ttu-id="9ff57-153">Durch diesen Code allgemeine gekennzeichnete auch Anfragen von einem Client anzeigen oder Ändern von Konfigurationseinstellungen für den Anbieter.</span><span class="sxs-lookup"><span data-stu-id="9ff57-153">Requests from a client to view or change configuration settings for any of the providers are also handled by this common code.</span></span>
  
<span data-ttu-id="9ff57-154">**Installieren und Konfigurieren von Serviceanbietern**</span><span class="sxs-lookup"><span data-stu-id="9ff57-154">**Installing and configuring service providers**</span></span>
  
<span data-ttu-id="9ff57-155">![Installieren und Konfigurieren von Dienstanbietern] (media/amapi_55.gif "Installieren und Konfigurieren von Dienstanbietern")</span><span class="sxs-lookup"><span data-stu-id="9ff57-155">![Installing and configuring service providers](media/amapi_55.gif "Installing and configuring service providers")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="9ff57-156">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="9ff57-156">See also</span></span>

- [<span data-ttu-id="9ff57-157">MAPIUID</span><span class="sxs-lookup"><span data-stu-id="9ff57-157">MAPIUID</span></span>](mapiuid.md)
- [<span data-ttu-id="9ff57-158">Übersicht über die MAPI-Programmierung</span><span class="sxs-lookup"><span data-stu-id="9ff57-158">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

