---
title: Senden oder Empfangen einer Nachricht nach Bedarf
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 479404c5-4926-402a-aa12-75dd23276d75
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 15b9c8c5a56b6f37464d2469bd1d7b3e24596502
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32356476"
---
# <a name="sending-or-receiving-a-message-on-demand"></a><span data-ttu-id="4822e-103">Senden oder Empfangen einer Nachricht nach Bedarf</span><span class="sxs-lookup"><span data-stu-id="4822e-103">Sending or receiving a message on demand</span></span>
  
<span data-ttu-id="4822e-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="4822e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="4822e-105">Clients verwenden in der Regel das MAPI-Subsystem, die MAPI-Warteschlange und die Dienstanbieter, um den Zeitpunkt der Nachrichtenübermittlung und des Empfangs zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="4822e-105">Clients typically rely on the MAPI subsystem — the MAPI spooler and the service providers — to handle the timing of message transmission and reception.</span></span> <span data-ttu-id="4822e-106">Sie können dieses Timing jedoch ändern, indem Sie das Status-Objekt entweder des MAPI-Spoolers oder eines Transportanbieters verwenden.</span><span class="sxs-lookup"><span data-stu-id="4822e-106">However, you can alter this timing by using the status object of either the MAPI spooler or a transport provider.</span></span>
  
<span data-ttu-id="4822e-107">Mit der [IMAPIStatus:: FlushQueues](imapistatus-flushqueues.md) -Methode werden alle Nachrichten aus den eingehenden oder ausgehenden Warteschlangen eines oder mehrerer Transportanbieter entfernt.</span><span class="sxs-lookup"><span data-stu-id="4822e-107">The [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md) method removes all messages from one or more transport provider's incoming or outgoing queues.</span></span> <span data-ttu-id="4822e-108">In den folgenden Verfahren werden zwei Techniken zum Senden oder empfangen von Nachrichten bei Bedarf beschrieben.</span><span class="sxs-lookup"><span data-stu-id="4822e-108">The following procedures describe two techniques for sending or receiving messages on demand.</span></span> <span data-ttu-id="4822e-109">Das erste Verfahren verwendet das Status-Objekt des MAPI-Spoolers, um die Warteschlangen aller Transportanbieter im Profil zu leeren. bei der zweiten Prozedur wird die Warteschlange eines einzelnen Transportanbieters geleert.</span><span class="sxs-lookup"><span data-stu-id="4822e-109">The first procedure uses the MAPI spooler's status object to flush the queues of every transport provider in the profile; the second procedure flushes the queue of a single transport provider.</span></span> 
  
### <a name="to-flush-all-incoming-or-outgoing-queues-in-a-single-operation"></a><span data-ttu-id="4822e-110">So leeren Sie alle eingehenden oder ausgehenden Warteschlangen in einem einzelnen Vorgang</span><span class="sxs-lookup"><span data-stu-id="4822e-110">To flush all incoming or outgoing queues in a single operation</span></span>
  
1. <span data-ttu-id="4822e-111">Rufen Sie [IMAPISession::](imapisession-getstatustable.md) getstatusable auf, um auf die Statustabelle zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="4822e-111">Call [IMAPISession::GetStatusTable](imapisession-getstatustable.md) to access the status table.</span></span> 
    
2. <span data-ttu-id="4822e-112">Rufen Sie die [IMAPITable::](imapitable-setcolumns.md) SetColumns-Methode der Statustabelle auf, um den Spaltensatz auf **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) und **PR_RESOURCE_TYPE** ([pidtagresourcetype (](pidtagresourcetype-canonical-property.md)) einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="4822e-112">Call the status table's [IMAPITable::SetColumns](imapitable-setcolumns.md) method to limit the column set to **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) and **PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)).</span></span>
    
3. <span data-ttu-id="4822e-113">Erstellen Sie eine Eigenschaftseinschränkung mithilfe einer [SPropertyRestriction](spropertyrestriction.md) -Struktur, um **PR_RESOURCE_TYPE** mit MAPI_SPOOLER zu vergleichen.</span><span class="sxs-lookup"><span data-stu-id="4822e-113">Build a property restriction using an [SPropertyRestriction](spropertyrestriction.md) structure to match **PR_RESOURCE_TYPE** with MAPI_SPOOLER.</span></span> 
    
4. <span data-ttu-id="4822e-114">Rufen Sie [HrQueryAllRows](hrqueryallrows.md)auf, und übergeben Sie die **SPropertyRestriction** -Struktur, um die Zeile abzurufen, die den Status des MAPI-Spoolers darstellt.</span><span class="sxs-lookup"><span data-stu-id="4822e-114">Call [HrQueryAllRows](hrqueryallrows.md), passing in the **SPropertyRestriction** structure, to retrieve the row that represents the status of the MAPI spooler.</span></span> 
    
5. <span data-ttu-id="4822e-115">Führen Sie die **PR_ENTRYID** -Spalte an [IMAPISession:: OpenEntry](imapisession-openentry.md) , um das Statusobjekt des MAPI-Spoolers zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="4822e-115">Pass the **PR_ENTRYID** column to [IMAPISession::OpenEntry](imapisession-openentry.md) to open the MAPI spooler's status object.</span></span> 
    
6. <span data-ttu-id="4822e-116">Rufen Sie die [IMAPIStatus:: FlushQueues](imapistatus-flushqueues.md) -Methode des MAPI-Spoolers auf, und übergeben Sie das FLUSH_NO_UI-Flag, um die Benutzeroberfläche und das FLUSH_DOWNLOAD-oder FLUSH_UPLOAD-Flag zum leeren der ausgehenden oder eingehenden Warteschlangen zu unterdrücken.</span><span class="sxs-lookup"><span data-stu-id="4822e-116">Call the MAPI spooler's [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md) method, passing the FLUSH_NO_UI flag to suppress the user interface and either the FLUSH_DOWNLOAD or FLUSH_UPLOAD flag to flush the outgoing or incoming queues.</span></span> 
    
7. <span data-ttu-id="4822e-117">Geben Sie das Status-und die Status-Tabelle sowie die [SRowSet](srowset.md) -Struktur frei, die für die Tabelle reserviert ist.</span><span class="sxs-lookup"><span data-stu-id="4822e-117">Release the status object and the status table, as well as the [SRowSet](srowset.md) structure that is allocated for the table.</span></span> 
    
### <a name="to-flush-incoming-or-outgoing-queues-individually-by-transport-provider"></a><span data-ttu-id="4822e-118">So leeren Sie eingehende oder ausgehende Warteschlangen einzeln über den Transportanbieter</span><span class="sxs-lookup"><span data-stu-id="4822e-118">To flush incoming or outgoing queues individually by transport provider</span></span>
  
1. <span data-ttu-id="4822e-119">Rufen Sie [IMAPISession::](imapisession-getstatustable.md) getstatusable auf, um auf die Statustabelle zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="4822e-119">Call [IMAPISession::GetStatusTable](imapisession-getstatustable.md) to access the status table.</span></span> 
    
2. <span data-ttu-id="4822e-120">Rufen Sie die [IMAPITable::](imapitable-setcolumns.md) SetColumns-Methode der Statustabelle auf, um den Spaltensatz auf **PR_ENTRYID** und **PR_RESOURCE_TYPE**zu begrenzen.</span><span class="sxs-lookup"><span data-stu-id="4822e-120">Call the status table's [IMAPITable::SetColumns](imapitable-setcolumns.md) method to limit the column set to **PR_ENTRYID** and **PR_RESOURCE_TYPE**.</span></span>
    
3. <span data-ttu-id="4822e-121">Erstellen Sie eine Eigenschaftseinschränkung mithilfe einer [SPropertyRestriction](spropertyrestriction.md) -Struktur, um **PR_RESOURCE_TYPE** mit MAPI_TRANSPORT_PROVIDER zu vergleichen.</span><span class="sxs-lookup"><span data-stu-id="4822e-121">Build a property restriction using an [SPropertyRestriction](spropertyrestriction.md) structure to match **PR_RESOURCE_TYPE** with MAPI_TRANSPORT_PROVIDER.</span></span> 
    
4. <span data-ttu-id="4822e-122">Rufen Sie [HrQueryAllRows](hrqueryallrows.md)auf, und übergeben Sie die **SPropertyRestriction** -Struktur, um die Zeilen abzurufen, die von Transportanbietern bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="4822e-122">Call [HrQueryAllRows](hrqueryallrows.md), passing in the **SPropertyRestriction** structure, to retrieve the rows that are supplied by transport providers.</span></span> 
    
5. <span data-ttu-id="4822e-123">Für jede Zeile, die von **HrQueryAllRows**zurückgegeben wird:</span><span class="sxs-lookup"><span data-stu-id="4822e-123">For each row returned from **HrQueryAllRows**:</span></span>
    
    1. <span data-ttu-id="4822e-124">Führen Sie die **PR_ENTRYID** -Spalte an [IMAPISession:: OpenEntry](imapisession-openentry.md) , um das Status-Objekt des Transportanbieters zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="4822e-124">Pass the **PR_ENTRYID** column to [IMAPISession::OpenEntry](imapisession-openentry.md) to open the transport provider's status object.</span></span> 
        
    2. <span data-ttu-id="4822e-125">Überprüfen Sie, ob das Transportstatus Objekt die **FlushQueues** -Methode unterstützt, indem Sie überprüfen, ob die **PR_RESOURCE_METHODS** ([PIDTAGRESOURCEMETHODS (](pidtagresourcemethods-canonical-property.md))-Eigenschaft das STATUS_FLUSH_QUEUES-Flag festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="4822e-125">Check that the transport status object supports the **FlushQueues** method by checking that its **PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md)) property has the STATUS_FLUSH_QUEUES flag set.</span></span> 
        
    3. <span data-ttu-id="4822e-126">Wenn unterstützt, rufen Sie [IMAPIStatus:: FlushQueues](imapistatus-flushqueues.md).</span><span class="sxs-lookup"><span data-stu-id="4822e-126">If supported, call [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md).</span></span> <span data-ttu-id="4822e-127">Wenn diese nicht unterstützt wird, rufen Sie die **IMAPIStatus:: FlushQueues** -Methode des MAPI-Spoolers auf, und übergeben Sie den Eintragsbezeichner des Transports im _lpTargetTransport_ -Parameter.</span><span class="sxs-lookup"><span data-stu-id="4822e-127">If unsupported, call the MAPI spooler's **IMAPIStatus::FlushQueues** method, passing the entry identifier of the transport in the  _lpTargetTransport_ parameter.</span></span> <span data-ttu-id="4822e-128">Im vorherigen Verfahren finden Sie Anweisungen für den Zugriff auf das Statusobjekt des MAPI-Spoolers.</span><span class="sxs-lookup"><span data-stu-id="4822e-128">See the preceding procedure for instructions on accessing the MAPI spooler's status object.</span></span> <span data-ttu-id="4822e-129">Legen Sie das FLUSH_DOWNLOAD-Flag so fest, dass die ausgehenden Warteschlangen oder das FLUSH_UPLOAD-Flag geleert werden.</span><span class="sxs-lookup"><span data-stu-id="4822e-129">Set the FLUSH_DOWNLOAD flag to flush the outgoing queues or the FLUSH_UPLOAD flag to flush the incoming queues.</span></span> 
        
    4. <span data-ttu-id="4822e-130">Geben Sie das Status-und die Status-Tabelle sowie die [SRowSet](srowset.md) -Struktur frei, die für die Tabelle reserviert ist.</span><span class="sxs-lookup"><span data-stu-id="4822e-130">Release the status object and the status table, as well as the [SRowSet](srowset.md) structure that is allocated for the table.</span></span> 
    
<span data-ttu-id="4822e-131">Der MAPI-Spooler würdigt das FLUSH_NO_UI-Flag wie die meisten LAN-Transportanbieter.</span><span class="sxs-lookup"><span data-stu-id="4822e-131">The MAPI spooler honors the FLUSH_NO_UI flag as do most LAN transport providers.</span></span> <span data-ttu-id="4822e-132">Nicht alle Transportanbieter Ehren dieses Flag, insbesondere solche, die explizit ein Modem verwenden, und den RAS-Dienst.</span><span class="sxs-lookup"><span data-stu-id="4822e-132">However, not all transport providers honor this flag, particularly those that use a modem explicitly and the Remote Access Service (RAS).</span></span> <span data-ttu-id="4822e-133">RAS wurde nicht entwickelt, um Clients das Unterdrücken der Benutzeroberfläche zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="4822e-133">RAS was not designed to allow clients to suppress the user interface.</span></span> <span data-ttu-id="4822e-134">Es ist möglich, dass ein Client so konfiguriert ist, dass er eine Verbindung herstellen kann, ohne die Interaktion eines Benutzers zu erfordern, aber es ist schwierig und erfordert eine genaue Kenntnis der Nachrichtendienste des Clients.</span><span class="sxs-lookup"><span data-stu-id="4822e-134">It is possible for a client to be configured so that it can connect without requiring the interaction of a user, but it is difficult and requires intimate knowledge of the client's message services.</span></span>
  

