---
title: Ereignisbenachrichtigung in MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7b3b625b-6dea-4b12-99a9-152935bdfe39
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 9c1fd58a31481d8666ca931408c16bd73aaba660
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19791656"
---
# <a name="event-notification-in-mapi"></a><span data-ttu-id="0917d-103">Ereignisbenachrichtigung in MAPI</span><span class="sxs-lookup"><span data-stu-id="0917d-103">Event notification in MAPI</span></span>

<span data-ttu-id="0917d-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="0917d-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="0917d-105">Benachrichtigung bei ist die Kommunikation des Informationsflusses zwischen zwei MAPI-Objekte.</span><span class="sxs-lookup"><span data-stu-id="0917d-105">Event notification is the communication of information between two MAPI objects.</span></span> <span data-ttu-id="0917d-106">Registriert über eines der Objekte ein Client oder Dienstanbieter für die Benachrichtigung über eine Änderung oder einen Fehler, aufgerufen, ein Ereignis, die in dem anderen Objekt erfolgen kann.</span><span class="sxs-lookup"><span data-stu-id="0917d-106">Through one of the objects, a client or service provider registers for notification of a change or error, called an event, which may take place in the other object.</span></span> <span data-ttu-id="0917d-107">Nachdem das Ereignis auftritt, wird das erste Objekt ändern oder Fehler benachrichtigt.</span><span class="sxs-lookup"><span data-stu-id="0917d-107">After the event occurs, the first object is notified of the change or error.</span></span> <span data-ttu-id="0917d-108">Das Objekt, das die Benachrichtigung empfangen, wird den Advise-Empfänger aufgerufen. das Objekt, die verantwortlich für die Benachrichtigung wird die Advise-Quelle bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="0917d-108">The object receiving the notification is called the advise sink; the object responsible for the notification is called the advise source.</span></span>
  
<span data-ttu-id="0917d-109">Es gibt drei Typen von Advise Empfängerobjekten (alle Typen sind standard MAPI-Objekte):</span><span class="sxs-lookup"><span data-stu-id="0917d-109">There are three types of advise sink objects (all types are standard MAPI objects):</span></span>
  
- <span data-ttu-id="0917d-110">Empfehlen Sie Empfängerobjekten.</span><span class="sxs-lookup"><span data-stu-id="0917d-110">Advise sink objects.</span></span>   
- <span data-ttu-id="0917d-111">Formular advise-Empfängerobjekten.</span><span class="sxs-lookup"><span data-stu-id="0917d-111">Form advise sink objects.</span></span>  
- <span data-ttu-id="0917d-112">Ansicht advise-Empfängerobjekten.</span><span class="sxs-lookup"><span data-stu-id="0917d-112">View advise sink objects.</span></span>
    
<span data-ttu-id="0917d-113">Informieren Sie die am häufigsten verwendeten Empfängerobjekten sind.</span><span class="sxs-lookup"><span data-stu-id="0917d-113">Advise sink objects are the most common type.</span></span> <span data-ttu-id="0917d-114">Advise-Senken sind in der Regel von Clientanwendungen Adressbuch und Benachrichtigungen über Textnachrichten Store and Support erhalten implementiert die [IMAPIAdviseSink: IUnknown](imapiadvisesinkiunknown.md) Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="0917d-114">Advise sinks are typically implemented by client applications to receive address book and message store notifications and support the [IMAPIAdviseSink : IUnknown](imapiadvisesinkiunknown.md) interface.</span></span> <span data-ttu-id="0917d-115">**IMAPIAdviseSink** enthält eine einzige Methode auf, [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md).</span><span class="sxs-lookup"><span data-stu-id="0917d-115">**IMAPIAdviseSink** contains a single method, [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md).</span></span> <span data-ttu-id="0917d-116">Formular- und darauf hinzuweisen, dass senken seltener sind; Sie werden implementiert Erhalt von Benachrichtigungen zu Änderungen für benutzerdefinierte Formulare.</span><span class="sxs-lookup"><span data-stu-id="0917d-116">Form and view advise sinks are less common; they are implemented to receive notifications about changes to custom forms.</span></span> <span data-ttu-id="0917d-117">Formular advise-senken Unterstützung der [IMAPIFormAdviseSink: IUnknown](imapiformadvisesinkiunknown.md) senken Support advise-Schnittstelle und Anzeigen der [IMAPIViewAdviseSink: IUnknown](imapiviewadvisesinkiunknown.md) Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="0917d-117">Form advise sinks support the [IMAPIFormAdviseSink : IUnknown](imapiformadvisesinkiunknown.md) interface and view advise sinks support the [IMAPIViewAdviseSink : IUnknown](imapiviewadvisesinkiunknown.md) interface.</span></span> <span data-ttu-id="0917d-118">Da die meisten Clients Einst advise-Empfängerobjekten, wird davon ausgegangen Sie, dass der Benachrichtigungen an Diskussionen mit Adressbuch und Benachrichtigungen über Textnachrichten Store statt Forms Benachrichtigungen verknüpft sind.</span><span class="sxs-lookup"><span data-stu-id="0917d-118">Because most clients implement standard advise sink objects, assume that discussions of notifications relate to address book and message store notifications rather than forms notifications.</span></span> <span data-ttu-id="0917d-119">Weitere Informationen zu Formularen Benachrichtigungen finden Sie unter [MAPI-Formulare Benachrichtigungen](mapi-forms-notifications.md) und [Schreiben von Formularcode Server](writing-form-server-code.md).</span><span class="sxs-lookup"><span data-stu-id="0917d-119">For more information about forms notifications, see [MAPI Forms Notifications](mapi-forms-notifications.md) and [Writing Form Server Code](writing-form-server-code.md).</span></span>
  
<span data-ttu-id="0917d-120">Informieren Sie die Objekte implementiert werden, indem Dienstanbieter und MAPI-Quelle.</span><span class="sxs-lookup"><span data-stu-id="0917d-120">Advise source objects are implemented by service providers and by MAPI.</span></span> <span data-ttu-id="0917d-121">Nicht alle Dienstanbieter unterstützen ereignisbenachrichtigung; Es ist optional, aber dringend empfohlen.</span><span class="sxs-lookup"><span data-stu-id="0917d-121">Not all service providers support event notification; it is optional, but strongly recommended.</span></span> <span data-ttu-id="0917d-122">Nachrichtenspeicher und Adressbucheinträge Anbieter Benachrichtigungen von Support-Objekt in der Regel für mehrere Objekte und Benachrichtigungen auf ihren Inhalt und Hierarchietabellen Tabelle.</span><span class="sxs-lookup"><span data-stu-id="0917d-122">Message store and address book providers usually support object notifications on several of their objects and table notifications on their contents and hierarchy tables.</span></span> <span data-ttu-id="0917d-123">Transportanbieter unterstützen Benachrichtigungen nicht direkt. geschäftswichtige alternativer Methoden der Kommunikation mit Clients.</span><span class="sxs-lookup"><span data-stu-id="0917d-123">Transport providers do not support notifications directly; they rely on alternative methods of communication with clients.</span></span>
  
<span data-ttu-id="0917d-124">Im Gegensatz zu Advise-senken empfehlen Sie, dass die Source-Objekten nicht über einen eindeutigen Objekttyp MAPI sind.</span><span class="sxs-lookup"><span data-stu-id="0917d-124">Unlike advise sinks, advise source objects are not a unique type of MAPI object.</span></span> <span data-ttu-id="0917d-125">Viele MAPI-Objekte, wie Nachrichtenspeicher und Tabellen, dauert die Rolle des Advise-Quelle.</span><span class="sxs-lookup"><span data-stu-id="0917d-125">Many MAPI objects, such as message stores and tables, can take on the role of advise source.</span></span> <span data-ttu-id="0917d-126">Eine Advise-Datenquelle ist jedes MAPI-Objekt mit den folgenden Funktionen:</span><span class="sxs-lookup"><span data-stu-id="0917d-126">An advise source is any MAPI object that does the following:</span></span>
  
- <span data-ttu-id="0917d-127">Implementiert eine **Advise** -Methode, um Registrierungen Benachrichtigung zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="0917d-127">Implements an **Advise** method to receive notification registrations.</span></span> 
    
- <span data-ttu-id="0917d-128">Implementiert eine **Unadvise** -Methode zum absagen Benachrichtigung zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="0917d-128">Implements an **Unadvise** method to receive notification cancellations.</span></span> 
    
- <span data-ttu-id="0917d-129">Generiert Benachrichtigungen des entsprechenden Typs auf die entsprechenden Advise-Empfänger-Objekte, die durch den Aufruf ihrer **IMAPIAdviseSink::OnNotify** Methoden registriert.</span><span class="sxs-lookup"><span data-stu-id="0917d-129">Generates notifications of the appropriate type to the appropriate advise sink objects that have registered by calling their **IMAPIAdviseSink::OnNotify** methods.</span></span> 
    
<span data-ttu-id="0917d-130">Clients, die implementiert werden ausschließlich Empfängerobjekten **Advise** aufrufen, wenn sie möchten, registrieren Sie sich für eine Benachrichtigung, in den meisten Fällen in die Eintrags-ID des Objekts mit der Registrierung erfolgen soll, und **Unadvise** übergeben, wenn sie abbrechen möchten die Registrierung.</span><span class="sxs-lookup"><span data-stu-id="0917d-130">Clients that implement advise sink objects call **Advise** when they want to register for a notification, in most cases passing in the entry identifier of the object with which registration should occur, and **Unadvise** when they want to cancel the registration.</span></span> <span data-ttu-id="0917d-131">Clients übergeben Sie einen Parameter an **anweisen** , die verschiedene Typen von Ereignissen gibt an, die sie überwachen möchten.</span><span class="sxs-lookup"><span data-stu-id="0917d-131">Clients pass a parameter to **Advise** that indicates which of the several types of events they want to monitor.</span></span> <span data-ttu-id="0917d-132">**Advise** gibt eine Zahl ungleich NULL, die eine erfolgreiche Verbindung zwischen der Advise-Empfänger und Advise-Quelle darstellt.</span><span class="sxs-lookup"><span data-stu-id="0917d-132">**Advise** returns a nonzero number that represents a successful connection between the advise sink and advise source.</span></span> 
  
<span data-ttu-id="0917d-133">Vor dem Aufruf von **anweisen**, können Clients bestimmen, ob eine Nachricht Speicheranbieter Benachrichtigung Mobilgeräts unterstützt, die das Flag STORE_NOTIFY_OK in den Nachrichtenspeicher **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) festgelegt ist -Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="0917d-133">Before calling **Advise**, clients can determine whether a message store provider supports notification by checking that the STORE_NOTIFY_OK flag is set in the message store's **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span> <span data-ttu-id="0917d-134">Besteht keine Möglichkeit für Clients, um feststellen, ob ein Adressbuchanbieter Benachrichtigungen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="0917d-134">There is no way for clients to determine ahead of time whether or not an address book provider supports notifications.</span></span> <span data-ttu-id="0917d-135">Clients müssen versuchen, registrieren, und wenn der Versuch ein Fehler auftritt, sie können davon ausgegangen, dass Benachrichtigungen nicht unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="0917d-135">Clients must attempt to register and if the attempt fails, they can assume notifications are unsupported.</span></span>
  
<span data-ttu-id="0917d-136">Tritt ein Ereignis für die Clientidentität registriert hat, benachrichtigt die Advise-Quelle Advise-Empfänger, indem er seine [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) -Methode mit einer Benachrichtigung-Datenstruktur Informationen über das Ereignis enthält.</span><span class="sxs-lookup"><span data-stu-id="0917d-136">When an event for which a client has registered occurs, the advise source notifies the advise sink by calling its [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) method with a notification data structure that contains information about the event.</span></span> <span data-ttu-id="0917d-137">Implementierung von **OnNotify** Advise-Empfänger kann als Antwort auf die Benachrichtigung, wie das Aktualisieren von Daten im Arbeitsspeicher oder Aktualisieren einer Bildschirmanzeige Aufgaben ausführen.</span><span class="sxs-lookup"><span data-stu-id="0917d-137">An advise sink's implementation of **OnNotify** can perform tasks in response to the notification, such as updating data in memory or refreshing a screen display.</span></span> 
  
<span data-ttu-id="0917d-138">Dienstanbieter implementieren die Unterstützung für Benachrichtigungen manuell oder der Hilfe in drei **IMAPISupport** Methoden nutzen können: [IMAPISupport::Subscribe](imapisupport-subscribe.md), [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md)und [IMAPISupport::Notify ](imapisupport-notify.md).</span><span class="sxs-lookup"><span data-stu-id="0917d-138">Service providers can implement support for notifications manually or take advantage of the help provided in three **IMAPISupport** methods: [IMAPISupport::Subscribe](imapisupport-subscribe.md), [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md), and [IMAPISupport::Notify](imapisupport-notify.md).</span></span> <span data-ttu-id="0917d-139">Die Methoden **Abonnieren** und **kündigen** benachrichtigungsregistrierung behandeln und für Anbieter für die Registrierung aufgehoben; die Methode **Benachrichtigen** verarbeitet sendende Benachrichtigungen bei Bedarf.</span><span class="sxs-lookup"><span data-stu-id="0917d-139">The **Subscribe** and **Unsubscribe** methods handle notification registration and deregistration for providers; the **Notify** method handles sending notifications when appropriate.</span></span> 
  
<span data-ttu-id="0917d-140">Für die Verwendung der Methoden des Support-Objekts für benachrichtigungsregistrierung-Dienstanbieter [IMAPISupport::Subscribe](imapisupport-subscribe.md) in ihren **Advise** -Methoden aufrufen und übergeben Sie **Abonnieren** den Advise-Empfängerzeiger, den Clients an **Advise**übergeben.</span><span class="sxs-lookup"><span data-stu-id="0917d-140">To use the support object methods for notification registration, service providers call [IMAPISupport::Subscribe](imapisupport-subscribe.md) in their **Advise** methods and pass to **Subscribe** the advise sink pointer that clients pass to **Advise**.</span></span> <span data-ttu-id="0917d-141">Wenn eine Eintrags-ID als Eingabeparameter an einer Datenquelle Advise übergeben wird, von Dienstanbietern zu einem binären Schlüssel konvertieren.</span><span class="sxs-lookup"><span data-stu-id="0917d-141">If an entry identifier is passed as an input parameter to specify an advise source, service providers convert it to a binary key.</span></span> <span data-ttu-id="0917d-142">**Subscribe** erstellt eine eindeutige Verbindung Reihe, und diese Nummer, die an die Clients Dienstanbieter zurückgeben kann.</span><span class="sxs-lookup"><span data-stu-id="0917d-142">**Subscribe** creates a unique connection number and it is this number that service providers return to clients.</span></span> <span data-ttu-id="0917d-143">Dienstanbieter können des Clients freigeben advise-Empfängerzeiger jederzeit nach Abschluss der **Advise** -Anruf.</span><span class="sxs-lookup"><span data-stu-id="0917d-143">Service providers can release the client's advise sink object pointer at any time after the **Advise** call has completed.</span></span> 
  
<span data-ttu-id="0917d-144">Wenn Clients **Unadvise** Abbrechen eine Registrierung Dienstanbieter aufrufen entweder die verweiszählung auf des Clients verringern advise-Empfängerzeiger, oder rufen Sie **kündigen** , um diesen Vorgang auszuführen.</span><span class="sxs-lookup"><span data-stu-id="0917d-144">When clients call **Unadvise** to cancel a registration, service providers either decrement the reference count on the client's advise sink pointer or call **Unsubscribe** to do the same.</span></span> 
  
<span data-ttu-id="0917d-145">Wenn eine Benachrichtigung generiert wird, führen Sie Dienstanbieter interne Verarbeitung, bezieht sich auf die Benachrichtigung, die eine [Benachrichtigung](notification.md) Struktur initialisiert, indem Sie alle nicht verwendeten Member auf 0 (null) festlegen.</span><span class="sxs-lookup"><span data-stu-id="0917d-145">When it is time to generate a notification, service providers perform any internal processing that relates to the notification and initializes a [NOTIFICATION](notification.md) structure by setting all of its unused members to zero.</span></span> <span data-ttu-id="0917d-146">Dieses Verfahren für die Initialisierung der **Benachrichtigung** Struktur hilft Clients kleiner, schneller und weniger fehleranfällig **OnNotify** Implementierungen zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="0917d-146">This technique for initializing the **NOTIFICATION** structure can help clients create smaller, faster, and less error-prone **OnNotify** implementations.</span></span> 
  
<span data-ttu-id="0917d-147">Die folgende Abbildung zeigt der Kommunikation zwischen Empfängerobjekten darauf hinzuweisen, advise-Source-Objekten und MAPI.</span><span class="sxs-lookup"><span data-stu-id="0917d-147">The following illustration shows the communication between advise sink objects, advise source objects, and MAPI.</span></span> <span data-ttu-id="0917d-148">MAPI ist beteiligt, nur, wenn die Advise-Quelle die **IMAPISupport** -Methoden für die Benachrichtigung Unterstützung aufruft.</span><span class="sxs-lookup"><span data-stu-id="0917d-148">MAPI is involved only when the advise source calls the **IMAPISupport** methods for notification support.</span></span> 
  
<span data-ttu-id="0917d-149">**Ereignisbenachrichtigungsaufrufe**</span><span class="sxs-lookup"><span data-stu-id="0917d-149">**Event notification calls**</span></span>
  
<span data-ttu-id="0917d-150">![Ereignisbenachrichtigungsaufrufe] (media/amapi_51.gif "Ereignisbenachrichtigungsaufrufe")</span><span class="sxs-lookup"><span data-stu-id="0917d-150">![Event notification calls](media/amapi_51.gif "Event notification calls")</span></span>
  
<span data-ttu-id="0917d-151">(Bei Verwendung der AdviseSink.h und AdviseSink.cpp-Dateien) MFCMAPI (engl.) **CAdviseSink** -Klasse implementiert das Advise-Empfängerobjekt für alle Anrufe **Advise**.</span><span class="sxs-lookup"><span data-stu-id="0917d-151">The MFCMAPI **CAdviseSink** class (using the AdviseSink.h and AdviseSink.cpp files) implements the advise sink object for all calls to **Advise**.</span></span> <span data-ttu-id="0917d-152">Weitere Informationen zu MFCMAPI (engl.) finden Sie unter [MFCMAPI (engl.) als ein Codebeispiel](mfcmapi-as-a-code-sample.md) und [MFCMAPI (engl.)](http://go.microsoft.com/fwlink/?LinkId=124154).</span><span class="sxs-lookup"><span data-stu-id="0917d-152">For more information about MFCMAPI, see [MFCMAPI as a Code Sample](mfcmapi-as-a-code-sample.md) and [MFCMAPI](http://go.microsoft.com/fwlink/?LinkId=124154).</span></span>
  

