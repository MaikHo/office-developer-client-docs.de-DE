---
title: Ereignisbenachrichtigung in MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7b3b625b-6dea-4b12-99a9-152935bdfe39
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 30d4ad5e0fc1ecdc4c8eb06f75d39e38dd481269
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32321396"
---
# <a name="event-notification-in-mapi"></a><span data-ttu-id="c7901-103">Ereignisbenachrichtigung in MAPI</span><span class="sxs-lookup"><span data-stu-id="c7901-103">Event notification in MAPI</span></span>

<span data-ttu-id="c7901-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c7901-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c7901-105">Ereignisbenachrichtigung ist die Kommunikation zwischen zwei MAPI-Objekten.</span><span class="sxs-lookup"><span data-stu-id="c7901-105">Event notification is the communication of information between two MAPI objects.</span></span> <span data-ttu-id="c7901-106">Durch eines der Objekte registriert ein Client-oder Dienstanbieter die Benachrichtigung über eine Änderung oder einen Fehler, die als Ereignis bezeichnet wird, die im anderen Objekt erfolgen kann.</span><span class="sxs-lookup"><span data-stu-id="c7901-106">Through one of the objects, a client or service provider registers for notification of a change or error, called an event, which may take place in the other object.</span></span> <span data-ttu-id="c7901-107">Nachdem das Ereignis eintritt, wird das erste Objekt über die Änderung oder den Fehler benachrichtigt.</span><span class="sxs-lookup"><span data-stu-id="c7901-107">After the event occurs, the first object is notified of the change or error.</span></span> <span data-ttu-id="c7901-108">Das Objekt, das die Benachrichtigung empfängt, wird als Advise-Senke bezeichnet. das für die Benachrichtigung zuständige Objekt wird als Advise-Quelle bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="c7901-108">The object receiving the notification is called the advise sink; the object responsible for the notification is called the advise source.</span></span>
  
<span data-ttu-id="c7901-109">Es gibt drei Typen von Advise-Senke-Objekten (alle Typen sind Standard-MAPI-Objekte):</span><span class="sxs-lookup"><span data-stu-id="c7901-109">There are three types of advise sink objects (all types are standard MAPI objects):</span></span>
  
- <span data-ttu-id="c7901-110">Advise-Objekte.</span><span class="sxs-lookup"><span data-stu-id="c7901-110">Advise sink objects.</span></span>   
- <span data-ttu-id="c7901-111">Formular Advise Sink-Objekte.</span><span class="sxs-lookup"><span data-stu-id="c7901-111">Form advise sink objects.</span></span>  
- <span data-ttu-id="c7901-112">View Advise-Senke-Objekte.</span><span class="sxs-lookup"><span data-stu-id="c7901-112">View advise sink objects.</span></span>
    
<span data-ttu-id="c7901-113">Advise-Senke-Objekte sind der häufigste Typ.</span><span class="sxs-lookup"><span data-stu-id="c7901-113">Advise sink objects are the most common type.</span></span> <span data-ttu-id="c7901-114">Advise-Senken werden in der Regel von Clientanwendungen implementiert, um Benachrichtigungen über Adressbuch-und Nachrichtenspeicher zu erhalten und die [IMAPIAdviseSink: IUnknown](imapiadvisesinkiunknown.md) -Schnittstelle zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="c7901-114">Advise sinks are typically implemented by client applications to receive address book and message store notifications and support the [IMAPIAdviseSink : IUnknown](imapiadvisesinkiunknown.md) interface.</span></span> <span data-ttu-id="c7901-115">**IMAPIAdviseSink** enthält eine einzelne Methode, [IMAPIAdviseSink:: OnNotify](imapiadvisesink-onnotify.md).</span><span class="sxs-lookup"><span data-stu-id="c7901-115">**IMAPIAdviseSink** contains a single method, [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md).</span></span> <span data-ttu-id="c7901-116">Formular-und Ansichts-Advise-Senken sind seltener; Sie werden implementiert, um Benachrichtigungen zu Änderungen an benutzerdefinierten Formularen zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="c7901-116">Form and view advise sinks are less common; they are implemented to receive notifications about changes to custom forms.</span></span> <span data-ttu-id="c7901-117">Form Advise-Senken unterstützen die [IMAPIFormAdviseSink: IUnknown](imapiformadvisesinkiunknown.md) -Schnittstelle und View Advise-Senken unterstützen die [IMAPIViewAdviseSink: IUnknown](imapiviewadvisesinkiunknown.md) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="c7901-117">Form advise sinks support the [IMAPIFormAdviseSink : IUnknown](imapiformadvisesinkiunknown.md) interface and view advise sinks support the [IMAPIViewAdviseSink : IUnknown](imapiviewadvisesinkiunknown.md) interface.</span></span> <span data-ttu-id="c7901-118">Da die meisten Clients standardmäßige Advise-Objekt Objekte implementieren, gehen Sie davon aus, dass sich die Diskussionen über Benachrichtigungen auf Adressbuch-und Nachrichtenspeicher Benachrichtigungen beziehen, statt auf Formular Benachrichtigungen.</span><span class="sxs-lookup"><span data-stu-id="c7901-118">Because most clients implement standard advise sink objects, assume that discussions of notifications relate to address book and message store notifications rather than forms notifications.</span></span> <span data-ttu-id="c7901-119">Weitere Informationen zu Formular Benachrichtigungen finden Sie unter [MAPI](mapi-forms-notifications.md) -Formular Benachrichtigungen und [Schreiben von Formular Server Code](writing-form-server-code.md).</span><span class="sxs-lookup"><span data-stu-id="c7901-119">For more information about forms notifications, see [MAPI Forms Notifications](mapi-forms-notifications.md) and [Writing Form Server Code](writing-form-server-code.md).</span></span>
  
<span data-ttu-id="c7901-120">Advise-Quellobjekte werden von Dienstanbietern und von MAPI implementiert.</span><span class="sxs-lookup"><span data-stu-id="c7901-120">Advise source objects are implemented by service providers and by MAPI.</span></span> <span data-ttu-id="c7901-121">Nicht alle Dienstanbieter unterstützen Ereignisbenachrichtigungen; Sie ist optional, wird jedoch dringend empfohlen.</span><span class="sxs-lookup"><span data-stu-id="c7901-121">Not all service providers support event notification; it is optional, but strongly recommended.</span></span> <span data-ttu-id="c7901-122">Nachrichtenspeicher-und Adressbuchanbieter unterstützen in der Regelobjekt Benachrichtigungen für mehrere Objekte und Tabellen Benachrichtigungen in ihren Inhalts-und Hierarchietabellen.</span><span class="sxs-lookup"><span data-stu-id="c7901-122">Message store and address book providers usually support object notifications on several of their objects and table notifications on their contents and hierarchy tables.</span></span> <span data-ttu-id="c7901-123">Transport Anbieter unterstützen keine Benachrichtigungen direkt; Sie setzen auf Alternative Kommunikationsmethoden mit Clients.</span><span class="sxs-lookup"><span data-stu-id="c7901-123">Transport providers do not support notifications directly; they rely on alternative methods of communication with clients.</span></span>
  
<span data-ttu-id="c7901-124">Im Gegensatz zu Advise-Senken sind Quellobjekte kein eindeutiger MAPI-Objekttyp.</span><span class="sxs-lookup"><span data-stu-id="c7901-124">Unlike advise sinks, advise source objects are not a unique type of MAPI object.</span></span> <span data-ttu-id="c7901-125">Viele MAPI-Objekte, wie Nachrichtenspeicher und Tabellen, können die Rolle der Advise-Quelle übernehmen.</span><span class="sxs-lookup"><span data-stu-id="c7901-125">Many MAPI objects, such as message stores and tables, can take on the role of advise source.</span></span> <span data-ttu-id="c7901-126">Eine Advise-Quelle ist ein MAPI-Objekt, das folgende Aktionen ausführt:</span><span class="sxs-lookup"><span data-stu-id="c7901-126">An advise source is any MAPI object that does the following:</span></span>
  
- <span data-ttu-id="c7901-127">Implementiert eine **Advise** -Methode, um Benachrichtigungs Registrierungen zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="c7901-127">Implements an **Advise** method to receive notification registrations.</span></span> 
    
- <span data-ttu-id="c7901-128">Implementiert eine **Unadvise** -Methode, um Benachrichtigungs Abbruch zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="c7901-128">Implements an **Unadvise** method to receive notification cancellations.</span></span> 
    
- <span data-ttu-id="c7901-129">Generiert Benachrichtigungen des entsprechenden Typs für die entsprechenden Advise-Empfängerobjekte, die sich registriert haben, indem **Sie Ihre IMAPIAdviseSink:: OnNotify** -Methoden aufrufen.</span><span class="sxs-lookup"><span data-stu-id="c7901-129">Generates notifications of the appropriate type to the appropriate advise sink objects that have registered by calling their **IMAPIAdviseSink::OnNotify** methods.</span></span> 
    
<span data-ttu-id="c7901-130">Clients, die Advise-Senke-Objekte implementieren, rufen **Advise** auf, wenn Sie sich für eine Benachrichtigung registrieren möchten, in den meisten Fällen übergeben Sie die Eintrags-ID \*\*\*\* des Objekts, mit dem die Registrierung erfolgen soll, und deaktivieren Sie, wenn Sie den Registrierung.</span><span class="sxs-lookup"><span data-stu-id="c7901-130">Clients that implement advise sink objects call **Advise** when they want to register for a notification, in most cases passing in the entry identifier of the object with which registration should occur, and **Unadvise** when they want to cancel the registration.</span></span> <span data-ttu-id="c7901-131">Clients übergeben einen Parameter, \*\*\*\* der angibt, welche der verschiedenen Ereignistypen überwacht werden sollen.</span><span class="sxs-lookup"><span data-stu-id="c7901-131">Clients pass a parameter to **Advise** that indicates which of the several types of events they want to monitor.</span></span> <span data-ttu-id="c7901-132">**Advise** gibt eine Zahl ungleich NULL zurück, die eine erfolgreiche Verbindung zwischen der Advise-Senke und der Advise-Quelle darstellt.</span><span class="sxs-lookup"><span data-stu-id="c7901-132">**Advise** returns a nonzero number that represents a successful connection between the advise sink and advise source.</span></span> 
  
<span data-ttu-id="c7901-133">Vor dem Aufrufen von **Advise**können Clients ermitteln, ob ein Nachrichtenspeicher Anbieter eine Benachrichtigung unterstützt, indem Sie überprüfen, dass das STORE_NOTIFY_OK-Flag im **PR_STORE_SUPPORT_MASK** des Nachrichtenspeichers ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) festgelegt ist. Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="c7901-133">Before calling **Advise**, clients can determine whether a message store provider supports notification by checking that the STORE_NOTIFY_OK flag is set in the message store's **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span> <span data-ttu-id="c7901-134">Es gibt keine Möglichkeit für Clients, vorab zu bestimmen, ob ein Adressbuchanbieter Benachrichtigungen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="c7901-134">There is no way for clients to determine ahead of time whether or not an address book provider supports notifications.</span></span> <span data-ttu-id="c7901-135">Clients müssen sich registrieren, und wenn der Versuch fehlschlägt, können Sie davon ausgehen, dass Benachrichtigungen nicht unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="c7901-135">Clients must attempt to register and if the attempt fails, they can assume notifications are unsupported.</span></span>
  
<span data-ttu-id="c7901-136">Tritt ein Ereignis ein, für das ein Client registriert wurde, benachrichtigt die Advise-Quelle die Advise-Senke, indem [Sie die IMAPIAdviseSink:: OnNotify](imapiadvisesink-onnotify.md) -Methode mit einer Benachrichtigungsdatenstruktur aufruft, die Informationen über das Ereignis enthält.</span><span class="sxs-lookup"><span data-stu-id="c7901-136">When an event for which a client has registered occurs, the advise source notifies the advise sink by calling its [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) method with a notification data structure that contains information about the event.</span></span> <span data-ttu-id="c7901-137">Die Implementierung von onNotify durch \*\*\*\* eine Advise-Senke kann Aufgaben als Reaktion auf die Benachrichtigung ausführen, beispielsweise das Aktualisieren von Daten im Arbeitsspeicher oder das Aktualisieren einer Bildschirmanzeige.</span><span class="sxs-lookup"><span data-stu-id="c7901-137">An advise sink's implementation of **OnNotify** can perform tasks in response to the notification, such as updating data in memory or refreshing a screen display.</span></span> 
  
<span data-ttu-id="c7901-138">Dienstanbieter können die Unterstützung für Benachrichtigungen manuell implementieren oder die Hilfe in drei **IMAPISupport** -Methoden nutzen: [IMAPISupport:: subscribe](imapisupport-subscribe.md), [IMAPISupport:: unsubscribe](imapisupport-unsubscribe.md)und [IMAPISupport:: notify ](imapisupport-notify.md).</span><span class="sxs-lookup"><span data-stu-id="c7901-138">Service providers can implement support for notifications manually or take advantage of the help provided in three **IMAPISupport** methods: [IMAPISupport::Subscribe](imapisupport-subscribe.md), [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md), and [IMAPISupport::Notify](imapisupport-notify.md).</span></span> <span data-ttu-id="c7901-139">Die **subscribe** - \*\*\*\* und die Unsubscribe-Methode behandeln die Benachrichtigungs Registrierung und-Deregistrierung für Anbieter. die **Notify** -Methode verarbeitet bei Bedarf das Senden von Benachrichtigungen.</span><span class="sxs-lookup"><span data-stu-id="c7901-139">The **Subscribe** and **Unsubscribe** methods handle notification registration and deregistration for providers; the **Notify** method handles sending notifications when appropriate.</span></span> 
  
<span data-ttu-id="c7901-140">Um die Support-Objektmethoden für die Benachrichtigungs Registrierung zu verwenden, rufen Dienstanbieter [IMAPISupport:: subscribe](imapisupport-subscribe.md) in Ihren **Advise** -Methoden auf und geben den Advise-Senke-Zeiger an, den die Clients an **Advise**übermitteln. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="c7901-140">To use the support object methods for notification registration, service providers call [IMAPISupport::Subscribe](imapisupport-subscribe.md) in their **Advise** methods and pass to **Subscribe** the advise sink pointer that clients pass to **Advise**.</span></span> <span data-ttu-id="c7901-141">Wenn eine Eintrags-ID als Eingabeparameter übergeben wird, um eine Advise-Quelle anzugeben, werden Sie von Dienstanbietern in einen Binär Schlüssel konvertiert.</span><span class="sxs-lookup"><span data-stu-id="c7901-141">If an entry identifier is passed as an input parameter to specify an advise source, service providers convert it to a binary key.</span></span> <span data-ttu-id="c7901-142">**Subscribe** erstellt eine eindeutige Verbindungsnummer, und diese Nummer wird von Dienstanbietern an Clients zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="c7901-142">**Subscribe** creates a unique connection number and it is this number that service providers return to clients.</span></span> <span data-ttu-id="c7901-143">Dienstanbieter können den Objektzeiger des Advise-Objekts des Clients jederzeit freigeben, nachdem der **Advise** -Aufruf abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="c7901-143">Service providers can release the client's advise sink object pointer at any time after the **Advise** call has completed.</span></span> 
  
<span data-ttu-id="c7901-144">Wenn Clients **Unadvise** aufrufen, um eine Registrierung abzubrechen, verringern die Dienstanbieter entweder den Verweiszähler auf den Zeiger der Advise-Senke des Clients oder rufen das **Abonnement** ab, um dasselbe zu tun.</span><span class="sxs-lookup"><span data-stu-id="c7901-144">When clients call **Unadvise** to cancel a registration, service providers either decrement the reference count on the client's advise sink pointer or call **Unsubscribe** to do the same.</span></span> 
  
<span data-ttu-id="c7901-145">Wenn es Zeit ist, eine Benachrichtigung zu generieren, führen Dienstanbieter jede interne Verarbeitung aus, die sich auf die Benachrichtigung [](notification.md) bezieht, und Initialisiert eine Benachrichtigungsstruktur, indem alle nicht verwendeten Member auf NULL festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="c7901-145">When it is time to generate a notification, service providers perform any internal processing that relates to the notification and initializes a [NOTIFICATION](notification.md) structure by setting all of its unused members to zero.</span></span> <span data-ttu-id="c7901-146">Diese Technik für die Initialisierung \*\*\*\* der Benachrichtigungsstruktur kann Clients helfen, kleinere, schnellere und weniger fehleranfällige OnNotify-Implementierungen zu erstellen. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="c7901-146">This technique for initializing the **NOTIFICATION** structure can help clients create smaller, faster, and less error-prone **OnNotify** implementations.</span></span> 
  
<span data-ttu-id="c7901-147">Die folgende Abbildung zeigt die Kommunikation zwischen den Advise-Senke-Objekten, Advise-Quellobjekten und MAPI.</span><span class="sxs-lookup"><span data-stu-id="c7901-147">The following illustration shows the communication between advise sink objects, advise source objects, and MAPI.</span></span> <span data-ttu-id="c7901-148">MAPI ist nur dann beteiligt, wenn die Advise-Quelle die **IMAPISupport** -Methoden für die Benachrichtigungsunterstützung aufruft.</span><span class="sxs-lookup"><span data-stu-id="c7901-148">MAPI is involved only when the advise source calls the **IMAPISupport** methods for notification support.</span></span> 
  
<span data-ttu-id="c7901-149">**Ereignisbenachrichtigungsaufrufe**</span><span class="sxs-lookup"><span data-stu-id="c7901-149">**Event notification calls**</span></span>
  
<span data-ttu-id="c7901-150">![Ereignis Benachrichtigungsaufrufe] (media/amapi_51.gif "Ereignis Benachrichtigungsaufrufe")</span><span class="sxs-lookup"><span data-stu-id="c7901-150">![Event notification calls](media/amapi_51.gif "Event notification calls")</span></span>
  
<span data-ttu-id="c7901-151">Die MFCMAPI- **CAdviseSink** -Klasse (mit den Dateien AdviseSink. h und AdviseSink. cpp) implementiert das Advise-Senke-Objekt für alle Aufrufe von **Advise**.</span><span class="sxs-lookup"><span data-stu-id="c7901-151">The MFCMAPI **CAdviseSink** class (using the AdviseSink.h and AdviseSink.cpp files) implements the advise sink object for all calls to **Advise**.</span></span> <span data-ttu-id="c7901-152">Weitere Informationen zu MFCMAPI finden Sie unter [MfcMapi als Code Beispiel](mfcmapi-as-a-code-sample.md) und [MfcMapi](https://go.microsoft.com/fwlink/?LinkId=124154).</span><span class="sxs-lookup"><span data-stu-id="c7901-152">For more information about MFCMAPI, see [MFCMAPI as a Code Sample](mfcmapi-as-a-code-sample.md) and [MFCMAPI](https://go.microsoft.com/fwlink/?LinkId=124154).</span></span>
  

