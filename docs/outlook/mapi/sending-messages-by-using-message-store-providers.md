---
title: Senden von Nachrichten durch Nachrichtenspeicheranbieter
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7632d784-00d8-48fd-a73b-73778efbef7f
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: b34714a230adb44417624d149d34ed6a14a2dfa5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33437609"
---
# <a name="sending-messages-by-using-message-store-providers"></a><span data-ttu-id="e410d-103">Senden von Nachrichten durch Nachrichtenspeicheranbieter</span><span class="sxs-lookup"><span data-stu-id="e410d-103">Sending messages by using message store providers</span></span>

<span data-ttu-id="e410d-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e410d-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e410d-105">Nachrichtenspeicher Anbieter sind nicht zur Unterstützung ausgehender Nachrichtenübermittlungen erforderlich (also die Möglichkeit, dass Clientanwendungen den Nachrichtenspeicher Anbieter zum Senden von Nachrichten verwenden können).</span><span class="sxs-lookup"><span data-stu-id="e410d-105">Message store providers are not required to support outgoing message submissions (that is, the ability for client applications to use the message store provider to send messages).</span></span> <span data-ttu-id="e410d-106">Client Anwendungen müssen beim Senden von Nachrichten einen Nachrichtenspeicher verwenden, da die Daten der Nachricht irgendwo zwischen dem Zeitpunkt gespeichert werden müssen, zu dem der Benutzer Sie erstellt hat, und der Zeit, die der MAPI-Spooler die Nachricht an einen Transportanbieter für Übermittlung an das zugrunde liegende Messagingsystem.</span><span class="sxs-lookup"><span data-stu-id="e410d-106">Client applications need to use a message store while sending messages, because the message's data must be stored somewhere between the time that the user is finished composing it and the time that the MAPI spooler gives the message to a transport provider for submission to the underlying messaging system.</span></span> <span data-ttu-id="e410d-107">Wenn der Nachrichtenspeicher Anbieter ausgehende Nachrichten nicht unterstützt, kann er nicht als Standardnachrichtenspeicher verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e410d-107">If your message store provider does not support outgoing message submissions, it cannot be used as the default message store.</span></span>
  
<span data-ttu-id="e410d-108">Um das Senden von Nachrichten zu unterstützen, muss der Nachrichtenspeicher Anbieter folgende Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="e410d-108">To support sending messages, your message store provider must do the following:</span></span>
  
- <span data-ttu-id="e410d-109">Implementieren Sie eine Warteschlange für ausgehende Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="e410d-109">Implement an outgoing message queue.</span></span>
    
- <span data-ttu-id="e410d-110">Unterstützen Sie die [IMessage:: SubmitMessage](imessage-submitmessage.md) -Methode für Nachrichtenobjekte, die im Nachrichtenspeicher erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="e410d-110">Support the [IMessage::SubmitMessage](imessage-submitmessage.md) method on message objects created in the message store.</span></span> 
    
- <span data-ttu-id="e410d-111">Unterstützen Sie die **IMsgStore** -Methoden, die für den MAPI-Spooler spezifisch sind: [IMsgStore:: FinishedMsg](imsgstore-finishedmsg.md), [IMsgStore:: GetOutgoingQueue](imsgstore-getoutgoingqueue.md), [IMsgStore:: NotifyNewMail](imsgstore-notifynewmail.md)und [IMsgStore:: SetLockState](imsgstore-setlockstate.md).</span><span class="sxs-lookup"><span data-stu-id="e410d-111">Support the **IMsgStore** methods that are specific to the MAPI spooler: [IMsgStore::FinishedMsg](imsgstore-finishedmsg.md), [IMsgStore::GetOutgoingQueue](imsgstore-getoutgoingqueue.md), [IMsgStore::NotifyNewMail](imsgstore-notifynewmail.md), and [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span></span>
    
<span data-ttu-id="e410d-112">Die **SetLockState** -Methode ist wichtig für eine ordnungsgemäße Zusammenarbeit zwischen dem MAPI-Spooler und den Clients.</span><span class="sxs-lookup"><span data-stu-id="e410d-112">The **SetLockState** method is important for proper interoperation between the MAPI spooler and clients.</span></span> <span data-ttu-id="e410d-113">Wenn der MAPI-Spooler **SetLockState** für eine ausgehende Nachricht aufruft, darf der Nachrichtenspeicher Anbieter die Nachricht nicht öffnen.</span><span class="sxs-lookup"><span data-stu-id="e410d-113">When the MAPI spooler calls **SetLockState** on an outgoing message, the message store provider must not let clients open the message.</span></span> <span data-ttu-id="e410d-114">Wenn ein Client versucht, eine vom MAPI-Spooler gesperrte Nachricht zu öffnen, sollte der Nachrichtenspeicher Anbieter MAPI_E_NO_ACCESS zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="e410d-114">If a client does try to open a message that is locked by the MAPI spooler, the message store provider should return MAPI_E_NO_ACCESS.</span></span> <span data-ttu-id="e410d-115">Der gesperrte Status einer Nachricht muss nicht persistent sein, wenn der Speicher heruntergefahren wird, während die Nachricht vom MAPI-Spooler gesperrt wird.</span><span class="sxs-lookup"><span data-stu-id="e410d-115">The locked state of a message does not have to be persistent in case the store is shut down while the message is locked by the MAPI spooler.</span></span> 
  
<span data-ttu-id="e410d-116">Unabhängig davon, ob der MAPI-Spooler eine ausgehende Nachricht gesperrt hat, sollte der Nachrichtenspeicher Anbieter nicht zulassen, dass eine Nachricht in der Warteschlange für ausgehende Nachrichten zum Schreiben geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="e410d-116">Regardless of whether the MAPI spooler has locked an outgoing message, the message store provider should not allow a message in the outgoing message queue to be opened for writing.</span></span> <span data-ttu-id="e410d-117">Wenn ein Client die [IMSgStore:: OpenEntry](imsgstore-openentry.md) -Methode für eine ausgehende Nachricht mit dem MAPI_MODIFY-Flag aufruft, sollte der Aufruf fehlschlagen und MAPI_E_SUBMITTED zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="e410d-117">If a client calls the [IMSgStore::OpenEntry](imsgstore-openentry.md) method on an outgoing message with the MAPI_MODIFY flag, the call should fail and return MAPI_E_SUBMITTED.</span></span> <span data-ttu-id="e410d-118">Wenn eine Clientanwendung **OpenEntry** für eine ausgehende Nachricht mit dem MAPI_BEST_ACCESS-Flag aufruft, sollte der Nachrichtenspeicher Anbieter schreibgeschützten Zugriff auf die Nachricht zulassen.</span><span class="sxs-lookup"><span data-stu-id="e410d-118">If a client application calls **OpenEntry** on an outgoing message with the MAPI_BEST_ACCESS flag, the message store provider should allow read-only access to the message.</span></span> 
  
<span data-ttu-id="e410d-119">Wenn eine Nachricht vom MAPI-Spooler verarbeitet werden soll, legt der Nachrichtenspeicher Anbieter die **PR_SUBMIT_FLAGS** ([pidtagsubmitflags (](pidtagsubmitflags-canonical-property.md))-Eigenschaft der Nachricht auf SUBMITFLAG_LOCKED fest.</span><span class="sxs-lookup"><span data-stu-id="e410d-119">When a message is to be handled by the MAPI spooler, the message store provider sets the message's **PR_SUBMIT_FLAGS** ([PidTagSubmitFlags](pidtagsubmitflags-canonical-property.md)) property to SUBMITFLAG_LOCKED.</span></span> <span data-ttu-id="e410d-120">Der SUBMITFLAG_LOCKED-Wert gibt an, dass die MAPI-Warteschlange die Nachricht für ihre exklusive Verwendung gesperrt hat.</span><span class="sxs-lookup"><span data-stu-id="e410d-120">The SUBMITFLAG_LOCKED value indicates that the MAPI spooler has locked the message for its exclusive use.</span></span> <span data-ttu-id="e410d-121">Der andere Wert für **PR_SUBMIT_FLAGS**, SUBMITFLAG_PREPROCESS, wird festgelegt, wenn die Nachricht die Vorverarbeitung durch eine oder mehrere präprozessorfunktionen erfordert, die von einem Transportanbieter registriert werden.</span><span class="sxs-lookup"><span data-stu-id="e410d-121">The other value for **PR_SUBMIT_FLAGS**, SUBMITFLAG_PREPROCESS, is set when the message requires preprocessing by one or more preprocessor functions registered by a transport provider.</span></span>
  
<span data-ttu-id="e410d-122">In den folgenden Verfahren wird beschrieben, wie Nachrichtenspeicher, Transport und MAPI-Spooler interagieren, um eine Nachricht von einem Client an einen oder mehrere Empfänger zu senden.</span><span class="sxs-lookup"><span data-stu-id="e410d-122">The following procedures describe how the message store, transport, and MAPI spooler interact to send a message from a client to one or more recipients.</span></span> 
  
<span data-ttu-id="e410d-123">Die Clientanwendung Ruft die [IMessage:: SubmitMessage](imessage-submitmessage.md) -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="e410d-123">The client application calls the [IMessage::SubmitMessage](imessage-submitmessage.md) method.</span></span> <span data-ttu-id="e410d-124">In **SubmitMessage**führt der Nachrichtenspeicher Anbieter folgende Aktionen aus:</span><span class="sxs-lookup"><span data-stu-id="e410d-124">In **SubmitMessage**, the message store provider does the following:</span></span>
  
1. <span data-ttu-id="e410d-125">Ruft [IMAPISupport::P reparesubmit](imapisupport-preparesubmit.md).</span><span class="sxs-lookup"><span data-stu-id="e410d-125">Calls [IMAPISupport::PrepareSubmit](imapisupport-preparesubmit.md).</span></span> <span data-ttu-id="e410d-126">Wenn MAPI einen Fehler zurückgibt, gibt der Nachrichtenspeicher Anbieter diesen Fehler an den Client zurück.</span><span class="sxs-lookup"><span data-stu-id="e410d-126">If MAPI returns an error, the message store provider returns that error to the client.</span></span>
    
2. <span data-ttu-id="e410d-127">Legt das MSGFLAG_SUBMIT-Bit in der **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md))-Eigenschaft der Nachricht fest.</span><span class="sxs-lookup"><span data-stu-id="e410d-127">Sets the MSGFLAG_SUBMIT bit in the **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) property of the message.</span></span>
    
3. <span data-ttu-id="e410d-128">Stellt sicher, dass eine Spalte für die **PR_RESPONSIBILITY** ([pidtagresponsibility (](pidtagresponsibility-canonical-property.md))-Eigenschaft in der Recipient-Tabelle vorhanden ist, und legt Sie auf false fest, um anzugeben, dass noch kein Transport die Verantwortung für die Übertragung der Nachricht übernommen hat.</span><span class="sxs-lookup"><span data-stu-id="e410d-128">Ensures that there is a column for the **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property in the recipient table and sets it to FALSE to indicate that no transport has yet assumed responsibility for transmitting the message.</span></span>
    
4. <span data-ttu-id="e410d-129">Legt das Datum und die Uhrzeit der Ursprung in der **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md))-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="e410d-129">Sets the date and time of origination in the **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) property.</span></span>
    
5. <span data-ttu-id="e410d-130">Ruft [IMAPISupport:: ExpandRecips](imapisupport-expandrecips.md) auf, um folgende Aufgaben auszuführen:</span><span class="sxs-lookup"><span data-stu-id="e410d-130">Calls [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md) to do the following:</span></span> 
    
    1. <span data-ttu-id="e410d-131">Erweitern Sie alle pers�nlichen Verteilerlisten und benutzerdefinierte Empf�nger, und Ersetzen Sie alle ge�nderten Anzeigenamen durch ihren Originalnamen.</span><span class="sxs-lookup"><span data-stu-id="e410d-131">Expand all personal distribution lists and custom recipients and replace all changed display names with their original names.</span></span>
        
    2. <span data-ttu-id="e410d-132">Entfernen von Duplikaten.</span><span class="sxs-lookup"><span data-stu-id="e410d-132">Remove duplicate names.</span></span>
        
    3. <span data-ttu-id="e410d-133">Überprüfen Sie, ob die erforderliche Vorverarbeitung erforderlich ist, und legen Sie das NEEDS_PREPROCESSING-Flag und die **PR_PREPROCESS** ([pidtagpreprocess (](pidtagpreprocess-canonical-property.md))-Eigenschaft fest, die für MAPI reserviert ist.</span><span class="sxs-lookup"><span data-stu-id="e410d-133">Check for any required preprocessing and, if preprocessing is required, set the NEEDS_PREPROCESSING flag and the **PR_PREPROCESS** ([PidTagPreprocess](pidtagpreprocess-canonical-property.md)) property, which is reserved for MAPI.</span></span> 
        
    4. <span data-ttu-id="e410d-134">Legen Sie das Flag NEEDS_SPOOLER, wenn der Nachrichtenspeicher eng mit einer Transport verkn�pft ist und nicht behandelt alle Empf�nger werden kann.</span><span class="sxs-lookup"><span data-stu-id="e410d-134">Set the NEEDS_SPOOLER flag if the message store is tightly coupled with a transport and it cannot handle all of the recipients.</span></span> 
    
6. <span data-ttu-id="e410d-135">F�hrt die folgenden Aufgaben aus, wenn der Nachrichtenkennzeichnung NEEDS_PREPROCESSING festgelegt ist:</span><span class="sxs-lookup"><span data-stu-id="e410d-135">Performs the following tasks if the NEEDS_PREPROCESSING message flag is set:</span></span>
    
    1. <span data-ttu-id="e410d-136">Platziert die Nachricht in der ausgehenden Warteschlange mit dem SUBMITFLAG_PREPROCESS-Bit, das in der **PR_SUBMIT_FLAGS** -Eigenschaft festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="e410d-136">Puts the message in the outgoing queue with the SUBMITFLAG_PREPROCESS bit set in the **PR_SUBMIT_FLAGS** property.</span></span> 
        
    2. <span data-ttu-id="e410d-137">Benachrichtigt die MAPI-Warteschlange, die die Warteschlange ge�ndert wurde.</span><span class="sxs-lookup"><span data-stu-id="e410d-137">Notifies the MAPI spooler that the queue has changed.</span></span>
        
    3. <span data-ttu-id="e410d-138">Gibt die Steuerung an den Client, und Nachrichtenfluss wird in die Warteschlange MAPI fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="e410d-138">Returns control to the client, and message flow continues in the MAPI spooler.</span></span> <span data-ttu-id="e410d-139">Die MAPI-Warteschlange f�hrt die folgenden Aufgaben:</span><span class="sxs-lookup"><span data-stu-id="e410d-139">The MAPI spooler performs the following tasks:</span></span> 
    
       1. <span data-ttu-id="e410d-140">Sperrt die Nachricht durch Aufrufen von [IMsgStore:: SetLockState](imsgstore-setlockstate.md).</span><span class="sxs-lookup"><span data-stu-id="e410d-140">Locks the message by calling [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span></span>
            
       2. <span data-ttu-id="e410d-141">Führt die erforderliche Vorverarbeitung aus, indem alle Vorverarbeitungsfunktionen in der Reihenfolge der Registrierung aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="e410d-141">Performs the needed preprocessing by calling all of the preprocessing functions in the order of registration.</span></span> <span data-ttu-id="e410d-142">Transport Anbieter rufen [IMAPISupport:: RegisterPreprocessor](imapisupport-registerpreprocessor.md) auf, um Vorverarbeitungsfunktionen zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="e410d-142">Transport providers call [IMAPISupport::RegisterPreprocessor](imapisupport-registerpreprocessor.md) to register preprocessing functions.</span></span> 
            
       3. <span data-ttu-id="e410d-143">Ruft [IMessage:: SubmitMessage](imessage-submitmessage.md) für die offene Nachricht auf, um dem Nachrichtenspeicher anzuzeigen, dass die Vorverarbeitung abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="e410d-143">Calls [IMessage::SubmitMessage](imessage-submitmessage.md) on the open message to indicate to the message store that preprocessing is complete.</span></span> 
    
<span data-ttu-id="e410d-144">Wenn es keine Vorverarbeitung oder eine Vorverarbeitung gab, und der MAPI-Spooler namens **SubmitMessage**, führt der Nachrichtenspeicher Anbieter im Clientprozess folgende Aktionen aus:</span><span class="sxs-lookup"><span data-stu-id="e410d-144">If there was no preprocessing, or there was preprocessing and the MAPI spooler called **SubmitMessage**, the message store provider does the following in the client process:</span></span> 
  
- <span data-ttu-id="e410d-145">Performs the following tasks if the message store is tightly coupled to a transport and the NEEDS_SPOOLER flag was returned from [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md):</span><span class="sxs-lookup"><span data-stu-id="e410d-145">Performs the following tasks if the message store is tightly coupled to a transport and the NEEDS_SPOOLER flag was returned from [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md):</span></span>
    
   - <span data-ttu-id="e410d-146">Verarbeitet Empf�nger, die es verarbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="e410d-146">Handles any recipients that it can handle.</span></span>
    
   - <span data-ttu-id="e410d-147">Legt die **PR_RESPONSIBILITY** -Eigenschaft auf TRUE fest, f�r alle Empf�nger, die sie behandelt.</span><span class="sxs-lookup"><span data-stu-id="e410d-147">Sets the **PR_RESPONSIBILITY** property to TRUE for any recipients that it handles.</span></span> 
    
   - <span data-ttu-id="e410d-148">F�hrt die folgenden Aufgaben aus, wenn alle Empf�nger zu diesem eng gekoppelten Store und Transport bekannt sind:</span><span class="sxs-lookup"><span data-stu-id="e410d-148">Performs the following tasks if all recipients are known to this tightly coupled store and transport:</span></span> 
    
     - <span data-ttu-id="e410d-149">Ruft [IMAPISupport:: CompleteMsg](imapisupport-completemsg.md) auf, wenn die Nachricht vorverarbeitet wurde oder der Nachrichtenspeicher Anbieter den MAPI-Spooler zum Abschließen der Nachrichtenverarbeitung wünscht.</span><span class="sxs-lookup"><span data-stu-id="e410d-149">Calls [IMAPISupport::CompleteMsg](imapisupport-completemsg.md) if the message was preprocessed or the message store provider wants the MAPI spooler to complete message processing.</span></span> <span data-ttu-id="e410d-150">Der Nachrichtenfluss wird mit dem MAPI-Spooler fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="e410d-150">Message flow continues with the MAPI spooler.</span></span> 
    
     - <span data-ttu-id="e410d-151">Führt die folgenden Aufgaben aus, wenn die Nachricht nicht vorverarbeitet wurde oder der Nachrichtenspeicher Anbieter nicht möchten, dass die Nachrichtenverarbeitung vom MAPI-Spooler abgeschlossen wird:</span><span class="sxs-lookup"><span data-stu-id="e410d-151">Performs the following tasks if the message was not preprocessed or the message store provider does not want the MAPI spooler to complete message processing:</span></span>
    
       1. <span data-ttu-id="e410d-152">Kopiert die Nachricht in den Ordner, der durch den Eintragsbezeichner in der **PR_SENTMAIL_ENTRYID** ([pidtagsentmailentryid (](pidtagsentmailentryid-canonical-property.md))-Eigenschaft identifiziert wird, falls festgelegt.</span><span class="sxs-lookup"><span data-stu-id="e410d-152">Copies the message to the folder identified by the entry identifier in the **PR_SENTMAIL_ENTRYID** ([PidTagSentMailEntryId](pidtagsentmailentryid-canonical-property.md)) property, if set.</span></span>
            
       2. <span data-ttu-id="e410d-153">Löscht die Nachricht, wenn die **PR_DELETE_AFTER_SUBMIT** ([pidtagdeleteaftersubmit (](pidtagdeleteaftersubmit-canonical-property.md))-Eigenschaft auf true festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="e410d-153">Deletes the message if the **PR_DELETE_AFTER_SUBMIT** ([PidTagDeleteAfterSubmit](pidtagdeleteaftersubmit-canonical-property.md)) property has been set to TRUE.</span></span>
            
       3. <span data-ttu-id="e410d-154">Hebt die Sperre der Nachricht auf, wenn Sie gesperrt ist.</span><span class="sxs-lookup"><span data-stu-id="e410d-154">Unlocks the message if it is locked.</span></span>
            
       4. <span data-ttu-id="e410d-155">Gibt den Client zurück.</span><span class="sxs-lookup"><span data-stu-id="e410d-155">Returns to the client.</span></span> <span data-ttu-id="e410d-156">Der Nachrichtenfluss ist abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="e410d-156">Message flow is complete.</span></span>
    
  - <span data-ttu-id="e410d-157">Führt die folgenden Aufgaben aus, wenn die Nachricht vorverarbeitet wurde oder der Anbieter den MAPI-Spooler zum Abschließen der Nachrichtenverarbeitung wünscht:</span><span class="sxs-lookup"><span data-stu-id="e410d-157">Performs the following tasks if the message was preprocessed or the provider wants the MAPI spooler to complete message processing:</span></span>
    
    1. <span data-ttu-id="e410d-158">Ruft [IMAPISupport:: CompleteMsg](imapisupport-completemsg.md)auf.</span><span class="sxs-lookup"><span data-stu-id="e410d-158">Calls [IMAPISupport::CompleteMsg](imapisupport-completemsg.md).</span></span> 
          
    2. <span data-ttu-id="e410d-159">Setzt den Nachrichtenfluss mit dem MAPI-Spooler fort.</span><span class="sxs-lookup"><span data-stu-id="e410d-159">Continues message flow with the MAPI spooler.</span></span> <span data-ttu-id="e410d-160">Weitere Informationen finden Sie unter [Senden von Nachrichten: MAPI](sending-messages-mapi-spooler-tasks.md)-spoolEr-Aufgaben.</span><span class="sxs-lookup"><span data-stu-id="e410d-160">For more information, see [Sending Messages: MAPI Spooler Tasks](sending-messages-mapi-spooler-tasks.md).</span></span>
    
  - <span data-ttu-id="e410d-161">Führt die folgenden Aufgaben aus, wenn die Nachricht nicht vorverarbeitet wurde oder wenn der Spooler die Nachrichtenverarbeitung nicht abschließen soll:</span><span class="sxs-lookup"><span data-stu-id="e410d-161">Performs the following tasks if the message was not preprocessed or the provider does not want the spooler to complete message processing:</span></span>
    
    1. <span data-ttu-id="e410d-162">Kopiert die Nachricht in den Ordner, der durch den Eintragsbezeichner in der **PR_SENTMAIL_ENTRYID** -Eigenschaft identifiziert wird, falls festgelegt.</span><span class="sxs-lookup"><span data-stu-id="e410d-162">Copies the message to the folder identified by the entry identifier in the **PR_SENTMAIL_ENTRYID** property, if set.</span></span> 
        
    2. <span data-ttu-id="e410d-163">Löscht die Nachricht, wenn die **PR_DELETE_AFTER_SUBMIT** -Eigenschaft auf true festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="e410d-163">Deletes the message if the **PR_DELETE_AFTER_SUBMIT** property has been set to TRUE.</span></span> 
        
    3. <span data-ttu-id="e410d-164">Hebt die Sperre der Nachricht auf, wenn Sie gesperrt ist.</span><span class="sxs-lookup"><span data-stu-id="e410d-164">Unlocks the message if it is locked.</span></span> 
        
    4. <span data-ttu-id="e410d-165">Gibt den Aufrufer zurück.</span><span class="sxs-lookup"><span data-stu-id="e410d-165">Returns to the caller.</span></span> <span data-ttu-id="e410d-166">Der Nachrichtenfluss ist abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="e410d-166">Message flow is complete.</span></span>
    
- <span data-ttu-id="e410d-167">F�hrt die folgenden Aufgaben aus, wenn der Nachrichtenspeicher nicht eng um einen Transport verkn�pft, nicht alle Empf�nger mit dem Nachrichtenspeicher bezeichnet wurden oder das Flag NEEDS_SPOOLER festgelegt ist:</span><span class="sxs-lookup"><span data-stu-id="e410d-167">Performs the following tasks if the message store is not tightly coupled to a transport, not all of the recipients were known to the message store, or the NEEDS_SPOOLER flag is set:</span></span>
    
  1. <span data-ttu-id="e410d-168">Versetzt die Nachricht in der ausgehenden Warteschlange ohne das SUBMITFLAG_PREPROCESS Bit in der **PR_SUBMIT_FLAGS** -Eigenschaft festlegen.</span><span class="sxs-lookup"><span data-stu-id="e410d-168">Puts the message in the outgoing queue without setting the SUBMITFLAG_PREPROCESS bit in the **PR_SUBMIT_FLAGS** property.</span></span> 
    
  2. <span data-ttu-id="e410d-169">Benachrichtigt die MAPI-Warteschlange, die die ausgehende Warteschlange ge�ndert wurde, indem eine Benachrichtigung �ber eine Tabelle zu generieren.</span><span class="sxs-lookup"><span data-stu-id="e410d-169">Notifies the MAPI spooler that the outgoing queue has changed by generating a table notification.</span></span> 
    
  3. <span data-ttu-id="e410d-170">Gibt f�r den Client und Nachrichtenfluss weiterhin mit einem Satz von Aufgaben, die MAPI-Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="e410d-170">Returns to the client, and message flow continues with a set of tasks performed by the MAPI spooler.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="e410d-171">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="e410d-171">See also</span></span>

- [<span data-ttu-id="e410d-172">Nachrichtenspeicher-Features</span><span class="sxs-lookup"><span data-stu-id="e410d-172">Message Store Features</span></span>](message-store-features.md)

