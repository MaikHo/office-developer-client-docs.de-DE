---
title: Im Leerlauf MAPI-Modul
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 755d096a-2a61-44d2-a765-5d464a857756
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: 9fdc254053c2d35c83866bd8a076279fd383db02
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/23/2018
ms.locfileid: "22583036"
---
# <a name="mapi-idle-engine"></a><span data-ttu-id="0c1f5-103">Im Leerlauf MAPI-Modul</span><span class="sxs-lookup"><span data-stu-id="0c1f5-103">MAPI Idle Engine</span></span>

  
  
<span data-ttu-id="0c1f5-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="0c1f5-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="0c1f5-105">MAPI bietet verschiedene Funktionen, die allgemein als im Leerlauf Engine bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-105">MAPI provides several functions that are collectively known as the idle engine.</span></span> <span data-ttu-id="0c1f5-106">Diese Funktionen ermöglichen Clients, adressbuchanbietern implementierte und Message-Anbieter für verschiedene Aufgaben langsame Zeiten in der Sitzung oder als Reaktion auf einen Zeitpunkt langsam.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-106">These functions allow clients, address book providers, and message store providers to perform various tasks during slow times in the session or in response to a slow time.</span></span> <span data-ttu-id="0c1f5-107">Beispielsweise können Clients und Dienstanbieter langsame Vorgänge zurückgestellt oder schließen Sie Dateien, die für einen längeren Zeitraum nicht verwendete befunden hat.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-107">For example, clients and service providers can defer slow operations or close files that have remained unused for a lengthy period.</span></span> <span data-ttu-id="0c1f5-108">Transportanbieter in der Regel verwenden das Modul im Leerlauf Sie nicht, da die **IXPLogon::Idle** -Methode die stattfindet.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-108">Transport providers typically do not use the idle engine because the **IXPLogon::Idle** method takes its place.</span></span> <span data-ttu-id="0c1f5-109">Weitere Informationen finden Sie unter [IXPLogon::Idle](ixplogon-idle.md).</span><span class="sxs-lookup"><span data-stu-id="0c1f5-109">For more information, see [IXPLogon::Idle](ixplogon-idle.md).</span></span>
  
<span data-ttu-id="0c1f5-110">Erstellen Sie für die Verwendung des Moduls im Leerlauf Clients und -Dienstanbieter eine Rückruffunktion, die die Aufgaben, die ausgeführt werden soll enthält, wenn das MAPI-Subsystem im Leerlauf befindet.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-110">To use the idle engine, clients and service providers create a callback function that contains the tasks that should occur when the MAPI subsystem is idle.</span></span> <span data-ttu-id="0c1f5-111">Wenn MAPI Leerlaufzeit erkennt, wird diese Callback-Funktion aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-111">When MAPI detects idle time, it invokes this callback function.</span></span> <span data-ttu-id="0c1f5-112">Die Callback-Funktion: **FNIDLE** Prototyp wie folgt definiert</span><span class="sxs-lookup"><span data-stu-id="0c1f5-112">The callback function follows the **FNIDLE** prototype, defined as follows:</span></span> 
  
 `BOOL (STDAPICALLTYPE FNIDLE) (LPVOID lpvContext)`
  
<span data-ttu-id="0c1f5-113">Weitere Informationen finden Sie unter [FNIDLE](fnidle.md).</span><span class="sxs-lookup"><span data-stu-id="0c1f5-113">For more information, see [FNIDLE](fnidle.md).</span></span>
  
<span data-ttu-id="0c1f5-114">Die Funktionen, die das Modul im Leerlauf bilden sind:</span><span class="sxs-lookup"><span data-stu-id="0c1f5-114">The functions that make up the idle engine are:</span></span>
  
[<span data-ttu-id="0c1f5-115">ChangeIdleRoutine</span><span class="sxs-lookup"><span data-stu-id="0c1f5-115">ChangeIdleRoutine</span></span>](changeidleroutine.md)
  
[<span data-ttu-id="0c1f5-116">DeregisterIdleRoutine</span><span class="sxs-lookup"><span data-stu-id="0c1f5-116">DeregisterIdleRoutine</span></span>](deregisteridleroutine.md)
  
[<span data-ttu-id="0c1f5-117">EnableIdleRoutine</span><span class="sxs-lookup"><span data-stu-id="0c1f5-117">EnableIdleRoutine</span></span>](enableidleroutine.md)
  
[<span data-ttu-id="0c1f5-118">FtgRegisterIdleRoutine</span><span class="sxs-lookup"><span data-stu-id="0c1f5-118">FtgRegisterIdleRoutine</span></span>](ftgregisteridleroutine.md)
  
[<span data-ttu-id="0c1f5-119">MAPIDeInitIdle</span><span class="sxs-lookup"><span data-stu-id="0c1f5-119">MAPIDeInitIdle</span></span>](mapideinitidle.md)
  
[<span data-ttu-id="0c1f5-120">MAPIInitIdle</span><span class="sxs-lookup"><span data-stu-id="0c1f5-120">MAPIInitIdle</span></span>](mapiinitidle.md)
  
<span data-ttu-id="0c1f5-121">Um eine Callback-Funktion zu registrieren, rufen Sie Clients und -Dienstanbieter die **FtgRegisterIdleRoutine** -Funktion.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-121">To register a callback function, clients and service providers call the **FtgRegisterIdleRoutine** function.</span></span> <span data-ttu-id="0c1f5-122">Die Eingabeparametern umfassen eine optionale Priorität, einen Block von Arbeitsspeicher, die an die Rückruffunktion übergeben wird, als Eingabe, eine bestimmte Zeitspanne keinerlei gegebenenfalls verwendet werden, und eine Reihe von Option Kennzeichen.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-122">The input parameters include an optional priority, a block of memory that is passed to your callback function as input, an amount of time to be used in any way appropriate, and a set of option flags.</span></span> 
  
<span data-ttu-id="0c1f5-123">Clients und Dienstanbieter können Geben Sie eine Priorität in der _PriIdle_ -Parameter, der steuert, wie die im Leerlauf-Funktion ausgeführt wird oder 0 (null) angeben, wenn die Priorität kein Belang ist.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-123">Clients and service providers can specify a priority in the  _priIdle_ parameter that controls how the idle function runs or specify zero if priority is not an issue.</span></span> <span data-ttu-id="0c1f5-124">Da negative Zahlen einer höheren Priorität als positive Zahlen oder NULL darstellen, sollte Komprimierung und Suche Vorgänge negative Zahlen zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-124">Because negative numbers represent higher priorities than positive numbers or zero, compression and search operations should be assigned negative numbers.</span></span> <span data-ttu-id="0c1f5-125">Aufgaben, bei denen auf einmalige positive Zahlen zugewiesen werden soll.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-125">Tasks that occur once should be assigned positive numbers.</span></span> 
  
<span data-ttu-id="0c1f5-126">Rufen zum Aufheben der Registrierung für einer aktive Callback-Funktion, Clients und -Dienstanbieter die **DeregisterIdleRoutine** -Funktion.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-126">To deregister an active callback function, clients and service providers call the **DeregisterIdleRoutine** function.</span></span> <span data-ttu-id="0c1f5-127">Da **DeregisterIdleRoutine** asynchron ausgeführt wird, ist es möglich, dass der Callback-Funktion können Sie jederzeit während des Anrufs Registrierung aufheben aufgerufen werden und möglicherweise sogar, nachdem **DeregisterIdleRoutine** zurückgegeben hat.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-127">Because **DeregisterIdleRoutine** operates asynchronously, it is possible for the callback function to be invoked at any time during the deregister call and possibly even after **DeregisterIdleRoutine** has returned.</span></span> 
  
<span data-ttu-id="0c1f5-128">Um einige oder alle der Merkmale der Callback-Funktion zu ändern, rufen Sie Clients und -Dienstanbieter die **ChangeIdleRoutine** -Funktion.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-128">To modify some or all of the characteristics of a callback function, clients and service providers call the **ChangeIdleRoutine** function.</span></span> <span data-ttu-id="0c1f5-129">**ChangeIdleRoutine** wird, ändert sich entsprechend der Flags-Parameter _IrcIdle_ wie festgelegt wird. **ChangeIdleRoutine** können die Funktion selbst, dessen Priorität, die Einstellung und input-Parameter ändern.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-129">**ChangeIdleRoutine** makes changes according to how the flags parameter  _ircIdle_ is set; **ChangeIdleRoutine** can change the function itself, its priority, time setting, and input parameter.</span></span> 
  
<span data-ttu-id="0c1f5-130">MAPI im Leerlauf definiert die gleiche wie das Betriebssystem, wenn das Betriebssystem eine Definition hat.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-130">MAPI defines idle the same as the operating system, when the operating system has a definition.</span></span> <span data-ttu-id="0c1f5-131">Unter Win32 erstellt MAPI einen Thread mit Priorität Leerlauf--Klasse im Leerlauf Aufgaben zu planen.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-131">On Win32, MAPI creates a thread with idle-class priority to schedule idle tasks.</span></span> <span data-ttu-id="0c1f5-132">Dieser Thread verfolgt die Uhrzeit und sendet eine Nachricht an den Thread, der der Leerlauf-Task ausgeführt werden soll, wenn die Zeit für die Ausführung eingeht.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-132">This thread keeps track of the time and posts a message to the thread that is to execute the idle task when the time for its execution arrives.</span></span> <span data-ttu-id="0c1f5-133">Win32 plant Threads, nicht verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-133">Win32 schedules threads, not processes.</span></span> <span data-ttu-id="0c1f5-134">Wenn Aufgaben, bei die eine höhere Priorität als im Leerlauf Priorität haben auf der Arbeitsstation auftreten werden, sollte der im Leerlauf Vorgang nicht für die Ausführung geplant erhalten möchten, bis die Aufgaben abgeschlossen haben.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-134">If tasks that have a priority higher than the idle priority are occurring on the workstation, the idle task should not get scheduled for execution until the tasks have completed.</span></span> 
  
<span data-ttu-id="0c1f5-135">Führen Sie alle Aufgaben im Leerlauf auf der Thread, **MAPIInitIdle**aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-135">All idle tasks run on the thread that called **MAPIInitIdle**.</span></span> <span data-ttu-id="0c1f5-136">MAPI verfügt über einen separaten Thread für die Planung, aber sobald ein Vorgang im Leerlauf berechtigt ist, sendet eine Meldung über den Initialisierung Thread und der Leerlauf-Task es ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-136">MAPI has a separate thread for scheduling, but when an idle task becomes eligible, it posts a message back over to the initialization thread and the idle task is executed there.</span></span> <span data-ttu-id="0c1f5-137">Die Konsequenzen für die verschiedenen Typen von Clients sind zulässig.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-137">The implications for different types of clients are as follows.</span></span>
  
|<span data-ttu-id="0c1f5-138">**Threading-Modell**</span><span class="sxs-lookup"><span data-stu-id="0c1f5-138">**Threading model**</span></span>|<span data-ttu-id="0c1f5-139">**Implikation**</span><span class="sxs-lookup"><span data-stu-id="0c1f5-139">**Implication**</span></span>|
|:-----|:-----|
|<span data-ttu-id="0c1f5-140">Single Threading-</span><span class="sxs-lookup"><span data-stu-id="0c1f5-140">Single-threaded</span></span>  <br/> |<span data-ttu-id="0c1f5-141">Kein Problem.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-141">No problem.</span></span> <span data-ttu-id="0c1f5-142">Im Leerlauf Funktionen auf Ihrem Client Hauptthread ausführen und Schleife Nachricht serialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-142">Idle functions execute on your client's main thread and are serialized through the message loop.</span></span>  <br/> |
|<span data-ttu-id="0c1f5-143">Freethreadanbieter</span><span class="sxs-lookup"><span data-stu-id="0c1f5-143">Free-threaded</span></span>  <br/> |<span data-ttu-id="0c1f5-144">Im Leerlauf Funktionen muss threadsicheren, aber der Empfänger die notwendige Infrastruktur bereits verfügt.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-144">Idle functions must be thread-safe, but your client already has the necessary infrastructure.</span></span> <span data-ttu-id="0c1f5-145">Das MAPI-Modul im Leerlauf möglicherweise nicht in allen Ihrer Client erforderlich.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-145">Your client might not need the MAPI idle engine at all.</span></span>  <br/> |
|<span data-ttu-id="0c1f5-146">Des Apartmentthreading Thread-</span><span class="sxs-lookup"><span data-stu-id="0c1f5-146">Apartment-threaded</span></span>  <br/> |<span data-ttu-id="0c1f5-147">Im Leerlauf-Funktion hat, auf dem gleichen Thread auszuführen, die sie registriert, wenn sie MAPI oder OLE-COM-Schnittstellen verwenden möchte.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-147">Idle function has to execute on the same thread that registered it if it wants to use MAPI, OLE, or any other COM interfaces.</span></span> <span data-ttu-id="0c1f5-148">Am einfachsten ist eine Funktion im Leerlauf MAPI, die eine Nachricht an den richtigen Thread bereitstellt registriert werden und die Funktion "real" im Leerlauf direkt aus diesem Thread Nachrichtenschleife versenden.</span><span class="sxs-lookup"><span data-stu-id="0c1f5-148">The most straightforward way is to register an idle function with MAPI that posts a message to the right thread and dispatch the "real" idle function directly from that thread's message loop.</span></span>  <br/> |
   

