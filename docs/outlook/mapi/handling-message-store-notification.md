---
title: Behandeln von Nachrichtenspeicherbenachrichtigungen
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3e0cc2f9-a88d-4cec-bef5-b60f2ec80f1c
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: d370603dc7cfc015fe7b2757d1cf0525b3092c5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428025"
---
# <a name="handling-message-store-notification"></a><span data-ttu-id="58922-103">Behandeln von Nachrichtenspeicherbenachrichtigungen</span><span class="sxs-lookup"><span data-stu-id="58922-103">Handling message store notification</span></span>
  
<span data-ttu-id="58922-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="58922-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="58922-105">Wenn Sie sich für Nachrichtenspeicher Benachrichtigungen registrieren möchten, rufen Sie die [IMAPISession:: Advise](imapisession-advise.md) -oder [IMsgStore:: Advise](imsgstore-advise.md) -Methode auf, und geben Sie im Inhalt des _lpEntryID_ -Parameters einen Nachrichtenspeicher, einen Ordner oder eine Nachrichten Eintrags-ID an.</span><span class="sxs-lookup"><span data-stu-id="58922-105">To register for message store notifications, call either the [IMAPISession::Advise](imapisession-advise.md) or [IMsgStore::Advise](imsgstore-advise.md) method and specify a message store, folder, or message entry identifier in the contents of the  _lpEntryID_ parameter.</span></span> <span data-ttu-id="58922-106">Nachrichtenspeicher Anbieter unterstützen sowohl Objekt-als auch Tabellen Benachrichtigungen.</span><span class="sxs-lookup"><span data-stu-id="58922-106">Message store providers support both object and table notifications.</span></span> <span data-ttu-id="58922-107">Unabhängig davon, ob Sie sich mit bestimmten Nachrichtenspeicher Objekten registrieren, mit den Tabellenhierarchien und Inhaltsverzeichnissen, die diese Objekte beschreiben, oder mit beiden Objekten und Tabellen hängt von den erwarteten Benachrichtigungen ab, welche Anrufe Sie zur Durchführung von Vorgängen vornehmen und wie der Nachrichtenspeicher Anbieter unterstützt Benachrichtigungen.</span><span class="sxs-lookup"><span data-stu-id="58922-107">Whether you register with particular message store objects, with the folder hierarchy and contents tables that describe these objects, or with both objects and tables depends on the notifications you expect to see, the calls you make to perform operations, and how the message store provider supports notification.</span></span> 
  
<span data-ttu-id="58922-108">Da MAPI die Flexibilität in der Art der Unterstützung von Anbietern von Benachrichtigungen ermöglicht, müssen Sie beachten, dass Sie nicht immer dieselbe Art von Benachrichtigung als Reaktion auf ein bestimmtes Ereignis von allen Nachrichtenspeicher Anbietern erhalten.</span><span class="sxs-lookup"><span data-stu-id="58922-108">Because MAPI allows flexibility in how providers support notifications, be aware that you will not always receive the same type of notification in response to a particular event from all message store providers.</span></span> <span data-ttu-id="58922-109">Einige Nachrichtenspeicher Anbieter unterstützen keine Benachrichtigungen.</span><span class="sxs-lookup"><span data-stu-id="58922-109">Some message store providers do not support notifications at all.</span></span> <span data-ttu-id="58922-110">Um zu ermitteln, ob der verwendete Nachrichtenspeicher die Benachrichtigung unterstützt, suchen Sie nach dem STORE_NOTIFY_OK-Bit in der **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md))-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="58922-110">To determine if the message store you are using supports notification, look for the STORE_NOTIFY_OK bit in its **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="58922-111">An einem Ende des Spektrums der Nachrichtenspeicher Anbieter, die Benachrichtigungen unterstützen, handelt es sich um Anbieter, die "Rich"-Benachrichtigungen generieren. Diese Anbieter senden beschreibende Benachrichtigungen für alle registrierten Advise-Quellen.</span><span class="sxs-lookup"><span data-stu-id="58922-111">At one end of the spectrum of message store providers that support notification are the providers that generate "rich" notifications; these providers send descriptive notifications for all registered advise sources.</span></span> <span data-ttu-id="58922-112">Am anderen Ende befinden sich die Nachrichtenspeicher Anbieter, die eingeschränkte Benachrichtigungen unterstützen. Diese Anbieter senden allgemeine Benachrichtigungen für eine eingeschränkte Anzahl von Advise-Quellen.</span><span class="sxs-lookup"><span data-stu-id="58922-112">At the other end are the message store providers that support limited notifications; these providers send general notifications for a restricted number of advise sources.</span></span> 
  
<span data-ttu-id="58922-113">Wenn Sie beispielsweise eine Nachricht in einen Ordner kopieren, für den Sie sowohl kopierte Objekte als auch verschobene Objekte erhalten haben, können Sie das Objekt als Kopie der Benachrichtigung erhalten oder nicht.</span><span class="sxs-lookup"><span data-stu-id="58922-113">For example, if you copy a message to a folder with which you have registered to receive both object copied and object moved notifications, you may or may not receive the object copied notification.</span></span> <span data-ttu-id="58922-114">Ob Sie Sie erhalten, hängt von folgenden Themen ab:</span><span class="sxs-lookup"><span data-stu-id="58922-114">Whether or not you receive it depends on:</span></span>
  
- <span data-ttu-id="58922-115">Die Methode, die Sie zum Ausführen der Kopie aufgerufen haben.</span><span class="sxs-lookup"><span data-stu-id="58922-115">The method that you called to perform the copy.</span></span> <span data-ttu-id="58922-116">Dies kann [IMAPIFolder:: CopyMessages](imapifolder-copymessages.md), [IMAPIProp:: CopyTo](imapiprop-copyto.md)oder [IMAPIProp:: CopyProps](imapiprop-copyprops.md)sein.</span><span class="sxs-lookup"><span data-stu-id="58922-116">This could be [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md), or [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="58922-117">Wie der Nachrichtenspeicher Anbieter die Copy-Methode implementiert.</span><span class="sxs-lookup"><span data-stu-id="58922-117">How the message store provider implements the copy method.</span></span>
    
- <span data-ttu-id="58922-118">Gibt an, ob der Nachrichtenspeicher Anbieterobjekt kopierte Benachrichtigungen für Ordner unterstützt.</span><span class="sxs-lookup"><span data-stu-id="58922-118">Whether or not the message store provider supports object copied notifications on folders.</span></span>
    
<span data-ttu-id="58922-119">Da es keine strengen Richtlinien gibt, die beschreiben, wie Ereignisbenachrichtigungen für Nachrichtenspeicher Anbieter implementiert werden, können Clients kein konsistentes Verhalten erwarten.</span><span class="sxs-lookup"><span data-stu-id="58922-119">Because there are no strict guidelines that describe how to implement event notification for message store providers, clients cannot expect consistent behavior.</span></span> <span data-ttu-id="58922-120">MAPI gibt Empfehlungen dazu ab, wie Nachrichtenspeicher Anbieter Ereignisbenachrichtigungen implementieren, und in der folgenden Tabelle werden diese Empfehlungen beschrieben.</span><span class="sxs-lookup"><span data-stu-id="58922-120">MAPI does make recommendations as to how message store providers implement event notification and the following table outlines these recommendations.</span></span> <span data-ttu-id="58922-121">Lesen Sie die Tabelle wie folgt: Wenn Sie den Vorgang in der ersten Spalte ausgeführt haben, erwarten Sie, dass Sie eine Benachrichtigung über den in der zweiten Spalte aufgeführten Typ erhalten, wenn Sie sich für diesen Typ mit dem in der dritten Spalte aufgeführten Objekt registriert haben.</span><span class="sxs-lookup"><span data-stu-id="58922-121">Read the table as follows: after you perform the operation in the first column, expect to receive a notification of the type listed in the second column if you have registered for that type with the object listed in the third column.</span></span> <span data-ttu-id="58922-122">Wenn Sie beispielsweise einen Ordner erstellt haben, erhalten Sie nur dann eine _fnevObjectCreated_ -Benachrichtigung, wenn Sie sich für _fnevObjectCreated_ -Benachrichtigungen mit dem Nachrichtenspeicher registriert haben.</span><span class="sxs-lookup"><span data-stu-id="58922-122">For example, after you have created a folder, you will receive an  _fnevObjectCreated_ notification only if you have registered for  _fnevObjectCreated_ notifications with the message store.</span></span> 
  
|<span data-ttu-id="58922-123">**Vorgang**</span><span class="sxs-lookup"><span data-stu-id="58922-123">**Operation**</span></span>|<span data-ttu-id="58922-124">**Ereignistyp**</span><span class="sxs-lookup"><span data-stu-id="58922-124">**Event type**</span></span>|<span data-ttu-id="58922-125">**Quelle beraten**</span><span class="sxs-lookup"><span data-stu-id="58922-125">**Advise source**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="58922-126">Erstellen eines Ordners</span><span class="sxs-lookup"><span data-stu-id="58922-126">Create a folder</span></span>  <br/> | <span data-ttu-id="58922-127">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="58922-127">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="58922-128">Nachrichtenspeicher</span><span class="sxs-lookup"><span data-stu-id="58922-128">Message store</span></span>  <br/> |
|<span data-ttu-id="58922-129">Löschen eines Ordners</span><span class="sxs-lookup"><span data-stu-id="58922-129">Delete a folder</span></span>  <br/> | <span data-ttu-id="58922-130">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="58922-130">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="58922-131">Gelöschter Nachrichtenspeicher Ordner</span><span class="sxs-lookup"><span data-stu-id="58922-131">Message store Deleted folder</span></span>  <br/> |
|<span data-ttu-id="58922-132">Verschieben eines Ordners aus einem Ordner in einen anderen</span><span class="sxs-lookup"><span data-stu-id="58922-132">Move a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="58922-133">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="58922-133">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="58922-134">Verschobener Nachrichtenspeicher Ordner</span><span class="sxs-lookup"><span data-stu-id="58922-134">Message store Moved folder</span></span>  <br/> |
|<span data-ttu-id="58922-135">Kopieren eines Ordners aus einem Ordner in einen anderen</span><span class="sxs-lookup"><span data-stu-id="58922-135">Copy a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="58922-136">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="58922-136">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="58922-137">Nachrichtenspeicher und kopierter Ordner (für die neue Kopie des Ordners wurde keine _fnevObjectCreated_ -Benachrichtigung gesendet)</span><span class="sxs-lookup"><span data-stu-id="58922-137">Message store and copied folder (no  _fnevObjectCreated_ notification sent for the new copy of the folder)</span></span>  <br/> |
|<span data-ttu-id="58922-138">Änderung in einer Eigenschaft des berechneten Ordners (**PR_SUBFOLDERS** ([Pidtagsubfolders (](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([pidtagcontentunreadcount (](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([pidtagcontentcount (](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="58922-138">Change in a computed folder property (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>  <br/> | <span data-ttu-id="58922-139">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="58922-139">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="58922-140">Nachrichtenspeicher Geänderter Ordner (keine Benachrichtigung an übergeordneten Ordner)</span><span class="sxs-lookup"><span data-stu-id="58922-140">Message store Changed folder (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="58922-141">Erstellen einer Nachricht</span><span class="sxs-lookup"><span data-stu-id="58922-141">Create a message</span></span>  <br/> | <span data-ttu-id="58922-142">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="58922-142">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="58922-143">Nachrichtenspeicher</span><span class="sxs-lookup"><span data-stu-id="58922-143">Message store</span></span>  <br/> |
|<span data-ttu-id="58922-144">Löschen einer Nachricht, was zu einer Änderung in der **PR_CONTENT_COUNT** -Eigenschaft des übergeordneten Ordners führt</span><span class="sxs-lookup"><span data-stu-id="58922-144">Delete a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="58922-145">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="58922-145">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="58922-146">Gelöschte Nachricht des Nachrichtenspeichers</span><span class="sxs-lookup"><span data-stu-id="58922-146">Message store Deleted message</span></span>  <br/> |
|<span data-ttu-id="58922-147">Verschieben einer Nachricht von einem Ordner in einen anderen</span><span class="sxs-lookup"><span data-stu-id="58922-147">Move a message from one folder to another</span></span>  <br/> | <span data-ttu-id="58922-148">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="58922-148">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="58922-149">Nachrichtenspeicher-verschobene Nachricht</span><span class="sxs-lookup"><span data-stu-id="58922-149">Message store Moved message</span></span>  <br/> |
|<span data-ttu-id="58922-150">Kopieren einer Nachricht von einem Ordner in einen anderen</span><span class="sxs-lookup"><span data-stu-id="58922-150">Copy a message from one folder to another</span></span>  <br/> | <span data-ttu-id="58922-151">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="58922-151">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="58922-152">Nachrichtenspeicher kopierte Nachricht (keine _fnevObjectCreated_ -Benachrichtigung für neue Kopie der Nachricht)</span><span class="sxs-lookup"><span data-stu-id="58922-152">Message store Copied message (No  _fnevObjectCreated_ notification for new copy of the message)</span></span>  <br/> |
|<span data-ttu-id="58922-153">Speichern einer Nachricht, was zu einer Änderung in der **PR_CONTENT_COUNT** -Eigenschaft des übergeordneten Ordners führt</span><span class="sxs-lookup"><span data-stu-id="58922-153">Save a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="58922-154">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="58922-154">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="58922-155">Nachrichtenspeicher nur beim ersten Speichern</span><span class="sxs-lookup"><span data-stu-id="58922-155">Message store on first save only</span></span>  <br/> |
|<span data-ttu-id="58922-156">Speichern einer Nachricht</span><span class="sxs-lookup"><span data-stu-id="58922-156">Save a message</span></span>  <br/> | <span data-ttu-id="58922-157">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="58922-157">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="58922-158">Nachrichtenspeicher nach der ersten Speicherung geänderter Nachricht (keine Benachrichtigung an übergeordneten Ordner)</span><span class="sxs-lookup"><span data-stu-id="58922-158">Message store on saves after the first save Changed message (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="58922-159">Abschließen eines Suchvorgangs</span><span class="sxs-lookup"><span data-stu-id="58922-159">Complete a search operation</span></span>  <br/> | <span data-ttu-id="58922-160">_fnevSearchComplete_</span><span class="sxs-lookup"><span data-stu-id="58922-160">_fnevSearchComplete_</span></span> <br/> |<span data-ttu-id="58922-161">Nachrichtenspeicher-Suchordner</span><span class="sxs-lookup"><span data-stu-id="58922-161">Message store Search folder</span></span>  <br/> |
|<span data-ttu-id="58922-162">Neue Nachricht</span><span class="sxs-lookup"><span data-stu-id="58922-162">New message</span></span>  <br/> | <span data-ttu-id="58922-163">_Uleventmaskfnevnewmail_</span><span class="sxs-lookup"><span data-stu-id="58922-163">_fnevNewMail_</span></span> <br/> |<span data-ttu-id="58922-164">Nachrichtenspeicher</span><span class="sxs-lookup"><span data-stu-id="58922-164">Message store</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="58922-165">Wenn Sie eine geänderte Objekt Benachrichtigung erhalten, denken Sie daran, dass der Array Teil der [OBJECT_NOTIFICATION](object_notification.md) -Struktur, auf den durch den _lpNotifications_ -Parameter \*\*\*\* im OnNotify-Aufruf verwiesen wird, möglicherweise den Wert NULL hat oder nicht.</span><span class="sxs-lookup"><span data-stu-id="58922-165">When you receive an object modified notification, remember that the property tag array portion of the [OBJECT_NOTIFICATION](object_notification.md) structure pointed to by the  _lpNotifications_ parameter in the **OnNotify** call may or may not be NULL.</span></span> <span data-ttu-id="58922-166">Nachrichtenspeicher Anbieter sind nicht zum Einfügen von Eigenschaftsinformationen in diesem Array und die meisten nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="58922-166">Message store providers are not required to insert property information in this array and most do not.</span></span> <span data-ttu-id="58922-167">Stellen Sie sicher \*\*\*\* , dass Ihre OnNotify-Methode den Fall behandeln kann, dass der _LPPROPTAGARRAY_ -Zeiger NULL ist.</span><span class="sxs-lookup"><span data-stu-id="58922-167">Make sure your **OnNotify** method can handle the case where the  _lpPropTagArray_ pointer is NULL.</span></span> 
  
<span data-ttu-id="58922-168">Aktualisieren Sie für die meisten, wenn nicht alle Objekt Benachrichtigungen, die Ansicht des betreffenden Ordners oder der betroffenen Ordner.</span><span class="sxs-lookup"><span data-stu-id="58922-168">For most, if not all object notifications, update the view of the affected folder or folders.</span></span>
  

