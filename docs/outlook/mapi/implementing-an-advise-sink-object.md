---
title: Implementieren einer Benachrichtigungssenke
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7461c4f6-7030-4ba2-ada4-26ebfbbfa001
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: a95222f8ec75c519558636cf54111f28cbe14066
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19792551"
---
# <a name="implementing-an-advise-sink-object"></a><span data-ttu-id="4f732-103">Implementieren einer Benachrichtigungssenke</span><span class="sxs-lookup"><span data-stu-id="4f732-103">Implementing an Advise Sink Object</span></span>

  
  
<span data-ttu-id="4f732-104">**Betrifft**: Outlook</span><span class="sxs-lookup"><span data-stu-id="4f732-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="4f732-105">Ein Client kann entweder Implementieren der Empfängerobjekten eigene Advise oder eine Hilfsfunktion [HrAllocAdviseSink](hrallocadvisesink.md)verwenden.</span><span class="sxs-lookup"><span data-stu-id="4f732-105">A client can either implement its own advise sink objects or use a utility function, [HrAllocAdviseSink](hrallocadvisesink.md).</span></span> <span data-ttu-id="4f732-106">**HrAllocAdviseSink** erstellt ein Advise-Empfänger-Objekt mit einer Implementierung der **OnNotify** , die eine Callback-Funktion aufruft.</span><span class="sxs-lookup"><span data-stu-id="4f732-106">**HrAllocAdviseSink** creates an advise sink object with an implementation of **OnNotify** that invokes a callback function.</span></span> 
  
<span data-ttu-id="4f732-107">Vor- und Nachteile der Verwendung von **HrAllocAdviseSink**sind.</span><span class="sxs-lookup"><span data-stu-id="4f732-107">There are advantages and disadvantages to using **HrAllocAdviseSink**.</span></span> <span data-ttu-id="4f732-108">Sie können Arbeit speichern, aber es bietet keine Kontrolle über Verweis zählen von der Advise-Empfängerobjekt, das erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="4f732-108">It can save work, but it provides no control over reference counting the advise sink object that it creates.</span></span> <span data-ttu-id="4f732-109">Aus diesem Grund sollten Clients, die ihre Advise-Empfänger Version sorgfältig kontrollieren möchten, oder deren Abhängigkeiten zwischen ihren Advise-Empfänger und einem anderen Clientobjekt, Erstellen ihrer eigenen **IMAPIAdviseSink** -Implementierung und vermeiden der Verwendung von ** HrAllocAdviseSink** vollständig.</span><span class="sxs-lookup"><span data-stu-id="4f732-109">Therefore, clients that need to carefully control their advise sink's release or that have interdependencies between their advise sink and another client object should construct their own **IMAPIAdviseSink** implementation and avoid using **HrAllocAdviseSink** altogether.</span></span> 
  
<span data-ttu-id="4f732-110">Ein Client, implementieren eine eigene Advise-Empfänger sollte ein unabhängiger-Objekt nicht im Zusammenhang mit der oder alle anderen Objekte Allgemein Komplikationen in Verweis-Zählvorgängen und Objekt Version zu vermeiden abhängenden ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="4f732-110">A client implementing its own advise sink should make it an independent object not related to or dependent upon any other objects so as to eliminate potential complications in reference counting and object release.</span></span> <span data-ttu-id="4f732-111">Jedoch, wenn Sie müssen Advise-Empfänger im Rahmen eines anderen Objekts implementieren oder einen Back Zeiger in ein anderes Objekt als Datenmember einschließen, es wird empfohlen, dass zwei separate Referenzzähler verwaltet werden: eine für das Objekt, die durch die Advise-Empfänger und einen für die Advise-Empfänger.</span><span class="sxs-lookup"><span data-stu-id="4f732-111">However, if you must implement your advise sink as part of another object or include a back pointer to another object as a data member, it is recommended that two separate reference counts be maintained: one for the object referenced by the advise sink and one for the advise sink.</span></span> 
  
<span data-ttu-id="4f732-112">Wenn die Anzahl der Verweise des referenzierten Objekts 0 (null) liegt, alle ihre Methoden kann fehlschlagen und die vtable des Objekts kann gelöscht werden, aber des Speichers für die Advise-Empfänger muss erst nach seiner Referenzzähler auch auf 0 (null) fällt bleiben.</span><span class="sxs-lookup"><span data-stu-id="4f732-112">When the reference count of the referenced object falls to zero, all of its methods can fail and its vtable can be destroyed, but the memory for the advise sink must remain intact until after its reference count also falls to zero.</span></span> <span data-ttu-id="4f732-113">Dies bedeutet, dass der Advise-Empfänger **Release** -Methode muss den Referenzzähler verringert und Fertig stellen, das Objekt löschen, wenn diese Anzahl 0 (null) erreicht.</span><span class="sxs-lookup"><span data-stu-id="4f732-113">This means that the advise sink's **Release** method must decrement its reference count and finish destroying the object when that count reaches zero.</span></span> <span data-ttu-id="4f732-114">Wenn zwei separate Referenzzähler nicht verwaltet werden, wäre es leicht zu Advise-Empfänger als Teil **des Objekts übergreifende Freigabeprozess** versehentlich gelöscht.</span><span class="sxs-lookup"><span data-stu-id="4f732-114">If two separate reference counts are not maintained, it would be easy to inadvertently destroy the advise sink as part of the encompassing object's **Release** process.</span></span> 
  
<span data-ttu-id="4f732-115">Clients verwenden **HrAllocAdviseSink** Advise-Empfänger implementieren müssen gleichmäßig auf keinen Fall ihre Callback-Funktion als eine Methode in einer anderen Advise-Empfängerobjekt enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="4f732-115">Clients using **HrAllocAdviseSink** to implement an advise sink must be equally careful not to include their callback function as a method in another advise sink object.</span></span> <span data-ttu-id="4f732-116">C++-Clients ist es läge vertraut sind, und den _diesem_ Zeiger als Parameter übergeben.</span><span class="sxs-lookup"><span data-stu-id="4f732-116">For C++ clients, it is tempting to do this and pass the  _this_ pointer as a parameter.</span></span> <span data-ttu-id="4f732-117">Dies ist eine gefährlicher Strategie, da Clients in der Regel ein Objekt frei, wenn seine Referenzzähler 0 (null) erreicht.</span><span class="sxs-lookup"><span data-stu-id="4f732-117">This is a dangerous strategy because clients typically free an object when its reference count reaches zero.</span></span> <span data-ttu-id="4f732-118">Freigeben des Speichers für das Empfängerobjekt Advise würden _diese_ den Zeiger ungültig wird.</span><span class="sxs-lookup"><span data-stu-id="4f732-118">Freeing the memory for the advise sink object would render the  _this_ pointer invalid.</span></span> 
  
<span data-ttu-id="4f732-119">Je nach Typ des Ereignisses und die Advise-Quelle kann Ihre **OnNotify** -Methode auf verschiedene Weise behandeln.</span><span class="sxs-lookup"><span data-stu-id="4f732-119">Depending on the type of event and the advise source, your **OnNotify** method can handle events in various ways.</span></span> <span data-ttu-id="4f732-120">In der folgenden Tabelle wird das in einige der Standardereignisse Behandlung von Vorschlägen.</span><span class="sxs-lookup"><span data-stu-id="4f732-120">The following table offers suggestions in how to handle some of the standard events.</span></span> 
  
|<span data-ttu-id="4f732-121">**Ereignistyp**</span><span class="sxs-lookup"><span data-stu-id="4f732-121">**Type of event**</span></span>|<span data-ttu-id="4f732-122">**Behandeln von OnNotify**</span><span class="sxs-lookup"><span data-stu-id="4f732-122">**Handling in OnNotify**</span></span>|
|:-----|:-----|
|<span data-ttu-id="4f732-123">Objekt wurde verschoben</span><span class="sxs-lookup"><span data-stu-id="4f732-123">Object moved</span></span>  <br/> |<span data-ttu-id="4f732-124">Wenn das verschobene ursprüngliche übergeordnete Objekt für das neue übergeordnete Element verknüpft ist, aktualisieren Sie am Anfang der Ansicht mit dem Ordner oder Adressbuchcontainer in der Hierarchie.</span><span class="sxs-lookup"><span data-stu-id="4f732-124">If the moved object's original parent is related to the new parent, update the view beginning with the folder or address book container highest in the hierarchy.</span></span> <span data-ttu-id="4f732-125">Wenn die zwei übergeordneten Container nicht miteinander verknüpft sind, aktualisieren Sie beide den Ansichten.</span><span class="sxs-lookup"><span data-stu-id="4f732-125">If the two parent containers are unrelated, update both of their views.</span></span>  <br/> |
|<span data-ttu-id="4f732-126">Neue Nachricht</span><span class="sxs-lookup"><span data-stu-id="4f732-126">New message</span></span>  <br/> |<span data-ttu-id="4f732-127">Ändern der Benutzeroberfläche, um den Benutzer über den Empfang von einen oder mehrere neue Nachrichten zu informieren.</span><span class="sxs-lookup"><span data-stu-id="4f732-127">Change the user interface to inform the user of the arrival of one or more new messages.</span></span> <span data-ttu-id="4f732-128">Platzieren Sie den Empfangsordner in der aktuellen Ansicht.</span><span class="sxs-lookup"><span data-stu-id="4f732-128">Place the receive folder in the current view.</span></span>  <br/> |
|<span data-ttu-id="4f732-129">Fehler</span><span class="sxs-lookup"><span data-stu-id="4f732-129">Error</span></span>  <br/> |<span data-ttu-id="4f732-130">Melden Sie für alle Objekte außer der Sitzung den Fehler bei Bedarf und zurück.</span><span class="sxs-lookup"><span data-stu-id="4f732-130">For all objects except the session, log the error if necessary and return.</span></span> <span data-ttu-id="4f732-131">Melden Sie für das Sitzungsobjekt Wenn möglich ab.</span><span class="sxs-lookup"><span data-stu-id="4f732-131">For the session object, log off if possible.</span></span>  <br/> |
|<span data-ttu-id="4f732-132">Suche abgeschlossen</span><span class="sxs-lookup"><span data-stu-id="4f732-132">Search complete</span></span>  <br/> |<span data-ttu-id="4f732-133">Keine Verarbeitung erforderlich.</span><span class="sxs-lookup"><span data-stu-id="4f732-133">No processing necessary.</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="4f732-134">Benachrichtigungshandler sollte wiedereintretende sein.</span><span class="sxs-lookup"><span data-stu-id="4f732-134">Notification handlers should be reentrant.</span></span> 
  

