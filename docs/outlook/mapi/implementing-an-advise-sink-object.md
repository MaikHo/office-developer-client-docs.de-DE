---
title: Implementieren eines Advise-Senke-Objekts
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7461c4f6-7030-4ba2-ada4-26ebfbbfa001
description: 'Letzte �nderung: Montag, 9. M�rz 2015'
ms.openlocfilehash: ecaad65d28f74b843b86ca82dab9a833ade77363
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32351100"
---
# <a name="implementing-an-advise-sink-object"></a><span data-ttu-id="e32cf-103">Implementieren eines Advise-Senke-Objekts</span><span class="sxs-lookup"><span data-stu-id="e32cf-103">Implementing an Advise Sink Object</span></span>

  
  
<span data-ttu-id="e32cf-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e32cf-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e32cf-105">Ein Client kann entweder eigene Advise-Empfängerobjekte implementieren oder eine Hilfsfunktion [HrAllocAdviseSink](hrallocadvisesink.md)verwenden.</span><span class="sxs-lookup"><span data-stu-id="e32cf-105">A client can either implement its own advise sink objects or use a utility function, [HrAllocAdviseSink](hrallocadvisesink.md).</span></span> <span data-ttu-id="e32cf-106">**HrAllocAdviseSink** erstellt ein Advise-Senke-Objekt mit \*\*\*\* einer Implementierung von OnNotify, die eine Rückruffunktion aufruft.</span><span class="sxs-lookup"><span data-stu-id="e32cf-106">**HrAllocAdviseSink** creates an advise sink object with an implementation of **OnNotify** that invokes a callback function.</span></span> 
  
<span data-ttu-id="e32cf-107">Es gibt vor-und Nachteile bei der Verwendung von **HrAllocAdviseSink**.</span><span class="sxs-lookup"><span data-stu-id="e32cf-107">There are advantages and disadvantages to using **HrAllocAdviseSink**.</span></span> <span data-ttu-id="e32cf-108">Es kann Arbeit speichern, aber es bietet keine Kontrolle über die Verweiszählung des Advise-Senke-Objekts, das es erstellt.</span><span class="sxs-lookup"><span data-stu-id="e32cf-108">It can save work, but it provides no control over reference counting the advise sink object that it creates.</span></span> <span data-ttu-id="e32cf-109">Daher sollten Clients, die die Freigabe ihrer Advise-Senke sorgfältig steuern müssen oder die gegenseitige Abhängigkeiten zwischen Ihrer Advise-Senke und einem anderen Clientobjekt aufweisen, ihre eigene **IMAPIAdviseSink** -Implementierung erstellen und die Verwendung **von HrAllocAdviseSink** .</span><span class="sxs-lookup"><span data-stu-id="e32cf-109">Therefore, clients that need to carefully control their advise sink's release or that have interdependencies between their advise sink and another client object should construct their own **IMAPIAdviseSink** implementation and avoid using **HrAllocAdviseSink** altogether.</span></span> 
  
<span data-ttu-id="e32cf-110">Ein Client, der seine eigene Advise-Senke implementiert, sollte es zu einem unabhängigen Objekt machen, das nicht mit oder von anderen Objekten abhängig ist, um mögliche Komplikationen bei der Verweiszählung und der Objektfreigabe zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="e32cf-110">A client implementing its own advise sink should make it an independent object not related to or dependent upon any other objects so as to eliminate potential complications in reference counting and object release.</span></span> <span data-ttu-id="e32cf-111">Wenn Sie jedoch ihre Advise-Senke als Teil eines anderen Objekts implementieren oder einen Rückzeiger auf ein anderes Objekt als Datenmember einfügen müssen, wird empfohlen, zwei getrennte Verweiszähler beizubehalten: eine für das Objekt, auf das von der Advise-Senke verwiesen wird, und eine für die Advise-Senke.</span><span class="sxs-lookup"><span data-stu-id="e32cf-111">However, if you must implement your advise sink as part of another object or include a back pointer to another object as a data member, it is recommended that two separate reference counts be maintained: one for the object referenced by the advise sink and one for the advise sink.</span></span> 
  
<span data-ttu-id="e32cf-112">Wenn der Verweiszähler des referenzierten Objekts auf 0 (null) fällt, können alle seine Methoden fehlschlagen und seine Vtable kann zerstört werden, aber der Speicher für die Advise-Senke muss intakt bleiben, bis der Verweiszähler auch auf Null fällt.</span><span class="sxs-lookup"><span data-stu-id="e32cf-112">When the reference count of the referenced object falls to zero, all of its methods can fail and its vtable can be destroyed, but the memory for the advise sink must remain intact until after its reference count also falls to zero.</span></span> <span data-ttu-id="e32cf-113">Dies hat zur Folge, dass die **Release** -Methode der Advise-Senke den Verweiszähler verringern und das Objekt zerstören muss, wenn diese Anzahl Null erreicht.</span><span class="sxs-lookup"><span data-stu-id="e32cf-113">This means that the advise sink's **Release** method must decrement its reference count and finish destroying the object when that count reaches zero.</span></span> <span data-ttu-id="e32cf-114">Wenn zwei getrennte Verweiszähler nicht verwaltet werden, wäre es einfach, die Advise-Senke als Teil des **Release** -Prozesses des umfassenden Objekts versehentlich zu zerstören.</span><span class="sxs-lookup"><span data-stu-id="e32cf-114">If two separate reference counts are not maintained, it would be easy to inadvertently destroy the advise sink as part of the encompassing object's **Release** process.</span></span> 
  
<span data-ttu-id="e32cf-115">Clients, die **HrAllocAdviseSink** zum Implementieren einer Advise-Senke verwenden, müssen ebenso darauf achten, dass Sie Ihre Rückruffunktion nicht als Methode in einem anderen Advise-Senke-Objekt einbeziehen.</span><span class="sxs-lookup"><span data-stu-id="e32cf-115">Clients using **HrAllocAdviseSink** to implement an advise sink must be equally careful not to include their callback function as a method in another advise sink object.</span></span> <span data-ttu-id="e32cf-116">Für C++-Clients ist es verlockend, dies zu tun und den _this_ -Zeiger als Parameter zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="e32cf-116">For C++ clients, it is tempting to do this and pass the  _this_ pointer as a parameter.</span></span> <span data-ttu-id="e32cf-117">Dies ist eine gefährliche Strategie, da Clients in der Regel ein Objekt freigeben, wenn der Verweiszähler Null erreicht.</span><span class="sxs-lookup"><span data-stu-id="e32cf-117">This is a dangerous strategy because clients typically free an object when its reference count reaches zero.</span></span> <span data-ttu-id="e32cf-118">Durch Freigeben des Speichers für das Advise-Senke-Objekt würde _dieser_ Zeiger ungültig.</span><span class="sxs-lookup"><span data-stu-id="e32cf-118">Freeing the memory for the advise sink object would render the  _this_ pointer invalid.</span></span> 
  
<span data-ttu-id="e32cf-119">Je nach Art des Ereignisses und der Advise-Quelle kann die **OnNotify** -Methode Ereignisse auf unterschiedliche Weise behandeln.</span><span class="sxs-lookup"><span data-stu-id="e32cf-119">Depending on the type of event and the advise source, your **OnNotify** method can handle events in various ways.</span></span> <span data-ttu-id="e32cf-120">In der folgenden Tabelle finden Sie Vorschläge, wie Sie einige der Standardereignisse behandeln können.</span><span class="sxs-lookup"><span data-stu-id="e32cf-120">The following table offers suggestions in how to handle some of the standard events.</span></span> 
  
|<span data-ttu-id="e32cf-121">**Ereignistyp**</span><span class="sxs-lookup"><span data-stu-id="e32cf-121">**Type of event**</span></span>|<span data-ttu-id="e32cf-122">**Behandlung in onNotify**</span><span class="sxs-lookup"><span data-stu-id="e32cf-122">**Handling in OnNotify**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e32cf-123">Objekt verschoben</span><span class="sxs-lookup"><span data-stu-id="e32cf-123">Object moved</span></span>  <br/> |<span data-ttu-id="e32cf-124">Wenn das ursprüngliche übergeordnete Objekt des verschobenen Objekts mit dem neuen übergeordneten Element verknüpft ist, aktualisieren Sie die Ansicht, beginnend mit dem Ordner-oder Adressbuchcontainer am höchsten in der Hierarchie.</span><span class="sxs-lookup"><span data-stu-id="e32cf-124">If the moved object's original parent is related to the new parent, update the view beginning with the folder or address book container highest in the hierarchy.</span></span> <span data-ttu-id="e32cf-125">Wenn die beiden übergeordneten Container nicht miteinander verbunden sind, aktualisieren Sie beide Ansichten.</span><span class="sxs-lookup"><span data-stu-id="e32cf-125">If the two parent containers are unrelated, update both of their views.</span></span>  <br/> |
|<span data-ttu-id="e32cf-126">Neue Nachricht</span><span class="sxs-lookup"><span data-stu-id="e32cf-126">New message</span></span>  <br/> |<span data-ttu-id="e32cf-127">Ändern Sie die Benutzeroberfläche, um den Benutzer über das Eintreffen einer oder mehrerer neuer Nachrichten zu informieren.</span><span class="sxs-lookup"><span data-stu-id="e32cf-127">Change the user interface to inform the user of the arrival of one or more new messages.</span></span> <span data-ttu-id="e32cf-128">Platzieren Sie den Empfangsordner in der aktuellen Ansicht.</span><span class="sxs-lookup"><span data-stu-id="e32cf-128">Place the receive folder in the current view.</span></span>  <br/> |
|<span data-ttu-id="e32cf-129">Fehler</span><span class="sxs-lookup"><span data-stu-id="e32cf-129">Error</span></span>  <br/> |<span data-ttu-id="e32cf-130">Protokollieren Sie bei allen Objekten mit Ausnahme der Sitzung den Fehler, falls erforderlich, und geben Sie zurück.</span><span class="sxs-lookup"><span data-stu-id="e32cf-130">For all objects except the session, log the error if necessary and return.</span></span> <span data-ttu-id="e32cf-131">Melden Sie sich bei dem Session-Objekt ab, falls möglich.</span><span class="sxs-lookup"><span data-stu-id="e32cf-131">For the session object, log off if possible.</span></span>  <br/> |
|<span data-ttu-id="e32cf-132">Vollständige Suche</span><span class="sxs-lookup"><span data-stu-id="e32cf-132">Search complete</span></span>  <br/> |<span data-ttu-id="e32cf-133">Keine Verarbeitung erforderlich.</span><span class="sxs-lookup"><span data-stu-id="e32cf-133">No processing necessary.</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="e32cf-134">Benachrichtigungshandler sollten wieder eintreten.</span><span class="sxs-lookup"><span data-stu-id="e32cf-134">Notification handlers should be reentrant.</span></span> 
  

