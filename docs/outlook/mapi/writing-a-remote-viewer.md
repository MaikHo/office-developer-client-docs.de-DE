---
title: Schreiben eines Remote-Viewers
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f4d7d42f-688a-4199-b972-dd42528c0cdf
description: 'Letzte �nderung: Montag, 9. M�rz 2015'
ms.openlocfilehash: 1d7fea7f92a315b9671d17c82a82d5d7d180f4bb
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32325662"
---
# <a name="writing-a-remote-viewer"></a><span data-ttu-id="b8cf4-103">Schreiben eines Remote-Viewers</span><span class="sxs-lookup"><span data-stu-id="b8cf4-103">Writing a remote viewer</span></span>

<span data-ttu-id="b8cf4-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="b8cf4-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="b8cf4-105">Bei einem Remote Viewer handelt es sich um ein Fenster in einer Clientanwendung, das den Zugriff auf Nachrichten kontrolliert, die auf einem anderen Computer gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-105">A remote viewer is a window in a client application that provides controlled access to messages stored on another computer.</span></span> <span data-ttu-id="b8cf4-106">Dieser kontrollierte Zugriff kann auf eine langsame Kommunikationsverbindung angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-106">This controlled access might operate on a slow communications link.</span></span> <span data-ttu-id="b8cf4-107">Statt eine vollständige Auswahl der verfügbaren Nachrichten immer dann abzurufen, wenn ein Benutzer einen Ordner öffnet, werden zunächst nur die Kopfzeilen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-107">Rather than retrieve a complete selection of available messages every time a user opens a folder, the remote viewer first displays only the headers.</span></span> <span data-ttu-id="b8cf4-108">Der Benutzer wählt dann aus den Kopfzeilen aus, welche der Nachrichten vollständig angezeigt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-108">The user then selects from the headers which of the messages to display in full.</span></span> <span data-ttu-id="b8cf4-109">Remote Viewer-Clients können Benutzern das Löschen von Nachrichten ermöglichen, bevor Sie heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-109">Remote viewer clients can allow their users to delete messages before they are ever downloaded.</span></span> 
  
## <a name="to-retrieve-the-headers-of-messages-stored-remotely"></a><span data-ttu-id="b8cf4-110">So rufen Sie die Kopfzeilen von Nachrichten ab, die Remote gespeichert werden</span><span class="sxs-lookup"><span data-stu-id="b8cf4-110">To retrieve the headers of messages stored remotely</span></span>
  
1. <span data-ttu-id="b8cf4-111">Rufen Sie [IMAPISession::](imapisession-getstatustable.md) getstatusable auf, um auf die Statustabelle zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-111">Call [IMAPISession::GetStatusTable](imapisession-getstatustable.md) to access the status table.</span></span> 
    
2. <span data-ttu-id="b8cf4-112">Rufen Sie [IMAPITable:: Restrict](imapitable-restrict.md) auf, um die Statustabelle auf die Zeilen einzuschränken, deren **PR\_-\_Ressourcentyp** ([pidtagresourcetype (](pidtagresourcetype-canonical-property.md))\_auf\_MAPI-Transport Anbieter festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-112">Call [IMAPITable::Restrict](imapitable-restrict.md) to limit the status table to only those rows that have their **PR\_RESOURCE\_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)) column set to MAPI\_TRANSPORT\_PROVIDER.</span></span> 
    
3. <span data-ttu-id="b8cf4-113">Rufen Sie [IMAPITable::](imapitable-setcolumns.md) SetColumns auf, um die folgenden Spalten in die Statustabelle einzuschließen:</span><span class="sxs-lookup"><span data-stu-id="b8cf4-113">Call [IMAPITable::SetColumns](imapitable-setcolumns.md) to include the following columns in the status table:</span></span> 
   - <span data-ttu-id="b8cf4-114">**PR\_** -Eintrags-Nr. ([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-114">**PR\_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>
   - <span data-ttu-id="b8cf4-115">**PR\_-\_Ressourcen Methoden** ([pidtagresourcemethods (](pidtagresourcemethods-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-115">**PR\_RESOURCE\_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span></span>
   - <span data-ttu-id="b8cf4-116">**PR\_-\_Ressourcentyp**, **\_PR\_-Anbieter Anzeige** ([pidtagproviderdisplay (](pidtagproviderdisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-116">**PR\_RESOURCE\_TYPE**, **PR\_PROVIDER\_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md))</span></span>
   - <span data-ttu-id="b8cf4-117">**PR\_-\_Status Code** ([pidtagstatuscode (](pidtagstatuscode-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="b8cf4-117">**PR\_STATUS\_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md)).</span></span>
    
4. <span data-ttu-id="b8cf4-118">Rufen Sie [HrQueryAllRows](hrqueryallrows.md) auf, um alle Zeilen in der Statustabelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-118">Call [HrQueryAllRows](hrqueryallrows.md) to retrieve all the rows in the status table.</span></span> 
    
5. <span data-ttu-id="b8cf4-119">Führen Sie den Eintragsbezeichner für jede Zeile in der Tabelle in einem Aufruf von [IMAPISession:: OpenEntry](imapisession-openentry.md)aus.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-119">Pass the entry identifier for each row in the table in a call to [IMAPISession::OpenEntry](imapisession-openentry.md).</span></span> <span data-ttu-id="b8cf4-120">Da diese Schnittstelle vom Prozesskontext des MAPI-Spoolers zum Prozesskontext des Clients gemarshallt wird – im Gegensatz zu Schnittstellen, die normalerweise von Adressbuch-oder Nachrichtenspeicher Anbietern abgerufen werden – sind Probleme im Zusammenhang mit Multithreading von größerer Bedeutung.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-120">Because this interface is marshaled from the MAPI spooler's process context to the client's process context — unlike interfaces typically obtained from address book or message store providers — issues concerning multithreading are of more importance.</span></span> 
    
6. <span data-ttu-id="b8cf4-121">Rufen Sie die [IUnknown:: QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d.aspx) -Methode des Status-Objekts auf, übergeben Sie IID_IMAPIFolder als Schnittstellenbezeichner, um den Remoteordner abzurufen.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-121">Call the status object's [IUnknown::QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d.aspx) method, passing IID_IMAPIFolder as the interface identifier, to retrieve the remote folder.</span></span> <span data-ttu-id="b8cf4-122">Der Remoteordner ist keine vollständige Ordner Implementierung; Es unterstützt nur eine Teilmenge der Folder-Methoden und-Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-122">The remote folder is not a complete folder implementation; it supports only a subset of folder methods and properties.</span></span> <span data-ttu-id="b8cf4-123">Eine der erforderlichen Methoden, [IMAPIProp::](imapiprop-getprops.md)GetProps, unterstützt das Abrufen der folgenden Eigenschaften:</span><span class="sxs-lookup"><span data-stu-id="b8cf4-123">One of the required methods, [IMAPIProp::GetProps](imapiprop-getprops.md), supports the retrieval of the following properties:</span></span>
    
    |||
    |:-----|:-----|
    |<span data-ttu-id="b8cf4-124">**PR\_-Zugriff** ([pidtagaccess (](pidtagaccess-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-124">**PR\_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-125">**PR_ACCESS_LEVEL** ([Pidtagaccesslevel (](pidtagaccesslevel-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-125">**PR_ACCESS_LEVEL** ([PidTagAccessLevel](pidtagaccesslevel-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="b8cf4-126">**PR_CONTENT_COUNT** ([Pidtagcontentcount (](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-126">**PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-127">**PR_ASSOC_CONTENT_COUNT** ([Pidtagassociatedcontentcount (](pidtagassociatedcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-127">**PR_ASSOC_CONTENT_COUNT** ([PidTagAssociatedContentCount](pidtagassociatedcontentcount-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="b8cf4-128">**PR_FOLDER_TYPE** ([Pidtagfoldertype (](pidtagfoldertype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-128">**PR_FOLDER_TYPE** ([PidTagFolderType](pidtagfoldertype-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-129">**PR_OBJECT_TYPE** ([Pidtagobjecttype (](pidtagobjecttype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-129">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="b8cf4-130">**PR\_** -Unterordner ([pidtagsubfolders (](pidtagsubfolders-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-130">**PR\_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-131">**PR_CREATION_TIME** ([PidTagCreationTime](pidtagcreationtime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-131">**PR_CREATION_TIME** ([PidTagCreationTime](pidtagcreationtime-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="b8cf4-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-133">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-133">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span></span>  <br/> |
    
    <span data-ttu-id="b8cf4-134">Remote Ordner müssen außerdem die Methoden [IMAPIProp::](imapiprop-getproplist.md)getproplist, [IMAPIContainer::](imapicontainer-getcontentstable.md)getcontentable und [IMAPIFolder:: SetMessageStatus](imapifolder-setmessagestatus.md) unterstützen.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-134">Remote folders must also support the [IMAPIProp::GetPropList](imapiprop-getproplist.md), [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md), and [IMAPIFolder::SetMessageStatus](imapifolder-setmessagestatus.md) methods.</span></span> <span data-ttu-id="b8cf4-135">Inhaltstabellen für Remote Ordner unterstützen in der Regel die folgenden Spalten:</span><span class="sxs-lookup"><span data-stu-id="b8cf4-135">Remote folder contents tables typically support the following columns:</span></span> 
        
    |||
    |:-----|:-----|
    |<span data-ttu-id="b8cf4-136">**PR\_-\_Anzeige an** ([PidTagDisplayTo](pidtagdisplayto-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-136">**PR\_DISPLAY\_TO** ([PidTagDisplayTo](pidtagdisplayto-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-137">**PR\_-Eintrags-Nr.**</span><span class="sxs-lookup"><span data-stu-id="b8cf4-137">**PR\_ENTRYID**</span></span> <br/> |
    |<span data-ttu-id="b8cf4-138">**PR\_-HASATTACH** ([pidtaghasattachments (](pidtaghasattachments-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-138">**PR\_HASATTACH** ([PidTagHasAttachments](pidtaghasattachments-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-139">**PR_IMPORTANCE** ([PidTagImportance](pidtagimportance-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-139">**PR_IMPORTANCE** ([PidTagImportance](pidtagimportance-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="b8cf4-140">**PR_INSTANCE_KEY** ([Pidtaginstancekey (](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-140">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-141">**PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-141">**PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="b8cf4-142">**PR\_-MESSAGE_DELIVERY_TIME** ([pidtagmessagedeliverytime (](pidtagmessagedeliverytime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-142">**PR\_MESSAGE_DELIVERY_TIME** ([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-143">**PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-143">**PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="b8cf4-144">**PR\_-MESSAGE_DOWNLOAD_TIME** ([pidtagmessagedownloadtime (](pidtagmessagedownloadtime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-144">**PR\_MESSAGE_DOWNLOAD_TIME** ([PidTagMessageDownloadTime](pidtagmessagedownloadtime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-145">**PR_MESSAGE_SIZE** ([Pidtagmessagesize (](pidtagmessagesize-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-145">**PR_MESSAGE_SIZE** ([PidTagMessageSize](pidtagmessagesize-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="b8cf4-146">**PR_MSG_STATUS** ([Pidtagmessagestatus (](pidtagmessagestatus-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-146">**PR_MSG_STATUS** ([PidTagMessageStatus](pidtagmessagestatus-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-147">**PR_OBJECT_TYPE**</span><span class="sxs-lookup"><span data-stu-id="b8cf4-147">**PR_OBJECT_TYPE**</span></span> <br/> |
    |<span data-ttu-id="b8cf4-148">**PR_NORMALIZED_SUBJECT** ([PidTagNormalizedSubject](pidtagnormalizedsubject-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-148">**PR_NORMALIZED_SUBJECT** ([PidTagNormalizedSubject](pidtagnormalizedsubject-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-149">**PR_PRIORITY** ([Pidtagpriority (](pidtagpriority-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-149">**PR_PRIORITY** ([PidTagPriority](pidtagpriority-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="b8cf4-150">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-150">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-151">**PR_SENSITIVITY** ([PidTagSensitivity](pidtagsensitivity-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-151">**PR_SENSITIVITY** ([PidTagSensitivity](pidtagsensitivity-canonical-property.md))</span></span>  <br/> |
    |<span data-ttu-id="b8cf4-152">**PR\_-SENT_REPRESENTING_NAME** ([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-152">**PR\_SENT_REPRESENTING_NAME** ([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b8cf4-153">**PR_Subject** ([PidTagSubject](pidtagsubject-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b8cf4-153">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span></span>  <br/> |
   
7. <span data-ttu-id="b8cf4-154">Rufen Sie die [IMAPIStatus:: ValidateState](imapistatus-validatestate.md) -Methode des Transportanbieters zum ersten Mal auf, wenn eine der Übertragungsoptionen ausgewählt wird.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-154">Call the transport provider's [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method the first time that one of the transfer options is picked.</span></span> <span data-ttu-id="b8cf4-155">Entweder das REFRESH_XP_HEADER_CACHE-oder das PROCESS_XP_HEADER_CACHE-Prozess Kennzeichen sollte ebenso festgelegt werden wie das SHOW_XP_SSESSION_UI-Flag, damit die Benutzeroberfläche angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-155">Either the REFRESH_XP_HEADER_CACHE or PROCESS_XP_HEADER_CACHE process flag should be set as well as the SHOW_XP_SSESSION_UI flag to allow the user interface to be shown.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="b8cf4-156">Um einen bestimmten Nachrichtenkopf zum Herunterladen oder löschen zu markieren, Ruft ein Client [IMAPIFolder:: SetMessageStatus](imapifolder-setmessagestatus.md) auf und legt das MSGSTATUS_REMOTE_DOWNLOAD-oder MSGSTATUS_REMOTE_DELETE-Flag fest.</span><span class="sxs-lookup"><span data-stu-id="b8cf4-156">To mark a particular message header for downloading or deletion, a client calls [IMAPIFolder::SetMessageStatus](imapifolder-setmessagestatus.md) and sets either the MSGSTATUS_REMOTE_DOWNLOAD or MSGSTATUS_REMOTE_DELETE flag.</span></span> 
  

