---
title: MAPI-Profile
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 493c87a4-317d-47ec-850b-342cac59594b
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: 9db1f8e163e44a44df1e798cebccb3639325275e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32340082"
---
# <a name="mapi-profiles"></a><span data-ttu-id="da4cc-103">MAPI-Profile</span><span class="sxs-lookup"><span data-stu-id="da4cc-103">MAPI Profiles</span></span>

  
  
<span data-ttu-id="da4cc-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="da4cc-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="da4cc-105">In einem Profil werden Informationen zu Dienstanbietern und Nachrichtendiensten gespeichert, die auf einem Computer installiert sind.</span><span class="sxs-lookup"><span data-stu-id="da4cc-105">A profile stores information about service providers and message services that are installed on a computer.</span></span> <span data-ttu-id="da4cc-106">Bei jeder Sitzung wählt ein Client zum Zeitpunkt der Anmeldung ein Profil aus, das die zu verwendenden Anbieter und Dienste beschreibt.</span><span class="sxs-lookup"><span data-stu-id="da4cc-106">For every session, a client at logon time selects one profile that describes the providers and services to be used.</span></span> <span data-ttu-id="da4cc-107">Ein Client kann aus einer Auflistung von Profilen auswählen und bei Bedarf einen als Standard festlegen.</span><span class="sxs-lookup"><span data-stu-id="da4cc-107">A client can choose from a collection of profiles and, if desired, establish one as the default.</span></span> <span data-ttu-id="da4cc-108">Das Standardprofil ist das Profil, das automatisch ausgewählt wird, wenn ein Client eine Sitzung startet und kein Profil explizit angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="da4cc-108">The default profile is the profile that is selected automatically when a client starts a session and has not explicitly specified a profile.</span></span>
  
<span data-ttu-id="da4cc-109">In diesen Themen finden Sie auch eine Erläuterung des Spitznamen Caches, der in einem binären Datenstrom gespeichert ist.</span><span class="sxs-lookup"><span data-stu-id="da4cc-109">Also in these topics, you will find a discussion of the nickname cache, which is stored in a binary stream.</span></span>
  
- [<span data-ttu-id="da4cc-110">Cache für Spitznamen</span><span class="sxs-lookup"><span data-stu-id="da4cc-110">Nickname cache</span></span>](nickname-cache.md)
    
- [<span data-ttu-id="da4cc-111">AutoVervollständigen-Stream</span><span class="sxs-lookup"><span data-stu-id="da4cc-111">Autocomplete Stream</span></span>](autocomplete-stream.md)
    
- [<span data-ttu-id="da4cc-112">Analysieren von Binärdateien</span><span class="sxs-lookup"><span data-stu-id="da4cc-112">Binary File Parsing</span></span>](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)
    
## <a name="profile-sections"></a><span data-ttu-id="da4cc-113">Profilabschnitte</span><span class="sxs-lookup"><span data-stu-id="da4cc-113">Profile Sections</span></span>

<span data-ttu-id="da4cc-114">Profile sind in Abschnitte unterteilt, die Clients und Dienstanbieter Zugriff auf Profileigenschaften für Benutzer anzeigen oder Konfigurationsänderungen vornehmen.</span><span class="sxs-lookup"><span data-stu-id="da4cc-114">Profiles are divided into sections that clients and service providers access to display profile properties to users or to make configuration changes.</span></span> <span data-ttu-id="da4cc-115">Ein Profil Abschnitt ist ein MAPI-Objekt, das die **IProfSect** -Schnittstelle implementiert, eine Schnittstelle, die von **IMAPIProp** abgeleitet wird und keine zusätzlichen Methoden aufweist.</span><span class="sxs-lookup"><span data-stu-id="da4cc-115">A profile section is a MAPI object that implements the **IProfSect** interface, an interface that derives from **IMAPIProp** and has no additional methods.</span></span> <span data-ttu-id="da4cc-116">Weitere Informationen finden Sie unter [IProfSect: IMAPIProp](iprofsectimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="da4cc-116">For more information, see [IProfSect : IMAPIProp](iprofsectimapiprop.md).</span></span> <span data-ttu-id="da4cc-117">Der einzige Zweck besteht darin, die Eigenschaften eines Profil Abschnitts zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="da4cc-117">Its only purpose is to manipulate the properties of a profile section.</span></span> <span data-ttu-id="da4cc-118">Zum Abrufen eines **IProfSect** -Zeigers auf einen bestimmten Profil Abschnitt rufen Clients und Dienstanbieter die folgenden Methoden auf.</span><span class="sxs-lookup"><span data-stu-id="da4cc-118">To retrieve an **IProfSect** pointer to a particular profile section, clients and service providers call the following methods.</span></span> 
  
|||
|:-----|:-----|
|<span data-ttu-id="da4cc-119">Clients können Folgendes aufrufen:</span><span class="sxs-lookup"><span data-stu-id="da4cc-119">Clients can call:</span></span>  <br/> |[<span data-ttu-id="da4cc-120">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="da4cc-120">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="da4cc-121">Dienstanbieter können Folgendes aufrufen:</span><span class="sxs-lookup"><span data-stu-id="da4cc-121">Service providers can call:</span></span>  <br/> |[<span data-ttu-id="da4cc-122">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="da4cc-122">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md) <br/> |
|<span data-ttu-id="da4cc-123">Entweder Clients oder Anbieter können Folgendes aufrufen:</span><span class="sxs-lookup"><span data-stu-id="da4cc-123">Either clients or providers can call:</span></span>  <br/> |[<span data-ttu-id="da4cc-124">IProviderAdmin::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="da4cc-124">IProviderAdmin::OpenProfileSection</span></span>](iprovideradmin-openprofilesection.md) <br/> |
   
<span data-ttu-id="da4cc-125">Profile werden ähnlich wie die Mapisvc hierarchisch organisiert. INF-Datei.</span><span class="sxs-lookup"><span data-stu-id="da4cc-125">Profiles are organized hierarchically much like the MAPISVC.INF file.</span></span> <span data-ttu-id="da4cc-126">Oben in der Hierarchie befinden sich Profilabschnitte, die für das Profil relevante Informationen enthalten.</span><span class="sxs-lookup"><span data-stu-id="da4cc-126">At the top of the hierarchy, there are profile sections that contain information relevant to the profile.</span></span> <span data-ttu-id="da4cc-127">Die mittlere Ebene umfasst Abschnitte, die Informationen zu einem bestimmten Nachrichtendienst enthalten, und die untere Ebene enthält Abschnitte, die Informationen zu einem der Dienstanbieter in einem Nachrichtendienst enthalten.</span><span class="sxs-lookup"><span data-stu-id="da4cc-127">The middle level includes sections that contain information about a particular message service and the lower level includes sections that contain information about one of the service providers in a message service.</span></span> 
  
<span data-ttu-id="da4cc-128">Jedes Profil verfügt über mehrere erforderliche Eigenschaften, die in einem oder mehreren Abschnitten des Profils gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="da4cc-128">Every profile has several required properties that are stored in one or more of the sections of the profile.</span></span> <span data-ttu-id="da4cc-129">Jedes Profil verfügt beispielsweise über die Eigenschaften **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)) und **PR_SEARCH_KEY** ([pidtagsearchkey (](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="da4cc-129">For example, every profile has the **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)) and **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) properties.</span></span> <span data-ttu-id="da4cc-130">Der Suchschlüssel eines Profils wird auf den in MAPIGUID definierten Wert festgelegt. H als MUID_PROFILE_INSTANCE und ist immer garantiert eindeutig unter allen Profilen.</span><span class="sxs-lookup"><span data-stu-id="da4cc-130">A profile's search key is set to the value defined in MAPIGUID.H as MUID_PROFILE_INSTANCE and is always guaranteed to be unique among all profiles.</span></span> <span data-ttu-id="da4cc-131">Obwohl zwei Profile denselben Namen haben können, können Sie nicht den gleichen Suchschlüssel aufweisen.</span><span class="sxs-lookup"><span data-stu-id="da4cc-131">Although two profiles can have the same name, they cannot have the same search key.</span></span> <span data-ttu-id="da4cc-132">Suchschlüssel sollten als Binärdaten anstelle von Daten eines bestimmten Typs behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="da4cc-132">Search keys should be treated as binary data instead of data of any particular type.</span></span>
  
<span data-ttu-id="da4cc-133">Nachrichtenspeicher Anbieter müssen die **PR_DISPLAY_NAME** -Eigenschaft ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) Ihres Nachrichtenspeichers in die Profilabschnitte für das Profil und ihren Nachrichtenspeicher Anbieter einschließen und diese Einträge synchron halten.</span><span class="sxs-lookup"><span data-stu-id="da4cc-133">Message store providers are required to include their message store's **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) property in the profile sections for the profile and for their message store provider and to keep these entries synchronized.</span></span> <span data-ttu-id="da4cc-134">Wenn ein Nachrichtenspeicher erstellt wird, legt der Anbieter **PR_DISPLAY_NAME** basierend auf dem in diesen Profil Abschnitten gespeicherten Wert fest.</span><span class="sxs-lookup"><span data-stu-id="da4cc-134">When a message store is created, the provider sets **PR_DISPLAY_NAME** based on the value stored in these profile sections.</span></span> 
  
<span data-ttu-id="da4cc-135">Es gibt zwei große Unterschiede zwischen Profil Abschnitten und anderen Objekten, die von **IMAPIProp**erben:</span><span class="sxs-lookup"><span data-stu-id="da4cc-135">There are two major differences between profile sections and other objects that inherit from **IMAPIProp**:</span></span> 
  
- <span data-ttu-id="da4cc-136">In Profil Abschnitten werden keine Transaktionen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="da4cc-136">Profile sections do not support transactions.</span></span>
    
- <span data-ttu-id="da4cc-137">Profilabschnitte unterstützen keine benannten Eigenschaften und geben MAPI_E_NO_SUPPORT aus Ihren **IMAPIProp:: GetIDsFromNames** -und **IMAPIProp:: GetNamesFromIDs** -Implementierungen zurück.</span><span class="sxs-lookup"><span data-stu-id="da4cc-137">Profile sections do not support named properties, returning MAPI_E_NO_SUPPORT from their **IMAPIProp::GetIDsFromNames** and **IMAPIProp::GetNamesFromIDs** implementations.</span></span> <span data-ttu-id="da4cc-138">Weitere Informationen finden Sie unter [IMAPIProp:: GetIDsFromNames](imapiprop-getidsfromnames.md) und [IMAPIProp:: GetNamesFromIDs](imapiprop-getnamesfromids.md).</span><span class="sxs-lookup"><span data-stu-id="da4cc-138">For more information, see [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) and [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span></span>
    
<span data-ttu-id="da4cc-139">Da in Profil Abschnitten keine Transaktionen unterstützt werden, werden alle Änderungen, die mit Aufrufen von **IMAPIProp:: CopyProps**, **CopyTo**oder SetProps vorgenommen werden, sofort wirksam. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="da4cc-139">Because profile sections do not support transactions, any changes made with calls to **IMAPIProp::CopyProps**, **CopyTo**, or **SetProps** immediately take effect.</span></span> <span data-ttu-id="da4cc-140">Weitere Informationen finden Sie unter [IMAPIProp:: CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="da4cc-140">For more information, see [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span> <span data-ttu-id="da4cc-141">Clients und Dienstanbieter können die **IMAPIProp:: SaveChanges** -Methode eines Profil Abschnitts aufrufen, die zwar erfolgreich ist, aber keine Auswirkung auf die Profil Abschnittsdaten hat.</span><span class="sxs-lookup"><span data-stu-id="da4cc-141">Clients and service providers can call a profile section's **IMAPIProp::SaveChanges** method and it will succeed, but it does not affect the profile section data.</span></span> <span data-ttu-id="da4cc-142">Weitere Informationen finden Sie unter [IMAPIProp:: SaveChanges](imapiprop-savechanges.md).</span><span class="sxs-lookup"><span data-stu-id="da4cc-142">For more information, see [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span></span> <span data-ttu-id="da4cc-143">Das sofortige Auftreten von Änderungen kann sich darauf auswirken, wie Dienstanbieter die Eigenschaftenblätter implementieren, die Clients zum Anzeigen von Profileigenschaften für Benutzer verwenden.</span><span class="sxs-lookup"><span data-stu-id="da4cc-143">Having changes occur immediately can affect how service providers implement the property sheets that clients use to display profile properties to users.</span></span> <span data-ttu-id="da4cc-144">Dienstanbieter, die Benutzer in der Lage sein sollen, Änderungen zu verschieben oder rückgängig zu machen, müssen ihre Eigenschaftenblätter mit Kopien von Profil Abschnitten anstelle der realen Abschnitte implementieren.</span><span class="sxs-lookup"><span data-stu-id="da4cc-144">Service providers that want users to be able to postpone or undo changes must implement their property sheets with copies of profile sections instead of the real sections.</span></span> <span data-ttu-id="da4cc-145">Durch die Verwendung von Kopien können Benutzer Änderungen vornehmen und diese Änderungen später abbrechen, sodass die ursprünglichen Profilabschnitte unberührt bleiben.</span><span class="sxs-lookup"><span data-stu-id="da4cc-145">By using copies, users can make changes and then later cancel those changes, leaving the original profile sections untouched.</span></span> 
  
<span data-ttu-id="da4cc-146">Die Reihenfolge, in der Informationen in einem Profil angezeigt werden, wirkt sich auf die Art und Weise aus, in der MAPI Ressourcen konfiguriert und Zuordnungen in einer Sitzung tätigt.</span><span class="sxs-lookup"><span data-stu-id="da4cc-146">The order in which information appears in a profile affects how MAPI configures resources and makes assignments in a session.</span></span> <span data-ttu-id="da4cc-147">Die folgenden Zuordnungen sind von der Profilreihenfolge betroffen:</span><span class="sxs-lookup"><span data-stu-id="da4cc-147">The following assignments are affected by profile order:</span></span>
  
- <span data-ttu-id="da4cc-148">Standardnachrichtenspeicher</span><span class="sxs-lookup"><span data-stu-id="da4cc-148">Default message store</span></span>
    
- <span data-ttu-id="da4cc-149">Persönliches Adressbuch</span><span class="sxs-lookup"><span data-stu-id="da4cc-149">Personal address book</span></span>
    
- <span data-ttu-id="da4cc-150">Standardsuch Pfad für Nachrichtenspeicher</span><span class="sxs-lookup"><span data-stu-id="da4cc-150">Default message store search path</span></span>
    
- <span data-ttu-id="da4cc-151">Standardpfad für Adressbuchsuche</span><span class="sxs-lookup"><span data-stu-id="da4cc-151">Default address book search path</span></span>
    
- <span data-ttu-id="da4cc-152">Transport Anbieter Reihenfolge</span><span class="sxs-lookup"><span data-stu-id="da4cc-152">Transport provider order</span></span>
    
<span data-ttu-id="da4cc-153">MAPI legt den Standardnachrichtenspeicher als ersten Nachrichtenspeicher im Profil fest, auf dem das STATUS_DEFAULT_STORE-Flag in seiner **PR_RESOURCE_FLAGS** ([pidtagresourceflags (](pidtagresourceflags-canonical-property.md))-Eigenschaft festgelegt ist, was darauf hinweist, dass es sich um den Standardspeicher handeln kann.</span><span class="sxs-lookup"><span data-stu-id="da4cc-153">MAPI sets the default message store to be the first message store in the profile that has the STATUS_DEFAULT_STORE flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property, which indicates that it can be the default store.</span></span> <span data-ttu-id="da4cc-154">Clients können diese Einstellung durch Aufrufen von **IMAPISession:: SetDefaultStore**außer Kraft setzen.</span><span class="sxs-lookup"><span data-stu-id="da4cc-154">Clients can override this setting by calling **IMAPISession::SetDefaultStore**.</span></span> <span data-ttu-id="da4cc-155">Weitere Informationen finden Sie unter [IMAPISession:: SetDefaultStore](imapisession-setdefaultstore.md).</span><span class="sxs-lookup"><span data-stu-id="da4cc-155">For more information, see [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span></span>
  
<span data-ttu-id="da4cc-156">MAPI erstellt einen Transportauftrag für die Verarbeitung von ausgehenden und eingehenden Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="da4cc-156">MAPI creates a transport order for handling outgoing and incoming messages.</span></span> <span data-ttu-id="da4cc-157">Wenn mehr als ein Transportanbieter für eine Nachricht eines bestimmten Typs registriert wurde, verwendet MAPI diese Reihenfolge, um zu ermitteln, welcher Anbieter die Nachricht verarbeiten soll.</span><span class="sxs-lookup"><span data-stu-id="da4cc-157">When more than one transport provider has registered for a message of a particular type, MAPI uses this order to determine which provider should handle the message.</span></span> <span data-ttu-id="da4cc-158">MAPI legt den Transportauftrag als die Reihenfolge fest, in der die Transportanbieter dem Profil mit einer Ausnahme hinzugefügt wurden: die Transporte, die das STATUS_XP_PREFER_LAST-Flag in Ihrer **PR_RESOURCE_FLAGS** -Eigenschaft festlegen, werden zuletzt in der Reihenfolge positioniert.</span><span class="sxs-lookup"><span data-stu-id="da4cc-158">MAPI sets the transport order to be the order in which the transport providers were added to the profile with one exception--the transports that set the STATUS_XP_PREFER_LAST flag in their **PR_RESOURCE_FLAGS** property are positioned last in the order.</span></span> <span data-ttu-id="da4cc-159">Clients können die Transport Reihenfolge durch Aufrufen von **IMsgServiceAdmin:: MsgServiceTransportOrder**festlegen.</span><span class="sxs-lookup"><span data-stu-id="da4cc-159">Clients can set the transport order by calling **IMsgServiceAdmin::MsgServiceTransportOrder**.</span></span> <span data-ttu-id="da4cc-160">Weitere Informationen finden Sie unter [IMsgServiceAdmin:: MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span><span class="sxs-lookup"><span data-stu-id="da4cc-160">For more information, see [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span></span>
  
<span data-ttu-id="da4cc-161">Diese Richtlinien für die Bestellung von Dienstanbietern und Nachrichtendiensten können manchmal einen Konflikt verursachen.</span><span class="sxs-lookup"><span data-stu-id="da4cc-161">These guidelines for ordering service providers and message services might sometimes conflict.</span></span> <span data-ttu-id="da4cc-162">Wenn ein Konflikt vorliegt, sollte der Code den Konflikt lösen.</span><span class="sxs-lookup"><span data-stu-id="da4cc-162">If there is a conflict, your code should resolve the conflict.</span></span> <span data-ttu-id="da4cc-163">Sie können das Programm für die Mail-Systemsteuerung verwenden, um ein Profil zu überprüfen, das Sie erstellt haben, um zu ermitteln, ob die Anbieter wie erwartet konfiguriert wurden.</span><span class="sxs-lookup"><span data-stu-id="da4cc-163">You can use the Mail Control Panel program to inspect a profile that you have created to determine whether the providers have been configured as expected.</span></span>
  

