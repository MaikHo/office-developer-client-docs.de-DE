---
title: Suchen den Nachrichten-Downloadverlauf für ein POP3-Konto
manager: soliver
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: 90a51150-5c2c-4d5b-8717-5dacc8532744
description: In diesem Thema wird beschrieben, wie e-Mail-Client die PidTagAttachDataBinary-Eigenschaft zum Abrufen des Nachrichten-Downloadverlauf für ein POP3-Konto zugreifen kann.
ms.openlocfilehash: 00cf5b02e29a22b5165a4aa339230b604722ab6d
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19791117"
---
# <a name="locating-the-message-download-history-for-a-pop3-account"></a><span data-ttu-id="2f5a4-103">Suchen den Nachrichten-Downloadverlauf für ein POP3-Konto</span><span class="sxs-lookup"><span data-stu-id="2f5a4-103">Locating the message download history for a POP3 account</span></span>

<span data-ttu-id="2f5a4-104">In diesem Thema wird beschrieben, wie e-Mail-Client die [PidTagAttachDataBinary](http://msdn.microsoft.com/library/3b0a8b28-863e-4b96-a4c0-fdb8f40555b9%28Office.15%29.aspx) -Eigenschaft zum Abrufen des Nachrichten-Downloadverlauf für ein POP3-Konto zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-104">This topic describes how a mail client can access the [PidTagAttachDataBinary](http://msdn.microsoft.com/library/3b0a8b28-863e-4b96-a4c0-fdb8f40555b9%28Office.15%29.aspx) property to get the message download history for a POP3 account.</span></span> 

<span data-ttu-id="2f5a4-105"><a name="OL15Con_AuxRef_LocatingMsgsUIDLHistory_WhyGetUIDLHistory"> </a></span><span class="sxs-lookup"><span data-stu-id="2f5a4-105"></span></span>

## <a name="why-get-the-message-download-history"></a><span data-ttu-id="2f5a4-106">Den Nachrichten-Downloadverlauf Warum?</span><span class="sxs-lookup"><span data-stu-id="2f5a4-106">Why get the message download history?</span></span>

<span data-ttu-id="2f5a4-107">Der Anbieter Post Office Protocol (POP) für Outlook ermöglicht Benutzern abgerufen, und Laden Sie neue e-Mail-Nachrichten auf ihrem lokalen Gerät, und anschließend lassen oder löschen diese e-Mail-Nachrichten auf dem e-Mail-Server.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-107">The Post Office Protocol (POP) provider for Outlook allows users to retrieve and download new email messages on their local device, and subsequently to leave or delete these email messages on the mail server.</span></span> <span data-ttu-id="2f5a4-108">E-Mail-Client für neue Nachrichten herunterladen überprüft, verfügt zu identifizieren, und Laden Sie nur die neuen Nachrichten für Posteingang.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-108">When the mail client checks for new messages to download, it has to be able to identify and download only the new messages for that Inbox.</span></span> <span data-ttu-id="2f5a4-109">E-Mail-Client wird mithilfe von den Befehl UIDL (eindeutige ID aufgelistet), der eine Zuordnung jeder Nachricht abruft, die jemals an Posteingang auf einen eindeutigen Bezeichner (UID) übermittelt wurde.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-109">The mail client does this by first using the UIDL (Unique ID Listing) command, which obtains a map of each message that has ever been delivered to that Inbox to a unique identifier (UID).</span></span> <span data-ttu-id="2f5a4-110">Der Client ruft auch den Nachrichten-Downloadverlauf für Nachrichten, die heruntergeladen oder für den Posteingang auf den Client gelöscht wurden.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-110">The client also gets the message download history for messages that have been downloaded or deleted for the Inbox on that client.</span></span> <span data-ttu-id="2f5a4-111">Mit der Meldung UID-Karte und Downloadverlauf, Identifizieren des Clients kann dann diese Nachrichten, die nicht vorhanden sind im Verlauf als neue und daher sollte heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-111">Using the message UID map and download history, the client can then identify those messages that are absent in the history as new and, hence, should be downloaded.</span></span>
  
<span data-ttu-id="2f5a4-112">Zum Abrufen des Nachrichten-Downloadverlauf für ein Posteingang:</span><span class="sxs-lookup"><span data-stu-id="2f5a4-112">To get the message download history for an Inbox:</span></span>
  
- <span data-ttu-id="2f5a4-113">Führen Sie die Schritte in diesem Thema, um die Eigenschaft **PidTagAttachDataBinary** zu finden, die den Verlauf in ein binary large Object (BLOB) enthält, die ein bestimmtes Format folgt.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-113">Follow the steps in this topic to find the **PidTagAttachDataBinary** property, which contains the history in a binary large object (BLOB) that follows a specific format.</span></span> 
    
- <span data-ttu-id="2f5a4-114">Fahren Sie mit der [Analyse den Nachrichten-Downloadverlauf für ein POP3-Konto](parsing-the-message-download-history-for-a-pop3-account.md), das beschreibt das Analysieren dieser BLOB, um Nachrichten zu ermitteln, die heruntergeladen oder für Posteingang gelöscht wurden.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-114">Continue with [Parsing the message download history for a POP3 account](parsing-the-message-download-history-for-a-pop3-account.md), which describes how to parse this BLOB to identify messages that have been downloaded or deleted for that Inbox.</span></span>
    
## <a name="core-concepts-to-know-for-locating-the-message-download-history"></a><span data-ttu-id="2f5a4-115">Kernkonzepte für die Suche nach der Nachricht Downloadverlauf</span><span class="sxs-lookup"><span data-stu-id="2f5a4-115">Core concepts to know for locating the message download history</span></span>

<span data-ttu-id="2f5a4-116">Der Nachricht Downloadverlauf für einen Posteingang wird in eine binäre MAPI-Eigenschaft, **PidTagAttachDataBinary**, für eine Anlage einer ausgeblendete Nachricht im Posteingang gespeichert.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-116">The message download history for an Inbox is stored in a binary MAPI property, **PidTagAttachDataBinary**, on an attachment of a hidden message in the Inbox.</span></span> <span data-ttu-id="2f5a4-117">Tabelle 1 zeigt die Ressourcen für die Konzepte, erläutert, wie Sie die Nachricht suchen Chatverlauf herunterzuladen.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-117">Table 1 shows resources for concepts that help you understand how to locate the message download history.</span></span>
  
<span data-ttu-id="2f5a4-118">**In Tabelle 1. Zentrale Konzepte**</span><span class="sxs-lookup"><span data-stu-id="2f5a4-118">**Table 1. Core concepts**</span></span>

|<span data-ttu-id="2f5a4-119">**Titel des Artikels**</span><span class="sxs-lookup"><span data-stu-id="2f5a4-119">**Article title**</span></span>|<span data-ttu-id="2f5a4-120">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="2f5a4-120">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="2f5a4-121">MAPI-ausgeblendet Ordner</span><span class="sxs-lookup"><span data-stu-id="2f5a4-121">MAPI Hidden Folders</span></span>](http://msdn.microsoft.com/library/8b3b9c80-f7f4-4f37-bd6b-323469d020f1%28Office.15%29.aspx) <br/> |<span data-ttu-id="2f5a4-122">MAPI ermöglicht es e-Mail-Clients zum Speichern von Informationen in ausgeblendeten Ordnern und ausgeblendete Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-122">MAPI allows mail clients to store information in hidden folders and hidden messages.</span></span> <span data-ttu-id="2f5a4-123">Verborgene Ordner befinden sich in der zugeordneten Teil des MAPI-Ordner und in der Regel enthalten Informationen, die nicht sichtbar sind und nicht durch Benutzer geändert werden.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-123">Hidden folders are in the associated part of MAPI folders and typically contain information that is not visible to and not to be manipulated by users.</span></span> <span data-ttu-id="2f5a4-124">Clients entscheiden, das Format und der Inhalt im ausgeblendete Nachrichten in verborgene Ordner speichern.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-124">Clients decide the format and contents to store in hidden messages in hidden folders.</span></span>  <br/> |
|[<span data-ttu-id="2f5a4-125">MAPI-Nachrichten</span><span class="sxs-lookup"><span data-stu-id="2f5a4-125">MAPI Messages</span></span>](http://msdn.microsoft.com/library/417c113f-bd98-4515-85d1-09db7fc3a227%28Office.15%29.aspx) <br/> |<span data-ttu-id="2f5a4-126">MAPI werden Nachrichten gespeichert, in Ordnern, entweder in der standard-IPM-Unterstruktur, die für Benutzer von einem Client oder außerhalb der Unterstruktur und für den Benutzer unsichtbar sichtbar ist.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-126">MAPI stores messages in folders, either in the standard IPM subtree that is visible to users of a client, or outside of the subtree and invisible to users.</span></span> <span data-ttu-id="2f5a4-127">Nachrichten können zusätzliche Daten in einer Anlage, die in Form einer Datei, eine andere Nachricht oder ein OLE-Objekt sein kann gespeichert haben.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-127">Messages can have additional data stored in an attachment, which can be in the form of a file, another message, or an OLE object.</span></span> <span data-ttu-id="2f5a4-128">Bei der Nachrichten-Downloadverlauf wird der Verlauf in einer Eigenschaft einer Nachricht gespeichert, die an eine andere ausgeblendete Nachricht angefügt wird.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-128">In the case of the message download history, the history is stored in a property of a message that is attached to another hidden message.</span></span>  <br/> |
|[<span data-ttu-id="2f5a4-129">Nachricht Eigenschaften (Übersicht)</span><span class="sxs-lookup"><span data-stu-id="2f5a4-129">Message Properties Overview</span></span>](http://msdn.microsoft.com/library/447f54de-9f0d-4f73-89b6-bed9cfea9c15%28Office.15%29.aspx) <br/> |<span data-ttu-id="2f5a4-130">Wenn ein Client Informationen in einer Nachricht speichert, speichert es tatsächlich die Informationen in einer Eigenschaft der Nachricht an.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-130">When a client stores information in a message, it actually stores the information in a property of the message.</span></span> <span data-ttu-id="2f5a4-131">MAPI unterstützt viele Eigenschaften – einige immer vorhanden und kann von Clients festgelegt werden, andere sind optional – und Clients können nicht erwarten, dass sie verfügbar oder festgelegt werden, gültige Werte.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-131">MAPI supports many properties—some always exist and can be set by clients, others are optional—and clients cannot expect them to be available or set to valid values.</span></span> <span data-ttu-id="2f5a4-132">Der Nachrichten-Downloadverlauf wird in der **PidTagAttachDataBinary** -Eigenschaft auf eine ausgeblendete Nachricht einer Anlage gespeichert.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-132">The message download history is stored in the **PidTagAttachDataBinary** property of an attachment to a hidden message.</span></span>  <br/> |
|[<span data-ttu-id="2f5a4-133">MAPI-Profile</span><span class="sxs-lookup"><span data-stu-id="2f5a4-133">MAPI Profiles</span></span>](http://msdn.microsoft.com/library/493c87a4-317d-47ec-850b-342cac59594b%28Office.15%29.aspx) <br/> |<span data-ttu-id="2f5a4-134">Bei der Anmeldung in einer Sitzung wählt der e-Mail-Client ein Profil, das den Anbieter und die Dienste zu verwendende beschreibt.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-134">At logon time in a session, the mail client selects a profile that describes the providers and services to be used.</span></span> <span data-ttu-id="2f5a4-135">Ein Profil ist in Abschnitte unterteilt, die Eigenschaften enthalten.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-135">A profile is divided into sections that contain properties.</span></span> <span data-ttu-id="2f5a4-136">Insbesondere die [PidTagSearchKey](http://msdn.microsoft.com/library/fcab369a-a1f4-4425-a272-e35046914a4d%28Office.15%29.aspx) (**PR_SEARCH_KEY**) und [PidTagProfileName](http://msdn.microsoft.com/library/13ca726d-ae7a-4da9-9c8e-3db3c479f839%28Office.15%29.aspx) (**PR_PROFILE_NAME**) Eigenschaften sind immer vorhanden.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-136">In particular, the [PidTagSearchKey](http://msdn.microsoft.com/library/fcab369a-a1f4-4425-a272-e35046914a4d%28Office.15%29.aspx) (**PR_SEARCH_KEY**) and [PidTagProfileName](http://msdn.microsoft.com/library/13ca726d-ae7a-4da9-9c8e-3db3c479f839%28Office.15%29.aspx) (**PR_PROFILE_NAME**) properties always exist.</span></span> <span data-ttu-id="2f5a4-137">Ein Profil Search-Schlüssel ist eindeutig für alle Profile, und befindet sich im Profilabschnitt, der von **MUID_PROFILE_INSTANCE** angegeben wird (die im MAPIGUID definiert ist. H).</span><span class="sxs-lookup"><span data-stu-id="2f5a4-137">A profile's search key is unique among all profiles, and is stored in the profile section that is identified by **MUID_PROFILE_INSTANCE** (which is defined in MAPIGUID.H).</span></span> <span data-ttu-id="2f5a4-138">Verwenden Sie [IMAPISession::OpenProfileSection](http://msdn.microsoft.com/library/e2757028-27e7-4fc0-9674-e8e30737ef1d%28Office.15%29.aspx) , um den Abschnitt zu öffnen, und verwenden Sie [IMAPIProp::GetProps](http://msdn.microsoft.com/library/1c7a9cd2-d765-4218-9aee-52df1a2aae6c%28Office.15%29.aspx) , um die Eigenschaftswerte abzurufen.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-138">Use [IMAPISession::OpenProfileSection](http://msdn.microsoft.com/library/e2757028-27e7-4fc0-9674-e8e30737ef1d%28Office.15%29.aspx) to open the section, and use [IMAPIProp::GetProps](http://msdn.microsoft.com/library/1c7a9cd2-d765-4218-9aee-52df1a2aae6c%28Office.15%29.aspx) to get the property values.</span></span>  <br/> |
|[<span data-ttu-id="2f5a4-139">Inhalt von Tabellen</span><span class="sxs-lookup"><span data-stu-id="2f5a4-139">Contents Tables</span></span>](http://msdn.microsoft.com/library/7b8efb4e-b5be-41b8-81bb-9aa1da421433%28Office.15%29.aspx) <br/> |<span data-ttu-id="2f5a4-140">Nachricht Anbieter implementieren Inhalt Tabellen für ihre Ordner.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-140">Message store providers implement contents tables for their folders.</span></span> <span data-ttu-id="2f5a4-141">Ausgeblendete Nachrichten in das zugeordnete Teil eines Ordners Nachricht Anbieter unterstützen zugeordneten Inhalt Tabellen und Clients können die [IMAPIContainer::GetContentsTable](http://msdn.microsoft.com/library/88c7a666-875d-473a-b126-dbbb7009f7d9%28Office.15%29.aspx) -Methode verwenden, um einen Zeiger auf die Inhaltstabelle zugeordneten zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-141">For hidden messages in the associated part of a folder, message store providers support associated contents tables, and clients can use the [IMAPIContainer::GetContentsTable](http://msdn.microsoft.com/library/88c7a666-875d-473a-b126-dbbb7009f7d9%28Office.15%29.aspx) method to return a pointer to the associated contents table.</span></span>  <br/> |
|[<span data-ttu-id="2f5a4-142">Informationen zu Einschränkungen</span><span class="sxs-lookup"><span data-stu-id="2f5a4-142">About Restrictions</span></span>](http://msdn.microsoft.com/library/e119fa20-08b8-4c8d-93fc-56037220890d%28Office.15%29.aspx) <br/> [<span data-ttu-id="2f5a4-143">Arten von Einschränkungen</span><span class="sxs-lookup"><span data-stu-id="2f5a4-143">Types of Restrictions</span></span>](http://msdn.microsoft.com/library/0d3bd58b-7100-4117-91ac-27139715c85b%28Office.15%29.aspx) <br/> [<span data-ttu-id="2f5a4-144">Erstellen eine Einschränkung</span><span class="sxs-lookup"><span data-stu-id="2f5a4-144">Building a Restriction</span></span>](http://msdn.microsoft.com/library/12abbd8c-f825-493e-af42-344371d9658e%28Office.15%29.aspx) <br/> [<span data-ttu-id="2f5a4-145">Beispielcode für die Einschränkung</span><span class="sxs-lookup"><span data-stu-id="2f5a4-145">Sample Restriction Code</span></span>](http://msdn.microsoft.com/library/9b82097c-dbd6-4ba0-a6cb-292301f9402b%28Office.15%29.aspx) <br/> |<span data-ttu-id="2f5a4-146">In MAPI können Clients Einschränkungen zum Filtern von Inhalt Tabellen, Zeilen suchen, die Nachrichten darstellen, die eine bestimmte Eigenschaft auf einen bestimmten Wert festgelegt haben.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-146">In MAPI, clients can use restrictions to filter contents tables, to search for rows that represent messages that have a certain property set to a specific value.</span></span> <span data-ttu-id="2f5a4-147">Einschränkungen werden mithilfe der [SRestriction](http://msdn.microsoft.com/library/c12b4409-da6f-480b-87af-1e5baea2e8bd%28Office.15%29.aspx) -Datenstruktur, die eine Vereinigung von speziellere Einschränkung Strukturen enthalten kann definiert.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-147">Restrictions are defined by using the [SRestriction](http://msdn.microsoft.com/library/c12b4409-da6f-480b-87af-1e5baea2e8bd%28Office.15%29.aspx) data structure, which can contain a union of more specialized restriction structures.</span></span> <span data-ttu-id="2f5a4-148">Die [IMAPITable](http://msdn.microsoft.com/library/6511368c-9777-497e-9eea-cf390c04b92e%28Office.15%29.aspx) -Methode wendet die Einschränkung an und ruft die erste Zeile in einer Tabelle, die die Einschränkungskriterien entspricht.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-148">The [IMAPITable::FindRow](http://msdn.microsoft.com/library/6511368c-9777-497e-9eea-cf390c04b92e%28Office.15%29.aspx) method applies a restriction and retrieves the first row in a table that matches the restriction criteria.</span></span>  <br/> |
|[<span data-ttu-id="2f5a4-149">Zum Registrieren von Speicher für die Indizierung</span><span class="sxs-lookup"><span data-stu-id="2f5a4-149">About Registering Stores for Indexing</span></span>](http://msdn.microsoft.com/library/dd2aa06a-96e8-1291-18b5-fc3c40b74e4d%28Office.15%29.aspx) <br/> |<span data-ttu-id="2f5a4-150">Verwenden Sie die [PidTagStoreProvider](http://msdn.microsoft.com/library/6f6cc66f-a08e-4f8e-b33a-d3674319248e%28Office.15%29.aspx) (**PR_MDB_PROVIDER**)-Eigenschaft, um den Typ des Anbieters sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-150">Use the [PidTagStoreProvider](http://msdn.microsoft.com/library/6f6cc66f-a08e-4f8e-b33a-d3674319248e%28Office.15%29.aspx) (**PR_MDB_PROVIDER**) property to verify the type of store provider.</span></span> <span data-ttu-id="2f5a4-151">Beispielsweise sollte um zu überprüfen, ob ein Speicher einen Exchange-Speicher ist, die **PidTagStoreProvider** -Eigenschaft einen Wert zurückgeben, dargestellt durch die Konstante **PbExchangeProviderPrimaryUserGuid**, die in der öffentlichen Header-Datei edkmdb.h definiert ist.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-151">For example, to verify whether a store is an Exchange store, the **PidTagStoreProvider** property should return a value represented by the constant **pbExchangeProviderPrimaryUserGuid**, which is defined in the public header file edkmdb.h.</span></span>  <br/> |
   
## <a name="locating-the-appropriate-hidden-message-and-attachment"></a><span data-ttu-id="2f5a4-152">Suchen nach den entsprechenden ausgeblendete Nachricht und Anlage</span><span class="sxs-lookup"><span data-stu-id="2f5a4-152">Locating the appropriate hidden message and attachment</span></span>

<span data-ttu-id="2f5a4-153">Nun, wir, dass der Nachricht Downloadverlauf für einen Posteingang in der **PidTagAttachDataBinary** -Eigenschaft auf eine ausgeblendete Nachricht einer Anlage ist wissen, umfasst die Vorgehensweise zum Suchen nach der entsprechenden Anlage der entsprechenden ausgeblendete Nachricht Folgendes Verfahren:</span><span class="sxs-lookup"><span data-stu-id="2f5a4-153">Now that we know the message download history for an Inbox is in the **PidTagAttachDataBinary** property of an attachment to a hidden message, the procedure to locate the appropriate attachment of the appropriate hidden message involves the following procedures:</span></span> 
  
1. [<span data-ttu-id="2f5a4-154">Suchen Sie nach der entsprechenden ausgeblendete Nachricht</span><span class="sxs-lookup"><span data-stu-id="2f5a4-154">Find the appropriate hidden message</span></span>](#OL15Con_AuxRef_LocatingMsgsUIDLHistory_FindHiddenMsg)
    
2. [<span data-ttu-id="2f5a4-155">Suchen Sie nach der entsprechenden Anlage der ausgeblendete Nachricht</span><span class="sxs-lookup"><span data-stu-id="2f5a4-155">Find the appropriate attachment of the hidden message</span></span>](#OL15Con_AuxRef_LocatingMsgsUIDLHistory_FindAttachment)
    
3. [<span data-ttu-id="2f5a4-156">Zugriff auf die PidTagAttachDataBinary-Eigenschaft des e-Mail-Nachrichtenanhang</span><span class="sxs-lookup"><span data-stu-id="2f5a4-156">Access the PidTagAttachDataBinary property of the message attachment</span></span>](#OL15Con_AuxRef_LocatingMsgsUIDLHistory_AccessProp)

<span data-ttu-id="2f5a4-157"><a name="OL15Con_AuxRef_LocatingMsgsUIDLHistory_FindHiddenMsg"> </a></span><span class="sxs-lookup"><span data-stu-id="2f5a4-157"></span></span>

### <a name="find-the-appropriate-hidden-message"></a><span data-ttu-id="2f5a4-158">Suchen Sie nach der entsprechenden ausgeblendete Nachricht</span><span class="sxs-lookup"><span data-stu-id="2f5a4-158">Find the appropriate hidden message</span></span>

1. <span data-ttu-id="2f5a4-159">Rufen Sie die Eigenschaft [PidTagSearchKey](http://msdn.microsoft.com/library/fcab369a-a1f4-4425-a272-e35046914a4d%28Office.15%29.aspx) (**PR_SEARCH_KEY**) aus dem Profil im Profilabschnitt durch **MUID_PROFILE_INSTANCE**angegeben.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-159">Get the [PidTagSearchKey](http://msdn.microsoft.com/library/fcab369a-a1f4-4425-a272-e35046914a4d%28Office.15%29.aspx) (**PR_SEARCH_KEY**) property from the profile, in the profile section specified by **MUID_PROFILE_INSTANCE**.</span></span>
    
2. <span data-ttu-id="2f5a4-160">Öffnen Sie den Inhalt verknüpft ist, für den Ordner Posteingang durch Aufrufen von **IMAPIContainer::GetContentsTable**.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-160">Open the Associated Contents for the Inbox folder by calling **IMAPIContainer::GetContentsTable**.</span></span>
    
3. <span data-ttu-id="2f5a4-161">Erstellen Sie eine Einschränkung basierend auf der [PidTagConversationKey](http://msdn.microsoft.com/library/52c97d6c-7f4b-4522-aeac-0c1ed8475952%28Office.15%29.aspx) (**PR_CONVERSATION_KEY**), **PidTagSearchKey** (**PR_SEARCH_KEY**) und [PidTagMessageClass](http://msdn.microsoft.com/library/1e704023-1992-4b43-857e-0a7da7bc8e87%28Office.15%29.aspx) (**PR_MESSAGE_CLASS**) Eigenschaften zum Abrufen einer Tabelle, enthält alle ausgeblendeten Nachrichten im Inhalt des Posteingangs verknüpft ist.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-161">Create a restriction based on the [PidTagConversationKey](http://msdn.microsoft.com/library/52c97d6c-7f4b-4522-aeac-0c1ed8475952%28Office.15%29.aspx) (**PR_CONVERSATION_KEY**), **PidTagSearchKey** (**PR_SEARCH_KEY**), and [PidTagMessageClass](http://msdn.microsoft.com/library/1e704023-1992-4b43-857e-0a7da7bc8e87%28Office.15%29.aspx) (**PR_MESSAGE_CLASS**) properties to get a table that contains all the hidden messages in the Associated Contents of the Inbox.</span></span> <span data-ttu-id="2f5a4-162">Es folgt ein Beispiel für eine Einschränkung finden Sie [Den POP3 UIDL Verlauf](http://blogs.msdn.com/b/stephen_griffin/archive/2012/12/03/locating-the-pop3-uidl-history.aspx)extrahiert haben.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-162">The following is an example of a restriction extracted from [Locating the POP3 UIDL History](http://blogs.msdn.com/b/stephen_griffin/archive/2012/12/03/locating-the-pop3-uidl-history.aspx).</span></span>
    
   ```cpp
      SRestriction rgRes[3]; 
      SPropValue rgProps[3]; 
      rgRes[0].rt = RES_AND; 
      rgRes[0].res.resAnd.cRes = 2; 
      rgRes[0].res.resAnd.lpRes = &amp;rgRes[1]; 
      rgRes[1].rt = RES_PROPERTY; 
      rgRes[1].res.resProperty.relop = RELOP_EQ; 
      rgRes[1].res.resProperty.ulPropTag = PR_CONVERSATION_KEY; 
      rgRes[1].res.resProperty.lpProp = &amp;rgProps[0]; 
      rgRes[2].rt = RES_PROPERTY; 
      rgRes[2].res.resProperty.relop = RELOP_EQ; 
      rgRes[2].res.resProperty.ulPropTag = PR_MESSAGE_CLASS; 
      rgRes[2].res.resProperty.lpProp = &amp;rgProps[1]; 
      rgProps[0].ulPropTag = PR_CONVERSATION_KEY; 
      rgProps[0].Value.bin = pVals[iSearchKey].Value.bin; // PR_SEARCH_KEY from the profile 
      rgProps[1].ulPropTag = PR_MESSAGE_CLASS; 
      rgProps[1].Value.LPSZ = (LPTSTR)"IPM.MessageManager";
   ```

4. <span data-ttu-id="2f5a4-163">Hier finden Sie ausgeblendete Nachricht mithilfe von **IMAPITable**, aus der Tabelle.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-163">From the table, find the hidden message by using **IMAPITable::FindRow**.</span></span>
    
5. <span data-ttu-id="2f5a4-164">Wenn Schritt 4 fehlschlägt, ausgeblendete Nachricht zu erhalten, ändern Sie die Einschränkung zu **PidTagSearchKey** (**PR_SEARCH_KEY**) anstelle von **PidTagConversationKey**, verwenden Sie wie folgt:</span><span class="sxs-lookup"><span data-stu-id="2f5a4-164">If step 4 fails to find a hidden message, change the restriction to use **PidTagSearchKey** (**PR_SEARCH_KEY**) instead of **PidTagConversationKey**, as shown below:</span></span>
    
   ```cpp
    rgRes[1].res.resProperty.ulPropTag = rgProps[0].ulPropTag = PR_SEARCH_KEY;
   ```

6. <span data-ttu-id="2f5a4-165">Hier finden Sie die ausgeblendete Nachricht **IMAPITable**verwenden.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-165">Find the hidden message using **IMAPITable::FindRow**.</span></span> 
    
7. <span data-ttu-id="2f5a4-166">Wenn Schritt 6 ein Fehler auftritt, ändern Sie die Einschränkung zu [PidTagSubject](http://msdn.microsoft.com/library/aa7ba4d9-c5e0-4ce7-a34e-65f675223bc9%28Office.15%29.aspx) (**PR_SUBJECT**) wird auf den folgenden Wert verwenden (wie unten gezeigt verwenden `printf` Ersetzung der Kürze halber formatieren).</span><span class="sxs-lookup"><span data-stu-id="2f5a4-166">If Step 6 fails, change the restriction to use [PidTagSubject](http://msdn.microsoft.com/library/aa7ba4d9-c5e0-4ce7-a34e-65f675223bc9%28Office.15%29.aspx) (**PR_SUBJECT**) being equal to the following value (shown below using  `printf` style substitution for brevity).</span></span> 
    
   ```cpp
    "Outlook Message Manager (%s) (KEY: %s)", PR_PROFILE_NAME, HexFromBin(PR_SEARCH_KEY)
   ```

8. <span data-ttu-id="2f5a4-167">Suchen Sie ausgeblendete Nachricht mithilfe von **IMAPITable**.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-167">Find the hidden message by using **IMAPITable::FindRow**.</span></span>
    
9. <span data-ttu-id="2f5a4-168">Wenn Sie Outlook 2010 oder eine höhere Version ausgeführt werden, verwenden Sie jeweils die folgenden Werte für **PidTagProfileName** (**PR_PROFILE_NAME**) und **PidTagSearchKey** (**PR_SEARCH_KEY**).</span><span class="sxs-lookup"><span data-stu-id="2f5a4-168">If you are running Outlook 2010 or a later version, use the following values for **PidTagProfileName** (**PR_PROFILE_NAME**) and **PidTagSearchKey** (**PR_SEARCH_KEY**), respectively.</span></span>
    
   ```cpp
    CHAR g_szGeneralKey[] = "General Key"; 
    const SBinary g_binGeneralKey = {sizeof(g_szGeneralKey), (LPBYTE)g_szGeneralKey};
   ```

   <span data-ttu-id="2f5a4-169">Führen Sie die Schritte 3 bis 8.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-169">Run through Steps 3 through 8.</span></span> <span data-ttu-id="2f5a4-170">Wenn dies fehlschlägt, eine Nachricht zu erhalten, zurückgreifen Sie auf die ursprüngliche Schritte 3 bis 8.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-170">If this fails to find a message, fall back to the original steps 3 through 8.</span></span>
    
10. <span data-ttu-id="2f5a4-171">Öffnen Sie die ausgeblendete Nachricht in Schritt 4, 6 oder 8 gefunden wurde.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-171">Open the hidden message found in Step 4, 6, or 8.</span></span>

<span data-ttu-id="2f5a4-172"><a name="OL15Con_AuxRef_LocatingMsgsUIDLHistory_FindAttachment"> </a></span><span class="sxs-lookup"><span data-stu-id="2f5a4-172"></span></span>

### <a name="find-the-appropriate-attachment-of-the-hidden-message"></a><span data-ttu-id="2f5a4-173">Suchen Sie nach der entsprechenden Anlage der ausgeblendete Nachricht</span><span class="sxs-lookup"><span data-stu-id="2f5a4-173">Find the appropriate attachment of the hidden message</span></span>

<span data-ttu-id="2f5a4-174">Da ausgeblendete Nachricht mehr als eine Anlage möglicherweise, suchen Sie nach der entsprechenden Anlage in der folgenden Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-174">Because the hidden message may have more than one attachment, look for the appropriate attachment in the following order.</span></span>
  
> [!NOTE]
> <span data-ttu-id="2f5a4-175">Dieses Verfahren erneut verwendet die `printf` Ersetzung der Kürze halber formatieren.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-175">This procedure again uses the  `printf` style substitution for brevity.</span></span> 

1. <span data-ttu-id="2f5a4-176">Suchen Sie nach einer Anlage, deren [PidTagAttachLongFilename](http://msdn.microsoft.com/library/83b69e8f-0b5a-4992-b5b8-160d3bdfa22a%28Office.15%29.aspx) (**PR_ATTACH_LONG_FILENAME**) die folgende Zeichenfolge übereinstimmt, in dem `szEmailAddress` SMTP-Adresse des Benutzers, wie im Profil des Benutzers angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-176">Look for an attachment whose [PidTagAttachLongFilename](http://msdn.microsoft.com/library/83b69e8f-0b5a-4992-b5b8-160d3bdfa22a%28Office.15%29.aspx) (**PR_ATTACH_LONG_FILENAME**) matches the following string, where  `szEmailAddress` is the user's SMTP address, as specified in the user's profile.</span></span> <span data-ttu-id="2f5a4-177">.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-177"></span></span> 
    
   ```cpp
    "BlobPOP%s", szEmailAddress
   ```

2. <span data-ttu-id="2f5a4-178">Suchen Sie nach einer Anlage, deren [PidTagAttachFilename](http://msdn.microsoft.com/library/cbf34dd6-7733-47f6-9c41-9d82656ca9dc%28Office.15%29.aspx) (**PR_ATTACH_FILENAME**) entspricht "BlobPOP %s" `szEmailAddress`.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-178">Look for an attachment whose [PidTagAttachFilename](http://msdn.microsoft.com/library/cbf34dd6-7733-47f6-9c41-9d82656ca9dc%28Office.15%29.aspx) (**PR_ATTACH_FILENAME**) matches "BlobPOP%s",  `szEmailAddress`.</span></span>
    
3. <span data-ttu-id="2f5a4-179">Suchen Sie nach einer Anlage, deren [PidTagDisplayName](http://msdn.microsoft.com/library/bd094e00-5c60-4bb3-9a45-b943fab52876%28Office.15%29.aspx) (**PR_DISPLAY_NAME**) entspricht "BlobPOP %s" `szEmailAddress`.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-179">Look for an attachment whose [PidTagDisplayName](http://msdn.microsoft.com/library/bd094e00-5c60-4bb3-9a45-b943fab52876%28Office.15%29.aspx) (**PR_DISPLAY_NAME**) matches "BlobPOP%s",  `szEmailAddress`.</span></span>
    
4. <span data-ttu-id="2f5a4-180">Suchen Sie nach einer Anlage, deren **PidTagAttachFilename** (**PR_ATTACH_FILENAME**) entspricht "Blob%.8x", `dwAcctUID`, wobei `dwAcctUID` [PROP_ACCT_MINI_UID](prop_acct_mini_uid.md)stammt.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-180">Look for an attachment whose **PidTagAttachFilename** (**PR_ATTACH_FILENAME**) matches "Blob%.8x",  `dwAcctUID`, where  `dwAcctUID` comes from [PROP_ACCT_MINI_UID](prop_acct_mini_uid.md).</span></span> <span data-ttu-id="2f5a4-181">Die [IOlkAccount::GetProp](iolkaccount-getprop.md) -Methode können Sie die **PROP_ACCT_MINI_UID** -Eigenschaft zugreifen.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-181">You can use the [IOlkAccount::GetProp](iolkaccount-getprop.md) method to access the **PROP_ACCT_MINI_UID** property.</span></span> 

<span data-ttu-id="2f5a4-182"><a name="OL15Con_AuxRef_LocatingMsgsUIDLHistory_AccessProp"> </a></span><span class="sxs-lookup"><span data-stu-id="2f5a4-182"></span></span>

### <a name="access-the-pidtagattachdatabinary-property-of-the-message-attachment"></a><span data-ttu-id="2f5a4-183">Zugriff auf die PidTagAttachDataBinary-Eigenschaft des e-Mail-Nachrichtenanhang</span><span class="sxs-lookup"><span data-stu-id="2f5a4-183">Access the PidTagAttachDataBinary property of the message attachment</span></span>

<span data-ttu-id="2f5a4-184">Verwenden Sie nach der Suche nach den entsprechenden e-Mail-Nachrichtenanhang der ausgeblendete Nachricht, **IMAPIProp::GetProps** , um die **PidTagAttachDataBinary** -Eigenschaft der Anlage zu lesen.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-184">After locating the appropriate message attachment of the hidden message, use **IMAPIProp::GetProps** to read the **PidTagAttachDataBinary** property of the attachment.</span></span> 

<span data-ttu-id="2f5a4-185"><a name="OL15Con_AuxRef_LocatingMsgsUIDLHistory_NextSteps"> </a></span><span class="sxs-lookup"><span data-stu-id="2f5a4-185"></span></span>

## <a name="next-steps"></a><span data-ttu-id="2f5a4-186">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="2f5a4-186">Next steps</span></span>

<span data-ttu-id="2f5a4-187">Sie haben zum Ermitteln den Nachrichten-Downloadverlauf für den Posteingang von POP3 e-Mail-Client in diesem Thema erfahren.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-187">You have learned from this topic how to locate the message download history for the Inbox of a POP3 mail client.</span></span> <span data-ttu-id="2f5a4-188">Finden Sie unter [analysieren den Nachrichten-Downloadverlauf für ein POP3-Konto](parsing-the-message-download-history-for-a-pop3-account.md) , um Informationen zum Analysieren der Verlauf, um Nachrichten zu ermitteln, die heruntergeladen oder für den Posteingang gelöscht wurden.</span><span class="sxs-lookup"><span data-stu-id="2f5a4-188">See [Parsing the message download history for a POP3 account](parsing-the-message-download-history-for-a-pop3-account.md) to learn how to parse this history to identify messages that have been downloaded or deleted for the Inbox.</span></span> 

<span data-ttu-id="2f5a4-189"><a name="OL15Con_AuxRef_LocatingMsgsUIDLHistory_AdditionalRsc"> </a></span><span class="sxs-lookup"><span data-stu-id="2f5a4-189"></span></span>

## <a name="see-also"></a><span data-ttu-id="2f5a4-190">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="2f5a4-190">See also</span></span>

- [<span data-ttu-id="2f5a4-191">Verwalten von Nachricht downloads für POP3-Konten</span><span class="sxs-lookup"><span data-stu-id="2f5a4-191">Managing message downloads for POP3 accounts</span></span>](managing-message-downloads-for-pop3-accounts.md)   
- [<span data-ttu-id="2f5a4-192">Analysieren den Nachrichten-Downloadverlauf für ein POP3-Konto</span><span class="sxs-lookup"><span data-stu-id="2f5a4-192">Parsing the message download history for a POP3 account</span></span>](parsing-the-message-download-history-for-a-pop3-account.md)
- [<span data-ttu-id="2f5a4-193">Suchen den POP3 UIDL-Verlauf</span><span class="sxs-lookup"><span data-stu-id="2f5a4-193">Locating the POP3 UIDL History</span></span>](http://blogs.msdn.com/b/stephen_griffin/archive/2012/12/03/locating-the-pop3-uidl-history.aspx)
    

