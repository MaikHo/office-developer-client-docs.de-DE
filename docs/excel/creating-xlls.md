---
title: Erstellen von XLLs
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
keywords:
- DLLs [Excel 2007], Aufrufen in Excel,xlAutoFree-Funktion [Excel 2007],xlAutoFree12-Funktion [Excel 2007],xlcall32.lib [Excel 2007],xlAutoRegister-Funktion [Excel 2007],xlcall.cpp [Excel 2007],xlAutoRemove-Funktion [Excel 2007],xlAddInManagerInfo-Funktion [Excel 2007],xlAutoAdd-Funktion [Excel 2007],xlAutoOpen-Funktion [Excel 2007],xlAutoClose-Funktion [Excel 2007],DLLs [Excel 2007], Umwandeln in XLLs,XLLs [Excel 2007], Aufrufen in Excel,xlAutoRegister12-Funktion [Excel 2007],xlcall.h [Excel 2007],xlAddInManagerInfo12-Funktion [Excel 2007]
ms.assetid: 7754998f-4e13-4a37-9724-43b6ee6c919b
description: 'Gilt für: Excel 2013 | Office 2013 | Visual Studio'
localization_priority: Priority
ms.openlocfilehash: 886b8e74f00f2e724785d43475ee0ffa3c922710
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32304144"
---
# <a name="creating-xlls"></a><span data-ttu-id="bd068-104">Erstellen von XLLs</span><span class="sxs-lookup"><span data-stu-id="bd068-104">Creating XLLs</span></span>

<span data-ttu-id="bd068-105">**Gilt für**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="bd068-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="bd068-106">Wenn Ihre DLL eigenständig ist oder sich nur auf andere Bibliotheken stützt, müssen Sie wissen, wie Sie Microsoft Excel aktivieren, um Zugriff auf die zugehörigen Funktionen und Befehle zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="bd068-106">If your DLL is self-contained or relies only on other libraries, you must know how to enable Microsoft Excel to access its functions and commands.</span></span> <span data-ttu-id="bd068-107">Weitere Informationen finden Sie unter [Zugreifen auf DLLs in Excel](how-to-access-dlls-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="bd068-107">For more information, see [Access DLLs in Excel](how-to-access-dlls-in-excel.md).</span></span> 
  
<span data-ttu-id="bd068-108">Wenn Ihre DLL jedoch auf die Excel-Funktionalität zugreifen muss (z. B. um den Inhalt einer Zelle abzurufen, eine Arbeitsblattfunktion aufzurufen oder Excel nach Informationen zum Arbeitsbereich abzufragen), muss Ihr Code einen Rückruf in Excel vornehmen können.</span><span class="sxs-lookup"><span data-stu-id="bd068-108">However, if your DLL needs to access Excel functionality (for example, to get the contents of a cell, to call a worksheet function, or to interrogate Excel to obtain workspace information), your code must be able to call back into Excel.</span></span>
  
<span data-ttu-id="bd068-109">Die C-API von Excel bietet mehrere Funktionen, mit denen DLLs einen Rückruf in Excel vornehmen können.</span><span class="sxs-lookup"><span data-stu-id="bd068-109">The Excel C API provides several functions that enable DLLs to call back into Excel.</span></span> <span data-ttu-id="bd068-110">Damit die DLL auf diese Funktionen zugreifen kann, muss sie zur Kompilierzeit statisch mit der 32-Bit-Bibliothek von Excel (xlcall32.lib) verknüpft werden.</span><span class="sxs-lookup"><span data-stu-id="bd068-110">To access these, the DLL must be linked statically at compile time with the Excel 32-bit library, xlcall32.lib.</span></span> <span data-ttu-id="bd068-111">Die statische Bibliothek kann von Microsoft als Teil des Microsoft Excel 2013 XLL SDKs heruntergeladen werden, das sowohl die 32-Bit- als auch die 64-Bit-Version dieser Bibliothek enthält.</span><span class="sxs-lookup"><span data-stu-id="bd068-111">The static library is downloadable from Microsoft as part of the Microsoft Excel 2013 XLL SDK, which includes both 32-bit and 64-bit versions of this library.</span></span>
  
## <a name="enabling-dlls-to-call-back-into-excel"></a><span data-ttu-id="bd068-112">Aktivieren von DLLs für den Rückruf in Excel</span><span class="sxs-lookup"><span data-stu-id="bd068-112">Enabling DLLs to Call Back into Excel</span></span>

<span data-ttu-id="bd068-113">Damit eine DLL auf die Funktionen in Excel zugreifen und Arbeitsbereichsinformationen abrufen oder festlegen kann, muss sie zunächst die Adressen der Excel-Rückruffunktionen **Excel4**, **Excel4v**, **Excel12** und **Excel12v** abrufen.</span><span class="sxs-lookup"><span data-stu-id="bd068-113">For a DLL to be able to access the functionality in Excel and get or set workspace information, it must first obtain the addresses of the Excel callback functions **Excel4**, **Excel4v**, **Excel12**, and **Excel12v**.</span></span> <span data-ttu-id="bd068-114">Die beiden letzten Funktionen wurden in Excel 2007 eingeführt und sind in nachfolgenden Versionen verfügbar.</span><span class="sxs-lookup"><span data-stu-id="bd068-114">The last two were introduced in Excel 2007 and are available in subsequent versions.</span></span> <span data-ttu-id="bd068-115">Um auf all diese Funktionen zuzugreifen, muss das DLL-Projekt Verweise auf die folgenden Dateien aus dem Excel 2013 XLL SDK enthalten.</span><span class="sxs-lookup"><span data-stu-id="bd068-115">To access all of these, the DLL project must include references to the following files from the Excel 2013 XLL SDK.</span></span> <span data-ttu-id="bd068-116">Wenn Sie nur auf die beiden ersten Rückruffunktionen (in jeder Excel-Version enthalten) zugreifen möchten, muss Ihr Projekt nur die beiden ersten Dateien enthalten.</span><span class="sxs-lookup"><span data-stu-id="bd068-116">If you want to access only the first two callbacks (in any version of Excel), your project needs to include only the first two files.</span></span>
  
### <a name="xlcallh"></a><span data-ttu-id="bd068-117">Xlcall.h</span><span class="sxs-lookup"><span data-stu-id="bd068-117">Xlcall.h</span></span>

<span data-ttu-id="bd068-118">Die Datei "Xlcall.h" enthält die folgenden Elemente:</span><span class="sxs-lookup"><span data-stu-id="bd068-118">The Xlcall.h file contains the following items:</span></span>
  
- <span data-ttu-id="bd068-119">Funktionsprototypen für alle Rückruffunktionen.</span><span class="sxs-lookup"><span data-stu-id="bd068-119">Function prototypes for all callback functions.</span></span>
    
- <span data-ttu-id="bd068-120">Definitionen der Datenstrukturen, welche die Rückruffunktionen für den Austausch von Daten zwischen DLL/XLL und Excel verwenden, und Definitionen von Datentypkonstanten.</span><span class="sxs-lookup"><span data-stu-id="bd068-120">Definitions of the data structures that the callbacks use to exchange data between the DLL/XLL and Excel, and data-type constant definitions.</span></span>
    
- <span data-ttu-id="bd068-121">Definitionen der C-API-Funktion und Befehlsentsprechungen für Arbeitsblatt, Makroblattfunktionen und unterstützte Excel-Befehle.</span><span class="sxs-lookup"><span data-stu-id="bd068-121">Definitions of the C API function and command equivalents of the worksheet, macro sheet functions, and supported Excel commands.</span></span>
    
- <span data-ttu-id="bd068-122">Definitionen der Rückgabewerte der Rückruffunktion.</span><span class="sxs-lookup"><span data-stu-id="bd068-122">Definitions of callback function return values.</span></span>
    
<span data-ttu-id="bd068-123">Sie sollten für diese Datei die Direktive **#include** (direkt oder indirekt über eine andere Headerdatei) in allen Dateien verwenden, die auf die C-API zugreifen oder die Datentypen verarbeiten, die von der C-API verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="bd068-123">You should use the **#include** directive for this file, directly or indirectly via another header file, in all files that access the C API or that handle data types that the C API uses.</span></span> 
  
### <a name="xlcall32lib"></a><span data-ttu-id="bd068-124">Xlcall32.lib</span><span class="sxs-lookup"><span data-stu-id="bd068-124">Xlcall32.lib</span></span>

<span data-ttu-id="bd068-125">Die Bibliothek "Xlcall32.lib" exportiert die beiden ersten Rückruffunktionen **Excel4** und **Excel4v** sowie die **XlCallVer**-Funktion.</span><span class="sxs-lookup"><span data-stu-id="bd068-125">The Xlcall32.lib library exports the first two callbacks, **Excel4** and **Excel4v**, and also the **XlCallVer** function.</span></span> <span data-ttu-id="bd068-126">Ohne einen Verweis auf diese Bibliothek in Ihrem Projekt kann der Linker die XLL nicht erstellen, wenn Sie einen dieser Rückrufe in Ihrem Code verwendet haben.</span><span class="sxs-lookup"><span data-stu-id="bd068-126">Without a reference to this library in your project, the linker cannot create the XLL if you have used any of these callbacks in your code.</span></span> <span data-ttu-id="bd068-127">(Die Adressen dieser Funktionen können Sie durch eine dynamische Verknüpfung mit der entsprechenden Xlcall32.dll beziehen, die im Rahmen einer normalen Excel-Installation auf Ihr System kopiert wird.)</span><span class="sxs-lookup"><span data-stu-id="bd068-127">(You can obtain the addresses of these functions by linking dynamically to the equivalent Xlcall32.dll that is copied to your system as part of a normal Excel installation.)</span></span> 
  
### <a name="xlcallcpp"></a><span data-ttu-id="bd068-128">Xlcall.cpp</span><span class="sxs-lookup"><span data-stu-id="bd068-128">Xlcall.cpp</span></span>

<span data-ttu-id="bd068-129">Die Excel-Rückruffunktionen **Excel12** und **Excel12v** werden nicht in Xlcall32.lib exportiert.</span><span class="sxs-lookup"><span data-stu-id="bd068-129">The Excel callbacks **Excel12** and **Excel12v** are not exported in Xlcall32.lib.</span></span> <span data-ttu-id="bd068-130">Dadurch wird sichergestellt, dass XLL-Projekte, die Sie ab Excel 2007 erstellen, auch mit früheren Excel-Versionen funktionieren.</span><span class="sxs-lookup"><span data-stu-id="bd068-130">This ensures that XLL projects that you create starting in Excel 2007 will also work with earlier versions of Excel.</span></span> <span data-ttu-id="bd068-131">Das Modul "Xlcall.cpp" enthält Code für die Funktionen **Excel12** und **Excel12v**, die ab Excel 2007 einen Excel-Einstiegspunkt aufrufen oder den Wert "safe error" (sicherer Fehler) zurückgeben, wenn Sie eine frühere Version von Excel ausführen.</span><span class="sxs-lookup"><span data-stu-id="bd068-131">The Xlcall.cpp module contains code for the **Excel12** and **Excel12v** functions, which call into an Excel entry point starting in Excel 2007, or return a safe error value if you are running an earlier version of Excel.</span></span> <span data-ttu-id="bd068-132">Sie sollten dieses Modul in Ihr Projekt einbeziehen, wenn Sie eine XLL erstellen möchten, die in Excel 2007 oder höher ausgeführt werden und in der Lage sein soll, die neuen Datentypen zu verwenden, die größere Raster und längere Unicode-Zeichenfolgen verarbeiten können.</span><span class="sxs-lookup"><span data-stu-id="bd068-132">You should include this module in your project if you want to create an XLL that runs starting in Excel 2007 and that is able to use the new data types that handle larger grids and longer Unicode strings.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="bd068-133">Ab dem Excel 2010 SDK kann diese Datei sowohl für 32-Bit- als auch 64-Bit-XLLs kompiliert werden.</span><span class="sxs-lookup"><span data-stu-id="bd068-133">Starting with the Excel 2010 SDK, this file can be compiled for both 32-bit and 64-bit XLLs.</span></span> 
  
## <a name="turning-dlls-into-xlls-add-in-manager-interface-functions"></a><span data-ttu-id="bd068-134">Umwandeln von DLLs in XLLs: Add-In-Manager und Schnittstellenfunktionen</span><span class="sxs-lookup"><span data-stu-id="bd068-134">Turning DLLs into XLLs: Add-in Manager Interface Functions</span></span>

<span data-ttu-id="bd068-135">Eine XLL ist eine DLL, die mehrere Prozeduren exportiert, die von Excel oder dem Add-In-Manager von Excel aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="bd068-135">An XLL is a DLL that exports several procedures that are called by Excel or the Excel Add-in Manager.</span></span> <span data-ttu-id="bd068-136">Diese Prozeduren sind hier kurz beschrieben und werden ausführlich unter [Add-In-Manager und XLL-Schnittstellenfunktionen](add-in-manager-and-xll-interface-functions.md) behandelt.</span><span class="sxs-lookup"><span data-stu-id="bd068-136">These procedures are described briefly here and discussed in detail in [Add-in Manager and XLL Interface Functions](add-in-manager-and-xll-interface-functions.md).</span></span> <span data-ttu-id="bd068-137">All diese DLL-Rückrufe beginnen mit dem Präfix **xlAuto**.</span><span class="sxs-lookup"><span data-stu-id="bd068-137">All of these DLL callbacks start with the prefix **xlAuto**.</span></span> <span data-ttu-id="bd068-138">Nur einer der Rückrufe, der Befehl **xlAutoOpen**, ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="bd068-138">Only one of these, the command **xlAutoOpen**, is required.</span></span> <span data-ttu-id="bd068-139">Er wird beim Aktivieren des Add-Ins aufgerufen und wird in der Regel zum Registrieren von XLL-Funktionen und -Befehlen mit Excel und für andere Initialisierungsaufgaben verwendet.</span><span class="sxs-lookup"><span data-stu-id="bd068-139">It is called when the add-in is activated, and it is typically used to register XLL functions and commands with Excel and to do other initialization tasks.</span></span> <span data-ttu-id="bd068-140">Die Funktionssignaturen und Beispielimplementierungen aller **xlAuto**-Funktionen finden Sie in den nachfolgenden Abschnitten.</span><span class="sxs-lookup"><span data-stu-id="bd068-140">The function signatures and example implementations of all of the **xlAuto** functions are provided in later sections.</span></span> 
  
<span data-ttu-id="bd068-141">Obwohl nur **xlAutoOpen** als Rückruffunktion erforderlich ist, muss das Add-In möglicherweise auch andere Funktionen exportieren. Das hängt vom Verhalten des Add-Ins ab.</span><span class="sxs-lookup"><span data-stu-id="bd068-141">Even though **xlAutoOpen** is the only required one of these callbacks, your add-in may also need to export others depending on its behavior.</span></span> 
  
<span data-ttu-id="bd068-142">In Excel 2007 wurde der neue Datentyp **XLOPER12** eingeführt, um größere Raster und lange Unicode-Zeichenfolgen zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="bd068-142">Excel 2007 introduced a new data type, **XLOPER12**, to accommodate larger grids and to support long Unicode strings.</span></span> <span data-ttu-id="bd068-143">**XLOPER12** wird weiter unten in diesem Thema beschrieben.</span><span class="sxs-lookup"><span data-stu-id="bd068-143">**XLOPER12** is described later in this topic.</span></span> <span data-ttu-id="bd068-144">Während **xlAuto**-Funktionen den alten Datentyp **XLOPER** übernehmen oder zurückgeben, wurden in Excel 2007 neue Versionen dieser Funktionen eingeführt, welche die Datentypen **XLOPER12** verwenden.</span><span class="sxs-lookup"><span data-stu-id="bd068-144">Whereas **xlAuto** functions take or return the old data type **XLOPER**, new versions of these functions were introduced in Excel 2007 that use **XLOPER12** data types.</span></span> <span data-ttu-id="bd068-145">Mit Ausnahme der **xlAutoFree12**-Funktion, die Sie manchmal zur Vermeidung von **XLOPER12**-Speicherverlusten implementieren müssen, können Sie bedenkenlos auf alle **xlAuto**-Funktionen der Version 12 verzichten. In diesem Fall ruft Excel (ab Excel 2007) die **XLOPER**-Versionen auf.</span><span class="sxs-lookup"><span data-stu-id="bd068-145">With the exception of **xlAutoFree12**, which you must sometimes implement to avoid **XLOPER12** memory leaks, you can safely omit all the version 12 **xlAuto** functions, in which case, starting in Excel 2007, Excel calls the **XLOPER** versions.</span></span> 
  
### <a name="xlautoopen"></a><span data-ttu-id="bd068-146">xlAutoOpen</span><span class="sxs-lookup"><span data-stu-id="bd068-146">xlAutoOpen</span></span>

<span data-ttu-id="bd068-147">Excel ruft jedes Mal, wenn die XLL aktiviert wird, die [xlAutoOpen](xlautoopen.md)-Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="bd068-147">Excel calls the [xlAutoOpen](xlautoopen.md) function whenever the XLL is activated.</span></span> <span data-ttu-id="bd068-148">Das Add-In wird zu Beginn einer Excel-Sitzung aktiviert, wenn es in der letzten Excel-Sitzung, die ordnungsgemäß beendet wurde, aktiv war.</span><span class="sxs-lookup"><span data-stu-id="bd068-148">The add-in will be activated at the start of an Excel session if it was active in the last Excel session that ended normally.</span></span> <span data-ttu-id="bd068-149">Das Add-In wird aktiviert, wenn es während einer Excel-Sitzung geladen werden.</span><span class="sxs-lookup"><span data-stu-id="bd068-149">The add-in is activated if it is loaded during an Excel session.</span></span> <span data-ttu-id="bd068-150">Das Add-In kann während einer Excel-Sitzung deaktiviert und erneut aktiviert werden. Bei der erneuten Aktivierung wird die Funktion aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="bd068-150">The add-in can be deactivated and reactivated during an Excel session, and the function is called on reactivation.</span></span> 
  
<span data-ttu-id="bd068-151">Verwenden Sie **xlAutoOpen**, um XLL-Funktionen und -Befehle zu registrieren, Datenstrukturen zu initialisieren, die Benutzeroberfläche anzupassen usw.</span><span class="sxs-lookup"><span data-stu-id="bd068-151">You should use **xlAutoOpen** to register XLL functions and commands, initialize data structures, customize the user interface, and so on.</span></span> 
  
<span data-ttu-id="bd068-152">Wenn das Add-In die [xlAutoRegister](xlautoregister-xlautoregister12.md)-Funktion oder die [xlAutoRegister12](xlautoregister-xlautoregister12.md)-Funktion implementiert und exportiert, versucht Excel möglicherweise, eine Funktion oder einen Befehl zu aktivieren und zu registrieren, ohne zuerst die **xlAutoOpen**-Funktion aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="bd068-152">If your add-in implements and exports the [xlAutoRegister](xlautoregister-xlautoregister12.md) function or the [xlAutoRegister12](xlautoregister-xlautoregister12.md) function, Excel might attempt to activate and register a function or command without first calling the **xlAutoOpen** function.</span></span> <span data-ttu-id="bd068-153">In diesem Fall müssen Sie sicherstellen, dass das Add-In für die Funktion oder den Befehl ausreichend initialisiert ist, damit es ordnungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="bd068-153">In this case, you should ensure that your add-in is sufficiently initialized for your function or command to work properly.</span></span> <span data-ttu-id="bd068-154">Wenn das nicht zutrifft, sollten Sie entweder den Versuch, die Funktion oder den Befehl zu registrieren, abbrechen oder die erforderliche Initialisierung ausführen.</span><span class="sxs-lookup"><span data-stu-id="bd068-154">If it is not, you should either fail the attempt to register the function or command, or carry out the necessary initialization.</span></span> 
  
### <a name="xlautoclose"></a><span data-ttu-id="bd068-155">xlAutoClose</span><span class="sxs-lookup"><span data-stu-id="bd068-155">xlAutoClose</span></span>

<span data-ttu-id="bd068-156">Excel ruft jedes Mal, wenn die XLL deaktiviert wird, die [xlAutoClose](xlautoclose.md)-Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="bd068-156">Excel calls the [xlAutoClose](xlautoclose.md) function whenever the XLL is deactivated.</span></span> <span data-ttu-id="bd068-157">Das Add-in wird deaktiviert, wenn eine Excel-Sitzung ordnungsgemäß beendet wird.</span><span class="sxs-lookup"><span data-stu-id="bd068-157">The add-in will be deactivated when an Excel session ends normally.</span></span> <span data-ttu-id="bd068-158">Wenn der Benutzer während einer Excel-Sitzung das Add-In deaktiviert, wird die Funktion aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="bd068-158">If the user deactivates the add-in during an Excel session, the function is called.</span></span> 
  
<span data-ttu-id="bd068-159">Verwenden Sie **xlAutoClose**, um die Registrierung von Funktionen und Befehlen aufzuheben, Ressourcen freizugeben, Anpassungen rückgängig zu machen usw.</span><span class="sxs-lookup"><span data-stu-id="bd068-159">You should use **xlAutoClose** to unregister functions and commands, release resources, undo customizations, and so on.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="bd068-160">Bei der Aufhebung der Registrierung von Funktionen und Befehlen gibt es ein bekanntes Problem.</span><span class="sxs-lookup"><span data-stu-id="bd068-160">There is a known issue with the unregistration of functions and commands.</span></span> <span data-ttu-id="bd068-161">Weitere Informationen finden Sie unter [Bekannte Probleme bei der Excel-XLL-Entwicklung](known-issues-in-excel-xll-development.md).</span><span class="sxs-lookup"><span data-stu-id="bd068-161">For more information, see [Known Issues in Excel XLL Development](known-issues-in-excel-xll-development.md).</span></span> 
  
### <a name="xlautoadd"></a><span data-ttu-id="bd068-162">xlAutoAdd</span><span class="sxs-lookup"><span data-stu-id="bd068-162">xlAutoAdd</span></span>

<span data-ttu-id="bd068-163">Excel ruft jedes Mal, wenn der Benutzer während einer Excel-Sitzung die XLL mithilfe des Add-In-Managers aktiviert, die [xlAutoAdd](xlautoadd.md)-Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="bd068-163">Excel calls the [xlAutoAdd function](xlautoadd.md) whenever the user activates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="bd068-164">Diese Funktion wird nicht aufgerufen, wenn Excel startet und ein vorinstalliertes Add-In lädt.</span><span class="sxs-lookup"><span data-stu-id="bd068-164">This function is not called when Excel starts and loads a preinstalled add-in.</span></span> 
  
<span data-ttu-id="bd068-165">Sie können diese Funktion verwenden, um ein benutzerdefiniertes Dialogfeld anzuzeigen, das dem Benutzer mitteilt, dass das Add-In zum Lesen oder Schreiben in der Registrierung oder zum Überprüfen von Lizenzinformationen aktiviert wurde.</span><span class="sxs-lookup"><span data-stu-id="bd068-165">You can use this function to display a custom dialog box that tells the user that the add-in has been activated, to read from or write to the registry, or to check licensing information.</span></span>
  
### <a name="xlautoremove"></a><span data-ttu-id="bd068-166">xlAutoRemove</span><span class="sxs-lookup"><span data-stu-id="bd068-166">xlAutoRemove</span></span>

<span data-ttu-id="bd068-167">Excel ruft jedes Mal, wenn der Benutzer während einer Excel-Sitzung die XLL mithilfe des Add-In-Managers deaktiviert, die [xlAutoRemove](xlautoremove.md)-Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="bd068-167">Excel calls the [xlAutoRemove](xlautoremove.md) function whenever the user deactivates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="bd068-168">Diese Funktion wird nicht aufgerufen, wenn eine Excel-Sitzung mit dem installierten Add-In (ordnungsgemäß oder unerwartet) beendet wird.</span><span class="sxs-lookup"><span data-stu-id="bd068-168">This function is not called when an Excel session closes, normally or abnormally, with the add-in installed.</span></span> 
  
<span data-ttu-id="bd068-169">Sie können diese Funktion verwenden, um ein benutzerdefiniertes Dialogfeld anzuzeigen, das dem Benutzer mitteilt, dass das Add-In zum Lesen oder Schreiben in der Registrierung deaktiviert wurde.</span><span class="sxs-lookup"><span data-stu-id="bd068-169">You can use this function to display a custom dialog box that tells the user that the add-in has been deactivated, or to read from or write to the registry.</span></span>
  
### <a name="xladdinmanagerinfoxladdinmanagerinfo12"></a><span data-ttu-id="bd068-170">xlAddInManagerInfo/xlAddInManagerInfo12</span><span class="sxs-lookup"><span data-stu-id="bd068-170">xlAddInManagerInfo/xlAddInManagerInfo12</span></span>

<span data-ttu-id="bd068-171">Excel ruft die [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md)-Funktion auf, wenn der Add-In-Manager zum ersten Mal in einer Excel-Sitzung aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="bd068-171">Excel calls the [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) function when the Add-in Manager is invoked for the first time in an Excel session.</span></span> <span data-ttu-id="bd068-172">Wenn Excel ein Argument gleich 1 übergibt, sollte diese Funktion eine Zeichenfolge (in der Regel der Name des Add-Ins) zurückgeben. Andernfalls sollte **#VALUE!** zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="bd068-172">If Excel passes an argument equal to 1, this function should return a string (typically, the name of the add-in); otherwise, it should return **#VALUE!**.</span></span>
  
<span data-ttu-id="bd068-173">Ab Excel 2007 ruft Excel bevorzugt die **xlAddInManagerInfo12**-Funktion statt der **xlAddInManagerInfo**-Funktion auf, wenn sie von der XLL exportiert wird.</span><span class="sxs-lookup"><span data-stu-id="bd068-173">Starting in Excel 2007, Excel calls the **xlAddInManagerInfo12** function in preference to the **xlAddInManagerInfo** function if it is exported by the XLL.</span></span> <span data-ttu-id="bd068-174">Die **xlAddInManagerInfo12**-Funktion sollte auf die gleiche Weise funktionieren wie die **xlAddInManagerInfo**-Funktion, um versionsspezifische Unterschiede im Verhalten der XLL zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="bd068-174">The **xlAddInManagerInfo12** function should work in the same way as the **xlAddInManagerInfo** function to avoid version-specific differences in the behavior of the XLL.</span></span> <span data-ttu-id="bd068-175">Die **xlAddInManagerInfo12**-Funktion sollte den Datentyp **XLOPER12** zurückgeben, während die **xlAddInManagerInfo**-Funktion den Datentyp \*\*XLOPER \*\* zurückgeben sollte.</span><span class="sxs-lookup"><span data-stu-id="bd068-175">The **xlAddInManagerInfo12** function should return an **XLOPER12** data type, whereas the **xlAddInManagerInfo** function should return an **XLOPER** data type.</span></span> 
  
### <a name="xlautoregisterxlautoregister12"></a><span data-ttu-id="bd068-176">xlAutoRegister/xlAutoRegister12</span><span class="sxs-lookup"><span data-stu-id="bd068-176">xlAutoRegister/xlAutoRegister12</span></span>

<span data-ttu-id="bd068-177">Excel ruft jedes Mal, wenn ein Aufruf der XLM-Funktion **REGISTER** oder der entsprechenden C-API-Funktion [xlfRegister](xlfregister-form-1.md) erfolgt, die [xlAutoRegister](xlautoregister-xlautoregister12.md)-Funktion auf, wobei der zu registrierenden Funktion Rückgabe- und Argumenttypen fehlen.</span><span class="sxs-lookup"><span data-stu-id="bd068-177">Excel calls the [xlAutoRegister](xlautoregister-xlautoregister12.md) function whenever a call has been made to the XLM function **REGISTER**, or the C API equivalent [xlfRegister](xlfregister-form-1.md) function, with the return and argument types missing for the function being registered.</span></span> <span data-ttu-id="bd068-178">Die **xlAutoRegister**-Funktion ermöglicht der XLL, die internen Listen mit exportierten Funktionen und Befehlen zu durchsuchen, um die Funktion mit dem Argument zu registrieren und die angegebenen Typen zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="bd068-178">The **xlAutoRegister** function allows the XLL to search its internal lists of exported functions and commands to register the function with the argument and return the specified types.</span></span> 
  
<span data-ttu-id="bd068-179">Ab Excel 2007 ruft Excel bevorzugt die **xlAddInRegister12**-Funktion statt der **xlAddInRegister**-Funktion auf, wenn sie von der XLL exportiert wird.</span><span class="sxs-lookup"><span data-stu-id="bd068-179">Starting in Excel 2007, Excel calls the **xlAddInRegister12** function in preference to the **xlAddInRegister** function if it is exported by the XLL.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="bd068-180">Wenn **xlAddInRegister**/ **xlAddInRegister12** versucht, die Funktion zu registrieren, ohne Argument und Rückgabetypen bereitzustellen, tritt eine rekursive Aufrufschleife und in der Folge ein Aufruflistenüberlauf auf, der dazu führt, dass Excel beendet wird oder nicht mehr reagiert.</span><span class="sxs-lookup"><span data-stu-id="bd068-180">If **xlAddInRegister**/ **xlAddInRegister12** tries to register the function without supplying the argument and return types, a recursive calling loop occurs that eventually overflows the call stack and causes Excel to close or stop responding.</span></span> 
  
### <a name="xlautofreexlautofree12"></a><span data-ttu-id="bd068-181">xlAutoFree/xlAutoFree12</span><span class="sxs-lookup"><span data-stu-id="bd068-181">xlAutoFree/xlAutoFree12</span></span>

<span data-ttu-id="bd068-182">Excel ruft die [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md)-Funktion auf, sobald eine XLL-Arbeitsblattfunktion den Datentyp **XLOPER**/ **XLOPER12** zurückgibt, und zwar mit einem Flag zur Information von Excel, dass Speicher vorhanden ist, den die XLL noch freigeben muss.</span><span class="sxs-lookup"><span data-stu-id="bd068-182">Excel calls the [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) function just after an XLL worksheet function returns an **XLOPER**/ **XLOPER12** data type with a flag set that tells Excel there is memory that the XLL still needs to release.</span></span> <span data-ttu-id="bd068-183">Dadurch kann die XLL dynamisch zugewiesene Arrays, Zeichenfolgen und externe Verweise auf das Arbeitsblatt ohne Speicherverluste zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="bd068-183">This enables the XLL to return dynamically allocated arrays, strings, and external references to the worksheet without memory leaks.</span></span> <span data-ttu-id="bd068-184">Ab Excel 2007 wird der Datentyp **XLOPER12** unterstützt.</span><span class="sxs-lookup"><span data-stu-id="bd068-184">Starting in Excel 2007, the **XLOPER12** data type is supported.</span></span> <span data-ttu-id="bd068-185">Weitere Informationen finden Sie unter [Speicherverwaltung in Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="bd068-185">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="bd068-186">Ab Excel 2007 wird bei einer Konfiguration von Excel für die Verwendung der Multithread-Neuberechnung eines Arbeitsblatts die **xlAutoFree**/ **xlAutoFree12**-Funktion im selben Thread aufgerufen, der gerade zum Aufrufen der Funktion verwendet wurde, die ihn zurückgegeben hat.</span><span class="sxs-lookup"><span data-stu-id="bd068-186">Starting in Excel 2007, when Excel is configured to use multithreaded worksheet recalculation, the **xlAutoFree**/ **xlAutoFree12** function is called on the same thread that was just used to call the function that returned it.</span></span> <span data-ttu-id="bd068-187">Der Aufruf von **xlAutoFree**/ **xlAutoFree12** erfolgt immer vor der Auswertung aller nachfolgenden Arbeitsblattzellen in diesem Thread.</span><span class="sxs-lookup"><span data-stu-id="bd068-187">The call to **xlAutoFree**/ **xlAutoFree12** is always made before any subsequent worksheet cells are evaluated on that thread.</span></span> <span data-ttu-id="bd068-188">Dies vereinfacht das threadsichere Design in Ihrer XLL.</span><span class="sxs-lookup"><span data-stu-id="bd068-188">This simplifies thread-safe design in your XLL.</span></span> <span data-ttu-id="bd068-189">Weitere Informationen finden Sie unter [Multithread-Neuberechnung in Excel](multithreaded-recalculation-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="bd068-189">For more information, see [Multithreaded Recalculation in Excel](multithreaded-recalculation-in-excel.md).</span></span> 
  
### <a name="creating-64-bit-xlls"></a><span data-ttu-id="bd068-190">Erstellen von 64-Bit-XLLs</span><span class="sxs-lookup"><span data-stu-id="bd068-190">Creating 64-bit XLLs</span></span>

<span data-ttu-id="bd068-191">Excel und benutzerdefinierte Funktionen können auf 64-Bit-Betriebssystemen ausgeführt werden, um die Leistungsvorteile gegenüber 32-Bit-Betriebssystemen zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="bd068-191">Excel and user-defined functions can run on 64-bit operating systems to take advantage of performance benefits over 32-bit operating systems.</span></span> <span data-ttu-id="bd068-192">Excel übergibt Werte in **XLOPER12**-Strukturen, die Informationen zu den Typen für die Daten enthalten.</span><span class="sxs-lookup"><span data-stu-id="bd068-192">Excel passes values in **XLOPER12** structures that include information about the types for the data.</span></span> <span data-ttu-id="bd068-193">Gehen Sie beim Konvertieren von Werten zwischen der **XLOPER12**-Struktur und nativen Typen wie **int** oder Zeigern mit Bedacht vor, um die Werte im größeren Typ beizubehalten.</span><span class="sxs-lookup"><span data-stu-id="bd068-193">Be careful when you convert between values in the **XLOPER12** structure and native types like **int** or pointers to preserve the values in the larger type.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="bd068-194">Weitere Artikel</span><span class="sxs-lookup"><span data-stu-id="bd068-194">See also</span></span>



[<span data-ttu-id="bd068-195">Aufrufen von XLL-Funktionen aus dem Funktionsassistenten oder Ersetzen von Dialogfeldern</span><span class="sxs-lookup"><span data-stu-id="bd068-195">Call XLL Functions from the Function Wizard or Replace Dialog Boxes</span></span>](how-to-call-xll-functions-from-the-function-wizard-or-replace-dialog-boxes.md)
  
[<span data-ttu-id="bd068-196">Add-In-Manager und XLL-Schnittstellenfunktionen</span><span class="sxs-lookup"><span data-stu-id="bd068-196">Add-in Manager and XLL Interface Functions</span></span>](add-in-manager-and-xll-interface-functions.md)
  
[<span data-ttu-id="bd068-197">Entwickeln von XLLs für Excel</span><span class="sxs-lookup"><span data-stu-id="bd068-197">Developing Excel XLLs</span></span>](developing-excel-xlls.md)

