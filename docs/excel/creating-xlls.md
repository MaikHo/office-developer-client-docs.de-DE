---
title: Erstellen von XLLs
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
keywords:
- DLLs [excel 2007], Excel, XlAutoFree-Funktion [Excel 2007], xlAutoFree12-Funktion [Excel 2007],xlcall32.lib [Excel 2007], [Excel 2007],xlcall.cpp [Excel 2007], XlAutoRemove-Funktion [Excel 2007], XlAddInManagerInfo XlAutoRegister-Funktion aufruft Funktion [Excel 2007], XlAutoAdd-Funktion [Excel 2007], XlAutoOpen-Funktion [Excel 2007], XlAutoClose-Funktion [Excel 2007], DLLs [Excel 2007], Umwandeln in XLLs XLLs [Excel 2007], Excel, xlAutoRegister12-Funktion [Excel 2007],xlcall.h [Excel aufrufen 2007], xlAddInManagerInfo12-Funktion [Excel 2007]
localization_priority: Normal
ms.assetid: 7754998f-4e13-4a37-9724-43b6ee6c919b
description: 'Gilt f�r: Excel 2013�| Office 2013�| Visual Studio'
ms.openlocfilehash: de347d34768c25adf0d96642b4fade781ae26a9c
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2018
ms.locfileid: "19790404"
---
# <a name="creating-xlls"></a><span data-ttu-id="a183f-104">Erstellen von XLLs</span><span class="sxs-lookup"><span data-stu-id="a183f-104">Creating XLLs</span></span>

<span data-ttu-id="a183f-105">**Gilt für**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="a183f-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="a183f-106">Wenn die DLL eigenständig ist oder stützt sich nur auf andere Bibliotheken, müssen Sie zum Aktivieren von Microsoft Excel Zugriff auf seine Funktionen und Befehle kennen.</span><span class="sxs-lookup"><span data-stu-id="a183f-106">If your DLL is self-contained or relies only on other libraries, you must know how to enable Microsoft Excel to access its functions and commands.</span></span> <span data-ttu-id="a183f-107">Weitere Informationen finden Sie unter [Zugriff auf DLLs in Excel](how-to-access-dlls-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="a183f-107">For more information, see [Access DLLs in Excel](how-to-access-dlls-in-excel.md).</span></span> 
  
<span data-ttu-id="a183f-108">Jedoch, wenn die DLL muss Zugriff auf Excel-Funktionen (beispielsweise den Inhalt einer Zelle Aufrufen eine Tabellenfunktion oder Excel zum Abrufen von Informationen des Arbeitsbereichs abgefragt abrufen), muss der Code einen Rückruf in Excel können.</span><span class="sxs-lookup"><span data-stu-id="a183f-108">However, if your DLL needs to access Excel functionality (for example, to get the contents of a cell, to call a worksheet function, or to interrogate Excel to obtain workspace information), your code must be able to call back into Excel.</span></span>
  
<span data-ttu-id="a183f-109">Der Excel-C-API bietet verschiedene Funktionen, mit denen DLLs in Excel zurückruft.</span><span class="sxs-lookup"><span data-stu-id="a183f-109">The Excel C API provides several functions that enable DLLs to call back into Excel.</span></span> <span data-ttu-id="a183f-110">Um auf diese zuzugreifen, die DLL verknüpft sein statisch zur Kompilierzeit mit der Excel-32-Bit-Bibliothek xlcall32.lib.</span><span class="sxs-lookup"><span data-stu-id="a183f-110">To access these, the DLL must be linked statically at compile time with the Excel 32-bit library, xlcall32.lib.</span></span> <span data-ttu-id="a183f-111">Die statische Bibliothek ist zum Herunterladen von Microsoft als Teil der Microsoft Excel 2013 XLL-SDK, die 32-Bit- und 64-Bit-Versionen dieser Bibliothek enthält.</span><span class="sxs-lookup"><span data-stu-id="a183f-111">The static library is downloadable from Microsoft as part of the Microsoft Excel 2013 XLL SDK, which includes both 32-bit and 64-bit versions of this library.</span></span>
  
## <a name="enabling-dlls-to-call-back-into-excel"></a><span data-ttu-id="a183f-112">Aktivieren von DLLs Rückruf in Excel</span><span class="sxs-lookup"><span data-stu-id="a183f-112">Enabling DLLs to Call Back into Excel</span></span>

<span data-ttu-id="a183f-113">Für eine DLL sein können den Zugriff auf die Funktionen in Excel und Abrufen oder festlegen Arbeitsbereichsinformationen, müssen sie zunächst die Adressen der Excel-Rückruffunktionen **Excel4**, **Excel4v**, **Excel12**und **Excel12v**abrufen.</span><span class="sxs-lookup"><span data-stu-id="a183f-113">For a DLL to be able to access the functionality in Excel and get or set workspace information, it must first obtain the addresses of the Excel callback functions **Excel4**, **Excel4v**, **Excel12**, and **Excel12v**.</span></span> <span data-ttu-id="a183f-114">Die letzten beiden in Excel 2007 eingeführt wurden und in späteren Versionen verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="a183f-114">The last two were introduced in Excel 2007 and are available in subsequent versions.</span></span> <span data-ttu-id="a183f-115">Zugriff auf alle diese muss das DLL-Projekt Verweise auf die folgenden Dateien aus dem Excel 2013 XLL-SDK enthalten.</span><span class="sxs-lookup"><span data-stu-id="a183f-115">To access all of these, the DLL project must include references to the following files from the Excel 2013 XLL SDK.</span></span> <span data-ttu-id="a183f-116">Wenn Sie nur die ersten beiden Rückrufe (in einer Version von Excel) zugreifen möchten, muss das Projekt nur die ersten beiden Dateien enthalten.</span><span class="sxs-lookup"><span data-stu-id="a183f-116">If you want to access only the first two callbacks (in any version of Excel), your project needs to include only the first two files.</span></span>
  
### <a name="xlcallh"></a><span data-ttu-id="a183f-117">Xlcall.h</span><span class="sxs-lookup"><span data-stu-id="a183f-117">Xlcall.h</span></span>

<span data-ttu-id="a183f-118">Die Xlcall.h-Datei enthält die folgenden Elemente:</span><span class="sxs-lookup"><span data-stu-id="a183f-118">The Xlcall.h file contains the following items:</span></span>
  
- <span data-ttu-id="a183f-119">Von Funktionsprototypen für alle Rückruffunktionen.</span><span class="sxs-lookup"><span data-stu-id="a183f-119">Function prototypes for all callback functions.</span></span>
    
- <span data-ttu-id="a183f-120">Definitionen der Datenstrukturen, die die Rückrufe zum Austauschen von Daten zwischen der DLL/XLL und Excel verwenden und Datentyp Konstante.</span><span class="sxs-lookup"><span data-stu-id="a183f-120">Definitions of the data structures that the callbacks use to exchange data between the DLL/XLL and Excel, and data-type constant definitions.</span></span>
    
- <span data-ttu-id="a183f-121">Definitionen von der C-API-Funktion und Befehl Entsprechungen des Arbeitsblatts, des Makro Blatt Funktionen und der unterstützten Excel-Befehle.</span><span class="sxs-lookup"><span data-stu-id="a183f-121">Definitions of the C API function and command equivalents of the worksheet, macro sheet functions, and supported Excel commands.</span></span>
    
- <span data-ttu-id="a183f-122">Definitionen der Callback-Funktion geben Werte zurück.</span><span class="sxs-lookup"><span data-stu-id="a183f-122">Definitions of callback function return values.</span></span>
    
<span data-ttu-id="a183f-123">Verwenden Sie die **#include** Richtlinie für diese Datei, die direkt oder indirekt über einen anderen Headerdatei in alle Dateien, die auf der C-API zugreifen oder behandelt Datentypen, die der C-API verwendet.</span><span class="sxs-lookup"><span data-stu-id="a183f-123">You should use the **#include** directive for this file, directly or indirectly via another header file, in all files that access the C API or that handle data types that the C API uses.</span></span> 
  
### <a name="xlcall32lib"></a><span data-ttu-id="a183f-124">Xlcall32.lib</span><span class="sxs-lookup"><span data-stu-id="a183f-124">Xlcall32.lib</span></span>

<span data-ttu-id="a183f-125">Die Xlcall32.lib Bibliothek exportiert die ersten beiden Rückrufe, **Excel4** und **Excel4v**und auch die **XlCallVer** -Funktion.</span><span class="sxs-lookup"><span data-stu-id="a183f-125">The Xlcall32.lib library exports the first two callbacks, **Excel4** and **Excel4v**, and also the **XlCallVer** function.</span></span> <span data-ttu-id="a183f-126">Ohne einen Verweis auf diese Bibliothek in Ihrem Projekt kann nicht vom Linker XLL erstellt, wenn Sie eine der folgenden Rückrufe in Ihrem Code verwendet haben.</span><span class="sxs-lookup"><span data-stu-id="a183f-126">Without a reference to this library in your project, the linker cannot create the XLL if you have used any of these callbacks in your code.</span></span> <span data-ttu-id="a183f-127">(Sie erhalten die Adressen dieser Funktionen von dynamisch verknüpfen mit den entsprechenden Xlcall32.dll, die als Teil einer normalen Excel-Installation auf Ihr System kopiert werden.)</span><span class="sxs-lookup"><span data-stu-id="a183f-127">(You can obtain the addresses of these functions by linking dynamically to the equivalent Xlcall32.dll that is copied to your system as part of a normal Excel installation.)</span></span> 
  
### <a name="xlcallcpp"></a><span data-ttu-id="a183f-128">Xlcall.cpp</span><span class="sxs-lookup"><span data-stu-id="a183f-128">Xlcall.cpp</span></span>

<span data-ttu-id="a183f-129">Die Excel-Rückrufe **Excel12** und **Excel12v** werden nicht in Xlcall32.lib exportiert.</span><span class="sxs-lookup"><span data-stu-id="a183f-129">The Excel callbacks **Excel12** and **Excel12v** are not exported in Xlcall32.lib.</span></span> <span data-ttu-id="a183f-130">Dadurch wird sichergestellt, dass XLL-Projekten, die Sie erstellen ab Excel 2007 mit früheren Versionen von Excel auch funktioniert.</span><span class="sxs-lookup"><span data-stu-id="a183f-130">This ensures that XLL projects that you create starting in Excel 2007 will also work with earlier versions of Excel.</span></span> <span data-ttu-id="a183f-131">Das Modul Xlcall.cpp enthält Code für die **Excel12** und **Excel12v** -Funktionen, die in einem Excel-Eintrag aufrufen zeigen Sie in Excel 2007 starten oder einen sicheren Fehlerwert zurück, wenn Sie eine frühere Version von Excel ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="a183f-131">The Xlcall.cpp module contains code for the **Excel12** and **Excel12v** functions, which call into an Excel entry point starting in Excel 2007, or return a safe error value if you are running an earlier version of Excel.</span></span> <span data-ttu-id="a183f-132">Sie sollten in diesem Modul in Ihrem Projekt einschließen, wenn Sie eine XLL, ausgeführt wird, starten in Excel 2007 und, ist die neue Datentypen verwenden, die größer Raster und länger Unicode-Zeichenfolgen behandeln, erstellen möchten.</span><span class="sxs-lookup"><span data-stu-id="a183f-132">You should include this module in your project if you want to create an XLL that runs starting in Excel 2007 and that is able to use the new data types that handle larger grids and longer Unicode strings.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a183f-133">Beginnend mit Excel 2010 SDK, kann diese Datei für 32-Bit- und 64-Bit-XLLs kompiliert werden.</span><span class="sxs-lookup"><span data-stu-id="a183f-133">Starting with the Excel 2010 SDK, this file can be compiled for both 32-bit and 64-bit XLLs.</span></span> 
  
## <a name="turning-dlls-into-xlls-add-in-manager-interface-functions"></a><span data-ttu-id="a183f-134">Umwandeln von DLLs in XLLs: Add-In-Manager-Schnittstelle Funktionen</span><span class="sxs-lookup"><span data-stu-id="a183f-134">Turning DLLs into XLLs: Add-in Manager Interface Functions</span></span>

<span data-ttu-id="a183f-135">Eine XLL ist eine DLL, die verschiedene Prozeduren exportiert, die von Excel-Add-in-Manager oder Excel aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="a183f-135">An XLL is a DLL that exports several procedures that are called by Excel or the Excel Add-in Manager.</span></span> <span data-ttu-id="a183f-136">Diese Verfahren sind hier kurz beschrieben und ausführlich im [Add-In - Manager und die Funktionen der XLL-Schnittstelle](add-in-manager-and-xll-interface-functions.md).</span><span class="sxs-lookup"><span data-stu-id="a183f-136">These procedures are described briefly here and discussed in detail in [Add-in Manager and XLL Interface Functions](add-in-manager-and-xll-interface-functions.md).</span></span> <span data-ttu-id="a183f-137">Alle diese DLL Rückrufe beginnen mit dem Präfix **XlAuto**.</span><span class="sxs-lookup"><span data-stu-id="a183f-137">All of these DLL callbacks start with the prefix **xlAuto**.</span></span> <span data-ttu-id="a183f-138">Nur eine dieser Befehl **XlAutoOpen**, ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="a183f-138">Only one of these, the command **xlAutoOpen**, is required.</span></span> <span data-ttu-id="a183f-139">Es wird aufgerufen, wenn das Add-in ist aktiviert, und es wird gewöhnlich verwendet, Registrieren von XLL-Funktionen und Befehle mit Excel und für andere Aufgaben Initialisierung.</span><span class="sxs-lookup"><span data-stu-id="a183f-139">It is called when the add-in is activated, and it is typically used to register XLL functions and commands with Excel and to do other initialization tasks.</span></span> <span data-ttu-id="a183f-140">In den nachfolgenden Abschnitten werden die Funktionssignaturen und Beispiel-Implementierung aller **XlAuto** -Funktionen bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="a183f-140">The function signatures and example implementations of all of the **xlAuto** functions are provided in later sections.</span></span> 
  
<span data-ttu-id="a183f-141">Obwohl **XlAutoOpen** die einzige erforderliche diese Rückrufe ist, müssen Ihr Add-in auch andere Benutzer je nach dessen Verhalten zu exportieren.</span><span class="sxs-lookup"><span data-stu-id="a183f-141">Even though **xlAutoOpen** is the only required one of these callbacks, your add-in may also need to export others depending on its behavior.</span></span> 
  
<span data-ttu-id="a183f-142">Excel 2007 eingeführt einen neuen Datentyp **XLOPER12**, für ein größerer Raster und zur Unterstützung von langer Unicode-Zeichenfolgen.</span><span class="sxs-lookup"><span data-stu-id="a183f-142">Excel 2007 introduced a new data type, **XLOPER12**, to accommodate larger grids and to support long Unicode strings.</span></span> <span data-ttu-id="a183f-143">**XLOPER12** wird weiter unten in diesem Thema beschrieben.</span><span class="sxs-lookup"><span data-stu-id="a183f-143">**XLOPER12** is described later in this topic.</span></span> <span data-ttu-id="a183f-144">Während die **XlAuto** -Funktionen nutzen oder zurückgeben den alten Datentyp **XLOPER**, wurden neue Versionen dieser Funktionen in Excel 2007, die Datentypen **XLOPER12** verwenden eingeführt.</span><span class="sxs-lookup"><span data-stu-id="a183f-144">Whereas **xlAuto** functions take or return the old data type **XLOPER**, new versions of these functions were introduced in Excel 2007 that use **XLOPER12** data types.</span></span> <span data-ttu-id="a183f-145">Mit Ausnahme von **xlAutoFree12**, die Sie in einigen Fällen implementieren müssen, um **XLOPER12** Arbeitsspeicher vermeiden Speicherverlusten können, kann problemlos ausgelassen werden alle die Version 12 **XlAuto** Funktionen, die in diesem Fall ab Excel 2007, Excel Aufrufe der **XLOPER** Versionen.</span><span class="sxs-lookup"><span data-stu-id="a183f-145">With the exception of **xlAutoFree12**, which you must sometimes implement to avoid **XLOPER12** memory leaks, you can safely omit all the version 12 **xlAuto** functions, in which case, starting in Excel 2007, Excel calls the **XLOPER** versions.</span></span> 
  
### <a name="xlautoopen"></a><span data-ttu-id="a183f-146">xlAutoOpen</span><span class="sxs-lookup"><span data-stu-id="a183f-146">xlAutoOpen</span></span>

<span data-ttu-id="a183f-147">Excel Ruft die [XlAutoOpen](xlautoopen.md) -Funktion, wenn die XLL aktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="a183f-147">Excel calls the [xlAutoOpen](xlautoopen.md) function whenever the XLL is activated.</span></span> <span data-ttu-id="a183f-148">Das Add-In wird aktiviert, am Anfang einer Excel-Sitzung Wenn in der letzten Excel-Sitzung aktiv war, die normalerweise beendet.</span><span class="sxs-lookup"><span data-stu-id="a183f-148">The add-in will be activated at the start of an Excel session if it was active in the last Excel session that ended normally.</span></span> <span data-ttu-id="a183f-149">Das Add-in ist aktiviert, wenn sie während einer Excel-Sitzung geladen wurde.</span><span class="sxs-lookup"><span data-stu-id="a183f-149">The add-in is activated if it is loaded during an Excel session.</span></span> <span data-ttu-id="a183f-150">Das Add-in kann deaktiviert und während einer Sitzung Excel erneut aktiviert, und die Funktion für eine erneute Aktivierung aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="a183f-150">The add-in can be deactivated and reactivated during an Excel session, and the function is called on reactivation.</span></span> 
  
<span data-ttu-id="a183f-151">Sie sollten **XlAutoOpen** zum Registrieren von XLL-Funktionen und Befehle, Initialisieren von Datenstrukturen, Anpassen der Benutzeroberfläche und so weiter verwenden.</span><span class="sxs-lookup"><span data-stu-id="a183f-151">You should use **xlAutoOpen** to register XLL functions and commands, initialize data structures, customize the user interface, and so on.</span></span> 
  
<span data-ttu-id="a183f-152">Wenn Ihr Add-In implementiert und die [XlAutoRegister](xlautoregister-xlautoregister12.md) -Funktion oder die Funktion [xlAutoRegister12 exportiert](xlautoregister-xlautoregister12.md) , versucht Excel möglicherweise, aktivieren und registrieren eine Funktion oder einen Befehl, ohne vorher die **XlAutoOpen** -Funktion.</span><span class="sxs-lookup"><span data-stu-id="a183f-152">If your add-in implements and exports the [xlAutoRegister](xlautoregister-xlautoregister12.md) function or the [xlAutoRegister12](xlautoregister-xlautoregister12.md) function, Excel might attempt to activate and register a function or command without first calling the **xlAutoOpen** function.</span></span> <span data-ttu-id="a183f-153">In diesem Fall sollten Sie sicherstellen, dass Ihr Add-in ausreichend für Ihre Funktion oder Befehl ordnungsgemäß initialisiert wird.</span><span class="sxs-lookup"><span data-stu-id="a183f-153">In this case, you should ensure that your add-in is sufficiently initialized for your function or command to work properly.</span></span> <span data-ttu-id="a183f-154">Wenn sie nicht der Fall ist, sollten Sie entweder beim Registrieren Sie die Funktion oder den Befehl, oder führen Sie die erforderliche Initialisierung fehl.</span><span class="sxs-lookup"><span data-stu-id="a183f-154">If it is not, you should either fail the attempt to register the function or command, or carry out the necessary initialization.</span></span> 
  
### <a name="xlautoclose"></a><span data-ttu-id="a183f-155">xlAutoClose</span><span class="sxs-lookup"><span data-stu-id="a183f-155">xlAutoClose</span></span>

<span data-ttu-id="a183f-156">Excel Ruft die [XlAutoClose](xlautoclose.md) -Funktion, wenn die XLL deaktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="a183f-156">Excel calls the [xlAutoClose](xlautoclose.md) function whenever the XLL is deactivated.</span></span> <span data-ttu-id="a183f-157">Das Add-In wird deaktiviert werden normalerweise am Ende eine Excel-Sitzung.</span><span class="sxs-lookup"><span data-stu-id="a183f-157">The add-in will be deactivated when an Excel session ends normally.</span></span> <span data-ttu-id="a183f-158">Wenn der Benutzer während einer Sitzung Excel das Add-in deaktiviert, wird die Funktion aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="a183f-158">If the user deactivates the add-in during an Excel session, the function is called.</span></span> 
  
<span data-ttu-id="a183f-159">Verwenden Sie **XlAutoClose** zum Aufheben der Registrierung Funktionen und Befehle, Ressourcen freizugeben, rückgängig Anpassungen und so weiter.</span><span class="sxs-lookup"><span data-stu-id="a183f-159">You should use **xlAutoClose** to unregister functions and commands, release resources, undo customizations, and so on.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a183f-160">Es ist ein bekanntes Problem bei der Aufhebung der Registrierung von Funktionen und Befehle.</span><span class="sxs-lookup"><span data-stu-id="a183f-160">There is a known issue with the unregistration of functions and commands.</span></span> <span data-ttu-id="a183f-161">Weitere Informationen finden Sie unter [Bekannte Probleme bei der Entwicklung von Excel XLL](known-issues-in-excel-xll-development.md).</span><span class="sxs-lookup"><span data-stu-id="a183f-161">For more information, see [Known Issues in Excel XLL Development](known-issues-in-excel-xll-development.md).</span></span> 
  
### <a name="xlautoadd"></a><span data-ttu-id="a183f-162">xlAutoAdd</span><span class="sxs-lookup"><span data-stu-id="a183f-162">xlAutoAdd</span></span>

<span data-ttu-id="a183f-163">Excel Ruft die [XlAutoAdd-Funktion](xlautoadd.md) , wenn der Benutzer die XLL während einer Sitzung Excel aktiviert, mit dem Add-In-Manager.</span><span class="sxs-lookup"><span data-stu-id="a183f-163">Excel calls the [xlAutoAdd function](xlautoadd.md) whenever the user activates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="a183f-164">Diese Funktion ist nicht aufgerufen, wenn Excel gestartet und eines vorinstallierten-add-ins lädt.</span><span class="sxs-lookup"><span data-stu-id="a183f-164">This function is not called when Excel starts and loads a preinstalled add-in.</span></span> 
  
<span data-ttu-id="a183f-165">Sie können diese Funktion verwenden, um ein benutzerdefiniertes Dialogfeld anzuzeigen, das dem Benutzer teilt mit, dass das Add-In aktiviert wurde, Lese- oder Schreibvorgänge in die Registrierung oder Lizenzinformationen zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="a183f-165">You can use this function to display a custom dialog box that tells the user that the add-in has been activated, to read from or write to the registry, or to check licensing information.</span></span>
  
### <a name="xlautoremove"></a><span data-ttu-id="a183f-166">xlAutoRemove</span><span class="sxs-lookup"><span data-stu-id="a183f-166">xlAutoRemove</span></span>

<span data-ttu-id="a183f-167">Excel Ruft die [XlAutoRemove](xlautoremove.md) -Funktion, wenn der Benutzer mit dem Add-In-Manager die XLL während einer Sitzung Excel deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="a183f-167">Excel calls the [xlAutoRemove](xlautoremove.md) function whenever the user deactivates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="a183f-168">Diese Funktion ist nicht aufgerufen, wenn eine Excel-Sitzung, ordnungsgemäß oder nicht ordnungsgemäß, mit der Add-in installiert wird geschlossen.</span><span class="sxs-lookup"><span data-stu-id="a183f-168">This function is not called when an Excel session closes, normally or abnormally, with the add-in installed.</span></span> 
  
<span data-ttu-id="a183f-169">Sie können diese Funktion verwenden, um ein benutzerdefiniertes Dialogfeld anzuzeigen, das dem Benutzer teilt mit, dass das Add-in deaktiviert wurde, oder zum Lesen aus und Schreiben in die Registrierung.</span><span class="sxs-lookup"><span data-stu-id="a183f-169">You can use this function to display a custom dialog box that tells the user that the add-in has been deactivated, or to read from or write to the registry.</span></span>
  
### <a name="xladdinmanagerinfoxladdinmanagerinfo12"></a><span data-ttu-id="a183f-170">XlAddInManagerInfo/xlAddInManagerInfo12</span><span class="sxs-lookup"><span data-stu-id="a183f-170">xlAddInManagerInfo/xlAddInManagerInfo12</span></span>

<span data-ttu-id="a183f-171">Excel Ruft die [XlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) -Funktion, wenn der Add-In-Manager zum ersten Mal in einer Excel-Sitzung aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="a183f-171">Excel calls the [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) function when the Add-in Manager is invoked for the first time in an Excel session.</span></span> <span data-ttu-id="a183f-172">Wenn Excel ein Argument gleich 1 übergibt, sollte eine Zeichenfolge (in der Regel der Name des Add-Ins); dieser Funktion zurückgegeben werden. Es sollte anderenfalls zurückgeben **#VALUE!**.</span><span class="sxs-lookup"><span data-stu-id="a183f-172">If Excel passes an argument equal to 1, this function should return a string (typically, the name of the add-in); otherwise, it should return **#VALUE!**.</span></span>
  
<span data-ttu-id="a183f-173">Ab Excel 2007, ruft Excel die Funktion **xlAddInManagerInfo12** anstelle der **XlAddInManagerInfo** -Funktion aus, wenn es von der XLL exportiert wird.</span><span class="sxs-lookup"><span data-stu-id="a183f-173">Starting in Excel 2007, Excel calls the **xlAddInManagerInfo12** function in preference to the **xlAddInManagerInfo** function if it is exported by the XLL.</span></span> <span data-ttu-id="a183f-174">Die Funktion **xlAddInManagerInfo12** sollte auf die gleiche Weise wie die **XlAddInManagerInfo** -Funktion zur Vermeidung von versionsspezifischen Unterschiede im Verhalten von XLL funktionieren.</span><span class="sxs-lookup"><span data-stu-id="a183f-174">The **xlAddInManagerInfo12** function should work in the same way as the **xlAddInManagerInfo** function to avoid version-specific differences in the behavior of the XLL.</span></span> <span data-ttu-id="a183f-175">Die **xlAddInManagerInfo12** -Funktion sollte einen Datentyp **XLOPER12** zurückgegeben, während die **XlAddInManagerInfo** -Funktion einen Datentyp **XLOPER** zurückgegeben werden soll.</span><span class="sxs-lookup"><span data-stu-id="a183f-175">The **xlAddInManagerInfo12** function should return an **XLOPER12** data type, whereas the **xlAddInManagerInfo** function should return an **XLOPER** data type.</span></span> 
  
### <a name="xlautoregisterxlautoregister12"></a><span data-ttu-id="a183f-176">XlAutoRegister/xlAutoRegister12</span><span class="sxs-lookup"><span data-stu-id="a183f-176">xlAutoRegister/xlAutoRegister12</span></span>

<span data-ttu-id="a183f-177">Excel Ruft die [XlAutoRegister](xlautoregister-xlautoregister12.md) -Funktion, wenn ein Anruf an die XLM-Funktion **Registrieren**oder der C-API entsprechende [XlfRegister](xlfregister-form-1.md) -Funktion, mit der Rückgabe vorgenommen wurde und Elementtypen, die für die Funktion registrierende fehlt.</span><span class="sxs-lookup"><span data-stu-id="a183f-177">Excel calls the [xlAutoRegister](xlautoregister-xlautoregister12.md) function whenever a call has been made to the XLM function **REGISTER**, or the C API equivalent [xlfRegister](xlfregister-form-1.md) function, with the return and argument types missing for the function being registered.</span></span> <span data-ttu-id="a183f-178">Die Funktion **XlAutoRegister** ermöglicht die XLL zum Suchen der internen Liste der exportierten Funktionen und Befehle aus, um die Funktion mit dem Argument registrieren und die angegebenen Typen zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="a183f-178">The **xlAutoRegister** function allows the XLL to search its internal lists of exported functions and commands to register the function with the argument and return the specified types.</span></span> 
  
<span data-ttu-id="a183f-179">Ab Excel 2007, ruft Excel die Funktion **xlAddInRegister12** anstelle der **XlAddInRegister** -Funktion aus, wenn es von der XLL exportiert wird.</span><span class="sxs-lookup"><span data-stu-id="a183f-179">Starting in Excel 2007, Excel calls the **xlAddInRegister12** function in preference to the **xlAddInRegister** function if it is exported by the XLL.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a183f-180">Wenn **XlAddInRegister**/ **xlAddInRegister12** versucht, die Funktion ohne das Argument registrieren und Rückgabetypen, eine rekursive Schleife aufrufen auftritt, der schließlich überschreitet die Aufrufliste und festgelegt, dass Excel schließen oder beenden reagiert.</span><span class="sxs-lookup"><span data-stu-id="a183f-180">If **xlAddInRegister**/ **xlAddInRegister12** tries to register the function without supplying the argument and return types, a recursive calling loop occurs that eventually overflows the call stack and causes Excel to close or stop responding.</span></span> 
  
### <a name="xlautofreexlautofree12"></a><span data-ttu-id="a183f-181">XlAutoFree/xlAutoFree12</span><span class="sxs-lookup"><span data-stu-id="a183f-181">xlAutoFree/xlAutoFree12</span></span>

<span data-ttu-id="a183f-182">Excel Ruft die [XlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) -Funktion auf, unmittelbar nachdem eine XLL-Arbeitsblattfunktion einen **XLOPER**gibt/ **XLOPER12** Datentyp mit Kennzeichen, die Excel angewiesen wird, Arbeitsspeicher, die die XLL weiterhin freigegeben werden muss.</span><span class="sxs-lookup"><span data-stu-id="a183f-182">Excel calls the [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) function just after an XLL worksheet function returns an **XLOPER**/ **XLOPER12** data type with a flag set that tells Excel there is memory that the XLL still needs to release.</span></span> <span data-ttu-id="a183f-183">Auf diese Weise können die XLL zurückzugebenden dynamisch Arrays, Zeichenfolgen und externe Verweise auf das Arbeitsblatt ohne Speicherverluste zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="a183f-183">This enables the XLL to return dynamically allocated arrays, strings, and external references to the worksheet without memory leaks.</span></span> <span data-ttu-id="a183f-184">Ab Excel 2007, wird der Datentyp **XLOPER12** unterstützt.</span><span class="sxs-lookup"><span data-stu-id="a183f-184">Starting in Excel 2007, the **XLOPER12** data type is supported.</span></span> <span data-ttu-id="a183f-185">Weitere Informationen finden Sie unter [Speicherverwaltung in Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="a183f-185">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="a183f-186">Ab Excel 2007, wenn Excel ist multithreaded Arbeitsblatt neu berechnen, die **XlAutoFree**für die Verwendung konfiguriert/ **xlAutoFree12** -Funktion wird aufgerufen, auf dem gleichen Thread, die gerade verwendet wurde, um die Funktion aufgerufen wird, die es zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="a183f-186">Starting in Excel 2007, when Excel is configured to use multithreaded worksheet recalculation, the **xlAutoFree**/ **xlAutoFree12** function is called on the same thread that was just used to call the function that returned it.</span></span> <span data-ttu-id="a183f-187">Der Aufruf von **XlAutoFree**/ **xlAutoFree12** wird immer durchgeführt werden, bevor alle nachfolgenden Arbeitsblattzellen auf diesem Thread ausgewertet werden.</span><span class="sxs-lookup"><span data-stu-id="a183f-187">The call to **xlAutoFree**/ **xlAutoFree12** is always made before any subsequent worksheet cells are evaluated on that thread.</span></span> <span data-ttu-id="a183f-188">Dies vereinfacht die threadsicheren Design in Ihrer XLL.</span><span class="sxs-lookup"><span data-stu-id="a183f-188">This simplifies thread-safe design in your XLL.</span></span> <span data-ttu-id="a183f-189">Weitere Informationen finden Sie unter [Multithreaded Neuberechnung in Excel](multithreaded-recalculation-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="a183f-189">For more information, see [Multithreaded Recalculation in Excel](multithreaded-recalculation-in-excel.md).</span></span> 
  
### <a name="creating-64-bit-xlls"></a><span data-ttu-id="a183f-190">Erstellen von XLLs 64-bit</span><span class="sxs-lookup"><span data-stu-id="a183f-190">Creating 64-bit XLLs</span></span>

<span data-ttu-id="a183f-191">Excel und benutzerdefinierte Funktionen können auf 64-Bit-Betriebssysteme Leistungsvorteile über 32-Bit-Betriebssystemen nutzen ausführen.</span><span class="sxs-lookup"><span data-stu-id="a183f-191">Excel and user-defined functions can run on 64-bit operating systems to take advantage of performance benefits over 32-bit operating systems.</span></span> <span data-ttu-id="a183f-192">Excel übergibt Werte in **XLOPER12** Strukturen, die Informationen zu den Typen für die Daten enthalten.</span><span class="sxs-lookup"><span data-stu-id="a183f-192">Excel passes values in **XLOPER12** structures that include information about the types for the data.</span></span> <span data-ttu-id="a183f-193">Seien Sie vorsichtig bei der Konvertierung zwischen Werten in der Struktur **XLOPER12** und systemeigenen Typen wie **Int** oder Zeiger auf die Werte in der größeren Typ beizubehalten.</span><span class="sxs-lookup"><span data-stu-id="a183f-193">Be careful when you convert between values in the **XLOPER12** structure and native types like **int** or pointers to preserve the values in the larger type.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="a183f-194">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="a183f-194">See also</span></span>



[<span data-ttu-id="a183f-195">Anruf XLL-Funktionen aus der Funktions-Assistenten oder Dialogfelder ersetzen</span><span class="sxs-lookup"><span data-stu-id="a183f-195">Call XLL Functions from the Function Wizard or Replace Dialog Boxes</span></span>](how-to-call-xll-functions-from-the-function-wizard-or-replace-dialog-boxes.md)
  
[<span data-ttu-id="a183f-196">Add-In-Manager und Funktionen von XLL-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="a183f-196">Add-in Manager and XLL Interface Functions</span></span>](add-in-manager-and-xll-interface-functions.md)
  
[<span data-ttu-id="a183f-197">Entwickeln von Excel-XLLs</span><span class="sxs-lookup"><span data-stu-id="a183f-197">Developing Excel XLLs</span></span>](developing-excel-xlls.md)

