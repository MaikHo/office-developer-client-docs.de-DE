---
title: Cluster sichere Funktionen
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
localization_priority: Normal
ms.assetid: 787badaf-8782-454d-a016-7eae83bbd8a9
description: 'Gilt für: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: d32925fcd5c3be7fe3e615ee2290f25c7595911c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409300"
---
# <a name="cluster-safe-functions"></a><span data-ttu-id="5fe45-103">Cluster sichere Funktionen</span><span class="sxs-lookup"><span data-stu-id="5fe45-103">Cluster safe functions</span></span>

<span data-ttu-id="5fe45-104">**Gilt für**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="5fe45-104">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="5fe45-105">In Excel 2013 kann Excel benutzerdefinierte Funktionen (User-Defined Function, UDF)-Aufrufe an einen Hochleistungs-Computing-Cluster über eine dedizierte Cluster-Connector-Schnittstelle Abladen.</span><span class="sxs-lookup"><span data-stu-id="5fe45-105">In Excel 2013, Excel can offload User-Defined Function (UDF) calls to a high-performance computing cluster through a dedicated cluster connector interface.</span></span> <span data-ttu-id="5fe45-106">Compute Cluster vendors stellen Cluster-Konnektoren bereit.</span><span class="sxs-lookup"><span data-stu-id="5fe45-106">Compute cluster vendors provide Cluster Connectors.</span></span> <span data-ttu-id="5fe45-107">UDF-Autoren können Ihre UDFs als Cluster sicher deklarieren, und wenn ein Cluster-Konnektor vorhanden ist, sendet Excel Aufrufe an diese UDFs an den Cluster-Konnektor zur Entlastung.</span><span class="sxs-lookup"><span data-stu-id="5fe45-107">UDF authors can declare their UDFs as cluster safe and then, when a cluster connector is present, Excel sends calls to these UDFs to the cluster connector for offloading.</span></span>
  
<span data-ttu-id="5fe45-108">Wenn Excel eine Cluster sichere UDF während der Neuberechnung erkennt, übergibt Sie den Namen der XLL, die derzeit läuft, den Namen des Cluster sicheren UDF und alle Parameter an den Cluster-Konnektor.</span><span class="sxs-lookup"><span data-stu-id="5fe45-108">When Excel discovers a cluster-safe UDF during recalculation, it passes the name of the XLL that is currently running, the name of the cluster-safe UDF, and any parameters to the cluster connector.</span></span> <span data-ttu-id="5fe45-109">Der Connector führt den UDF-Aufruf Remote aus und gibt die Ergebnisse an Excel zurück.</span><span class="sxs-lookup"><span data-stu-id="5fe45-109">The connector runs the UDF call remotely and returns the results to Excel.</span></span> <span data-ttu-id="5fe45-110">Die nicht abhängige Berechnung wird fortgesetzt, und wenn der Cluster-Konnektor die UDF-Funktion abgeschlossen hat, werden die Ergebnisse an Excel übergeben, und die abhängigen Berechnungen werden fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="5fe45-110">Non-dependent calculation continues and when the cluster connector has finished running the UDF, it passes the results to Excel and dependent calculations continue.</span></span> <span data-ttu-id="5fe45-111">Der Mechanismus für dieses asynchrone Verhalten imitiert den Mechanismus, der von asynchronen UDFs verwendet wird, mit der Ausnahme, dass der Cluster-Konnektor die asynchronen Aspekte anstelle des UDF-Autors verwaltet.</span><span class="sxs-lookup"><span data-stu-id="5fe45-111">The mechanism for this asynchronous behavior mimics the mechanism used by asynchronous UDFs, except that the cluster connector manages the asynchronous aspects instead of the UDF author.</span></span> <span data-ttu-id="5fe45-112">In der Regel implementiert ein Cluster-Connector einen XLL-Shim zum Laden von XLLs und zum Ausführen von UDFs auf Compute-Clusterknoten.</span><span class="sxs-lookup"><span data-stu-id="5fe45-112">Typically, a cluster connector implements an XLL shim to load XLLs and run UDFs on compute cluster nodes.</span></span>
  
<span data-ttu-id="5fe45-113">Die Mechanik der Deklaration von UDFs als Cluster sicher ähnelt denen der Deklaration von UDFs als sicher für die Neuberechnung mit mehreren Threads.</span><span class="sxs-lookup"><span data-stu-id="5fe45-113">The mechanics of declaring UDFs as cluster-safe resemble those of declaring UDFs as safe for multi-threaded recalculation.</span></span> <span data-ttu-id="5fe45-114">Da die UDF jedoch nicht unbedingt auf demselben Computer wie andere UDFs aus derselben Excel-Sitzung läuft, gibt es unterschiedliche Aspekte beim Schreiben von Cluster sicheren UDFs.</span><span class="sxs-lookup"><span data-stu-id="5fe45-114">However, because the UDF is not necessarily running on the same computer as other UDFs from the same Excel session, there are different considerations when writing cluster-safe UDFs.</span></span>
  
<span data-ttu-id="5fe45-115">Um eine UDF als Cluster sicher zu registrieren, müssen Sie die [xlfRegister (Form 1)](xlfregister-form-1.md) -Rückruffunktion über die **Excel12** -oder **Excel12v** -Schnittstelle aufrufen.</span><span class="sxs-lookup"><span data-stu-id="5fe45-115">To register a UDF as cluster-safe, you must call the [xlfRegister (Form 1)](xlfregister-form-1.md) callback function through the **Excel12** or **Excel12v** interface.</span></span> <span data-ttu-id="5fe45-116">Weitere Informationen zu diesen Schnittstellen finden Sie unter [Excel4/Excel12](excel4-excel12.md) und [Excel4v/Excel12v](excel4v-excel12v.md).</span><span class="sxs-lookup"><span data-stu-id="5fe45-116">For more information about these interfaces, see the [Excel4/Excel12](excel4-excel12.md) and [Excel4v/Excel12v](excel4v-excel12v.md).</span></span> <span data-ttu-id="5fe45-117">Das Registrieren einer UDF als Cluster-Safe über die **Excel4** -oder **Excel4v** -Schnittstelle wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="5fe45-117">Registering a UDF as cluster-safe through the **Excel4** or **Excel4v** interface is not supported.</span></span> 
  
<span data-ttu-id="5fe45-118">Wenn Sie eine Funktion als Cluster sicher registrieren, müssen Sie sicherstellen, dass sich die Funktion Cluster sicher verhält.</span><span class="sxs-lookup"><span data-stu-id="5fe45-118">If you register a function as cluster-safe, you must ensure that the function behaves in a cluster-safe way.</span></span> <span data-ttu-id="5fe45-119">Obwohl das genaue Verhalten des Cluster-Konnektors implementierungsspezifisch ist, sollten Sie die UDF so entwerfen, dass Sie auf einem verteilten Computersystem ausgeführt wird und über die folgenden Merkmale verfügt:</span><span class="sxs-lookup"><span data-stu-id="5fe45-119">Although the exact behavior of the cluster connector is implementation-specific, you should design your UDF to run on a distributed computer system and to have the following characteristics:</span></span>
  
- <span data-ttu-id="5fe45-120">Eine UDF sollte nicht auf einen Speicherstatus angewiesen sein.</span><span class="sxs-lookup"><span data-stu-id="5fe45-120">A UDF should not rely on any memory state.</span></span> <span data-ttu-id="5fe45-121">Eine UDF sollte sich beispielsweise nicht auf einen vorhandenen Cache im Arbeitsspeicher verlassen.</span><span class="sxs-lookup"><span data-stu-id="5fe45-121">For example, a UDF should not rely on an existing in-memory cache.</span></span>
    
- <span data-ttu-id="5fe45-122">Eine UDF sollte keine Excel-Rückrufe ausführen, die der Cluster-Connector-Anbieter nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="5fe45-122">A UDF should not perform Excel callbacks that the cluster connector provider does not support.</span></span>
    
<span data-ttu-id="5fe45-123">Neben dem Cluster sicheren Verhalten gelten für Cluster sichere UDFs die folgenden technischen Einschränkungen:</span><span class="sxs-lookup"><span data-stu-id="5fe45-123">In addition to cluster-safe behavior, there are the following technical restrictions on cluster-safe UDFs:</span></span>
  
1. <span data-ttu-id="5fe45-124">Keine XLOPER-Argumente (Typen ' P ', ' R ').</span><span class="sxs-lookup"><span data-stu-id="5fe45-124">No XLOPER arguments (types 'P', 'R').</span></span>
    
2. <span data-ttu-id="5fe45-125">Keine XLOPER12-Argumente, die Range-Verweise unterstützen (Typ "U").</span><span class="sxs-lookup"><span data-stu-id="5fe45-125">No XLOPER12 arguments that support range references (type 'U').</span></span>
    
3. <span data-ttu-id="5fe45-126">Es kann sich nicht um eine entsprechende Makroblatt Funktion handeln ('&amp;# ' und ' ' kann nicht kombiniert werden).</span><span class="sxs-lookup"><span data-stu-id="5fe45-126">Cannot be a macro sheet equivalent function ('#' and '&amp;' cannot be combined).</span></span>
    
<span data-ttu-id="5fe45-127">Für UDFs mit kürzeren Ausführungszeiten kann der Aufwand für die Verschiebung größer sein als die Zeit, die die UDF-Ausführung benötigt wird, was viele der Vorteile der Verwendung dieser Infrastruktur negiert.</span><span class="sxs-lookup"><span data-stu-id="5fe45-127">For UDFs with shorter execution times, the overhead of offloading may be larger than the time it takes the UDF to execute, negating many of the benefits of using this infrastructure.</span></span>
  
> [!NOTE]
> <span data-ttu-id="5fe45-128">Sie können keine Cluster sichere UDF als asynchrone UDF deklarieren.</span><span class="sxs-lookup"><span data-stu-id="5fe45-128">You cannot declare a cluster-safe UDF as an asynchronous UDF.</span></span> 
  
<span data-ttu-id="5fe45-129">Eine UDF kann bestimmen, ob Sie mit einem Cluster-Konnektor ausgeführt wird, indem Sie die [xlRunningOnCluster](xlrunningoncluster.md) -Rückruffunktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="5fe45-129">A UDF can determine whether it is being run using a cluster connector by calling the [xlRunningOnCluster](xlrunningoncluster.md) callback function.</span></span> 
  

