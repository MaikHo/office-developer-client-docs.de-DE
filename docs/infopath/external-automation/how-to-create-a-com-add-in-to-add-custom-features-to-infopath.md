---
title: Erstellen eines COM-Add-Ins zum Hinzufügen von benutzerdefinierten Features zu InfoPath
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- InfoPath 2007, Erstellen von COM-Add-Ins, InfoPath 2007, Hinzufügen von benutzerdefinierten Features, COM-Add-Ins [InfoPath 2007]
localization_priority: Normal
ms.assetid: af0b0bc9-20ef-4503-8b3b-8f2a97b671a2
description: Microsoft InfoPath unterstützt COM-Add-Ins für die Erweiterung der Benutzerumgebung zum Bearbeiten von Formularen. Obwohl die Unterstützung für COM-Add-ins erstmals in InfoPath hinzugefügt wurde, haben andere Office-Anwendungen wie Microsoft Office Word und Microsoft Office Excel seit Office 2000 COM-Add-Ins unterstützt.
ms.openlocfilehash: f8dd16b161c4ea862cf3b15e56e26a2547c1fc4c
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303787"
---
# <a name="create-a-com-add-in-to-add-custom-features-to-infopath"></a><span data-ttu-id="2af0a-105">Erstellen eines COM-Add-Ins zum Hinzufügen von benutzerdefinierten Features zu InfoPath</span><span class="sxs-lookup"><span data-stu-id="2af0a-105">Create a COM Add-in to Add Custom Features to InfoPath</span></span>

<span data-ttu-id="2af0a-106">Microsoft InfoPath unterstützt COM-Add-Ins für die Erweiterung der Benutzerumgebung zum Bearbeiten von Formularen.</span><span class="sxs-lookup"><span data-stu-id="2af0a-106">Microsoft InfoPath supports COM Add-ins for extending the form editing user experience.</span></span> <span data-ttu-id="2af0a-107">Obwohl die Unterstützung für COM-Add-ins erstmals in InfoPath hinzugefügt wurde, haben andere Office-Anwendungen wie Microsoft Office Word und Microsoft Office Excel seit Office 2000 COM-Add-Ins unterstützt.</span><span class="sxs-lookup"><span data-stu-id="2af0a-107">Although support for COM Add-ins was first added in InfoPath, other Office applications such as Microsoft Office Word and Microsoft Office Excel have supported COM add-ins since Office 2000.</span></span>
  
<span data-ttu-id="2af0a-108">Die COM-Add-in-Unterstützung in InfoPath ist für die Formularbearbeitungsumgebung verfügbar.</span><span class="sxs-lookup"><span data-stu-id="2af0a-108">COM Add-in support in InfoPath is available for the form editing environment.</span></span> <span data-ttu-id="2af0a-109">Die Formularentwurfsumgebung kann nicht mithilfe von COM-Add-Ins erweitert werden.</span><span class="sxs-lookup"><span data-stu-id="2af0a-109">The form design environment cannot be extended by using COM Add-ins.</span></span>
  
## <a name="the-idtextensibility2-interface"></a><span data-ttu-id="2af0a-110">Die IDTExtensibility2-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="2af0a-110">The IDTExtensibility2 Interface</span></span>

<span data-ttu-id="2af0a-111">Die InfoPath-Bearbeitungsumgebung bietet Unterstützung für die **IDTExtensibility2** -Schnittstelle, die von Entwicklern von COM-Add-Ins implementiert werden muss. **IDTExtensibility2** ist ein Dual-Interface-Objekt, das fünf Methoden bereitstellt, die als Ereignisse fungieren. innerhalb der Bearbeitungsumgebung.</span><span class="sxs-lookup"><span data-stu-id="2af0a-111">The InfoPath editing environment provides support for the **IDTExtensibility2** interface, which must be implemented by developers of COM Add-ins. **IDTExtensibility2** is a dual-interface object that provides five methods which act as events within the editing environment.</span></span> <span data-ttu-id="2af0a-112">Diese Methoden ermöglichen es dem COM-Add-in, auf Umgebungsstart-und-herunter fahrenbedingungen zu reagieren, die in der folgenden Tabelle aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="2af0a-112">These methods allow the COM add-in to respond to environment startup and shutdown conditions, listed in the following table.</span></span> 
  
|<span data-ttu-id="2af0a-113">**Schnittstelle**</span><span class="sxs-lookup"><span data-stu-id="2af0a-113">**Interface**</span></span>|<span data-ttu-id="2af0a-114">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="2af0a-114">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2af0a-115">**OnAddInsUpdate (ByVal Custom () As Variant)**</span><span class="sxs-lookup"><span data-stu-id="2af0a-115">**OnAddInsUpdate (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="2af0a-116">Tritt ein, wenn ein Add-in in der Umgebung geladen oder entladen wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-116">Occurs when an add-in is loaded or unloaded in the environment.</span></span>  <br/> |
|<span data-ttu-id="2af0a-117">**OnBeginShutdown (ByVal Custom () As Variant)**</span><span class="sxs-lookup"><span data-stu-id="2af0a-117">**OnBeginShutdown (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="2af0a-118">Tritt ein, wenn die Umgebung heruntergefahren wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-118">Occurs when the environment is being shut down.</span></span>  <br/> |
|<span data-ttu-id="2af0a-119">**OnConnection (ByVal Application as Object, ByVal ConnectMode as ext_ConnectMode, ByVal AddInInst as Object, ByVal Custom () As Variant)**</span><span class="sxs-lookup"><span data-stu-id="2af0a-119">**OnConnection(ByVal Application As Object, ByVal ConnectMode As ext_ConnectMode, ByVal AddInInst As Object, ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="2af0a-120">Tritt auf, wenn ein Add-in in der Umgebung geladen wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-120">Occurs when an add-in is loaded in the environment.</span></span>  <br/> |
|<span data-ttu-id="2af0a-121">**Disconnection (ByVal RemoveMode as ext_DisconnectMode, ByVal Custom () As Variant)**</span><span class="sxs-lookup"><span data-stu-id="2af0a-121">**OnDisconnection (ByVal RemoveMode As ext_DisconnectMode, ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="2af0a-122">Tritt auf, wenn ein Add-in aus der Umgebung entladen wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-122">Occurs when an add-in is unloaded from the environment.</span></span>  <br/> |
|<span data-ttu-id="2af0a-123">**OnStartupComplete (ByVal Custom () As Variant)**</span><span class="sxs-lookup"><span data-stu-id="2af0a-123">**OnStartupComplete (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="2af0a-124">Tritt ein, wenn die Umgebung gestartet wurde.</span><span class="sxs-lookup"><span data-stu-id="2af0a-124">Occurs when the environment has completed starting.</span></span>  <br/> |
   
## <a name="registering-com-add-ins"></a><span data-ttu-id="2af0a-125">Registrieren von COM-Add-ins</span><span class="sxs-lookup"><span data-stu-id="2af0a-125">Registering COM Add-ins</span></span>

<span data-ttu-id="2af0a-126">Alle Office-Anwendungen, einschließlich InfoPath, verwenden die Registrierung, um Add-Ins in der COM-Add-Ins-Auflistung aufzulisten, den Verbindungsstatus zu speichern und die Start-oder Demand-Lade Informationen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="2af0a-126">All Office applications, including InfoPath, use the registry to list add-ins in the COM Add-Ins collection, to store the connect state, and to store the boot or demand load information.</span></span> <span data-ttu-id="2af0a-127">Bei InfoPath-COM-Add-Ins wird der Name der einzelnen Add-Ins unter dem folgenden Schlüssel angezeigt:</span><span class="sxs-lookup"><span data-stu-id="2af0a-127">For InfoPath COM Add-ins, the name of each add-in appears under the following key:</span></span>
  
`HKEY_CURRENT_USER\Software\Microsoft\Office\InfoPath\AddIns\`
  
<span data-ttu-id="2af0a-128">Für COM-Add-Ins, die von jedem Benutzer des Clientcomputers installiert werden, befindet sich der Registrierungsschlüssel in der Registrierungsstruktur HKLM:</span><span class="sxs-lookup"><span data-stu-id="2af0a-128">For COM Add-ins installed for use by every user of the client computer, the registry key is located in the HKLM registry hive:</span></span>
  
`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\InfoPath\AddIns\`
  
<span data-ttu-id="2af0a-129">Der Registrierungsschlüsselname entspricht dem **ProgIdAttribute** des Add-Ins und enthält die folgenden Werte.</span><span class="sxs-lookup"><span data-stu-id="2af0a-129">The registry key name corresponds to the **ProgIdAttribute** of the add-in, and contains the following values.</span></span> 
  
|<span data-ttu-id="2af0a-130">**Name**</span><span class="sxs-lookup"><span data-stu-id="2af0a-130">**Name**</span></span>|<span data-ttu-id="2af0a-131">**Typ**</span><span class="sxs-lookup"><span data-stu-id="2af0a-131">**Type**</span></span>|<span data-ttu-id="2af0a-132">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="2af0a-132">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="2af0a-133">**FriendlyName**</span><span class="sxs-lookup"><span data-stu-id="2af0a-133">**FriendlyName**</span></span> <br/> |<span data-ttu-id="2af0a-134">**String**</span><span class="sxs-lookup"><span data-stu-id="2af0a-134">**String**</span></span> <br/> |<span data-ttu-id="2af0a-135">Der Name, der im Dialogfeld **com-Add-ins** angezeigt wird und auf der Seite **Add-ins** des **Trust Centers**aufgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-135">The name that is displayed in the **COM Add-ins** dialog box and listed in the **Add-ins** page of the **Trust Center**.</span></span>  <br/> |
|<span data-ttu-id="2af0a-136">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="2af0a-136">**Description**</span></span> <br/> |<span data-ttu-id="2af0a-137">**String**</span><span class="sxs-lookup"><span data-stu-id="2af0a-137">**String**</span></span> <br/> |<span data-ttu-id="2af0a-138">Die Zeichenfolge, die angezeigt wird, wenn das Add-in im **Vertrauensstellungs Center**ausgewählt wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-138">The string that is displayed when the add-in is selected in the **Trust Center**.</span></span>  <br/> |
|<span data-ttu-id="2af0a-139">**LoadBehavior**</span><span class="sxs-lookup"><span data-stu-id="2af0a-139">**LoadBehavior**</span></span> <br/> |<span data-ttu-id="2af0a-140">**DWORD**</span><span class="sxs-lookup"><span data-stu-id="2af0a-140">**DWORD**</span></span> <br/> |<span data-ttu-id="2af0a-141">Gibt an, wie das COM-Add-in geladen wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-141">Specifies the way the COM Add-in is loaded.</span></span> <span data-ttu-id="2af0a-142">Der Wert kann eine Kombination aus 0, 1, 2, 8 und 16 sein.</span><span class="sxs-lookup"><span data-stu-id="2af0a-142">The value can be a combination of 0, 1, 2, 8, and 16.</span></span> <span data-ttu-id="2af0a-143">Weitere Informationen finden Sie in der Tabelle unten.</span><span class="sxs-lookup"><span data-stu-id="2af0a-143">See the table below for more information.</span></span>  <br/> |
   
<span data-ttu-id="2af0a-144">Der **DWORD** -Wert für **LoadBehavior** sollte einen Wert enthalten, der beschreibt, wie das COM-Add-in in der Bearbeitungsumgebung geladen wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-144">The **DWORD** value for **LoadBehavior** should contain a value describing how the COM Add-in loads in the editing environment.</span></span> <span data-ttu-id="2af0a-145">Der Wert kann aus der folgenden Tabelle oder aus einer Kombination von Werten aus der Tabelle sein.</span><span class="sxs-lookup"><span data-stu-id="2af0a-145">The value can be from the table below, or a combination of values from the table.</span></span> <span data-ttu-id="2af0a-146">Ein COM-Add-in, das in Visual Studio 2005 erstellt wurde, hat beispielsweise eine **LoadBehavior** von "3", die beim Anwendungsstart geladen und verbunden werden kann.</span><span class="sxs-lookup"><span data-stu-id="2af0a-146">For example, a COM Add-in created in Visual Studio 2005 will have a **LoadBehavior** of "3" loaded at application startup and be connected.</span></span> 
  
|<span data-ttu-id="2af0a-147">**Wert**</span><span class="sxs-lookup"><span data-stu-id="2af0a-147">**Value**</span></span>|<span data-ttu-id="2af0a-148">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="2af0a-148">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2af0a-149">0</span><span class="sxs-lookup"><span data-stu-id="2af0a-149">0</span></span>  <br/> |<span data-ttu-id="2af0a-150">Getrennt.</span><span class="sxs-lookup"><span data-stu-id="2af0a-150">Disconnected.</span></span> <span data-ttu-id="2af0a-151">Das Add-in wird im Dialogfeld **com-Add-in** als inaktiv angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2af0a-151">The add-in shows as Inactive in the **COM Add-in** dialog box.</span></span>  <br/> |
|<span data-ttu-id="2af0a-152">1</span><span class="sxs-lookup"><span data-stu-id="2af0a-152">1</span></span>  <br/> |<span data-ttu-id="2af0a-153">Verbunden.</span><span class="sxs-lookup"><span data-stu-id="2af0a-153">Connected.</span></span> <span data-ttu-id="2af0a-154">Das Add-in wird im Dialogfeld **com-Add-in** als aktiv angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2af0a-154">The add-in shows as Active in the **COM Add-in** dialog box.</span></span>  <br/> |
|<span data-ttu-id="2af0a-155">2</span><span class="sxs-lookup"><span data-stu-id="2af0a-155">2</span></span>  <br/> |<span data-ttu-id="2af0a-156">Laden beim Start.</span><span class="sxs-lookup"><span data-stu-id="2af0a-156">Load at Startup.</span></span> <span data-ttu-id="2af0a-157">Das Add-in wird geladen und verbunden, wenn die Hostanwendung gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-157">The add-in is loaded and connected when the host application starts.</span></span>  <br/> |
|<span data-ttu-id="2af0a-158">8</span><span class="sxs-lookup"><span data-stu-id="2af0a-158">8</span></span>  <br/> |<span data-ttu-id="2af0a-159">Bei Bedarf laden.</span><span class="sxs-lookup"><span data-stu-id="2af0a-159">Load on Demand.</span></span> <span data-ttu-id="2af0a-160">Das Add-in wird geladen und verbunden, wenn die Hostanwendung es benötigt, beispielsweise wenn ein Benutzer auf eine Schaltfläche klickt, die Funktionalität im Add-in verwendet.</span><span class="sxs-lookup"><span data-stu-id="2af0a-160">The add-in is loaded and connected when the host application requires it, for example when a user clicks a button that uses functionality in the add-in.</span></span>  <br/> |
|<span data-ttu-id="2af0a-161">16</span><span class="sxs-lookup"><span data-stu-id="2af0a-161">16</span></span>  <br/> |<span data-ttu-id="2af0a-162">Verbindung bei der ersten Ausführung.</span><span class="sxs-lookup"><span data-stu-id="2af0a-162">Connect first time.</span></span> <span data-ttu-id="2af0a-163">Das Add-in wird geladen und verbunden, wenn der Benutzer die Hostanwendung zum ersten Mal ausführt, nachdem das Add-in registriert wurde.</span><span class="sxs-lookup"><span data-stu-id="2af0a-163">The add-in will be loaded and connected the first time the user runs the host application after registering the add-in.</span></span>  <br/> |
   
## <a name="creating-a-managed-com-add-in-with-visual-studio-2005-or-visual-studio-2008"></a><span data-ttu-id="2af0a-164">Erstellen eines verwalteten COM-Add-Ins mit Visual Studio 2005 oder Visual Studio 2008</span><span class="sxs-lookup"><span data-stu-id="2af0a-164">Creating a Managed COM Add-in with Visual Studio 2005 or Visual Studio 2008</span></span>

<span data-ttu-id="2af0a-165">Erstellen Sie ein FreigeGebenes Add-in-Projekt wie folgt, um ein verwaltetes COM-Add-in mithilfe von Microsoft Visual Studio 2005 oder Visual Studio 2008 zu erstellen:</span><span class="sxs-lookup"><span data-stu-id="2af0a-165">To create a managed COM add-in using Microsoft Visual Studio 2005 or Visual Studio 2008, create a Shared Add-In project as follows:</span></span> 
  
1. <span data-ttu-id="2af0a-166">Starten Sie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="2af0a-166">Start Visual Studio.</span></span>
    
2. <span data-ttu-id="2af0a-167">Klicken Sie im Menü **Datei** auf **Neues Projekt**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-167">On the **File** menu, click **New Project**.</span></span>
    
3. <span data-ttu-id="2af0a-168">Klicken Sie im Dialogfeld **Neues Projekt** im Bereich **Projekttypen** auf den Ordner **andere Projekttypen** , und klicken Sie dann \*\*\*\* auf Erweiterbarkeit.</span><span class="sxs-lookup"><span data-stu-id="2af0a-168">In the **Project Types** pane of the **New Project** dialog box, click the **Other Projects Types** folder, and then click **Extensibility**.</span></span>
    
4. <span data-ttu-id="2af0a-169">Klicken Sie im Bereich **Vorlagen** auf **freigegebenes Add-in**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-169">In the **Templates** pane, click **Shared Add-In**.</span></span>
    
5. <span data-ttu-id="2af0a-170">Geben Sie im Feld **Name** einen Namen für das Projekt ein.</span><span class="sxs-lookup"><span data-stu-id="2af0a-170">In the **Name** box, type a name for the project.</span></span> 
    
6. <span data-ttu-id="2af0a-171">Geben Sie im Feld **Speicherort** einen Ordnerpfad ein, oder klicken Sie auf **Durchsuchen** , und wählen Sie einen Ordnerpfad aus, und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-171">In the **Location** box, type a folder path or click **Browse** and select a folder path, and then click **OK**.</span></span> <span data-ttu-id="2af0a-172">Der **Assistent für gemeinsame Add-ins** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2af0a-172">The **Shared Add-in Wizard** appears.</span></span> 
    
7. <span data-ttu-id="2af0a-173">Klicken Sie im **Assistenten für freiGegebene Add-ins**auf **weiter** .</span><span class="sxs-lookup"><span data-stu-id="2af0a-173">Click **Next** in the **Shared Add-in Wizard**.</span></span> <span data-ttu-id="2af0a-174">Die Seite **Programmiersprache auswählen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2af0a-174">The **Select a Programming Language** page appears.</span></span> 
    
8. <span data-ttu-id="2af0a-175">Klicken Sie auf **Add-in mit Visual Basic erstellen**, und klicken Sie dann auf **weiter**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-175">Click **Create an Add-in using Visual Basic**, then click **Next**.</span></span> <span data-ttu-id="2af0a-176">Die Seite **Anwendungs Host auswählen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2af0a-176">The **Select An Application Host** page appears.</span></span> 
    
9. <span data-ttu-id="2af0a-177">Deaktivieren Sie die Kontrollkästchen neben den einzelnen Anwendungen, außer **Microsoft InfoPath**, und klicken Sie dann auf **weiter**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-177">Uncheck the boxes next to each application except **Microsoft InfoPath**, and then click **Next**.</span></span> <span data-ttu-id="2af0a-178">Die Seite **Name und Beschreibung eingeben** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2af0a-178">The **Enter a Name and Description** page appears.</span></span> 
    
10. <span data-ttu-id="2af0a-179">Geben Sie im Feld **wie lautet der Name Ihres Add-ins** den Namen des COM-Add-Ins ein.</span><span class="sxs-lookup"><span data-stu-id="2af0a-179">In the **What is the name of your Add-In** box, type the name of your COM Add-in.</span></span> 
    
11. <span data-ttu-id="2af0a-180">Geben Sie im Feld **wie lautet die Beschreibung Ihres Add-ins** ein, und klicken Sie auf **weiter**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-180">In the **What is the description of your Add-In** box, type the description for your COM Add-in, and click **Next**.</span></span> <span data-ttu-id="2af0a-181">Die Seite **Add-in-Optionen auswählen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2af0a-181">The **Choose Add-In Options** page appears.</span></span> 
    
12. <span data-ttu-id="2af0a-182">Aktivieren Sie das Kontrollkästchen Ich möchte, dass das **Add-in geladen wird, wenn die Hostanwendung** geladen **wird und mein Add-in für alle Benutzer des Computers, auf dem Sie installiert wurde, verfügbar sein soll, nicht nur für die Person, die die IT** -Box installiert.</span><span class="sxs-lookup"><span data-stu-id="2af0a-182">Check the **I would like my Add-in to load when the host application loads** and **My Add-in should be available to all users of the computer it was installed on, not just the person who installs it** boxes.</span></span> 
    
13. <span data-ttu-id="2af0a-183">Klicken Sie auf **weiter** , um die Seite **Zusammenfassung** zu überarbeiten, und klicken Sie auf **Fertig stellen**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-183">Click **Next** to review the **Summary** page, then click **Finish**.</span></span>
    
<span data-ttu-id="2af0a-184">Nachdem das Projekt von Visual Studio erstellt wurde, werden zwei Projekte im Projektmappen-Explorer angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2af0a-184">After the project is created by Visual Studio, you will see two projects in the Solution Explorer window.</span></span> <span data-ttu-id="2af0a-185">Das erste Projekt ist das Projekt für das COM-Add-in; Das zweite Projekt ist ein Setupprojekt für die Bereitstellung des COM-Add-Ins.</span><span class="sxs-lookup"><span data-stu-id="2af0a-185">The first project is the project for the COM Add-in; the second project is a setup project for deploying the COM Add-in.</span></span> <span data-ttu-id="2af0a-186">Der **Assistent für freiGegebene Add-ins** fügt nur einen Verweis auf die **Microsoft Office 14,0-Objektbibliothek**ein, daher muss mithilfe der folgenden Schritte ein Verweis auf die InfoPath-Objektbibliothek eingefügt werden:</span><span class="sxs-lookup"><span data-stu-id="2af0a-186">The **Shared Add-in Wizard** only inserts a reference to the **Microsoft Office 14.0 Object Library**, so it is necessary to insert a reference to the InfoPath object library using the following steps:</span></span>
  
1. <span data-ttu-id="2af0a-187">Doppelklicken Sie auf **mein Projekt** , um die Eigenschaften des Add-in-Projekts anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="2af0a-187">Double-click **My Project** to display the add-in project properties.</span></span> <span data-ttu-id="2af0a-188">Klicken Sie auf die Registerkarte **Verweise** , um die Verweise anzuzeigen, die dem Projekt automatisch hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="2af0a-188">Click the **References** tab to display the references automatically added to the project.</span></span> 
    
2. <span data-ttu-id="2af0a-189">Klicken Sie auf die Schaltfläche **Hinzufügen** , um das Dialogfeld **Verweis hinzufügen** anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="2af0a-189">Click the **Add** button to display the **Add Reference** dialog box.</span></span> 
    
3. <span data-ttu-id="2af0a-190">Doppelklicken Sie auf der Registerkarte **com** auf **Microsoft. InfoPath 2,0**-Typbibliothek, und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-190">On the **COM** tab, double-click **Microsoft.InfoPath 2.0 Type Library**, and click **OK**.</span></span>
    
4. <span data-ttu-id="2af0a-191">Wenn Sie einen Verweis auf die **Microsoft InfoPath 3,0** -Typbibliothek hinzufügen, werden auch Verweise auf drei Assemblys hinzugefügt, die entfernt werden müssen: **ADODB**, **MSHTML**und **msxml2**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-191">Adding a reference to the **Microsoft InfoPath 3.0 Type Library** also adds references to three assemblies that must be removed: **ADODB**, **MSHTML**, and **MSXML2**.</span></span> <span data-ttu-id="2af0a-192">Klicken Sie im **Projektmappen-Explorer** unter **Verweise**mit der rechten Maustaste auf jeden dieser Verweise, und klicken Sie dann auf **Entfernen**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-192">In **Solution Explorer** under **References**, right-click each of these references, and then click **Remove**.</span></span>
    
## <a name="viewing-the-registry-settings"></a><span data-ttu-id="2af0a-193">Anzeigen der Registrierungseinstellungen</span><span class="sxs-lookup"><span data-stu-id="2af0a-193">Viewing the Registry Settings</span></span>

<span data-ttu-id="2af0a-194">Führen Sie die folgenden Schritte aus, um die Registrierungseinstellungen anzuzeigen, die bei der Installation des COM-Add-Ins erstellt werden:</span><span class="sxs-lookup"><span data-stu-id="2af0a-194">To view the registry settings that will be created when the COM Add-in is installed, follow these steps:</span></span>
  
1. <span data-ttu-id="2af0a-195">Klicken Sie im **Projektmappen-Explorer**mit der rechten Maustaste auf den Stammknoten des Setup-Projekts, klicken Sie auf **Ansicht**, dann auf **Editor**, und klicken Sie dann auf **Registrierung**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-195">Right-click the root node of the setup project in the **Solution Explorer**, click **View**, then **Editor**, then click **Registry**.</span></span>
    
2. <span data-ttu-id="2af0a-196">Klicken Sie im linken Bereich auf das Plus, um **HKEY_LOCAL_MACHINE**, **Software**, **Microsoft**, **InfoPath**und dann AddIns \*\*\*\* zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="2af0a-196">In the left-hand pane, click the plus to expand **HKEY_LOCAL_MACHINE**, **Software**, **Microsoft**, **InfoPath**, then **AddIns**.</span></span>
    
3. <span data-ttu-id="2af0a-197">Klicken Sie auf den Namen, der der **ProgID**des freigegebenen Add-in-Projekts entspricht.</span><span class="sxs-lookup"><span data-stu-id="2af0a-197">Click the name corresponding to your shared add-in project's **ProgID**.</span></span>
    
<span data-ttu-id="2af0a-198">Um diese Eigenschaften zu ändern, klicken Sie mit der rechten Maustaste auf die Eigenschaft, klicken Sie auf **Eigenschaftenfenster**, und ändern Sie das Feld **Wert** im **Fenster Eigenschaften**.</span><span class="sxs-lookup"><span data-stu-id="2af0a-198">To change any of these properties, right-click the property, click **Properties Window**, and change the **Value** box in the **Properties Window**.</span></span>
  
## <a name="compiling-and-distributing-the-shared-add-in"></a><span data-ttu-id="2af0a-199">Kompilieren und Verteilen des freigegebenen Add-ins</span><span class="sxs-lookup"><span data-stu-id="2af0a-199">Compiling and Distributing the Shared Add-In</span></span>

<span data-ttu-id="2af0a-200">Zum Kompilieren des verwalteten COM-Add-Ins zu Testzwecken auf dem Computer, auf dem das FreigeGebene Add-in-Projekt entwickelt wurde, klicken Sie im projektMappen-Explorer mit der rechten Maustaste auf den Stammknoten des freigegebenen Add-in-Projekts, und klicken Sie auf erstellen.</span><span class="sxs-lookup"><span data-stu-id="2af0a-200">To compile the managed COM Add-in for testing on the computer on which the Shared Add-In project was developed, right-click the root node of the Shared Add-In project in the Solution Explorer and click Build.</span></span> <span data-ttu-id="2af0a-201">Wenn das Projekt ohne Fehler erstellt wird, können Sie die InfoPath-Bearbeitungsumgebung starten und mit der Verwendung des verwalteten COM-Add-ins beginnen.</span><span class="sxs-lookup"><span data-stu-id="2af0a-201">If the project builds with no errors, you can start the InfoPath editing environment and begin using the managed COM Add-in.</span></span> <span data-ttu-id="2af0a-202">Wenn Sie eine Instanz von InfoPath haben, schließen Sie Sie, bevor Sie das Projekt erstellen.</span><span class="sxs-lookup"><span data-stu-id="2af0a-202">If you have an instance of InfoPath running, close it before building the project.</span></span> <span data-ttu-id="2af0a-203">Möglicherweise muss auch das Dialogfeld COM-Add-Ins geöffnet werden, um zu überprüfen, ob das COM-Add-in registriert ist.</span><span class="sxs-lookup"><span data-stu-id="2af0a-203">It may also be necessary to open the COM Add-ins dialog box to verify that the COM Add-in is registered.</span></span> <span data-ttu-id="2af0a-204">Gehen Sie folgendermaßen vor, um das Dialogfeld COM-Add-Ins zu öffnen:</span><span class="sxs-lookup"><span data-stu-id="2af0a-204">To open the COM Add-ins dialog box, follow these steps:</span></span>
  
1. <span data-ttu-id="2af0a-205">Öffnen Sie die InfoPath-Bearbeitungsumgebung.</span><span class="sxs-lookup"><span data-stu-id="2af0a-205">Open the InfoPath editing environment.</span></span> <span data-ttu-id="2af0a-206">Die einfachste Möglichkeit hierzu ist das Öffnen einer vorhandenen Formularvorlage, mit der ein neues Formular erstellt wird, das auf dieser Formularvorlage basiert.</span><span class="sxs-lookup"><span data-stu-id="2af0a-206">The easiest way to do this is to open an existing form template, which will create a new form based on that form template.</span></span>
    
2. <span data-ttu-id="2af0a-207">Klicken Sie im Menü **Extras** auf **Vertrauensstellungs Center** .</span><span class="sxs-lookup"><span data-stu-id="2af0a-207">Click **Trust Center** on the **Tools** menu.</span></span> 
    
3. <span data-ttu-id="2af0a-208">Klicken Sie Links auf die Kategorie **Add-ins** .</span><span class="sxs-lookup"><span data-stu-id="2af0a-208">Click the **Add-ins** category on the left.</span></span> 
    
4. <span data-ttu-id="2af0a-209">Wählen Sie im Abschnitt **Verwalten** am unteren Rand des Dialogfelds **Vertrauensstellungs Center** die Option **com-Add-ins** aus der Liste aus, und klicken Sie auf die Schaltfläche **Gehe** zu.</span><span class="sxs-lookup"><span data-stu-id="2af0a-209">In the **Manage** section near the bottom of the **Trust Center** dialog box, select **COM Add-ins** from the list and click the **Go** button.</span></span> 
    
5. <span data-ttu-id="2af0a-210">Im Dialogfeld **com-Add-ins** wird der Name des kürzlich erstellten Add-Ins angezeigt, und daneben sollte ein Kontrollkästchen vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="2af0a-210">In the **COM Add-ins** dialog box, you will see the name of your recently-built add-in and there should be a check box next to it.</span></span> <span data-ttu-id="2af0a-211">Wenn kein Kontrollkästchen angezeigt wird, konnte das COM-Add-in aufgrund eines Fehlers nicht geladen werden, der im Abschnitt **Ladeverhalten** des Dialogfelds aufgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-211">If there is no check box next to it, the COM Add-in failed to load due to an error, which will be listed in the **Load Behavior** section of the dialog box.</span></span> 
    
<span data-ttu-id="2af0a-212">Zum Kompilieren des verwalteten COM-Add-Ins zur Verwendung auf einem anderen Computer als dem Computer, auf dem das FreigeGebene Add-in-Projekt entwickelt wurde, müssen Sie zusätzliche Schritte ausführen, um den Code zu sichern.</span><span class="sxs-lookup"><span data-stu-id="2af0a-212">To compile the managed COM add-in for use on a computer other than the computer on which the Shared Add-In project was developed, you must follow additional steps to secure your code.</span></span> <span data-ttu-id="2af0a-213">Informationen zum Sichern von Projekten für FreigeGebene Add-Ins zur Verwendung auf anderen Computern finden Sie in den folgenden drei Artikeln:</span><span class="sxs-lookup"><span data-stu-id="2af0a-213">For information on securing Shared Add-In projects for use on other computers, see the following three articles:</span></span>
  
- [<span data-ttu-id="2af0a-214">Bereitstellung von verwalteten COM-Add-Ins in Office XP</span><span class="sxs-lookup"><span data-stu-id="2af0a-214">Deployment of Managed COM Add-Ins in Office XP</span></span>](https://go.microsoft.com/fwlink/?LinkID=73473)
  
- [<span data-ttu-id="2af0a-215">Verwenden der COM-Add-in-Shimlösung zum Bereitstellen von verwalteten COM-Add-Ins in Office XP</span><span class="sxs-lookup"><span data-stu-id="2af0a-215">Using the COM Add-in Shim Solution to Deploy Managed COM Add-ins in Office XP</span></span>](https://go.microsoft.com/fwlink/?LinkID=73474)
  
- [<span data-ttu-id="2af0a-216">Isolieren von Office-Erweiterungen mit dem COM-Shim-Assistenten</span><span class="sxs-lookup"><span data-stu-id="2af0a-216">Isolating Office Extensions with the COM Shim Wizard</span></span>](https://go.microsoft.com/fwlink/?LinkID=73475)
  
> [!IMPORTANT]
> <span data-ttu-id="2af0a-217">Das nicht isolieren des COM-Add-Ins kann zu Speicherlecks und Anwendungsinstabilität führen.</span><span class="sxs-lookup"><span data-stu-id="2af0a-217">Not isolating the COM Add-in may cause memory leaks and application instability.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="2af0a-218">Wenn .NET Framework oder andere erforderliche Assemblys aus dem Setup-Projekt nicht bereits auf den Zielcomputern installiert sind, wird die MSI-Datei möglicherweise nicht richtig installiert.</span><span class="sxs-lookup"><span data-stu-id="2af0a-218">If the .NET Framework or other required assemblies from the setup project are not already installed on target computers, the .msi file may not install properly.</span></span> <span data-ttu-id="2af0a-219">Außerdem können Sie die MSI-Datei nicht verteilen und dann versuchen, die MSI-Datei zu installieren.</span><span class="sxs-lookup"><span data-stu-id="2af0a-219">Also, you cannot distribute the .msi file and then attempt to install the .msi file.</span></span> <span data-ttu-id="2af0a-220">Außerdem müssen Sie die anderen Supportdateien im selben Ordner wie die von Visual Studio generierte Original-MSI-Datei verteilen.</span><span class="sxs-lookup"><span data-stu-id="2af0a-220">You must also distribute the other support files in the same folder as the original .msi file generated by Visual Studio.</span></span> 
  
## <a name="coding-in-the-com-add-in"></a><span data-ttu-id="2af0a-221">Codieren im COM-Add-in</span><span class="sxs-lookup"><span data-stu-id="2af0a-221">Coding in the COM Add-in</span></span>

<span data-ttu-id="2af0a-222">Anwendungsereignisse, die in der InfoPath-Formularbearbeitungsumgebung auftreten, können von einem COM-Add-in erfasst werden.</span><span class="sxs-lookup"><span data-stu-id="2af0a-222">Application events that occur in the InfoPath form editing environment can be captured by a COM Add-in.</span></span> <span data-ttu-id="2af0a-223">Die folgenden Ereignisse des [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) -Objekts können vom COM-Add-in verwendet werden, um auf Benutzeraktionen zu reagieren:</span><span class="sxs-lookup"><span data-stu-id="2af0a-223">The following events of the [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) object can be used by the COM Add-in to respond to user actions:</span></span> 
  
|<span data-ttu-id="2af0a-224">**Event**</span><span class="sxs-lookup"><span data-stu-id="2af0a-224">**Event**</span></span>|<span data-ttu-id="2af0a-225">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="2af0a-225">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2af0a-226">[Neuxdocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.NewXDocument.aspx) Ereignis</span><span class="sxs-lookup"><span data-stu-id="2af0a-226">[NewXDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.NewXDocument.aspx) Event</span></span>  <br/> |<span data-ttu-id="2af0a-227">Tritt ein, wenn ein neues Formular erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-227">Occurs when a new form is created.</span></span>  <br/> |
|<span data-ttu-id="2af0a-228">[Beenden](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.Quit.aspx) Ereignis</span><span class="sxs-lookup"><span data-stu-id="2af0a-228">[Quit](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.Quit.aspx) Event</span></span>  <br/> |<span data-ttu-id="2af0a-229">Tritt ein, wenn der Benutzer InfoPath beendet.</span><span class="sxs-lookup"><span data-stu-id="2af0a-229">Occurs when the user quits InfoPath.</span></span>  <br/> |
|<span data-ttu-id="2af0a-230">[WindowDeactivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowActivate.aspx) Ereignis</span><span class="sxs-lookup"><span data-stu-id="2af0a-230">[WindowActivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowActivate.aspx) Event</span></span>  <br/> |<span data-ttu-id="2af0a-231">Tritt ein, wenn ein Dokumentfenster aktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-231">Occurs when any document window is activated.</span></span>  <br/> |
|<span data-ttu-id="2af0a-232">[WindowDeactivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowDeactivate.aspx) Ereignis</span><span class="sxs-lookup"><span data-stu-id="2af0a-232">[WindowDeactivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowDeactivate.aspx) Event</span></span>  <br/> |<span data-ttu-id="2af0a-233">Tritt ein, wenn ein Dokumentfenster deaktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-233">Occurs when any document window is deactivated.</span></span>  <br/> |
|<span data-ttu-id="2af0a-234">[Windowsisieren](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowSize.aspx) Ereignis</span><span class="sxs-lookup"><span data-stu-id="2af0a-234">[WindowSize](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowSize.aspx) Event</span></span>  <br/> |<span data-ttu-id="2af0a-235">Tritt ein, wenn die Größe eines Dokumentfensters geändert wird oder das Dokumentfenster verschoben wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-235">Occurs when any document window is resized or moved.</span></span>  <br/> |
|<span data-ttu-id="2af0a-236">[XDocumentBeforeClose](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeClose.aspx) Ereignis</span><span class="sxs-lookup"><span data-stu-id="2af0a-236">[XDocumentBeforeClose](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeClose.aspx) Event</span></span>  <br/> |<span data-ttu-id="2af0a-237">Tritt unmittelbar vor dem Schließen eines Dokuments ein.</span><span class="sxs-lookup"><span data-stu-id="2af0a-237">Occurs immediately before any open document closes.</span></span>  <br/> |
|<span data-ttu-id="2af0a-238">[XDocumentBeforePrint](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforePrint.aspx) Ereignis</span><span class="sxs-lookup"><span data-stu-id="2af0a-238">[XDocumentBeforePrint](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforePrint.aspx) Event</span></span>  <br/> |<span data-ttu-id="2af0a-239">Tritt unmittelbar vor dem Drucken eines geöffneten Dokuments auf.</span><span class="sxs-lookup"><span data-stu-id="2af0a-239">Occurs immediately before any open document is printed.</span></span>  <br/> |
|<span data-ttu-id="2af0a-240">[XDocumentBeforeSave](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeSave.aspx) Ereignis</span><span class="sxs-lookup"><span data-stu-id="2af0a-240">[XDocumentBeforeSave](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeSave.aspx) Event</span></span>  <br/> |<span data-ttu-id="2af0a-241">Tritt unmittelbar vor dem Speichern eines geöffneten Dokuments auf.</span><span class="sxs-lookup"><span data-stu-id="2af0a-241">Occurs immediately before any open document is saved.</span></span>  <br/> |
|<span data-ttu-id="2af0a-242">[XDocumentChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentChange.aspx) Ereignis</span><span class="sxs-lookup"><span data-stu-id="2af0a-242">[XDocumentChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentChange.aspx) Event</span></span>  <br/> |<span data-ttu-id="2af0a-243">Tritt ein, wenn ein neues Formular erstellt wird, wenn ein vorhandenes Formular geöffnet wird oder wenn ein anderes Formular als aktives Formular festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-243">Occurs when a new form is created, when an existing form is opened, or when another form is made the active form.</span></span>  <br/> |
|<span data-ttu-id="2af0a-244">[XDocumentOpen](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentOpen.aspx) Ereignis</span><span class="sxs-lookup"><span data-stu-id="2af0a-244">[XDocumentOpen](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentOpen.aspx) Event</span></span>  <br/> |<span data-ttu-id="2af0a-245">Tritt ein, wenn ein Dokument geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="2af0a-245">Occurs when a document is opened.</span></span>  <br/> |
   
<span data-ttu-id="2af0a-246">Um diese Ereignisse im COM-Add-in aufzuzeichnen, müssen Sie die folgenden Variablen auf Klassenebene in der **Connect** -Klasse deklarieren:</span><span class="sxs-lookup"><span data-stu-id="2af0a-246">To capture these events in the COM Add-in, you must declare the following class-level variables in your **Connect** class:</span></span> 
  
```vb
InfoPathApplication = DirectCast( _
   application, Microsoft.Office.Interop.InfoPath._Application3)
InfoPathApplicationEvents = DirectCast( _
   InfoPathApplication.Events, _
   Microsoft.Office.Interop.InfoPath.ApplicationEvents)
```

```cs
InfoPathApplication =
   (Microsoft.Office.Interop.InfoPath._Application3)application;
InfoPathApplicationEvents =
   (Microsoft.Office.Interop.InfoPath.ApplicationEvents)
   InfoPathApplication.Events;
```

<span data-ttu-id="2af0a-247">Die erste Codezeile wandelt das generische Application- **Objekt** , das vom Add-in empfangen wird, in das [_Application3](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.aspx) -Objekt um.</span><span class="sxs-lookup"><span data-stu-id="2af0a-247">The first line casts the generic application **Object** received by the add-in to the [_Application3](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.aspx) object.</span></span> <span data-ttu-id="2af0a-248">Die zweite Leitung wandelt die [Events](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.Events.aspx) -Eigenschaft des **_Application3** -Objekts (dargestellt durch die **InfoPathApplication** -Variable) in das [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) -Objekt um.</span><span class="sxs-lookup"><span data-stu-id="2af0a-248">The second line casts the [Events](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.Events.aspx) property of the **_Application3** object (represented by the **InfoPathApplication** variable) to the [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) object.</span></span> 
  
<span data-ttu-id="2af0a-249">Zum Erstellen von Ereignishandlern wählen Sie im Dropdownfeld **Klassenname** oben im Visual Studio-Fenster **InfoPathApplicationEvents** aus, und wählen Sie dann das zu behandelnde Ereignis im Dropdownfeld **methodenName** am oberen Rand des visuellen Studio-Fenster.</span><span class="sxs-lookup"><span data-stu-id="2af0a-249">To create event handlers, select **InfoPathApplicationEvents** from the **Class Name** drop-down box at the top of the Visual Studio window, and then select the event you want to handle in the **Method Name** drop-down box at the top of the Visual Studio window.</span></span> <span data-ttu-id="2af0a-250">Wenn Sie beispielsweise steuern möchten, wann ein Formular gespeichert wird, behandeln Sie das **XDocumentBeforeSave** -Ereignis.</span><span class="sxs-lookup"><span data-stu-id="2af0a-250">For example, if you need to control when a form is saved, you handle the **XDocumentBeforeSave** event.</span></span> <span data-ttu-id="2af0a-251">Durch Auswählen von **XDocumentBeforeSave** aus der Dropdownliste **Methoden Name** wird automatisch das folgende Verfahren eingefügt:</span><span class="sxs-lookup"><span data-stu-id="2af0a-251">Selecting **XDocumentBeforeSave** from the **Method Name** drop-down automatically inserts the following procedure:</span></span> 
  
```vb
Private Sub InfoPathApplicationEvents_XDocumentBeforeSave( _
   ByVal pDocument As Microsoft.Office.Interop.InfoPath._XDocument, _
   ByRef pfCancel As Boolean) _
   Handles InfoPathApplicationEvents.XDocumentBeforeSave
End Sub
```

```cs
private void InfoPathApplicationEvents_XDocumentBeforeSave(
   Microsoft.Office.Interop.InfoPath._XDocument pDocument, ref bool pfCancel)
{
}

```

<span data-ttu-id="2af0a-252">Ereignisse des **ApplicationEvents** -Objekts können vom COM-Add-in mit derselben Methode verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="2af0a-252">Any of the events of the **ApplicationEvents** object can be handled by the COM Add-in using the same method.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2af0a-253">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="2af0a-253">See also</span></span>

- [<span data-ttu-id="2af0a-254">Erstellen eines Microsoft Office 2000-COM-Add-ins</span><span class="sxs-lookup"><span data-stu-id="2af0a-254">Creating a Microsoft Office 2000 COM Add-in</span></span>](https://go.microsoft.com/fwlink/?LinkID=73468) 
- [<span data-ttu-id="2af0a-255">Erstellen von Office-verwalteten COM-Add-Ins mit Visual Studio .NET</span><span class="sxs-lookup"><span data-stu-id="2af0a-255">Creating Office Managed COM Add-Ins with Visual Studio .NET</span></span>](https://go.microsoft.com/fwlink/?LinkID=73470)
- [<span data-ttu-id="2af0a-256">Arbeiten mit den IDTExtensibility2-Ereignisprozeduren</span><span class="sxs-lookup"><span data-stu-id="2af0a-256">Working with the IDTExtensibility2 Event Procedures</span></span>](https://go.microsoft.com/fwlink/?LinkID=73471)
- [<span data-ttu-id="2af0a-257">Erstellen eines Office-COM-Add-Ins mit Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="2af0a-257">Build an Office COM Add-in With Visual Basic .NET</span></span>](https://go.microsoft.com/fwlink/?LinkID=73469)
- [<span data-ttu-id="2af0a-258">Erstellen eines Office-COM-Add-Ins mithilfe von Visual C# .NET</span><span class="sxs-lookup"><span data-stu-id="2af0a-258">Build an Office COM add-in by using Visual C# .NET</span></span>](https://support.microsoft.com/en-us/help/302901/how-to-build-an-office-com-add-in-by-using-visual-c-net)
- [<span data-ttu-id="2af0a-259">Erstellen von InfoPath 2007-Add-Ins mithilfe von Visual Studio 2005 Tools für Office System SE</span><span class="sxs-lookup"><span data-stu-id="2af0a-259">Creating InfoPath 2007 Add-Ins by Using Visual Studio 2005 Tools for the Office System SE</span></span>](https://msdn.microsoft.com/library/bb968857%28office.12%29.aspx)

