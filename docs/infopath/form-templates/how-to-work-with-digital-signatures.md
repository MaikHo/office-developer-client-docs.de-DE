---
title: Arbeiten mit digitalen Signaturen
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- digitale Signaturen [InfoPath 2007], InfoPath 2007, digitale Signaturen
localization_priority: Normal
ms.assetid: fd13fb71-aecf-47bb-8a6b-db70bd90ceeb
description: Das Objektmodell des Microsoft. Office. InfoPath-Namespaces bietet Funktionen zum programmgesteuerten Arbeiten mit digitalen Signaturen.
ms.openlocfilehash: ea657f80f6e38a06a91e19c245eadc203c7c580c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425575"
---
# <a name="work-with-digital-signatures"></a><span data-ttu-id="4b5ac-104">Arbeiten mit digitalen Signaturen</span><span class="sxs-lookup"><span data-stu-id="4b5ac-104">Work with Digital Signatures</span></span>

<span data-ttu-id="4b5ac-105">Das Objektmodell des [Microsoft. Office. InfoPath-](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) Namespaces bietet Funktionen zum programmgesteuerten Arbeiten mit digitalen Signaturen.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-105">The object model of the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace provides features for working with digital signatures programmatically.</span></span> 
  
## <a name="digital-signature-features"></a><span data-ttu-id="4b5ac-106">Features für digitale Signaturen</span><span class="sxs-lookup"><span data-stu-id="4b5ac-106">Digital Signature Features</span></span>

<span data-ttu-id="4b5ac-107">Mithilfe der für digitale Signaturen von InfoPath bereitgestellten Features können Sie Folgendes ausführen:</span><span class="sxs-lookup"><span data-stu-id="4b5ac-107">The digital signatures features provided by InfoPath enable you to:</span></span> 
  
- <span data-ttu-id="4b5ac-108">Zulassen von Signaturen für das gesamte Formular oder für bestimmte Gruppen von Daten im Formular, die getrennt signiert werden können.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-108">Enable signatures for the entire form, or for specific sets of data in the form that can be signed separately.</span></span>
    
- <span data-ttu-id="4b5ac-p101">Angeben bei jeder signierbaren Datengruppe, ob einzelne oder mehrere Signaturen zulässig sind und in welcher Beziehung diese zueinander stehen sollen. So können Sie beispielsweise angeben, ob es sich um parallele gemeinsame Signaturen handelt oder ob alle früheren Signaturen durch jede neue Signatur gegengezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-p101">Specify, for each set of data that can be signed, whether a single signature or multiple signatures are allowed and what their relationship will be. For example, you can specify whether they are parallel co-signatures or whether each new signature countersigns all the earlier signatures.</span></span>
    
- <span data-ttu-id="4b5ac-111">Angeben einer Meldung, die angezeigt werden soll, wenn Benutzer das Formular signieren.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-111">Specify a message to be shown to form users as they sign the form.</span></span>
    
- <span data-ttu-id="4b5ac-112">Einfügen und Anzeigen einer Signatur im Dokument.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-112">Insert and see a signature in the document.</span></span> 
    
- <span data-ttu-id="4b5ac-p102">Anzeigen überprüfbarer Nichtabstreitbarkeitsinformationen, die jeder Signatur zur Steigerung der Sicherheit hinzugefügt wurden. Diese zusätzlichen Informationen, die eine Ansicht des Formulars einschließen, wie es jeder signierenden Person vorgelegt wurde, sind ein Bestandteil der Signatur und können nicht entfernt werden, ohne die Signatur ungültig zu machen. Sie können diese Daten jederzeit erneut aufrufen, indem Sie auf die Signatur im Formular klicken, um das Dialogfeld **Digitale Signatur überprüfen** anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-p102">View verifiable non-repudiation information that has been added to each signature for increased security. This additional information, which includes a view of the form as it was presented to each signer, is part of the signature and cannot be removed without invalidating the signature. At any time, you can recall this data by clicking on the signature in the form to display the **Verify Digital Signature** dialog box.</span></span> 
    
- <span data-ttu-id="4b5ac-p103">Profitieren von einem umfangreicheren Objektmodell zum Arbeiten mit digitalen Signaturen. Fügen Sie dem Signaturblock in vollständig vertrauenswürdigen Formularen benutzerdefinierte Informationen zum Objektmodell für digitale Signaturen hinzu. </span><span class="sxs-lookup"><span data-stu-id="4b5ac-p103">Take advantage of an object model for working with digital signatures. Add custom information to the signature block in fully trusted forms through the digital signature object model.</span></span> 
    
## <a name="overview-of-the-digital-signatures-object-model"></a><span data-ttu-id="4b5ac-118">Übersicht über das Objektmodell für digitale Signaturen</span><span class="sxs-lookup"><span data-stu-id="4b5ac-118">Overview of the Digital Signatures Object Model</span></span>

### <a name="the-sign-event"></a><span data-ttu-id="4b5ac-119">Sign-Ereignis</span><span class="sxs-lookup"><span data-stu-id="4b5ac-119">The Sign Event</span></span>

<span data-ttu-id="4b5ac-120">Das Objektmodell für digitale Signaturen stellt das folgende Ereignis bereit.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-120">The object model for digital signatures provides the following event.</span></span>
  
|<span data-ttu-id="4b5ac-121">**Name**</span><span class="sxs-lookup"><span data-stu-id="4b5ac-121">**Name**</span></span>|<span data-ttu-id="4b5ac-122">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="4b5ac-122">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="4b5ac-123">Sign</span><span class="sxs-lookup"><span data-stu-id="4b5ac-123">Sign</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) <br/> |<span data-ttu-id="4b5ac-124">Tritt auf, nachdem eine Datengruppe zum Signieren ausgewählt wurde.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-124">Occurs after a set of data has been selected to sign.</span></span>  <br/> <span data-ttu-id="4b5ac-p104">Mithilfe dieses Ereignisses können Sie die in der digitalen Signatur gespeicherten Daten bearbeiten. So können Sie beispielsweise Daten eines vertrauenswürdigen Zeitstempelservers oder eine serverseitige Gegensignatur der Transaktion hinzufügen. Sie können mit diesem Ereignis auch Signaturen blockieren, wenn der aktuelle Benutzer kein Mitglied einer bestimmten Gruppe ist.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-p104">You can use this event to manipulate the data stored within the digital signature. For example, you can add data from a trusted timestamp server, or add a server-side countersignature of the transaction. You can also use this event to block signing if the current user is not a member of a particular group.</span></span>  <br/> |
   
### <a name="the-signeventargs-object"></a><span data-ttu-id="4b5ac-128">SignEventArgs-Objekt</span><span class="sxs-lookup"><span data-stu-id="4b5ac-128">The SignEventArgs Object</span></span>

<span data-ttu-id="4b5ac-129">Ein Ereignishandler für das [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) -Ereignis kann mit dem [SignEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.aspx) -Ereignisobjekt verwendet werden, das die folgenden Eigenschaften bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-129">An event handler for the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) event can work with the [SignEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.aspx) event object, which provides the following properties.</span></span> 
  
|<span data-ttu-id="4b5ac-130">**Name**</span><span class="sxs-lookup"><span data-stu-id="4b5ac-130">**Name**</span></span>|<span data-ttu-id="4b5ac-131">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="4b5ac-131">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="4b5ac-132">SignedDataBlock</span><span class="sxs-lookup"><span data-stu-id="4b5ac-132">SignedDataBlock</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.SignedDataBlock.aspx) <br/> |<span data-ttu-id="4b5ac-133">Ruft die Datengruppe ab, die das [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) -Ereignis ausgelöst hat.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-133">Gets the set of data that raised the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) event.</span></span>  <br/> |
|[<span data-ttu-id="4b5ac-134">SignatureWizard</span><span class="sxs-lookup"><span data-stu-id="4b5ac-134">SignatureWizard</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.SignatureWizard.aspx) <br/> |<span data-ttu-id="4b5ac-135">Ruft ab, ob das Dialogfeld **Digitale Signaturen** angezeigt werden soll, oder legt die Einstellung fest.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-135">Gets or sets whether to display the **Digital Signatures** dialog box.</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="4b5ac-136">In dem verwalteten Codeobjektmodell von [Microsoft. Office. Interop. InfoPath. SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) , das im Lieferumfang von InfoPath 2003 enthalten ist, stellt das [SignEvent](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignEvent.aspx) -ereignisObjekt für das OnSign-Ereignis eine **XDocument** -Eigenschaft für den Zugriff auf die [](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2.OnSign.aspx) \*\* XDocument\*\* -Objekt des dem Ereignis zugeordneten Formulars.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-136">In the [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) managed code object model that shipped with InfoPath 2003, the [SignEvent](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignEvent.aspx) event object for the [OnSign](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2.OnSign.aspx) event provides an **XDocument** property for accessing the **XDocument** object of the form associated with the event.</span></span> <span data-ttu-id="4b5ac-137">Dies ist bei Formularvorlagen, die mit InfoPath Forms Services oder InfoPath mithilfe des [Microsoft. Office. InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) -Objektmodells erstellt wurden, nicht erforderlich, da [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) auf die Objektmodellelemente der XmlForm-Klasse im Formularcode mithilfe des this-Objekts zugegriffen werden kann. \*\* \*\*(C#) oder **Me** (Visual Basic)-Schlüsselwort.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-137">This is not necessary with form templates created with InfoPath Forms Services or InfoPath using the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) object model because the object model members of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class can be accessed in form code using the **this** (C#) or **Me** (Visual Basic) keyword.</span></span> <span data-ttu-id="4b5ac-138">Um beispielsweise auf die [signierte](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Signed.aspx) Eigenschaft der [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) -Klasse zuzugreifen, um zu bestimmen, ob ein Formular signiert ist, `this.Signed` können Sie entweder`Me.Signed.`</span><span class="sxs-lookup"><span data-stu-id="4b5ac-138">For example, to access the [Signed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Signed.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class to determine if a form is signed, you can type either  `this.Signed` or  `Me.Signed.`</span></span>
  
### <a name="collections-and-objects"></a><span data-ttu-id="4b5ac-139">Auflistungen und Objekte</span><span class="sxs-lookup"><span data-stu-id="4b5ac-139">Collections and Objects</span></span>

<span data-ttu-id="4b5ac-140">Das Objektmodell für digitale Signaturen stellt die folgenden Auflistungen bereit.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-140">The object model for digital signatures provides the following collections.</span></span>
  
|<span data-ttu-id="4b5ac-141">**Name**</span><span class="sxs-lookup"><span data-stu-id="4b5ac-141">**Name**</span></span>|<span data-ttu-id="4b5ac-142">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="4b5ac-142">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="4b5ac-143">SignedDataBlockCollection</span><span class="sxs-lookup"><span data-stu-id="4b5ac-143">SignedDataBlockCollection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) <br/> |<span data-ttu-id="4b5ac-144">Die Auflistung der [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) -Objekte in der Formularvorlage, die zur Entwurfszeit im InfoPath-Entwurfsmodus definiert sind.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-144">The collection of the [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) objects in the form template as defined at design time in InfoPath design mode.</span></span>  <br/> <span data-ttu-id="4b5ac-145">Die [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) -Auflistung implementiert Eigenschaften, die für den Zugriff auf die einem Formular zugeordneten [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) -Objekte verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-145">The [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) collection implements properties that can be used to access the [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) objects associated with a form.</span></span> <span data-ttu-id="4b5ac-146">Auf [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) das einem Formular zugeordnete SignedDataBlockCollection-Objekt kann über die [SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SignedDataBlocks.aspx) -Eigenschaft der [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) -Klasse zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-146">The [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) object associated with a form is accessible through the [SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SignedDataBlocks.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class.</span></span>  <br/> |
|[<span data-ttu-id="4b5ac-147">SignatureCollection</span><span class="sxs-lookup"><span data-stu-id="4b5ac-147">SignatureCollection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) <br/> |<span data-ttu-id="4b5ac-148">Enthält eine Auflistung von [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) -Objekten für jedes [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) -Objekt im Formular.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-148">Contains a collection of [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) objects for each [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object in the form.</span></span>  <br/> <span data-ttu-id="4b5ac-149">Die [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) -Klasse implementiert Eigenschaften und eine Methode, die verwendet werden kann, um auf die zugeordneten [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) -Objekte eines Formulars zuzugreifen und eine Signatur zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-149">The [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) class implements properties and a method that can be used to access a form's associated [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) objects and to create a signature.</span></span> <span data-ttu-id="4b5ac-150">Auf [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) das SignatureCollection-Objekt, das einem [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) zugeordnet ist, kann mithilfe der [Signatures](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Signatures.aspx) -Eigenschaft zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-150">The [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) object associated with a [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) is accessible using the [Signatures](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Signatures.aspx) property.</span></span>  <br/> <span data-ttu-id="4b5ac-151">Wenn Sie die [CreateSignature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) -Methode der [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) -Klasse verwenden, beachten Sie, dass die Signatur erst dann geschrieben wird, wenn die [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) -Methode für das [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) -Objekt aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-151">When you use the [CreateSignature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) method of the [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) class, keep in mind that the signature is not written until the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) method is called on the [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) object.</span></span> <span data-ttu-id="4b5ac-152">Diese Methoden können nur vom **Sign**-Ereignishandler einer vollständig vertrauenswürdigen Formularvorlage aus aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-152">These methods can be called only from the **Sign** event handler of a fully trusted form template.</span></span>  <br/> |
   
<span data-ttu-id="4b5ac-153">Das Objektmodell für digitale Signaturen stellt die folgenden Objekte bereit.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-153">The object model for digital signatures provides the following objects.</span></span>
  
|<span data-ttu-id="4b5ac-154">**Name**</span><span class="sxs-lookup"><span data-stu-id="4b5ac-154">**Name**</span></span>|<span data-ttu-id="4b5ac-155">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="4b5ac-155">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="4b5ac-156">SignedDataBlock</span><span class="sxs-lookup"><span data-stu-id="4b5ac-156">SignedDataBlock</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) <br/> |<span data-ttu-id="4b5ac-157">Stellt eine signierbare Datengruppe in einem Formular dar.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-157">Represents a set of signable data in a form.</span></span> <span data-ttu-id="4b5ac-158">Das [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx)-Objekt stellt eine Reihe von Eigenschaften und eine Methode für die programmgesteuerte Interaktion mit einer signierbaren Datengruppe bereit.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-158">The [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object provides a number of properties and one method that can be used to programmatically interact with a set of signable data.</span></span>  <br/> |
|[<span data-ttu-id="4b5ac-159">Signatur</span><span class="sxs-lookup"><span data-stu-id="4b5ac-159">Signature</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) <br/> |<span data-ttu-id="4b5ac-160">Stellt eine digitale Signatur dar, die einem Formular oder einer signierbaren Datengruppe in einem Formular hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-160">Represents a digital signature that has been added to a form or set of signable data in a form.</span></span> <span data-ttu-id="4b5ac-161">Das [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) -Objekt implementiert Eigenschaften, mit denen Informationen zur digitalen Signatur abgerufen werden können, sowie die [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) -Methode zum Schreiben des XML-Signatur Blocks und zum Berechnen des kryptografischen Hashwerts.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-161">The [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) object implements properties that can be used to retrieve information about the digital signature, and the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) method for writing the XML digital signature block and computing its cryptographic hash value.</span></span>  <br/> |
|[<span data-ttu-id="4b5ac-162">Certificate</span><span class="sxs-lookup"><span data-stu-id="4b5ac-162">Certificate</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Certificate.aspx) <br/> |<span data-ttu-id="4b5ac-163">Stellt das digitale X.509-Zertifikat dar, das zum Erstellen der Signatur verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-163">Represents the X.509 digital certificate that has been used to create the signature.</span></span>  <br/> |
   
## <a name="working-with-digital-signatures-programmatically"></a><span data-ttu-id="4b5ac-164">Programmgesteuertes Arbeiten mit digitalen Signaturen</span><span class="sxs-lookup"><span data-stu-id="4b5ac-164">Working with Digital Signatures Programmatically</span></span>

<span data-ttu-id="4b5ac-165">Das Objektmodell des [Microsoft. Office. InfoPath-](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) Namespaces stellt Elemente für die programmgesteuerte Interaktion mit digitalen Signaturen bereit.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-165">The object model of the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace provides members for interacting with digital signatures programmatically.</span></span> <span data-ttu-id="4b5ac-166">Insbesondere können voll vertrauenswürdige Formulare dem Signaturblock benutzerdefinierte Informationen hinzufügen, bevor ein Commit ausgeführt wird, entsprechend der folgenden Zeitachse:</span><span class="sxs-lookup"><span data-stu-id="4b5ac-166">In particular, fully-trusted forms can add custom information to the signature block before it is committed, according to the following timeline:</span></span> 
  
1. <span data-ttu-id="4b5ac-167">Der Benutzer wählt aus, dass einem Formular eine digitale Signatur hinzugefügt werden soll.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-167">User chooses to add a digital signature to a form.</span></span>
    
2. <span data-ttu-id="4b5ac-168">Das Dialogfeld **digitale Signaturen** wird angezeigt, der Benutzer klickt auf **Hinzufügen**und wählt dann die zu Signier Daten aus.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-168">The **Digital Signatures** dialog box is displayed, the user clicks **Add**, and then selects the data to sign.</span></span>
    
3. <span data-ttu-id="4b5ac-169">Das [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) -Ereignis für die vom [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) -Objekt dargestellten ausgewählten Daten wird ausgelöst, und die [Sign ()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) -Methode des [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) -Objekts und die CreateSignature-Methode der [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) die Auflistung wird ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-169">The [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) event for the selected data represented by the [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object is raised, and the [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) method of [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object and the [CreateSignature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) method of the [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) collection are executed.</span></span> 
    
4. <span data-ttu-id="4b5ac-170">Alle optionalen benutzerdefinierten Aktionen werden ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-170">Any optional custom actions are executed.</span></span>
    
5. <span data-ttu-id="4b5ac-171">Die [Sign ()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) -Methode des [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) -Objekts wird ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-171">The [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) method of the [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) object is executed.</span></span> 
    
6. <span data-ttu-id="4b5ac-172">Das Dialogfeld **Signieren** wird zum Eingeben eines Namens (oder Auswählen eines Signaturbildes), zum Auswählen eines Zertifikats für die Signierung und zum Eingeben von Kommentaren angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-172">The **Sign** dialog box is displayed for typing a name (or selecting a signature image), selecting a certificate to sign with, and to enter comments.</span></span> 
    
7. <span data-ttu-id="4b5ac-173">Wenn auf die Schaltfläche **Signieren** geklickt wird, wird die Signatur der Auflistung mit Signaturen für das Formular hinzugefügt, und die Nichtabstreitbarkeitsinformationen werden mit der Signatur aufgezeichnet und gespeichert (dies kann später angezeigt werden, indem im Dialogfeld **Digitale Signaturen** auf **Signiertes Formular anzeigen** und dann auf **Siehe die zusätzlichen gesammelten Signierungsinformationen** geklickt wird).</span><span class="sxs-lookup"><span data-stu-id="4b5ac-173">When the **Sign** button is clicked, the signature is added to the collection of signatures for the form and the non-repudiation information is captured and saved with the signature (which can be viewed later by clicking **View Signed Form** on the **Digital Signatures** dialog box, and then clicking **See the additional signing information that was collected**).</span></span>
    
<span data-ttu-id="4b5ac-174">Im folgenden Beispiel wird die [Sign ()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) -Methode aufgerufen, wenn der Benutzer die ausgewählten Daten signiert und die Signatur mit einem Timestamp-Wert gegenzeichnet, der von einem vertrauenswürdigen Zeitstempeldienst abgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="4b5ac-174">The following example invokes the [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) method when the user signs the selected data and countersigns the signature with a timestamp value retrieved from a trusted timestamp service.</span></span> 
  
```cs
public void FormEvents_Sign(object sender, SignEventArgs e)
{
   // Add a new Signature object to the SignedDataBlockCollection.
   Signature thisSignature = 
      e.SignedDataBlock.Signatures.CreateSignature();
   // Write the XML digital signature block and compute hash
   // for signed data.
   thisSignature.Sign();
   // Countersign the signature with a trusted timestamp.
   // Get the XML node storing the signature block.
   XPathNavigator oNodeSig = thisSignature.SignatureBlockXmlNode;
   XPathNavigator oNodeSigValue = 
      oNodeSig.SelectSingleNode(
      ".//*[local-name(.)='signatureValue']");
   // Get timestamp from a trusted timestamp service (fictitious).
   MyTrustedTimeStampService s = new MyTrustedTimeStampService();
   string strVerifiedTimeStamp = s.AddTimeStamp(oNodeSigValue.Value);
   // Add the value returned from the timestamp service to the 
   // unsigned part of the signature block.
   XPathNavigator oNodeObj = 
      oNodeSig.SelectSingleNode(".//*[local-name(.)='Object']");
   XPathNavigator oNode = oNodeObj.Clone();
   oNode.SetValue(strVerifiedTimeStamp);
   oNodeObj.MoveToParent();
   oNodeObj.AppendChild(oNode);
   e.SignatureWizard = false;
}
```

```vb
Public Sub FormEvents_Sign(ByVal sender As Object, _
   ByVal e As SignEventArgs)
   ' Add a new Signature object to the SignedDataBlockCollection.
   Dim thisSignature As Signature = 
      e.SignedDataBlock.Signatures.CreateSignature
   ' Write the XML digital signature block and compute hash
   ' for signed data.
   thisSignature.Sign()
   ' Countersign the signature with a trusted timestamp.
   ' Get the XML node storing the signature block
   Dim oNodeSig As XPathNavigator  = _
      thisSignature.SignatureBlockXmlNode
   Dim oNodeSigValue As XPathNavigator  = _
      oNodeSig.SelectSingleNode(_
      ".//*[local-name(.)='signatureValue']")
   ' Get timestamp from a trusted timestamp service (fictitious).
   Dim s As MyTrustedTimeStampService = New MyTrustedTimeStampService()
   Dim strVerifiedTimeStamp As String  = _
      s.AddTimeStamp(oNodeSigValue.Value)
   ' Add the value returned from the timestamp service to the 
   ' unsigned part of the signature block.
   Dim oNodeObj As XPathNavigator  = 
      oNodeSig.SelectSingleNode(".//*[local-name(.)='Object']")
   Dim oNode As XPathNavigator  = oNodeObj.Clone()
   oNode.SetValue(strVerifiedTimeStamp)
   oNodeObj.MoveToParent()
   oNodeObj.AppendChild(oNode)
   e.SignatureWizard = False
```


