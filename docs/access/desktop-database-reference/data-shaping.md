---
title: Datenstrukturierung (Access PC-Datenbank-Referenz)
TOCTitle: Data shaping
ms:assetid: 650571cc-6874-2cdb-dd76-0804d1cc4e38
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249390(v=office.15)
ms:contentKeyID: 48545305
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: ad507ac8c963f1d6ead7bc3bf444e694d83f90e3
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: Auto
ms.contentlocale: de-DE
ms.lasthandoff: 01/17/2019
ms.locfileid: "28716810"
---
# <a name="data-shaping"></a><span data-ttu-id="c4d79-102">Datenmodellierung</span><span class="sxs-lookup"><span data-stu-id="c4d79-102">Data shaping</span></span>

<span data-ttu-id="c4d79-103">**Betrifft**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="c4d79-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="c4d79-104">Mithilfe der Datenstrukturierung können Sie die Spalten eines strukturierten **Recordset** -Objekts, die Beziehungen zwischen den von den Spalten dargestellten Entitäten und die Art und Weise, in der das **Recordset** -Objekt mit Daten aufgefüllt wird, definieren.</span><span class="sxs-lookup"><span data-stu-id="c4d79-104">Data shaping enables you to define the columns of a shaped **Recordset**, the relationships between the entities represented by the columns, and the manner in which the **Recordset** is populated with data.</span></span>

<span data-ttu-id="c4d79-105">Spalten eines strukturierten **Recordset** -Objekts können Daten von einem Datenprovider wie Microsoft SQL Server, Verweise auf andere **Recordset** -Objekte oder Werte enthalten, die aus einer Berechnung in einer Zeile eines **Recordset** -Objekts oder die aus einem für eine Spalte eines vollständigen **Recordset** -Objekts ausgeführten Vorgangs abgeleitetet sind. Sie können aber auch eine neu erstellte, leere Spalte sein.</span><span class="sxs-lookup"><span data-stu-id="c4d79-105">Columns of a shaped **Recordset** may contain data from a data provider such as Microsoft SQL Server, references to another **Recordset**, values derived from a calculation on a single row of a **Recordset**, values derived from an operation over a column of an entire **Recordset**; or they may be a newly fabricated, empty column.</span></span>

<span data-ttu-id="c4d79-p101">Wenn Sie den Wert einer Spalte abrufen, die einen Verweis auf ein anderes **Recordset**-Objekt enthält, wird von ADO (ActiveX Data Objects) automatisch das eigentliche **Recordset**-Objekt zurückgegeben, für das der Verweis steht. Ein **Recordset**-Objekt, das ein anderes **Recordset**-Objekt enthält, wird als hierarchisches Recordset bezeichnet. Hierarchische Recordsets weisen eine Beziehung der *Über- und Unterordnung* auf, in der das *übergeordnete Recordset* das *untergeordnete Recordset* enthält. Der Verweis auf ein **Recordset**-Objekt ist eigentlich ein Verweis auf eine Teilmenge des untergeordneten Recordsets, die als *Kapitel* bezeichnet wird. Ein einzelnes übergeordnetes Recordset kann auf mehrere untergeordnete **Recordset**-Objekte verweisen.</span><span class="sxs-lookup"><span data-stu-id="c4d79-p101">When you retrieve the value of a column that contains a reference to another **Recordset**, ADO automatically returns the actual **Recordset** represented by the reference. A **Recordset** that contains another **Recordset** is called a hierarchical recordset. Hierarchical recordsets exhibit a *parent-child* relationship, in which the *parent* is the containing recordset and the *child* is the contained recordset. The reference to a **Recordset** is actually a reference to a subset of the child, called a *chapter*. A single parent may reference more than one child **Recordset**.</span></span>

<span data-ttu-id="c4d79-p102">Durch die Syntax des Strukturierungsbefehls können Sie programmgesteuert ein strukturiertes **Recordset** -Objekt erstellen. Dann können Sie programmgesteuert oder durch geeignete visuelle Steuerelemente auf Komponenten des **Recordset** -Objekts zugreifen. Ein Strukturierungsbefehl wird wie alle anderen ADO-Befehlstexte ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="c4d79-p102">The shape command syntax enables you to programmatically create a shaped **Recordset**. You can then access the components of the **Recordset** programmatically or through an appropriate visual control. A shape command is issued like any other ADO command text.</span></span>

<span data-ttu-id="c4d79-p103">Mit der Syntax des Strukturierungsbefehls können Sie auf zwei Methoden hierarchische **Recordset** -Objekte erstellen. Bei der ersten Methode wird ein untergeordnetes **Recordset** -Objekt an ein übergeordnetes **Recordset** -Objekt angefügt. Das übergeordnete und das untergeordnete Recordset weisen üblicherweise zumindest eine gemeinsame Spalte auf: der Wert der Spalte in einer Zeile des übergeordneten Recordsets ist identisch mit dem Wert der Spalte in allen Zeilen des untergeordneten Recordsets.</span><span class="sxs-lookup"><span data-stu-id="c4d79-p103">You can make hierarchical **Recordset** objects in two ways with the shape command syntax. The first appends a child **Recordset** to a parent **Recordset**. The parent and child typically have at least one column in common: the value of the column in a row of the parent is the same as the value of the column in all rows of the child.</span></span>

<span data-ttu-id="c4d79-p104">Bei der zweiten Methode wird ein übergeordnetes Recordset-Objekt aus einem untergeordneten Recordset-Objekt generiert. Die Datensätze im untergeordneten Recordset-Objekt werden gruppiert (normalerweise mit der BY-Klausel), und für jede resultierende Gruppe im untergeordneten Recordset wird dem übergeordneten Recordset-Objekt eine Zeile hinzugefügt. Wird die BY-Klausel ausgelassen, bildet das untergeordnete Recordset-Objekt eine einzelne Gruppe, und das übergeordnete Recordset-Objekt enthält genau eine Zeile. Dies ist nützlich zum Berechnen von Gesamtsummenaggregaten für das vollständige untergeordnete Recordset-Objekt.</span><span class="sxs-lookup"><span data-stu-id="c4d79-p104">The second way generates a parent **Recordset** from a child **Recordset**. The records in the child **Recordset** are grouped, typically using the BY clause, and one row is added to the parent **Recordset** for each resulting group in the child. If the BY clause is omitted, the child **Recordset** will form a single group and the parent **Recordset** will contain exactly one row. This is useful for computing "grand total" aggregates over the entire child **Recordset**.</span></span>

<span data-ttu-id="c4d79-p105">Unabhängig davon, wie das übergeordnete **Recordset** -Objekt gebildet wird, enthält es eine Kapitelspalte, mit der es einem untergeordneten **Recordset** -Objekt zugeordnet werden kann. Bei Bedarf kann das übergeordnete **Recordset** -Objekt auch Spalten aufweisen, die Aggregate (SUM, MIN, MAX usw.) für die Zeilen des untergeordneten Objekts enthalten. Übergeordnete und untergeordnete **Recordset** -Objekte können Spalten aufweisen, die einen Ausdruck in der Zeile im **Recordset** -Objekt enthalten. Zudem können Sie Spalten aufweisen, die neu und zunächst leer sind.</span><span class="sxs-lookup"><span data-stu-id="c4d79-p105">Regardless of which way the parent **Recordset** is formed, it will contain a chapter column that is used to relate it to a child **Recordset**. If you wish, the parent **Recordset** may also have columns that contain aggregates (SUM, MIN, MAX, and so on) over the child rows. Both the parent and the child **Recordset** may have columns which contain an expression on the row in the **Recordset**, as well as columns which are new and initially empty.</span></span>

<span data-ttu-id="c4d79-124">Sie können hierarchische **Recordset** -Objekte in einer beliebigen Tiefe schachteln (d. h., Sie können untergeordnete **Recordset** -Objekte von untergeordneten **Recordset** -Objekten erstellen usw.).</span><span class="sxs-lookup"><span data-stu-id="c4d79-124">You can nest hierarchical **Recordset** objects to any depth (that is, create child **Recordset** objects of child **Recordset** objects, and so on).</span></span>

<span data-ttu-id="c4d79-125">Sie können programmgesteuert oder durch geeignete visuelle Steuerelemente auf **Recordset** -Komponenten des strukturierten **Recordset** -Objekts zugreifen.</span><span class="sxs-lookup"><span data-stu-id="c4d79-125">You can access the **Recordset** components of the shaped **Recordset** programmatically or through an appropriate visual control.</span></span>

<span data-ttu-id="c4d79-126">Beispiele für Strukturierungsbefehle und die daraus resultierenden Hierarchien finden Sie unter "Using the Data Shaping Service for OLE DB: A Closer Look".</span><span class="sxs-lookup"><span data-stu-id="c4d79-126">For examples of shape commands and their resulting hierarchies, see Using the Data Shaping Service for OLE DB: A Closer Look.</span></span>

<span data-ttu-id="c4d79-127">Dieser Abschnitt enthält die folgenden Themen:</span><span class="sxs-lookup"><span data-stu-id="c4d79-127">This section includes the following topics:</span></span>

- [<span data-ttu-id="c4d79-128">Umstrukturierung</span><span class="sxs-lookup"><span data-stu-id="c4d79-128">Reshaping</span></span>](reshaping.md)
- [<span data-ttu-id="c4d79-129">Untergeordnete Aggregate</span><span class="sxs-lookup"><span data-stu-id="c4d79-129">Grandchild aggregates</span></span>](grandchild-aggregates.md)
- [<span data-ttu-id="c4d79-130">Parametrisierte Befehle mit dazwischenliegenden COMPUTE-Befehlen</span><span class="sxs-lookup"><span data-stu-id="c4d79-130">Parameterized commands with intervening COMPUTE commands</span></span>](parameterized-commands-with-intervening-compute-commands.md)
- [<span data-ttu-id="c4d79-131">Speichern hierarchischer Recordsets</span><span class="sxs-lookup"><span data-stu-id="c4d79-131">Persisting hierarchical Recordsets</span></span>](persisting-hierarchical-recordsets.md)
