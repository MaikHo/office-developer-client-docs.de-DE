---
title: Speichern von Datensätzen im XML-Format
TOCTitle: Persisting Records in XML Format
ms:assetid: 8071e244-60c7-759c-094c-152add5d72e4
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249545(v=office.15)
ms:contentKeyID: 48545924
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 4b1e22c3f85c4289520326c34c6d0c218a442a3f
ms.sourcegitcommit: 19aca09c5812cfb98b68b5d4604dcaa814479df7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/09/2018
ms.locfileid: "25474501"
---
# <a name="persisting-records-in-xml-format"></a><span data-ttu-id="19a4a-102">Speichern von Datensätzen im XML-Format</span><span class="sxs-lookup"><span data-stu-id="19a4a-102">Persisting Records in XML Format</span></span>


<span data-ttu-id="19a4a-103">**Betrifft**: Access 2013 | Office 2013</span><span class="sxs-lookup"><span data-stu-id="19a4a-103">**Applies to**: Access 2013 | Office 2013</span></span>

<span data-ttu-id="19a4a-p101">Das Speichern von Recordset-Objekten im XML-Format wird wie beim ADTG-Format mit dem Microsoft OLE DB-Anbieter für Persistenz implementiert. Dieser Provider generiert ein schreibgeschütztes Vorwärtsrowset von einer gespeicherten XML-Datei oder einem gespeicherten XML-Datenstrom, die bzw. der die von ADO generierten Schemainformationen enthält. Entsprechend kann damit ein Recordset-Objekt von ADO verwendet, XML generiert sowie in einer Datei oder einem beliebigen Objekt gespeichert werden, das die COM-Schnittstelle IStream implementiert. (Eine Datei ist lediglich ein weiteres Beispiel für ein Objekt, das IStream unterstützt.) Für die Versionen 2.5 und höher verwendet ADO den Microsoft XML Parser (MSXML), um den XML-Code in das Recordset-Objekt zu laden. Deshalb ist msxml.dll erforderlich. Für Version 2.5 wurde MSXML mit Internet Explorer 5 ausgeliefert. Für Version 2.6 wurde MSXML mit SQL Server 2000 ausgeliefert.</span><span class="sxs-lookup"><span data-stu-id="19a4a-p101">Like ADTG format, **Recordset** persistence in XML format is implemented with the Microsoft OLE DB Persistence Provider. This provider generates a forward-only, read-only rowset from a saved XML file or stream that contains the schema information generated by ADO. Similarly, it can take an ADO **Recordset**, generate XML, and save it to a file or any object that implements the COM **IStream** interface. (In fact, a file is just another example of an object that supports **IStream**.) For versions 2.5 and later, ADO relies on the Microsoft XML Parser (MSXML) to load the XML into the **Recordset**; therefore msxml.dll is required. For version 2.5, MSXML shipped with Internet Explorer 5. For version 2.6, MSXML shipped with SQL Server 2000.</span></span>


> [!NOTE]
> <P><span data-ttu-id="19a4a-p102">[!HINWEIS] Beim Speichern hierarchischer <STRONG>Recordset</STRONG> -Objekte (Datenstrukturen) im XML-Format gelten einige Einschränkungen. Das Speichern im XML-Format ist nicht möglich, wenn das hierarchische <STRONG>Recordset</STRONG> -Objekt ausstehende Aktualisierungen aufweist. Außerdem kann ein parametrisiertes hierarchisches <STRONG>Recordset</STRONG> -Objekt nicht gespeichert werden. Weitere Informationen finden Sie unter <A href="hierarchical-recordsets-in-xml.md">Hierarchische Recordset-Objekte in XML</A>.</span><span class="sxs-lookup"><span data-stu-id="19a4a-p102">Some limitations apply when saving hierarchical <STRONG>Recordsets</STRONG> (data shapes) to XML format. You cannot save to XML if the hierarchical <STRONG>Recordset</STRONG> contains pending updates, and you cannot save a parameterized hierarchical <STRONG>Recordset</STRONG>. For more information, see <A href="hierarchical-recordsets-in-xml.md">Hierarchical Recordsets in XML</A>.</span></span></P>



<span data-ttu-id="19a4a-p103">Die Save-Methode bzw. die Open-Methode sind die einfachste Möglichkeit, um Daten im XML-Format zu speichern und über ADO erneut zu laden. Das folgende ADO-Codebeispiel veranschaulicht, wie die Daten in der Titles-Tabelle in der Datei titles.sav gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="19a4a-p103">The easiest way to persist data into XML and load it back again through ADO is with the **Save** and **Open** methods, respectively. The following ADO code example demonstrates saving the data in the Titles table to a file named titles.sav.</span></span>

```vb 
 
Dim rs as new Recordset 
Dim rs2 as new Recordset 
Dim c as new Connection 
Dim s as new Stream 
 
' Query the Titles table. 
c.Open "provider='sqloledb';data source='mydb';initial catalog='pubs';Integrated Security='SSPI'" 
rs.cursorlocation = adUseClient 
rs.Open "select * from titles", c, adOpenStatic 
 
' Save to the file in the XML format. Note that if you don't specify 
' adPersistXML, a binary format (ADTG) will be used by default. 
rs.Save "titles.sav", adPersistXML 
 
' Save the Recordset into the ADO Stream object. 
rs.save s, adPersistXML 
rs.Close 
c.Close 
 
set rs = nothing 
 
Reopen the file. 
rs.Open "titles.sav",,,,adCmdFile 
'Open the Stream back into a Recordset. 
rs2.open s 
```

<span data-ttu-id="19a4a-115">ADO speichert stets das gesamte **Recordset** -Objekt.</span><span class="sxs-lookup"><span data-stu-id="19a4a-115">ADO always persists the entire **Recordset** object.</span></span> <span data-ttu-id="19a4a-116">Wenn Sie nur eine Teilmenge der Zeilen des **Recordset** -Objekts beibehalten möchten, verwenden Sie die **Filter** -Methode die Zeilen Identitätswerte oder Ändern Ihrer Auswahlklausel.</span><span class="sxs-lookup"><span data-stu-id="19a4a-116">If you wish to only persist a subset of rows of the **Recordset** object, use the **Filter** method to narrow down the rows or change your selection clause.</span></span> <span data-ttu-id="19a4a-117">Sie müssen jedoch ein **Recordset** -Objekt mit einem clientseitige Cursor öffnen (**CursorLocation** = **AdUseClient**) mit der **Filter** -Methode zum Speichern einer Teilmenge von Zeilen.</span><span class="sxs-lookup"><span data-stu-id="19a4a-117">However, you must open a **Recordset** object with a client-side cursor (**CursorLocation** = **adUseClient**) to use the **Filter** method for saving a subset of rows.</span></span> <span data-ttu-id="19a4a-118">Um Titel abzurufen, die mit dem Buchstaben "b" beginnen, können Sie beispielsweise einen Filter auf ein geöffnetes **Recordset** -Objekt anwenden:</span><span class="sxs-lookup"><span data-stu-id="19a4a-118">For example, to retrieve titles that start with the letter "b," you can apply a filter to an open **Recordset** object:</span></span>

```vb 
 
rs.Filter "title_id like 'B*'" 
rs.Save "btitles.sav", adPersistXML 
```

<span data-ttu-id="19a4a-119">ADO verwendet stets das Client Cursor Engine-Rowset, um neben den vom Anbieter für Persistenz generierten Vorwärtscursordaten ein **Recordset** -Objekt zu erstellen, für das der Fensterinhalt verschoben und Lesezeichen festgelegt werden können.</span><span class="sxs-lookup"><span data-stu-id="19a4a-119">ADO always uses the Client Cursor Engine rowset to produce a scrollable, bookmarkable **Recordset** object on top of the forward-only data generated by the Persistence Provider.</span></span>

