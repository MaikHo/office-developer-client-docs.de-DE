---
title: Save-Methode-ActiveX Data Objects (ADO)
TOCTitle: Save method (ADO)
ms:assetid: 02dab13b-f947-b96d-46ea-0def3ed8f28f
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248793(v=office.15)
ms:contentKeyID: 48542968
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 0a3762c3d4fdb8cc833259b0435b225690d677ce
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32308918"
---
# <a name="save-method-ado"></a><span data-ttu-id="ebcba-102">Save-Methode (ADO)</span><span class="sxs-lookup"><span data-stu-id="ebcba-102">Save method (ADO)</span></span>

<span data-ttu-id="ebcba-103">**Gilt für**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="ebcba-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="ebcba-104">Speichert das [Recordset](recordset-object-ado.md)-Objekt in einer Datei oder in einem [Stream](stream-object-ado.md)-Objekt.</span><span class="sxs-lookup"><span data-stu-id="ebcba-104">Saves the [Recordset](recordset-object-ado.md) in a file or [Stream](stream-object-ado.md) object.</span></span>

## <a name="syntax"></a><span data-ttu-id="ebcba-105">Syntax</span><span class="sxs-lookup"><span data-stu-id="ebcba-105">Syntax</span></span>

<span data-ttu-id="ebcba-106">*Recordset*. *Ziel*speichern, *PersistFormat*</span><span class="sxs-lookup"><span data-stu-id="ebcba-106">*recordset*.Save*Destination*, *PersistFormat*</span></span>

## <a name="parameters"></a><span data-ttu-id="ebcba-107">Parameter</span><span class="sxs-lookup"><span data-stu-id="ebcba-107">Parameters</span></span>

|<span data-ttu-id="ebcba-108">Parameter</span><span class="sxs-lookup"><span data-stu-id="ebcba-108">Parameter</span></span>|<span data-ttu-id="ebcba-109">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="ebcba-109">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="ebcba-110">*Destination*</span><span class="sxs-lookup"><span data-stu-id="ebcba-110">*Destination*</span></span> |<span data-ttu-id="ebcba-p101">Optional. Ein **Variant** -Wert, der den vollständigen Namen des Pfads, unter dem das **Recordset** -Objekt gespeichert werden soll, oder einen Verweis auf ein **Stream** -Objekt darstellt.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p101">Optional. A **Variant** that represents the complete path name of the file where the **Recordset** is to be saved, or a reference to a **Stream** object.</span></span>|
|<span data-ttu-id="ebcba-113">*PersistFormat*</span><span class="sxs-lookup"><span data-stu-id="ebcba-113">*PersistFormat*</span></span> |<span data-ttu-id="ebcba-p102">Optional. Ein [PersistFormatEnum](persistformatenum.md)-Wert, der das Format angibt, in dem das **Recordset** -Objekt gespeichert werden soll (XML oder ADTG). Der Standardwert lautet **adPersistADTG**.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p102">Optional. A [PersistFormatEnum](persistformatenum.md) value that specifies the format in which the **Recordset** is to be saved (XML or ADTG). The default value is **adPersistADTG**.</span></span>|

## <a name="remarks"></a><span data-ttu-id="ebcba-117">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="ebcba-117">Remarks</span></span>

<span data-ttu-id="ebcba-p103">Die **Save**-Methode kann nur für ein offenes **Recordset**-Objekt aufgerufen werden. Verwenden Sie die [Open](open-method-ado-recordset.md)-Methode, um das **Recordset**-Objekt zu einem späteren Zeitpunkt von der *Destination* wiederherzustellen.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p103">The **Save** method can only be invoked on an open **Recordset**. Use the [Open](open-method-ado-recordset.md) method to later restore the **Recordset** from *Destination*.</span></span>

<span data-ttu-id="ebcba-p104">If the [Filter](filter-property-ado.md) property is in effect for the **Recordset**, then only the rows accessible under the filter are saved. If the **Recordset** is hierarchical, then the current child **Recordset** and its children are saved, including the parent **Recordset**. If the **Save** method of a child **Recordset** is called, the child and all its children are saved, but the parent is not.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p104">If the [Filter](filter-property-ado.md) property is in effect for the **Recordset**, then only the rows accessible under the filter are saved. If the **Recordset** is hierarchical, then the current child **Recordset** and its children are saved, including the parent **Recordset**. If the **Save** method of a child **Recordset** is called, the child and all its children are saved, but the parent is not.</span></span>

<span data-ttu-id="ebcba-p105">Wenn Sie das **Recordset**-Objekt das erste Mal speichern, können Sie optional das *Ziel* angeben. Wenn Sie das *Ziel* auslassen, wird eine neue Datei erstellt, deren Namen auf den Wert der [Source](source-property-ado-recordset.md)-Eigenschaft des **Recordset**-Objekts festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p105">The first time you save the **Recordset**, it is optional to specify *Destination*. If you omit *Destination*, a new file will be created with a name set to the value of the [Source](source-property-ado-recordset.md) property of the **Recordset**.</span></span>

<span data-ttu-id="ebcba-p106">Geben Sie die *Destination* nicht an, wenn Sie nach dem ersten Speichern **Save** aufrufen, andernfalls tritt ein Fehler auf. Wenn Sie nach dem Speichern **Save** mit einer neuen *Destination* aufrufen, wird das **Recordset**-Objekt an diesem neuen Ziel gespeichert. Das neue und das ursprüngliche Ziel sind jedoch beide offen.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p106">Omit *Destination* when you subsequently call **Save** after the first save, or a run-time error will occur. If you subsequently call **Save** with a new *Destination*, the **Recordset** is saved to the new destination. However, the new destination and the original destination will both be open.</span></span>

<span data-ttu-id="ebcba-p107">**Save** schließt das **Recordset**-Objekt oder die *Destination* nicht. Daher können Sie weiterhin mit dem **Recordset**-Objekt arbeiten und Ihre aktuellsten Änderungen speichern. *Destination* bleibt offen, bis das **Recordset**-Objekt geschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p107">**Save** does not close the **Recordset** or *Destination*, so you can continue to work with the **Recordset** and save your most recent changes. *Destination* remains open until the **Recordset** is closed.</span></span>

<span data-ttu-id="ebcba-p108">For reasons of security, the **Save** method permits only the use of low and custom security settings from a script executed by Microsoft Internet Explorer. For a more detailed explanation of security issues, see "ADO and RDS Security Issues in Microsoft Internet Explorer" under ActiveX Data Objects (ADO) Technical Articles in Microsoft Data Access Technical Articles.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p108">For reasons of security, the **Save** method permits only the use of low and custom security settings from a script executed by Microsoft Internet Explorer. For a more detailed explanation of security issues, see "ADO and RDS Security Issues in Microsoft Internet Explorer" under ActiveX Data Objects (ADO) Technical Articles in Microsoft Data Access Technical Articles.</span></span>

<span data-ttu-id="ebcba-132">Wenn die **Save** -Methode während eines asynchronen Abruf-, Ausführungs- oder Aktualisierungsvorgangs des **Recordset** -Objekts aufgerufen wird, wartet die **Save** -Methode, bis der asynchrone Vorgang abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="ebcba-132">If the **Save** method is called while an asynchronous **Recordset** fetch, execute, or update operation is in progress, then **Save** waits until the asynchronous operation is complete.</span></span>

<span data-ttu-id="ebcba-p109">Datensätze werden beginnend bei der ersten Zeile des **Recordset** -Objekts gespeichert. Wenn die **Save** -Methode abgeschlossen ist, wird die aktuelle Zeilenposition an die erste Zeile des **Recordset** -Objekts verschoben.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p109">Records are saved beginning with the first row of the **Recordset**. When the **Save** method is finished, the current row position is moved to the first row of the **Recordset**.</span></span>

<span data-ttu-id="ebcba-p110">Legen Sie die [CursorLocation](cursorlocation-property-ado.md)-Eigenschaft mithilfe von **Save** auf **adUseClient** fest, um optimale Ergebnisse zu erzielen. Wenn Ihr Anbieter nicht die gesamte zum Speichern von **Recordset** -Objekten erforderliche Funktionalität unterstützt, bietet der Cursordienst diese Funktionalität.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p110">For best results, set the [CursorLocation](cursorlocation-property-ado.md) property to **adUseClient** with **Save**. If your provider does not support all of the functionality necessary to save **Recordset** objects, the Cursor Service will provide that functionality.</span></span>

<span data-ttu-id="ebcba-p111">Wenn ein **Recordset** -Objekt mit der auf **adUseServer** festgelegten **CursorLocation** -Eigenschaft gespeichert wird, ist die Aktualisierungsfunktion für das **Recordset** -Objekt beschränkt. Je nach der Funktionalität des Anbieters ist in der Regel ist nur das Aktualisieren, Einfügen und Löschen einer einzelnen Tabelle zulässig. Die [Resync](resync-method-ado.md)-Methode ist bei dieser Konfiguration ebenfalls nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p111">When a **Recordset** is persisted with the **CursorLocation** property set to **adUseServer**, the update capability for the **Recordset** is limited. Typically, only single-table updates, insertions, and deletions are allowed (dependant upon provider functionality). The [Resync](resync-method-ado.md) method is also unavailable in this configuration.</span></span>

> [!NOTE]
> <span data-ttu-id="ebcba-140">[!HINWEIS] Das Speichern eines **Recordset** -Objekt mit **Fields** vom Typ **adVariant**, **adIDispatch** oder **adIUnknown** wird von ADO nicht unterstützt und kann zu unvorhersehbaren Ergebnissen führen.</span><span class="sxs-lookup"><span data-stu-id="ebcba-140">Saving a **Recordset** with **Fields** of type **adVariant**, **adIDispatch**, or **adIUnknown** is not supported by ADO and can cause unpredictable results.</span></span>

<span data-ttu-id="ebcba-141">Nur **Filter** in Form von Kriterien-Zeichenfolgen (z. \> b. OrderDate "12/31/1999") wirken sich auf den Inhalt eines beibehaltenen **Recordsets**aus.</span><span class="sxs-lookup"><span data-stu-id="ebcba-141">Only **Filters** in the form of Criteria Strings (e.g. OrderDate \> '12/31/1999') affect the contents of a persisted **Recordset**.</span></span> <span data-ttu-id="ebcba-142">Filter, die mit einem Array mit **Bookmarks** oder mithilfe eines Werts aus **FilterGroupEnum** erstellt wurden, wirken sich nicht auf den Inhalt des gespeicherten **Recordset**-Objekts aus.</span><span class="sxs-lookup"><span data-stu-id="ebcba-142">Filters created with an Array of **Bookmarks** or using a value from the **FilterGroupEnum** will not affect the contents of the persisted **Recordset**.</span></span> <span data-ttu-id="ebcba-143">Diese Regeln werden auf **Recordset**-Objekte angewendet, die mit einem clientseitigen oder einem serverseitigen Cursor erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="ebcba-143">These rules apply to **Recordsets** created with either client-side or server-side cursors.</span></span>

<span data-ttu-id="ebcba-p113">Da der *Destination*-Parameter alle Objekte akzeptiert, die die OLE DB IStream-Schnittstelle unterstützen, können Sie ein **Recordset**-Objekt direkt im ASP Response-Objekt speichern. Weitere Einzelheiten finden Sie unter [Speicherszenario für XML-Recordset](xml-recordset-persistence-scenario.md).</span><span class="sxs-lookup"><span data-stu-id="ebcba-p113">Because the *Destination* parameter can accept any object that supports the OLE DB IStream interface, you can save a **Recordset** directly to the ASP Response object. For more details, please see the [XML Recordset Persistence Scenario](xml-recordset-persistence-scenario.md).</span></span>

<span data-ttu-id="ebcba-146">Sie können ein **Recordset** -Objekt im XML-Format auch in einer Instanz eines MSXML DOM-Objekts speichern. Dies wird im folgenden Visual Basic-Code dargestellt:</span><span class="sxs-lookup"><span data-stu-id="ebcba-146">You can also save a **Recordset** in XML format to an instance of an MSXML DOM object, as is shown in the following Visual Basic code:</span></span>

> [!NOTE]
> <span data-ttu-id="ebcba-p114">[!HINWEIS] Beim Speichern hierarchischer **Recordset** -Objekte (Datenformen) im XML-Format gelten zwei Einschränkungen. Wenn das hierarchische **Recordset** -Objekt ausstehende Aktualisierungen enthält, können Sie dieses nicht im XML-Format speichern. Ein parametrisiertes, hierarchisches **Recordset** -Objekt kann auch nicht gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p114">Two limitations apply when saving hierarchical **Recordsets** (data shapes) in XML format. You cannot save into XML if the hierarchical **Recordset** contains pending updates, and you cannot save a parameterized hierarchical **Recordset**.</span></span>

<span data-ttu-id="ebcba-p115">A Recordset saved in XML format is saved using UTF-8 format. When such a file is loaded into an ADO Stream, the Stream object will not attempt to open a Recordset from the stream unless the Charset property of the stream is set to the appropriate value for UTF-8 format.</span><span class="sxs-lookup"><span data-stu-id="ebcba-p115">A Recordset saved in XML format is saved using UTF-8 format. When such a file is loaded into an ADO Stream, the Stream object will not attempt to open a Recordset from the stream unless the Charset property of the stream is set to the appropriate value for UTF-8 format.</span></span>

