---
title: HelloData Details (Access Desktop Database Reference)
TOCTitle: HelloData details
ms:assetid: db51e15c-1b5b-c64a-2f84-34dd0e78c6cf
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250105(v=office.15)
ms:contentKeyID: 48548103
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 78b04b74d4e2b8d9c215235d6e7ccebed4fa2ef2
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291999"
---
# <a name="hellodata-details"></a><span data-ttu-id="f7dfb-102">HelloData-Details</span><span class="sxs-lookup"><span data-stu-id="f7dfb-102">HelloData details</span></span>


<span data-ttu-id="f7dfb-103">**Gilt für**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="f7dfb-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="f7dfb-p101">The HelloData application steps through the basic operations of a typical ADO application: getting, examining, editing, and updating data. When you start the application, click the first button, **Get Data**. This will run the GetData() subroutine.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p101">The HelloData application steps through the basic operations of a typical ADO application: getting, examining, editing, and updating data. When you start the application, click the first button, **Get Data**. This will run the GetData() subroutine.</span></span>

## <a name="getdata"></a><span data-ttu-id="f7dfb-107">GetData</span><span class="sxs-lookup"><span data-stu-id="f7dfb-107">GetData</span></span>

<span data-ttu-id="f7dfb-108">GetData platziert eine gültige Verbindungszeichenfolge in eine Variable auf Modulebene, *m\_sConnStr*.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-108">GetData places a valid connection string into a module-level variable, *m\_sConnStr*.</span></span> <span data-ttu-id="f7dfb-109">For more information about connection strings, see [Creating the Connection String](creating-the-connection-string.md).</span><span class="sxs-lookup"><span data-stu-id="f7dfb-109">For more information about connection strings, see [Creating the Connection String](creating-the-connection-string.md).</span></span>

<span data-ttu-id="f7dfb-p103">Weisen Sie eine Fehlerbehandlungsroutine mithilfe der Visual Basic-Anweisung **OnError** zu. Weitere Informationen zur Fehlerbehandlung in ADO finden Sie in [Kapitel 6: Fehlerbehandlung](chapter-6-error-handling.md). Ein neues **Connection**-Objekt wird erstellt, und die **CursorLocation**-Eigenschaft wird auf **adUseClient** festgelegt, da mit dem HelloData-Beispiel eine *getrennte Datensatzgruppe* erstellt wird. Das bedeutet, dass die physikalische Verbindung nach dem Abrufen der Daten aus der Datenquelle unterbrochen wird. Sie können jedoch weiterhin mit den Daten arbeiten, da diese lokal im **Recordset**-Objekt zwischengespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p103">Assign an error handler using a Visual Basic **OnError** statement. For more information about error handling in ADO, see [Chapter 6: Error Handling](chapter-6-error-handling.md). A new **Connection** object is created, and the **CursorLocation** property is set to **adUseClient** because the HelloData example creates a *disconnected Recordset*. This means that once the data has been fetched from the data source, the physical connection with the data source is broken, but you can still work with the data that is cached locally in your **Recordset** object.</span></span>

<span data-ttu-id="f7dfb-114">Weisen Sie nach dem Öffnen der Verbindung einer Variablen (sSQL) eine SQL-Zeichenfolge zu.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-114">After the connection has been opened, assign a SQL string to a variable (sSQL).</span></span> <span data-ttu-id="f7dfb-115">Instanziieren Sie dann ein neues **Recordset** -Objekt\_, m oRecordset1.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-115">Then instantiate a new **Recordset** object, m\_oRecordset1 .</span></span> <span data-ttu-id="f7dfb-116">Öffnen Sie in der nächsten Codezeile das **Recordset** -Objekt über die vorhandene **Verbindung**, und übergeben Sie es.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-116">In the next line of code, open the **Recordset** over the existing **Connection**, passing in .</span></span> <span data-ttu-id="f7dfb-117">Öffnen Sie in der nächsten Codezeile das **Recordset** -Objekt über die vorhandene **Verbindung**, und übergeben Sie SSQL als Quelle des **Recordset-Objekts**.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-117">In the next line of code, open the **Recordset** over the existing **Connection**, passing in sSQL as the source of the **Recordset**.</span></span> <span data-ttu-id="f7dfb-118">Sie unterstützen ADO bei der Bestimmung, dass die SQL-Zeichenfolge, die Sie als Quelle für das **Recordset** -Objekt übergeben haben, eine Textdefinition eines Befehls ist, indem Sie **adCmdText** im letzten Argument an die **Open** -Methode des **Recordset-Objekts** übergeben.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-118">You assist ADO in making the determination that the SQL string you have passed as the source for the **Recordset** is a textual definition of a command by passing **adCmdText** in the final argument to the **Recordset** **Open** method.</span></span> <span data-ttu-id="f7dfb-119">In dieser Position werden auch die mit dem **Recordset**verknüpften **LockType** -und **CursorType** -Datensätze festgelegt.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-119">This line also sets the **LockType** and **CursorType** associated with the **Recordset**.</span></span>

<span data-ttu-id="f7dfb-120">Mit der nächsten Codezeile wird die **MarshalOptions** -Eigenschaft mit **adMarshalModifiedOnly** gleichgesetzt.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-120">The next line of code sets the **MarshalOptions** property equal to **adMarshalModifiedOnly**.</span></span> <span data-ttu-id="f7dfb-121">**MarshalOptions** gibt an, welche Datensätze auf die mittlere Ebene (oder den Webserver) gemarshallt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-121">**MarshalOptions** indicates which records should be marshaled to the middle tier (or web server).</span></span> <span data-ttu-id="f7dfb-122">Weitere Informationen zum Marshalling finden Sie in der Dokumentation zu COM.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-122">For more information about marshaling, see the COM documentation.</span></span> <span data-ttu-id="f7dfb-123">Bei Verwendung von **adMarshalModifiedOnly** mit einem clientseitigen Cursor ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**) werden nur Datensätze, die auf dem Client geändert wurden, in die mittlere Ebene zurückgeschrieben.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-123">When using **adMarshalModifiedOnly** with a client-side cursor ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), only records that have been modified on the client are written back to the middle tier.</span></span> <span data-ttu-id="f7dfb-124">Wenn **MarshalOptions** auf **adMarshalModifiedOnly** festgelegt wird, wird möglicherweise die Leistung verbessert, da weniger Zeilen gemarshallt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-124">Setting **MarshalOptions** to **adMarshalModifiedOnly** can improve performance because fewer rows are marshaled.</span></span>

<span data-ttu-id="f7dfb-p106">Trennen Sie anschließend das **Recordset** -Objekt, indem Sie die zugehörige **ActiveConnection** -Eigenschaft auf **Nothing** setzen. Weitere Informationen finden Sie unter [Trennen und Wiederherstellen der Verbindung für das Recordset-Objekt](disconnecting-and-reconnecting-the-recordset.md) in "Kapitel 5: Aktualisieren und Speichern von Daten".</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p106">Next, disconnect the **Recordset** by setting its **ActiveConnection** property equal to **Nothing**. For more information, see [Disconnecting and Reconnecting the Recordset](disconnecting-and-reconnecting-the-recordset.md) in Chapter 5: Updating and Persisting Data.</span></span>

<span data-ttu-id="f7dfb-127">Schließen Sie die Verbindung mit der Datenquelle, und löschen Sie das vorhandene **Connection** -Objekt. Damit geben Sie die von diesem Objekt belegten Ressourcen frei.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-127">Close the connection to the data source and destroy the existing **Connection** object, thereby releasing the resources it consumed.</span></span>

<span data-ttu-id="f7dfb-128">In einem letzten Schritt wird das **Recordset**-Objekt als **DataSource** für Microsoft DataBound-Rastersteuerelement auf dem Formular festgelegt, sodass die Daten aus dem **Recordset**-Objekt problemlos auf dem Formular angezeigt werden können.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-128">The final step is to set the **Recordset** as the **DataSource** for the Microsoft DataBound Grid Control on the form so that you can easily display the data from the **Recordset** on the form.</span></span>

<span data-ttu-id="f7dfb-p107">Click the second button, **Examine Data**. This runs the ExamineData subroutine.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p107">Click the second button, **Examine Data**. This runs the ExamineData subroutine.</span></span>

## <a name="examinedata"></a><span data-ttu-id="f7dfb-131">ExamineData</span><span class="sxs-lookup"><span data-stu-id="f7dfb-131">ExamineData</span></span>

<span data-ttu-id="f7dfb-132">ExamineData uses various methods and properties of the **Recordset** object to display information about the data in the **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-132">ExamineData uses various methods and properties of the **Recordset** object to display information about the data in the **Recordset**.</span></span> <span data-ttu-id="f7dfb-133">It reports the number of records by using the **RecordCount** property.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-133">It reports the number of records by using the **RecordCount** property.</span></span> <span data-ttu-id="f7dfb-134">It loops through the **Recordset** and prints the value of the **AbsolutePosition** property in the display text box on the form.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-134">It loops through the **Recordset** and prints the value of the **AbsolutePosition** property in the display text box on the form.</span></span> <span data-ttu-id="f7dfb-135">Auch in der Schleife wird der Wert der **Bookmark** -Eigenschaft für den dritten Datensatz in einer Variant-Variable, *vBookmark*, zur späteren Verwendung eingefügt.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-135">Also while in the loop, the value of the **Bookmark** property for the third record is placed into a variant variable, *vBookmark*, for later use.</span></span>

<span data-ttu-id="f7dfb-p109">The routine navigates directly back to the third record using the bookmark variable that it stored earlier. The routine calls the WalkFields subroutine, which loops through the **Fields** collection of the **Recordset** and displays details about each **Field** in the collection.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p109">The routine navigates directly back to the third record using the bookmark variable that it stored earlier. The routine calls the WalkFields subroutine, which loops through the **Fields** collection of the **Recordset** and displays details about each **Field** in the collection.</span></span>

<span data-ttu-id="f7dfb-p110">Finally, ExamineData uses the **Filter** property of the **Recordset** to screen for only those records with a CategoryId equal to 2. The result of applying this filter is immediately visible in the display grid on the form.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p110">Finally, ExamineData uses the **Filter** property of the **Recordset** to screen for only those records with a CategoryId equal to 2. The result of applying this filter is immediately visible in the display grid on the form.</span></span>

<span data-ttu-id="f7dfb-140">For more information about the functionality shown in the ExamineData subroutine, see [Chapter 3: Examining Data](chapter-3-examining-data.md).</span><span class="sxs-lookup"><span data-stu-id="f7dfb-140">For more information about the functionality shown in the ExamineData subroutine, see [Chapter 3: Examining Data](chapter-3-examining-data.md).</span></span>

<span data-ttu-id="f7dfb-p111">Next, click the third button, **Edit Data**. This will run the EditData subroutine.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p111">Next, click the third button, **Edit Data**. This will run the EditData subroutine.</span></span>

## <a name="editdata"></a><span data-ttu-id="f7dfb-143">EditData</span><span class="sxs-lookup"><span data-stu-id="f7dfb-143">EditData</span></span>

<span data-ttu-id="f7dfb-p112">When the code enters the EditData subroutine, the **Recordset** is still filtered on CategoryId equal to 2, so only those items that meet the filter criteria are visible. It first loops through the **Recordset** and increases the price of each visible item in the **Recordset** by 10 percent. The value of the **Price** field is changed by setting the **Value** property for that field equal to a new, valid amount.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p112">When the code enters the EditData subroutine, the **Recordset** is still filtered on CategoryId equal to 2, so only those items that meet the filter criteria are visible. It first loops through the **Recordset** and increases the price of each visible item in the **Recordset** by 10 percent. The value of the **Price** field is changed by setting the **Value** property for that field equal to a new, valid amount.</span></span>

<span data-ttu-id="f7dfb-p113">Remember that the **Recordset** is disconnected from the data source. The changes made in EditData are made only to the locally cached copy of the data. For more information, see [Chapter 4: Editing Data](chapter-4-editing-data.md).</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p113">Remember that the **Recordset** is disconnected from the data source. The changes made in EditData are made only to the locally cached copy of the data. For more information, see [Chapter 4: Editing Data](chapter-4-editing-data.md).</span></span>

<span data-ttu-id="f7dfb-p114">The changes will not be made on the data source until you click the fourth button, **Update Data**. This will run the UpdateData subroutine.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p114">The changes will not be made on the data source until you click the fourth button, **Update Data**. This will run the UpdateData subroutine.</span></span>

## <a name="updatedata"></a><span data-ttu-id="f7dfb-152">UpdateData</span><span class="sxs-lookup"><span data-stu-id="f7dfb-152">UpdateData</span></span>

<span data-ttu-id="f7dfb-153">UpdateData first removes the filter that has been applied to the **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-153">UpdateData first removes the filter that has been applied to the **Recordset**.</span></span> <span data-ttu-id="f7dfb-154">Der Code entfernt und setzt als **DataSource** für das Microsoft Bound-DataGrid auf dem Formular zurück, sodass das ungefilterte **Recordset** -Objekt im Raster angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-154">The code removes and resets as the **DataSource** for the Microsoft Bound DataGrid on the form so that the unfiltered **Recordset** appears in the grid.</span></span>

<span data-ttu-id="f7dfb-155">Der Code überprüft als Nächstes, ob Sie sich im **Recordset**-Objekt mithilfe der **Supports**-Methode mit dem **adMovePrevious**-Argument zurück bewegen können.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-155">The code then checks to see whether you can move backward in the **Recordset** by using the **Supports** method with the **adMovePrevious** argument.</span></span>

<span data-ttu-id="f7dfb-p116">Die Routine kehrt mit der **MoveFirst**-Methode zum ersten Datensatz zurück und zeigt den ursprünglichen und aktuellen Wert des Felds an. Hierzu werden die Eigenschaften **OriginalValue** und **Value** des **Field**-Objekts verwendet. Diese Eigenschaften werden zusammen mit der **UnderlyingValue**-Eigenschaft (hier nicht verwendet) in [Kapitel 5: Aktualisieren und Speichern von Daten](chapter-5-updating-and-persisting-data.md) beschrieben.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p116">The routine moves to the first record using the **MoveFirst** method and displays the field's original and current values, using the **OriginalValue** and **Value** properties of the **Field** object. These properties, along with the **UnderlyingValue** property (not used here), are discussed in [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

<span data-ttu-id="f7dfb-p117">Im nächsten Schritt wird ein neues **Connection**-Objekt erstellt und verwendet, um mit der Datenquelle erneut eine Verbindung herzustellen. Sie verbinden das **Recordset**-Objekt erneut mit der Datenquelle, indem Sie das neue **Connection**-Objekt als **ActiveConnection** für das **Recordset**-Objekt festlegen. Um die Aktualisierungen an den Server zu senden, ruft der Code **UpdateBatch** auf dem **Recordset**-Objekt auf.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p117">Next, a new **Connection** object is created and used to reestablish a connection to the data source. You reconnect the **Recordset** to the data source by setting the new **Connection** as the **ActiveConnection** for the **Recordset**. To send the updates to the server, the code calls **UpdateBatch** on the **Recordset**.</span></span>

<span data-ttu-id="f7dfb-161">Wenn die Batchaktualisierung erfolgreich ist, wird eine Flag-Variable auf Modulebene auf true festgelegt.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-161">If the batch update succeeds, a module-level flag variable, , is set to True.</span></span> <span data-ttu-id="f7dfb-162">Damit werden Sie später daran erinnert, alle an der Datenbank vorgenommenen Änderungen zu bereinigen.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-162">This will remind you later to clean up all changes made to the database.</span></span>

<span data-ttu-id="f7dfb-p119">In einem letzten Schritt kehrt der Code zum ersten Datensatz im **Recordset** -Objekt zurück und zeigt den ursprünglichen und aktuellen Wert an. Diese beiden Werte sind nach dem Aufruf von **UpdateBatch** identisch.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-p119">Finally, the code moves back to the first record in the **Recordset** and displays the original and current values. The values are the same after the call to **UpdateBatch**.</span></span>

<span data-ttu-id="f7dfb-165">Ausführlichere Informationen zum Aktualisieren von Daten sowie Anweisungen zur Vorgehensweise, wenn Daten auf dem Server geändert werden, während das **Recordset** -Objekt getrennt ist, finden Sie in [Kapitel 5: Aktualisieren und Speichern von Daten](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="f7dfb-165">For more detailed information about updating data, including what to do when data on the server changes while your **Recordset** is disconnected, see [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

## <a name="formunload"></a><span data-ttu-id="f7dfb-166">Formular\_entladen</span><span class="sxs-lookup"><span data-stu-id="f7dfb-166">Form\_Unload</span></span>

<span data-ttu-id="f7dfb-167">Die unter\_Routine für das Entladen von Formularen ist aus verschiedenen Gründen wichtig.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-167">The Form\_Unload subroutine is important for several reasons.</span></span> <span data-ttu-id="f7dfb-168">Da es sich um eine Beispielanwendung handelt,\_werden die Änderungen an der Datenbank bereinigt, bevor die Anwendung beendet wird.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-168">First, because this is a sample application, Form\_Unload cleans up the changes made to the database before the application exits.</span></span> <span data-ttu-id="f7dfb-169">Second, the code shows how a command can be executed directly from an open **Connection** object using the **Execute** method.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-169">Second, the code shows how a command can be executed directly from an open **Connection** object using the **Execute** method.</span></span> <span data-ttu-id="f7dfb-170">Schließlich zeigt es ein Beispiel für das Ausführen einer nicht Zeilen übergebenen Abfrage (eine Aktualisierungsabfrage) für die Datenquelle.</span><span class="sxs-lookup"><span data-stu-id="f7dfb-170">Finally, it shows an example of executing a non-row–returning query (an UPDATE query) against the data source.</span></span>

