---
title: Transaktionsverarbeitung
TOCTitle: Transaction Processing
ms:assetid: 7cacf3bb-e523-8739-f9ff-c8663c9ddfeb
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249523(v=office.15)
ms:contentKeyID: 48545842
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: c13f25df31bea1eb742b4a7e7c958ccdbfb7274a
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: Auto
ms.contentlocale: de-DE
ms.lasthandoff: 01/17/2019
ms.locfileid: "28703342"
---
# <a name="transaction-processing"></a><span data-ttu-id="f880e-102">Verarbeitung von Transaktionen</span><span class="sxs-lookup"><span data-stu-id="f880e-102">Transaction processing</span></span>

<span data-ttu-id="f880e-103">**Betrifft**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="f880e-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="f880e-p101">ADO stellt die folgenden Methoden zur Steuerung von Transaktionen bereit: **BeginTrans**, **CommitTrans** und **RollbackTrans**. Verwenden Sie diese Methoden mit einem **Connection** -Objekt, wenn Sie Änderungen an den Quelldaten als eine Einheit speichern oder abbrechen möchten. Um z. B. Geld zwischen Konten zu überweisen, subtrahieren Sie einen Betrag von einem Konto und addieren ihn zu einem anderen Konto. Wenn bei einer der Aktualisierungen ein Fehler gemeldet wird, stimmen die Konten nicht mehr. Wenn Sie diese Änderungen in einer geöffneten Transaktion vornehmen, ist sichergestellt, dass entweder alle oder keine Änderungen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="f880e-p101">ADO provides the following methods for controlling transactions: **BeginTrans**, **CommitTrans**, and **RollbackTrans**. Use these methods with a **Connection** object when you want to save or cancel a series of changes made to the source data as a single unit. For example, to transfer money between accounts, you subtract an amount from one and add the same amount to the other. If either update fails, the accounts no longer balance. Making these changes within an open transaction ensures that either all or none of the changes go through.</span></span>

> [!NOTE]
> <span data-ttu-id="f880e-p102">Transaktionen werden nicht von allen Anbietern unterstützt. Überprüfen Sie, ob die vom Anbieter definierte "**Transaction DDL**"-Eigenschaft in der [Properties](properties-collection-ado.md)-Auflistung des **Connection**-Objekts angezeigt wird und damit angibt, dass Transaktionen vom Anbieter unterstützt werden. Wenn Transaktionen vom Anbieter nicht unterstützt werden, wird beim Aufrufen einer dieser Methoden ein Fehler zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="f880e-p102">Not all providers support transactions. Verify that the provider-defined property "**Transaction DDL**" appears in the **Connection** object's [Properties](properties-collection-ado.md) collection, indicating that the provider supports transactions. If the provider does not support transactions, calling one of these methods will return an error.</span></span>

<span data-ttu-id="f880e-112">Nachdem Sie die **BeginTrans** -Methode aufgerufen haben, führt der Anbieter erst wieder einen sofortigen Commit für Ihre Änderungen aus, wenn Sie **CommitTrans** oder **RollbackTrans** zum Beenden der Transaktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="f880e-112">After you call the **BeginTrans** method, the provider will no longer instantaneously commit changes you make until you call **CommitTrans** or **RollbackTrans** to end the transaction.</span></span>

<span data-ttu-id="f880e-p103">Durch Aufrufen der **CommitTrans** -Methode werden Änderungen gespeichert, die in einer geöffneten Transaktion für die Verbindung vorgenommen wurden, und die Transaktion wird beendet. Durch Aufrufen der **RollbackTrans** -Methode werden alle Änderungen, die in einer geöffneten Transaktion vorgenommen wurden, rückgängig gemacht, und die Transaktion wird beendet. Ein Fehler wird generiert, wenn eine der Methoden ohne geöffnete Transaktion aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="f880e-p103">Calling the **CommitTrans** method saves changes made within an open transaction on the connection and ends the transaction. Calling the **RollbackTrans** method reverses any changes made within an open transaction and ends the transaction. Calling either method when there is no open transaction generates an error.</span></span>

<span data-ttu-id="f880e-p104">In Abhängigkeit von der **Attributes**-Eigenschaft des [Connection](attributes-property-ado.md) -Objekts kann durch Aufrufen der **CommitTrans** - oder **RollbackTrans** -Methode automatisch eine neue Transaktion gestartet werden. Wenn die **Attributes** -Eigenschaft auf **adXactCommitRetaining** festgelegt ist, startet der Anbieter nach einem Aufruf von **CommitTrans** automatisch eine neue Transaktion. Wenn die **Attributes** -Eigenschaft auf **adXactAbortRetaining** festgelegt ist, startet der Anbieter nach einem Aufruf von **RollbackTrans** automatisch eine neue Transaktion.</span><span class="sxs-lookup"><span data-stu-id="f880e-p104">Depending on the **Connection** object's [Attributes](attributes-property-ado.md) property, calling either the **CommitTrans** or **RollbackTrans** method may automatically start a new transaction. If the **Attributes** property is set to **adXactCommitRetaining**, the provider automatically starts a new transaction after a **CommitTrans** call. If the **Attributes** property is set to **adXactAbortRetaining**, the provider automatically starts a new transaction after a **RollbackTrans** call.</span></span>

## <a name="transaction-isolation-level"></a><span data-ttu-id="f880e-119">Transaktionsisolationsstufe</span><span class="sxs-lookup"><span data-stu-id="f880e-119">Transaction isolation level</span></span>

<span data-ttu-id="f880e-120">Mithilfe der **IsolationLevel** -Eigenschaft legen Sie die Isolationsstufe einer Transaktion in einem **Connection** -Objekt fest.</span><span class="sxs-lookup"><span data-stu-id="f880e-120">Use the **IsolationLevel** property to set the isolation level of a transaction on a **Connection** object.</span></span> <span data-ttu-id="f880e-121">Diese Einstellung wird erst nach dem nächsten Aufruf der [BeginTrans](begintrans-committrans-and-rollbacktrans-methods-ado.md)-Methode wirksam.</span><span class="sxs-lookup"><span data-stu-id="f880e-121">The setting does not take effect until the next time you call the [BeginTrans](begintrans-committrans-and-rollbacktrans-methods-ado.md) method.</span></span> <span data-ttu-id="f880e-122">Falls die angeforderte Isolationsstufe nicht verfügbar ist, gibt der Anbieter möglicherweise die nächsthöhere Isolationsstufe zurück.</span><span class="sxs-lookup"><span data-stu-id="f880e-122">If the level of isolation you request is unavailable, the provider may return the next greater level of isolation.</span></span> <span data-ttu-id="f880e-123">Verweisen Sie auf die **IsolationLevel** -Eigenschaft in der ADO-Programmierreferenz für Weitere Informationen zu gültigen Werten.</span><span class="sxs-lookup"><span data-stu-id="f880e-123">Refer to the **IsolationLevel** property in the ADO programmer's reference for more details on valid values.</span></span>

## <a name="nested-transactions"></a><span data-ttu-id="f880e-124">Geschachtelte Transaktionen</span><span class="sxs-lookup"><span data-stu-id="f880e-124">Nested transactions</span></span>

<span data-ttu-id="f880e-p106">Für Anbieter, die geschachtelte Transaktionen unterstützen, wird durch Aufrufen der **BeginTrans** -Methode in einer geöffneten Transaktion eine neue, geschachtelte Transaktion gestartet. Der Rückgabewert gibt die Schachtelungsebene an: Der Rückgabewert "1" gibt an, dass Sie eine Transaktion der obersten Ebene geöffnet haben (die Transaktion wird also nicht innerhalb einer anderen Transaktion geschachtelt); "2" gibt an, dass Sie eine Transaktion der zweiten Ebene geöffnet haben (eine Transaktion, die innerhalb einer Transaktion der obersten Ebene geschachtelt ist) usw. Das Aufrufen von **CommitTrans** oder **RollbackTrans** wirkt sich nur auf die zuletzt geöffnete Transaktion aus. Sie müssen die aktuelle Transaktion schließen oder ein Rollback dafür ausführen, damit Sie Transaktionen auf höherer Ebene auflösen können.</span><span class="sxs-lookup"><span data-stu-id="f880e-p106">For providers that support nested transactions, calling the **BeginTrans** method within an open transaction starts a new, nested transaction. The return value indicates the level of nesting: a return value of "1" indicates you have opened a top-level transaction (that is, the transaction is not nested within another transaction), "2" indicates that you have opened a second-level transaction (a transaction nested within a top-level transaction), and so forth. Calling **CommitTrans** or **RollbackTrans** affects only the most recently opened transaction; you must close or roll back the current transaction before you can resolve any higher-level transactions.</span></span>

